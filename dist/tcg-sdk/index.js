/*! For license information please see index.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(self,(function(){return(()=>{var e={4206:(e,t,n)=>{e.exports=n(8057)},4387:(e,t,n)=>{"use strict";var i=n(7485),o=n(4570),r=n(2940),s=n(581),a=n(574),c=n(3845),d=n(8338),l=n(8524),u=n(3141),h=n(7132);e.exports=function(e){return new Promise((function(t,n){var p,f=e.data,m=e.headers,v=e.responseType;function g(){e.cancelToken&&e.cancelToken.unsubscribe(p),e.signal&&e.signal.removeEventListener("abort",p)}i.isFormData(f)&&delete m["Content-Type"];var y=new XMLHttpRequest;if(e.auth){var C=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.Authorization="Basic "+btoa(C+":"+b)}var S=a(e.baseURL,e.url);function k(){if(y){var i="getAllResponseHeaders"in y?c(y.getAllResponseHeaders()):null,r={data:v&&"text"!==v&&"json"!==v?y.response:y.responseText,status:y.status,statusText:y.statusText,headers:i,config:e,request:y};o((function(e){t(e),g()}),(function(e){n(e),g()}),r),y=null}}if(y.open(e.method.toUpperCase(),s(S,e.params,e.paramsSerializer),!0),y.timeout=e.timeout,"onloadend"in y?y.onloadend=k:y.onreadystatechange=function(){y&&4===y.readyState&&(0!==y.status||y.responseURL&&0===y.responseURL.indexOf("file:"))&&setTimeout(k)},y.onabort=function(){y&&(n(l("Request aborted",e,"ECONNABORTED",y)),y=null)},y.onerror=function(){n(l("Network Error",e,null,y)),y=null},y.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",i=e.transitional||u.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(l(t,e,i.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",y)),y=null},i.isStandardBrowserEnv()){var T=(e.withCredentials||d(S))&&e.xsrfCookieName?r.read(e.xsrfCookieName):void 0;T&&(m[e.xsrfHeaderName]=T)}"setRequestHeader"in y&&i.forEach(m,(function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete m[t]:y.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(y.withCredentials=!!e.withCredentials),v&&"json"!==v&&(y.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&y.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&y.upload&&y.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(p=function(e){y&&(n(!e||e&&e.type?new h("canceled"):e),y.abort(),y=null)},e.cancelToken&&e.cancelToken.subscribe(p),e.signal&&(e.signal.aborted?p():e.signal.addEventListener("abort",p))),f||(f=null),y.send(f)}))}},8057:(e,t,n)=>{"use strict";var i=n(7485),o=n(875),r=n(5029),s=n(4941),a=function e(t){var n=new r(t),a=o(r.prototype.request,n);return i.extend(a,r.prototype,n),i.extend(a,n),a.create=function(n){return e(s(t,n))},a}(n(3141));a.Axios=r,a.Cancel=n(7132),a.CancelToken=n(4603),a.isCancel=n(1475),a.VERSION=n(3345).version,a.all=function(e){return Promise.all(e)},a.spread=n(5739),a.isAxiosError=n(5835),e.exports=a,e.exports.default=a},7132:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4603:(e,t,n)=>{"use strict";var i=n(7132);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,i=n._listeners.length;for(t=0;t<i;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,i=new Promise((function(e){n.subscribe(e),t=e})).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e((function(e){n.reason||(n.reason=new i(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},o.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},1475:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},5029:(e,t,n)=>{"use strict";var i=n(7485),o=n(581),r=n(8096),s=n(5009),a=n(4941),c=n(6144),d=c.validators;function l(e){this.defaults=e,this.interceptors={request:new r,response:new r}}l.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:d.transitional(d.boolean),forcedJSONParsing:d.transitional(d.boolean),clarifyTimeoutError:d.transitional(d.boolean)},!1);var n=[],i=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var o,r=[];if(this.interceptors.response.forEach((function(e){r.push(e.fulfilled,e.rejected)})),!i){var l=[s,void 0];for(Array.prototype.unshift.apply(l,n),l=l.concat(r),o=Promise.resolve(e);l.length;)o=o.then(l.shift(),l.shift());return o}for(var u=e;n.length;){var h=n.shift(),p=n.shift();try{u=h(u)}catch(e){p(e);break}}try{o=s(u)}catch(e){return Promise.reject(e)}for(;r.length;)o=o.then(r.shift(),r.shift());return o},l.prototype.getUri=function(e){return e=a(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,n,i){return this.request(a(i||{},{method:e,url:t,data:n}))}})),e.exports=l},8096:(e,t,n)=>{"use strict";var i=n(7485);function o(){this.handlers=[]}o.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},574:(e,t,n)=>{"use strict";var i=n(2642),o=n(2288);e.exports=function(e,t){return e&&!i(t)?o(e,t):t}},8524:(e,t,n)=>{"use strict";var i=n(9953);e.exports=function(e,t,n,o,r){var s=new Error(e);return i(s,t,n,o,r)}},5009:(e,t,n)=>{"use strict";var i=n(7485),o=n(9212),r=n(1475),s=n(3141),a=n(7132);function c(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new a("canceled")}e.exports=function(e){return c(e),e.headers=e.headers||{},e.data=o.call(e,e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return c(e),t.data=o.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return r(t)||(c(e),t&&t.response&&(t.response.data=o.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},9953:e=>{"use strict";e.exports=function(e,t,n,i,o){return e.config=t,n&&(e.code=n),e.request=i,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},4941:(e,t,n)=>{"use strict";var i=n(7485);e.exports=function(e,t){t=t||{};var n={};function o(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function r(n){return i.isUndefined(t[n])?i.isUndefined(e[n])?void 0:o(void 0,e[n]):o(e[n],t[n])}function s(e){if(!i.isUndefined(t[e]))return o(void 0,t[e])}function a(n){return i.isUndefined(t[n])?i.isUndefined(e[n])?void 0:o(void 0,e[n]):o(void 0,t[n])}function c(n){return n in t?o(e[n],t[n]):n in e?o(void 0,e[n]):void 0}var d={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return i.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=d[e]||r,o=t(e);i.isUndefined(o)&&t!==c||(n[e]=o)})),n}},4570:(e,t,n)=>{"use strict";var i=n(8524);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},9212:(e,t,n)=>{"use strict";var i=n(7485),o=n(3141);e.exports=function(e,t,n){var r=this||o;return i.forEach(n,(function(n){e=n.call(r,e,t)})),e}},3141:(e,t,n)=>{"use strict";var i=n(7485),o=n(1446),r=n(9953),s={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,d={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(c=n(4387)),c),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,n){if(i.isString(e))try{return(0,JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||d.transitional,n=t&&t.silentJSONParsing,o=t&&t.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||o&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(s){if("SyntaxError"===e.name)throw r(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){d.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){d.headers[e]=i.merge(s)})),e.exports=d},3345:e=>{e.exports={version:"0.24.0"}},875:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},581:(e,t,n)=>{"use strict";var i=n(7485);function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(i.isURLSearchParams(t))r=t.toString();else{var s=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),s.push(o(t)+"="+o(e))})))})),r=s.join("&")}if(r){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}},2288:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},2940:(e,t,n)=>{"use strict";var i=n(7485);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,n,o,r,s){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(o)&&a.push("path="+o),i.isString(r)&&a.push("domain="+r),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},2642:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},5835:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},8338:(e,t,n)=>{"use strict";var i=n(7485);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var i=e;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=i.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},1446:(e,t,n)=>{"use strict";var i=n(7485);e.exports=function(e,t){i.forEach(e,(function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])}))}},3845:(e,t,n)=>{"use strict";var i=n(7485),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,r,s={};return e?(i.forEach(e.split("\n"),(function(e){if(r=e.indexOf(":"),t=i.trim(e.substr(0,r)).toLowerCase(),n=i.trim(e.substr(r+1)),t){if(s[t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},5739:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},6144:(e,t,n)=>{"use strict";var i=n(3345).version,o={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){o[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var r={};o.transitional=function(e,t,n){function o(e,t){return"[Axios v"+i+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,s){if(!1===e)throw new Error(o(i," has been removed"+(t?" in "+t:"")));return t&&!r[i]&&(r[i]=!0,console.warn(o(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,s)}},e.exports={assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),o=i.length;o-- >0;){var r=i[o],s=t[r];if(s){var a=e[r],c=void 0===a||s(a,r,e);if(!0!==c)throw new TypeError("option "+r+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+r)}},validators:o}},7485:(e,t,n)=>{"use strict";var i=n(875),o=Object.prototype.toString;function r(e){return"[object Array]"===o.call(e)}function s(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==o.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function d(e){return"[object Function]"===o.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),r(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:r,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:s,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:d,isStream:function(e){return a(e)&&d(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function e(){var t={};function n(n,i){c(t[i])&&c(n)?t[i]=e(t[i],n):c(n)?t[i]=e({},n):r(n)?t[i]=n.slice():t[i]=n}for(var i=0,o=arguments.length;i<o;i++)l(arguments[i],n);return t},extend:function(e,t,n){return l(t,(function(t,o){e[o]=n&&"function"==typeof t?i(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},2179:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1743),o=function(){function e(e){var t=e.sdk;this.config=null,this.featureSwitch=null,this.role=null,this.hostUserId=null,this.loginHelper=null,this.seatIndex=0,this.serverSideDescription=i.empty,this.sdk=null,this.sdk=t}return e.prototype.setRole=function(e){this.role=e},e.prototype.setHostUserId=function(e){this.hostUserId=e},e.prototype.getHostUserId=function(){return this.hostUserId},e.prototype.setSeatIndex=function(e){this.seatIndex=e,this.parse()},e.prototype.setGameConfig=function(e){this.config=e;var t=e.sdk_conf;if(t){var n=this.sdk.getInitOptions(),i=n.webDraftLevel,o=n.keepLastFrame,r=n.tabletMode;"number"==typeof t.webdraft_level&&void 0!==i&&this.sdk.pageEvent.setWebDraftLevel(t.webdraft_level),t.connect_timeout&&this.sdk.cloudGamingWebRTC.setNewConnectTimeout(t.connect_timeout),t.noflow_timeout&&this.sdk.cloudGamingWebRTC.setNoflowTimeout(t.noflow_timeout),t.cursor_scale&&this.sdk.cloudGamingWebRTC.setMobileCursorScale(t.cursor_scale),t.cursor_style&&this.sdk.setRemoteCursorStyle(t.cursor_style),"boolean"==typeof t.keep_lastframe&&void 0===o&&this.sdk.cloudGamingWebRTC.setKeepLastFrame(t.keep_lastframe),"boolean"==typeof t.tablet_mode&&void 0===r&&this.sdk.mouseTabletMode(t.tablet_mode),"boolean"==typeof t.mobile_show_cursor&&this.sdk.cloudGamingWebRTC.setMobileShowCursor(t.mobile_show_cursor)}},e.prototype.getConfig=function(){return{login_helper:this.loginHelper,seat_index:this.seatIndex,role:this.role,game_config:this.config,server_side_description:this.serverSideDescription}},e.prototype.setFeatureSwitch=function(e){void 0===e&&(e={});try{var t=e.network_event_script;t&&(t=JSON.parse(t)),this.featureSwitch={network_event_script:t}}catch(e){this.sdk.log("setFeatureSwitch error",e)}},e.prototype.getFeatureSwitch=function(){return this.featureSwitch},e.prototype.setServerSideDescription=function(e){this.serverSideDescription=e,this.sdk.showStats.setStaticStat()},e.prototype.getServerSideDescription=function(){return this.serverSideDescription||i.empty},e.prototype.parse=function(){if(this.sdk.log("enter gameConfig parse",this.config,this.role,this.seatIndex),!this.config)return this.sdk.log("game_config does not set");if(!this.role)return this.sdk.log("role does not set");var e=(this.config.sdk_conf||i.empty).login_helper;e?this.loginHelper=e:this.sdk.log("no login helper loaded")},e}();t.default=o},5262:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0,t.config={version:"2.0.0",versionGC:"1.0.0",lite:!1,privatization:{server:""}}},8751:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraProfile=void 0,t.CameraProfile={"120p":{width:160,height:120,frameRate:30,bitrate:200,type:"120p"},"180p":{width:320,height:180,frameRate:30,bitrate:350,type:"180p"},"240p":{width:320,height:240,frameRate:30,bitrate:400,type:"240p"},"360p":{width:640,height:360,frameRate:30,bitrate:800,type:"360p"},"480p":{width:640,height:480,frameRate:30,bitrate:900,type:"480p"},"720p":{width:1280,height:720,frameRate:30,bitrate:1500,type:"720p"},"1080p":{width:1920,height:1080,frameRate:30,bitrate:2e3,type:"1080p"}}},9418:(e,t)=>{"use strict";var n,i,o,r,s,a,c,d,l,u,h;Object.defineProperty(t,"__esModule",{value:!0}),t.ANSWER_SDP_CODE=t.PROXY_CODE=t.TOUCH_EVENT_TYPE=t.WEB_DRAFT_LEVEL=t.DATACHANNEL=t.CONNECT_FAILED_CODE=t.RTC_CODE=t.CURSOR_MODE=t.STATUS=t.PAGE_STATS=t.STATS=void 0,function(e){e.LOADING="loading",e.PLAYING="playing",e.ENDED="ended"}(n||(t.STATS=n={})),function(e){e.LOADING="loading",e.PLAYING="playing",e.ENDED="ended"}(i||(t.PAGE_STATS=i={})),function(e){e[e.DISCONNECTED=0]="DISCONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.ESTABLISHED=2]="ESTABLISHED"}(o||(t.STATUS=o={})),function(e){e[e.LOCAL=0]="LOCAL",e[e.REMOTE_SRC=1]="REMOTE_SRC",e[e.REMOTE_DRAW=2]="REMOTE_DRAW",e[e.REMOTE_CUSTOM=3]="REMOTE_CUSTOM",e[e.REMOTE_SRC_POS=4]="REMOTE_SRC_POS",e[e.FRONT_DRAW_DELTA_POS=5]="FRONT_DRAW_DELTA_POS"}(r||(t.CURSOR_MODE=r={})),function(e){e[e.CREATE_OFFER_FAILED=-2]="CREATE_OFFER_FAILED",e[e.NEED_RECONNECT=-1]="NEED_RECONNECT",e[e.MANUAL_CLOSE=0]="MANUAL_CLOSE",e[e.OTHER_KICK=1]="OTHER_KICK",e[e.HEARTBEAT_TIMEOUT=2]="HEARTBEAT_TIMEOUT",e[e.CONNECT_FAILED=3]="CONNECT_FAILED",e[e.TOKEN_ERROR=4]="TOKEN_ERROR"}(s||(t.RTC_CODE=s={})),function(e){e[e.TOO_FREQUENTLY=-1]="TOO_FREQUENTLY",e[e.AUTO_RECONNECTING=-2]="AUTO_RECONNECTING",e[e.EXCEEDED_LIMIT_RERTY_TIMES=-3]="EXCEEDED_LIMIT_RERTY_TIMES"}(a||(t.CONNECT_FAILED_CODE=a={})),function(e){e.ACK="ack",e.HB="hb",e.CD="cd",e.KM="km",e.SVR="svr",e.SV="sv",e.CLOUD_DEVICE="cloud_device"}(c||(t.DATACHANNEL=c={})),function(e){e[e.CLOSE_HIGH_FREQUENCY=0]="CLOSE_HIGH_FREQUENCY",e[e.UNPACKAGE_SEND=1]="UNPACKAGE_SEND",e[e.PACKAGE_SEND=2]="PACKAGE_SEND",e[e.LIMIT_LENGTH=3]="LIMIT_LENGTH"}(d||(t.WEB_DRAFT_LEVEL=d={})),function(e){e[e.touchstart=0]="touchstart",e[e.touchmove=1]="touchmove",e[e.touchend=2]="touchend",e[e.touchcancel=2]="touchcancel"}(l||(t.TOUCH_EVENT_TYPE=l={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.STREAM_NOT_FOUND=4e3]="STREAM_NOT_FOUND",e[e.STREAM_EXIST=4001]="STREAM_EXIST",e[e.PARAM_ERROR=4002]="PARAM_ERROR",e[e.SERVER_ERROR=5e3]="SERVER_ERROR",e[e.BACK_TO_SOURCE_ERROR=5001]="BACK_TO_SOURCE_ERROR",e[e.BACK_TO_SOURCE_REQ_PARAM_ERROR=5002]="BACK_TO_SOURCE_REQ_PARAM_ERROR",e[e.BACK_TO_SOURCE_RES_PARAM_ERROR=5003]="BACK_TO_SOURCE_RES_PARAM_ERROR"}(u||(t.PROXY_CODE=u={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.BUSY=1]="BUSY",e[e.TOKEN_ERROR=2]="TOKEN_ERROR",e[e.SDP_ERROR=6]="SDP_ERROR",e[e.WAIT_HOST=8]="WAIT_HOST",e[e.PLAYERS_NUMBER_OR_ROLE_LIMIT=9]="PLAYERS_NUMBER_OR_ROLE_LIMIT",e[e.PROXY_ERROR=100]="PROXY_ERROR"}(h||(t.ANSWER_SDP_CODE=h={}))},1587:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.KEYCODE=void 0,function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.CapsLock=20]="CapsLock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Zero=48]="Zero",e[e.ClosedParen=48]="ClosedParen",e[e.One=49]="One",e[e.ExclamationMark=49]="ExclamationMark",e[e.Two=50]="Two",e[e.AtSign=50]="AtSign",e[e.Three=51]="Three",e[e.PoundSign=51]="PoundSign",e[e.Hash=51]="Hash",e[e.Four=52]="Four",e[e.DollarSign=52]="DollarSign",e[e.Five=53]="Five",e[e.PercentSign=53]="PercentSign",e[e.Six=54]="Six",e[e.Caret=54]="Caret",e[e.Hat=54]="Hat",e[e.Seven=55]="Seven",e[e.Ampersand=55]="Ampersand",e[e.Eight=56]="Eight",e[e.Star=56]="Star",e[e.Asterik=56]="Asterik",e[e.Nine=57]="Nine",e[e.OpenParen=57]="OpenParen",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.Numpad0=96]="Numpad0",e[e.Numpad1=97]="Numpad1",e[e.Numpad2=98]="Numpad2",e[e.Numpad3=99]="Numpad3",e[e.Numpad4=100]="Numpad4",e[e.Numpad5=101]="Numpad5",e[e.Numpad6=102]="Numpad6",e[e.Numpad7=103]="Numpad7",e[e.Numpad8=104]="Numpad8",e[e.Numpad9=105]="Numpad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.SemiColon=186]="SemiColon",e[e.Equals=187]="Equals",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.UnderScore=189]="UnderScore",e[e.PlusSign=187]="PlusSign",e[e.ForwardSlash=191]="ForwardSlash",e[e.Tilde=192]="Tilde",e[e.GraveAccent=192]="GraveAccent",e[e.Backquote=192]="Backquote",e[e.OpenBracket=219]="OpenBracket",e[e.ClosedBracket=221]="ClosedBracket",e[e.Quote=222]="Quote"}(n||(t.KEYCODE=n={}))},4993:function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CloudGamingWebSDK=void 0;var d=c(n(6994)),l=n(5262),u=n(9418),h=c(n(9752)),p=c(n(4711)),f=n(869),m=n(1743),v=c(n(2343)),g=c(n(5922)),y=c(n(969)),C=c(n(9531)),b=c(n(2179)),S=function(e){function t(){var t=e.call(this)||this;return t.version=l.config.version,t.cloudGamingWebRTC=null,t.pageEvent=null,t.gamepad=null,t.watchdog=null,t.gameConfig=null,t.showStats=null,t.initOptions={mount:null,reconnect:!0},t.uuid=null,t.sdkInitStartTime=null,t.cloudGamingWebRTC=new h.default({sdk:t}),t.pageEvent=new p.default({sdk:t}),t.gamepad=new y.default({sdk:t}),t.watchdog=new C.default({sdk:t}),t.gameConfig=new b.default({sdk:t}),t.showStats=new v.default({sdk:t}),t.uuid=+new Date,t}return o(t,e),Object.defineProperty(t.prototype,"mountPoint",{get:function(){return null===document||void 0===document?void 0:document.querySelector("#".concat(this.initOptions.mount))},enumerable:!1,configurable:!0}),t.prototype.init=function(e){this.initLoggerConfig(e),this.sdkInitStartTime=+new Date;var t=e.mount,n=e.loadingText,i=e.showLoading,o=e.restartText,s=e.controller;this.mountGamePoint({mount:t,loadingText:n,showLoading:i,restartText:o,controller:s}),this.initOptions=r(r({},this.initOptions),e),this.onPageLoad(e),this.log("init->",this.initOptions),this.log("userAgent",null===navigator||void 0===navigator?void 0:navigator.userAgent)},Object.defineProperty(t.prototype,"initStartTime",{get:function(){return this.sdkInitStartTime},enumerable:!1,configurable:!0}),t.prototype.getInitOptions=function(){return this.initOptions},t.prototype.getController=function(){return this.initOptions.controller},t.prototype.getClientSession=function(){return this.cloudGamingWebRTC.getClientSideDescription()},t.prototype.getServerSession=function(){return this.gameConfig.getServerSideDescription()},t.prototype.start=function(e){void 0===e&&(e=""),this.cloudGamingWebRTC.connect(e)},t.prototype.destroy=function(e){var t=void 0===e?m.empty:e,n=t.message,i=void 0===n?"主动关闭":n,o=t.code,r=void 0===o?u.RTC_CODE.MANUAL_CLOSE:o;this.log("destroy->","message: ",i,"code: ",r),this.cloudGamingWebRTC.disconnected({message:i,code:r})},t.prototype.reconnect=function(){this.cloudGamingWebRTC.clearPeerConnection(),this.cloudGamingWebRTC.reconnect({message:"manual reconnect"})},t.prototype.gameRestart=function(e){void 0===e&&(e=m.noop),this.log("gameRestart->"),this.cloudGamingWebRTC.sendAckData({data:{type:"game_op",op:"restart"},callback:e}),this.clearRemoteKeys()},t.prototype.gamePause=function(e){void 0===e&&(e=m.noop),this.log("gamePause->"),this.cloudGamingWebRTC.sendAckData({data:{type:"game_op",op:"pause"},callback:e}),this.cloudGamingWebRTC.setGameStatus("pause"),this.clearRemoteKeys()},t.prototype.gameResume=function(e){void 0===e&&(e=m.noop),this.log("gameResume->"),this.cloudGamingWebRTC.sendAckData({data:{type:"game_op",op:"resume"},callback:e}),this.cloudGamingWebRTC.setGameStatus("playing"),this.clearRemoteKeys()},t.prototype.playVideo=function(e){var t,n,i=this.getHuaweiAudioElement();return i&&("play"===e&&i.play(),"pause"===e&&i.pause()),"play"===e?null===(t=this.getVideoElement())||void 0===t?void 0:t.play():"pause"===e?null===(n=this.getVideoElement())||void 0===n?void 0:n.pause():void 0},t.prototype.setVideoOrientation=function(e){var t=void 0===e?{}:e,n=t.deg,i=void 0===n?0:n,o=t.rotateContainer,r=void 0===o||o,s=t.rotateMountPoint,a=void 0!==s&&s;this.log("setVideoOrientation",i,r),this.pageEvent.setVideoOrientation({deg:i,rotateContainer:r,rotateMountPoint:a})},t.prototype.getPageSize=function(){return{width:window.innerWidth,height:window.innerHeight}},t.prototype.sendKeyboardEvent=function(e){var t=e.key,n=e.down,i=e.location,o=void 0===i?0:i;this.cloudGamingWebRTC.sendKmData({type:"keyboard",key:t,down:n,location:o})},t.prototype.sendMouseEvent=function(e){var t=e.type,n=e.down,i=e.delta;this.cloudGamingWebRTC.sendKmData({type:t,down:n,delta:i})},t.prototype.sendGamepadEvent=function(e){var t=e.type,n=e.down,i=e.key,o=e.x,r=e.y;this.cloudGamingWebRTC.sendKmData({type:t,down:n,key:i,x:o,y:r})},t.prototype.sendRawEvent=function(e){switch(this.log("sendRawEvent->",e),"object"!=typeof e&&console.error("data is not an object"),!0){case"keyboard"===e.type:this.sendKeyboardEvent(e);break;case e.type.includes("mouse"):this.sendMouseEvent(e);break;case e.type.includes("gamepad")||e.type.includes("axis")||e.type.includes("lt")||e.type.includes("rt"):this.sendGamepadEvent(e);break;default:this.cloudGamingWebRTC.sendAckData({data:e})}},t.prototype.sendKmData=function(e){this.cloudGamingWebRTC.sendKmData(e)},t.prototype.setMoveSensitivity=function(e){this.log("setMoveSensitivity->",e),"number"!=typeof e&&console.error("input value must be number"),(e-.01<Number.EPSILON||e-100>Number.EPSILON)&&console.error("sensitivity is out of range"),this.pageEvent.setMoveSensitivity(e)},t.prototype.sendSeqRawEvents=function(e){this.log("sendSeqRawEvents->",e),this.cloudGamingWebRTC.sendKmData({type:"key_seq",keys:e.map((function(e){return JSON.stringify(e)}))})},t.prototype.getMoveSensitivity=function(){return this.pageEvent?1/this.pageEvent.getMoveSensitivity():1},t.prototype.setMouseCanLock=function(e){this.log("setMouseCanLock->",e),this.cloudGamingWebRTC.lockMouse(e),this.cloudGamingWebRTC.setForceShowCursor(!e)},t.prototype.lockMouse=function(e){this.log("lockMouse->",e),this.cloudGamingWebRTC.setForceLockCursor(e),this.cloudGamingWebRTC.lockMouse(e)},t.prototype.mouseMove=function(e,t,n,i){this.pageEvent.mouseMove(e,t,n,i)},t.prototype.mouseTabletMode=function(e){this.log("mouseTabletMode->",e),this.pageEvent.setTabletMode(e),this.resetCursorPos(this.cloudGamingWebRTC.getCursorMode())},t.prototype.setRemoteCursor=function(e){void 0===e&&(e=0),this.log("setRemoteCursor->",e),this.cloudGamingWebRTC.setCursorMode(e),this.resetCursorPos(e)},t.prototype.setCursorShowStat=function(e){this.log("setCursorShowStat->",e),this.cloudGamingWebRTC.setForceShowCursor(e)},t.prototype.setCursorShowStatus=function(e){this.log("setCursorShowStat->",e),this.cloudGamingWebRTC.setForceShowCursor(e)},t.prototype.setCursorState=function(e){"forceShow"===e&&(this.cloudGamingWebRTC.setForceShowCursor(!0),this.lockMouse(!1)),"forceLock"===e&&(this.cloudGamingWebRTC.setForceShowCursor(!1),this.lockMouse(!0)),"auto"===e&&(this.cloudGamingWebRTC.setForceShowCursor(!1),this.cloudGamingWebRTC.setForceLockCursor(!1))},t.prototype.getCursorShowStat=function(){return this.log("getCursorShowStat->",this.cloudGamingWebRTC.getCursorShowStatus()),this.cloudGamingWebRTC.getCursorShowStatus()},t.prototype.setMobileCursorScale=function(e){this.log("setMobileCursorScale->",e),this.cloudGamingWebRTC.setMobileCursorScale(e)},t.prototype.setRemoteCursorStyle=function(e){this.log("setRemoteCursorStyle->",e),this.cloudGamingWebRTC.sendAckData({data:{type:"set_pointer_style",style:e}})},t.prototype.clearRemoteKeys=function(){this.log("clearRemoteKeys->"),this.pageEvent.clearRemoteKeys()},t.prototype.resetRemoteCapsLock=function(){this.log("resetRemoteCapsLock->"),this.cloudGamingWebRTC.sendAckData({data:{type:"reset_capslock"}})},t.prototype.setDefaultCursorImage=function(e){this.log("setDefaultCursorImage->",e),e&&this.cloudGamingWebRTC.setDefaultCursorImage(e)},t.prototype.setKMStatus=function(e){var t=e.keyboard,n=void 0===t||t,i=e.mouse,o=void 0===i||i;this.pageEvent.setKMStatus({keyboard:n,mouse:o})},t.prototype.setPaste=function(e){this.pageEvent.setPaste(e)},t.prototype.setDebugMode=function(e){var t=void 0===e?{}:e,n=t.showStats,i=void 0!==n&&n,o=t.showLog,s=void 0!==o&&o,a=t.showOnAckMessage,c=void 0!==a&&a,d=t.showOnCdMessage,l=void 0!==d&&d,u=t.showOnHbMessage,h=void 0!==u&&u,p=t.showOnKmMessage,f=void 0!==p&&p,m=t.showOnSvMessage,v=void 0!==m&&m,g=t.showSendAckData,y=void 0!==g&&g,C=t.showSendHbData,b=void 0!==C&&C,S=t.showSendKmData,k=void 0!==S&&S;this.showStats.show(i),this.initOptions.debugSetting||(this.initOptions.debugSetting={}),this.initOptions.debugSetting=r(r({},this.initOptions.debugSetting),{showLog:s,showOnAckMessage:c,showOnCdMessage:l,showOnHbMessage:h,showOnKmMessage:f,showOnSvMessage:v,showSendAckData:y,showSendHbData:b,showSendKmData:k})},t.prototype.reportLog=function(){return this.log("reportLog, user manual upload"),this.reportLogInner()},t.prototype.setLogHandler=function(e){void 0===e&&(e=m.noop),this.log("setLogHandler"),this.setExternalLog(e)},t.prototype.toggleMetricReportBulk=function(e){void 0===e&&(e=!1),this.showStats.toggleMetricReportBulk(e)},t.prototype.setStreamProfile=function(e,t){var n;void 0===t&&(t=m.noop),this.log("setStreamProfile->",e),null===(n=this.cloudGamingWebRTC)||void 0===n||n.sendAckData({data:r(r({},e),{type:"res_mode",res:""}),callback:t})},t.prototype.getDisplayRect=function(){return this.cloudGamingWebRTC.getDisplayRect()},t.prototype.setVideoVolume=function(e){this.log("setVideoVolume->",e);var t=this.getHuaweiAudioElement();t&&(this.log("huawei setVideoVolume->",e),t.volume=e),this.getVideoElement().volume=e,0===e?(this.getVideoElement().muted=!0,this.pageEvent.setVideoMuted(!0)):(this.getVideoElement().muted=!1,this.pageEvent.setVideoMuted(!1),this.playVideo("play"))},t.prototype.getVideoVolume=function(){var e;return null!==(e=this.getVideoElement().volume)&&void 0!==e?e:0},t.prototype.switchMic=function(e){var t=e.status;return this.cloudGamingWebRTC.switchMic({status:t})},t.prototype.switchCamera=function(e){var t=e.status,n=e.profile;return this.cloudGamingWebRTC.switchCamera({status:t,profile:n})},t.prototype.setMicProfile=function(e){return this.cloudGamingWebRTC.setMicProfile(e)},t.prototype.setCameraProfile=function(e){return this.cloudGamingWebRTC.setCameraProfile(e)},t.prototype.getDevices=function(){return this.cloudGamingWebRTC.getDevices()},t.prototype.setPageBackground=function(e){void 0===e&&(e=""),this.log("setPageBackground->",e);var t=this.getCloudGamingContainerElement();t&&(t.style.background="url(".concat(e,")"))},t.prototype.sendText=function(e,t){void 0===e&&(e=""),void 0===t&&(t=m.noop),this.log("sendText",e),this.cloudGamingWebRTC.sendAckData({data:{type:"paste",content:e},callback:t})},t.prototype.setClientInteractMode=function(e){void 0===e&&(e="cursor"),this.log("setClientInteractMode->",e),this.pageEvent.setClientInteractMode(e)},t.prototype.setRemoteDesktopResolution=function(e){var t=this,n=e.width,i=e.height;return this.log("setRemoteDesktopResolution, width",n,"height",i),new Promise((function(e){t.cloudGamingWebRTC.sendAckData({data:{type:"desktop_res",width:Math.floor(n),height:Math.floor(i)},callback:function(t){var n=t.data;e(void 0===n?{code:-1}:n)}})}))},t.prototype.getRemoteStreamResolution=function(){if(this.getVideoElement().videoWidth&&this.getVideoElement().videoHeight)return{width:this.getVideoElement().videoWidth,height:this.getVideoElement().videoHeight};var e=this.gameConfig.getServerSideDescription().video,t=void 0===e?{}:e,n=t.width,i=void 0===n?0:n,o=t.height;return{width:i,height:void 0===o?0:o}},t.prototype.reshapeWindow=function(){this.pageEvent.reshapeWindow()},t.prototype.getUserMedia=function(){return this.cloudGamingWebRTC.getUserMedia()},t.prototype.getIsMobileGame=function(){return this.cloudGamingWebRTC.getIsMobileGame()},t.prototype.createCustomDataChannel=function(e){var t=e.destPort,n=e.onMessage,i=e.protocol,o=void 0===i?"text":i;return s(this,void 0,void 0,(function(){var e,i,r,s=this;return a(this,(function(a){switch(a.label){case 0:return[4,this.cloudGamingWebRTC.createCustomDataChannel({destPort:t,protocol:o,onMessage:n,onError:function(e){s.log("createCustomDataChannel onerror",e)},onClose:function(e){s.log("createCustomDataChannel onclose",e)}})];case 1:return e=a.sent(),i=e.code,r=e.msg,[2,{sendMessage:function(e){s.cloudGamingWebRTC.sendCustomDataChannelMessage({destPort:t,msg:e})},code:i,msg:r}]}}))}))},t.prototype.getPlayerVolume=function(e){return document.getElementById("".concat(e,"A")).volume},t.prototype.setPlayerVolume=function(e,t){this.log("setPlayerVolume->",t);var n=document.getElementById("".concat(e,"A"));0===t?n.muted=!0:(n.muted=!1,n.volume=t,n.play())},t.prototype.getSeats=function(){var e=this;return new Promise((function(t){e.cloudGamingWebRTC.sendAckData({data:{type:"sync_seats"},callback:function(e){var n=e.code,i=e.data,o=i.players,r=i.viewers;0===n&&t({players:o,viewers:r})}})}))},t.prototype.submitSeatChange=function(e){var t=this,n=e.user_id,i=e.to_role,o=e.seat_index,r=void 0===o?0:o;return new Promise((function(e){t.cloudGamingWebRTC.sendAckData({data:{type:"submit_seat_change",user_id:n,to_role:i,seat_index:r},callback:function(n){var i=n.data,o=void 0===i?{code:-1}:i;t.log("submit_seat_change res",o),e(o)}})}))},t.prototype.seatChange=function(e){var t=this,n=e.user_id,i=e.to_role,o=e.seat_index,r=void 0===o?0:o;return new Promise((function(e){t.cloudGamingWebRTC.sendAckData({data:{type:"seat_change",user_id:n,to_role:i,seat_index:r},callback:function(n){var i=n.data,o=void 0===i?{code:-1}:i;t.log("seat_change res",o),e(o)}})}))},t.prototype.changeMicStatus=function(e){var t=this,n=e.status,i=e.user_id;return new Promise((function(e){t.cloudGamingWebRTC.sendAckData({data:{type:"mic_status",user_id:i,status:n},callback:function(n){var i=n.data,o=void 0===i?{code:-1}:i,r=o.code,s=o.status,a=o.user_id,c=t.gameConfig.getServerSideDescription().user_id;0===r&&a===c&&(t.log("changeMicStatus",o),0!==s&&1!==s||a&&t.cloudGamingWebRTC.setTrackEnable({type:"audio",enable:!1}),2===s&&a&&t.cloudGamingWebRTC.setTrackEnable({type:"audio",enable:!0})),e(o)}})}))},t.prototype.onOrientationChange=function(e){var t,n;null===(n=(t=this.initOptions).onOrientationChange)||void 0===n||n.call(t,e)},t.prototype.onVisibilityChange=function(e){var t,n;null===(n=(t=this.initOptions).onVisibilityChange)||void 0===n||n.call(t,e)},t.prototype.onInitSuccess=function(e){var t,n;null===(n=(t=this.initOptions).onInitSuccess)||void 0===n||n.call(t,e)},t.prototype.onNetworkChange=function(e){var t,n;null===(n=(t=this.initOptions).onNetworkChange)||void 0===n||n.call(t,e)},t.prototype.onWebrtcStatusChange=function(e){var t,n,i,o;null===(n=(t=this.initOptions).onWebrtcStat)||void 0===n||n.call(t,e),null===(o=(i=this.initOptions).onWebrtcStatusChange)||void 0===o||o.call(i,e)},t.prototype.onDisconnect=function(e){var t,n;null===(n=(t=this.initOptions).onDisconnect)||void 0===n||n.call(t,e)},t.prototype.onConnectFailed=function(e){var t,n;null===(n=(t=this.initOptions).onConnectFail)||void 0===n||n.call(t,e)},t.prototype.onConnectSuccess=function(e){var t,n;this.log("onConnectSuccess ->"),null===(n=(t=this.initOptions).onConnectSuccess)||void 0===n||n.call(t,e)},t.prototype.onGameStartComplete=function(e){var t,n;null===(n=(t=this.initOptions).onGameStartComplete)||void 0===n||n.call(t,e)},t.prototype.onGameStop=function(e){var t,n;null===(n=(t=this.initOptions).onGameStop)||void 0===n||n.call(t,e)},t.prototype.onLoadGameArchive=function(e){var t,n;null===(n=(t=this.initOptions).onLoadGameArchive)||void 0===n||n.call(t,e)},t.prototype.onSaveGameArchive=function(e){var t,n;null===(n=(t=this.initOptions).onSaveGameArchive)||void 0===n||n.call(t,e)},t.prototype.onInputStatusChange=function(e){var t,n;null===(n=(t=this.initOptions).onInputStatusChange)||void 0===n||n.call(t,e)},t.prototype.onTouchEvent=function(e){var t,n;null===(n=(t=this.initOptions).onTouchEvent)||void 0===n||n.call(t,e)},t.prototype.onCursorShowStatChange=function(e){var t,n;null===(n=(t=this.initOptions).onCursorShowStatChange)||void 0===n||n.call(t,e)},t.prototype.onGamepadConnectChange=function(e){var t,n;null===(n=(t=this.initOptions).onGamepadConnectChange)||void 0===n||n.call(t,e)},t.prototype.onConfigurationChange=function(e){var t,n;null===(n=(t=this.initOptions).onConfigurationChange)||void 0===n||n.call(t,e)},t.prototype.onRemoteScreenResolutionChange=function(e){var t,n;null===(n=(t=this.initOptions).onRemoteScreenResolutionChange)||void 0===n||n.call(t,e)},t.prototype.onVideoStreamConfigChange=function(e){var t,n;null===(n=(t=this.initOptions).onVideoStreamConfigChange)||void 0===n||n.call(t,e)},t.prototype.onDoubleTap=function(e){var t,n;null===(n=(t=this.initOptions).onDoubleTap)||void 0===n||n.call(t,e)},t.prototype.onEvent=function(e){var t,n;null===(n=(t=this.initOptions).onEvent)||void 0===n||n.call(t,e)},t.prototype.onStreamPushStateChange=function(e){var t,n;null===(n=(t=this.initOptions).onStreamPushStateChange)||void 0===n||n.call(t,e)},t.prototype.onDeviceChange=function(e){var t,n;this.log("onDeviceChange",Event),null===(n=(t=this.initOptions).onDeviceChange)||void 0===n||n.call(t,e)},t.prototype.onGetUserMediaStatusChange=function(e){var t,n,i=e.msg,o=e.type,r=e.userMedia,s="",a=0;switch(i){case"NotFoundError":case"DevicesNotFoundError":s="NotFoundError",a=1;break;case"NotAllowedError":case"PermissionDeniedError":s="NotAllowedError",a=2;break;case"OverconstrainedError":s="OverconstrainedError",a=3;break;default:s=i}null===(n=(t=this.initOptions).onGetUserMediaStatusChange)||void 0===n||n.call(t,{code:a,msg:s,type:o,userMedia:r})},t.prototype.onMultiPlayerChange=function(e){var t,n;null===(n=(t=this.initOptions).onMultiPlayerChange)||void 0===n||n.call(t,e)},t.prototype.requestCloudDeviceStream=function(e){var t=e.instanceId,n=e.status,i=e.level,o=void 0===i?"normal":i;this.cloudGamingWebRTC.sendCloudDeviceData({type:"streaming_request",user:t,data:{status:n,level:o}})},t.prototype.setCloudDeviceMaster=function(e){var t=e.status,n=e.instanceId;this.cloudGamingWebRTC.sendCloudDeviceData({type:"set_master",user:n,data:{status:t}})},t.prototype.setCloudDeviceSyncList=function(e){var t=e.list,n=void 0===t?[]:t;this.cloudGamingWebRTC.sendCloudDeviceData({type:"set_sync_list",data:{user_list:n}})},t.prototype.onWebrtcStatsChange=function(e){var t,n,i,o;if(e===u.PAGE_STATS.PLAYING){this.pageEvent.addEventHandler();var r=this.gameConfig.getConfig().game_config,s=(void 0===r?m.empty:r).sdk_conf,a=void 0===s?m.empty:s;a||(a=m.empty),this.setDefaultCursorImage(null!==(t=this.initOptions.defaultCursorImgUrl)&&void 0!==t?t:a.default_cursor_url),this.resetCursorPos(null!==(n=this.initOptions.cursorMode)&&void 0!==n?n:a.cursor_mode),this.setRemoteCursor(null!==(i=this.initOptions.cursorMode)&&void 0!==i?i:a.cursor_mode),this.setPageBackground(null!==(o=this.initOptions.bgImgUrl)&&void 0!==o?o:a.bgimg_url)}},t.prototype.setFullscreen=function(e,t){return void 0===t&&(t=document.documentElement),s(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:this.log("setFullscreen->",e),n.label=1;case 1:return n.trys.push([1,6,,7]),e?[4,this.pageEvent.fullscreen(t)]:[3,3];case 2:return n.sent(),[3,5];case 3:return[4,this.pageEvent.exitFullscreen(t)];case 4:n.sent(),n.label=5;case 5:return[3,7];case 6:throw n.sent();case 7:return[2]}}))}))},t.prototype.getFullscreen=function(){return(0,m.isFullScreen)()},t.prototype.getPageOrientation=function(){return this.pageEvent.getPageOrientation()},t.prototype.isMobile=function(){return(0,m.isMobile)()},t.prototype.getGameMountPoint=function(){return document.getElementById(this.initOptions.mount)},t.prototype.getGameConfig=function(){return this.gameConfig.getConfig()},t.prototype.supportRenegotiation=function(){return(0,m.supportRenegotiation)()},t.prototype.getRequestId=function(){return this.cloudGamingWebRTC.getRequestId()},t.prototype.getVideoElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".video-stream")},t.prototype.getAudioElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector("#audio-stream")},t.prototype.getHuaweiAudioElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector("#tcg-audio-huawei")},t.prototype.getProgressBarElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".progress-bar-container")},t.prototype.getCursorElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector("#cursor")},t.prototype.getCloudGamingContainerElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".cloud-gaming-container")},t.prototype.getRestartElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".restart")},t.prototype.createAudioAndAddTrack=function(e){var t=e.id,n=e.source,i=document.getElementById(t);i||((i=document.createElement("audio")).id=t,i.autoplay=!0,i.className="audio-stream",i.setAttribute("playsinline","true"),i.setAttribute("webkit-playsinline","true"),i.setAttribute("x5-playsinline","true")),i.srcObject=n,this.getCloudGamingContainerElement().appendChild(i)},t.prototype.showTouchPosition=function(e){this.cloudGamingWebRTC.sendAckData({data:{type:"show_touch_pos",show:e}})},t.prototype.mountGamePoint=function(e){var t=e.mount,n=void 0===t?"":t,i=e.loadingText,o=void 0===i?"正在启动云渲染":i,r=e.showLoading,s=void 0===r||r,a=e.restartText,c=void 0===a?"重新连接":a,d=e.controller,l=void 0===d?null:d,u=document.createElement("style");document.querySelector("head").append(u),u.appendChild(document.createTextNode(f.MOUNT_POINT_CSS));var h=document.getElementById(n);h||console.error("mount point is not found"),h.innerHTML=f.HTML_STRING,h.style.backgroundColor="black";var p=function(e){(null==e?void 0:e.style)&&(e.style.width="100%",e.style.height="100%",e.style.position="relative")};p(h),p(document.body),p(document.getRootNode()),s||(this.getProgressBarElement().style.display="none"),h.querySelector(".starting").innerHTML=o,h.querySelector(".restart").innerHTML=c,l&&h.removeChild(h.querySelector(".restart"))},t.prototype.onPageLoad=function(e){this.log("init tcgsdk version->",l.config.version,"options->",e),this.log("webrtc-adapter",d.default.browserDetails.browser,d.default.browserDetails.version),e.onLog&&this.setExternalLog(e.onLog),this.cloudGamingWebRTC.init(e),this.pageEvent.init(e),this.setDebugMode(e.debugSetting),this.cloudGamingWebRTC.initWebRTCConnect()},t.prototype.resetCursorPos=function(e){if((0,m.isMobile)()){var t=window.devicePixelRatio,n=this.getDisplayRect(),i=n.width/2*t,o=n.height/2*t;this.log("isMobile true, cursor will auto move to->",i,o,"mode",e)}},t}(g.default);t.CloudGamingWebSDK=S;var k=new S;window.TCGSDK=k,window.CloudGamingWebRTC=k.cloudGamingWebRTC,window.PageEvent=k.pageEvent,t.default=k},969:function(e,t,n){"use strict";var i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s};Object.defineProperty(t,"__esModule",{value:!0});var o=n(7408),r=function(){function e(e){var t=e.sdk;this.gamepad="function"==typeof navigator.getGamepads?new o.GamepadListener:null,this.sdk=null,this.sdk=t}return e.prototype.addGamepadHandler=function(){var e=this,t=new Map;t.set(12,1),t.set(13,2),t.set(14,4),t.set(15,8),t.set(2,16384),t.set(3,32768),t.set(0,4096),t.set(1,8192),t.set(8,32),t.set(9,16),t.set(10,64),t.set(11,128),t.set(4,256),t.set(5,512),this.gamepad&&(this.gamepad.on("gamepad:connected",(function(t){var n=t.detail;e.sdk.log("gamepad:connected detail",n);var i=n.index,o=n.gamepad;e.sdk.log("gamepad connect, gamepad index is",i),e.sdk.sendGamepadEvent({type:"gamepadconnect"}),e.sdk.onGamepadConnectChange({status:"gamepadconnect",index:i,gamepad:o})})),this.gamepad.on("gamepad:disconnected",(function(t){var n=t.detail;e.sdk.log("gamepad:disconnected detail",n);var i=n.index;e.sdk.log("gamepad disconnected, gamepad index is",i),e.sdk.sendGamepadEvent({type:"gamepaddisconnect"}),e.sdk.onGamepadConnectChange({status:"gamepaddisconnect",index:i})})),this.gamepad.on("gamepad:button",(function(n){var i=n.detail,o=i.button,r=i.pressed,s=i.value,a=t.get(o);6===o||7===o?(6===o&&e.sdk.sendGamepadEvent({type:"lt",x:parseInt("".concat(255*s),10),down:r}),7===o&&e.sdk.sendGamepadEvent({type:"rt",x:parseInt("".concat(255*s),10),down:r})):e.sdk.sendGamepadEvent({type:"gamepadkey",key:a,down:r})})),this.gamepad.on("gamepad:axis",(function(t){var n=t.detail,o=n.stick,r=n.gamepad,s=i(r.axes,4),a=s[0],c=s[1],d=s[2],l=s[3];0===o&&e.sdk.sendGamepadEvent({type:"axisleft",x:parseInt("".concat(32767*a),10),y:-parseInt("".concat(32767*c),10)}),1===o&&e.sdk.sendGamepadEvent({type:"axisright",x:parseInt("".concat(32767*d),10),y:-parseInt("".concat(32767*l),10)})})),this.gamepad.start())},e}();t.default=r},9752:function(e,t,n){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(3578),d=n(9418),l=n(1743),u=a(n(1586)),h=n(8751),p={},f=function(){function e(e){var t=e.sdk;this.forceShowCursor=!1,this.forceLockCursor=!1,this.showCursor=!0,this.remoteCursorMode=d.CURSOR_MODE.LOCAL,this.mobileCursorScale=1,this.mobileShowCursor=!0,this.originCursorStyle="",this.hotSpot={x:0,y:0},this.remoteCursorImage="",this.token="",this.keepLastFrame=!1,this.serverSideDescription="",this.latestActionTime=+new Date,this.isMobileGame=!1,this.receivedOnloadedmetadataCallback=!1,this.connectBeginTime=0,this.connectTimeoutCount=0,this.connectStatus=d.STATUS.DISCONNECTED,this.heartbeatTimer=null,this.newConnectTimeout=60,this.noflowTimeout=10,this.peerConnection=null,this.kmDataChannel=null,this.ackDataChannel=null,this.hbDataChannel=null,this.cdDataChannel=null,this.svrDataChannel=null,this.cloudDeviceDataChannel=null,this.customDataChannel=new Map,this.ackDataChannelTimer=null,this.mediaStream=null,this.camera=null,this.mic=null,this.cameraMediaStream=null,this.micMediaStream=null,this.audioTransceiver=null,this.videoTransceiver=null,this.cameraProfile=h.CameraProfile["720p"],this.micProfile={sampleRate:44100,echoCancellation:!0,autoGainControl:!0,noiseSuppression:!0},this.clientSideDescription=null,this.requestId="",this.dataChannelCallbacks={},this.dataChannelRetryTimers={},this.checkMouseShowInterval=null,this.idleThreshold=3e5,this.idleTimes=0,this.lastInputStatus=!1,this.noFlowCount=0,this.gameStatus="playing",this.streamPushStat=null,this.sdk=null,this.sdk=t}return e.prototype.init=function(e){var t,n;this.forceShowCursor=null!==(t=e.forceShowCursor)&&void 0!==t&&t,this.idleThreshold=e.idleThreshold?1e3*e.idleThreshold:3e5,this.keepLastFrame=null!==(n=e.keepLastFrame)&&void 0!==n&&n,this.isMobileGame=e.mobileGame},Object.defineProperty(e.prototype,"debugSetting",{get:function(){return this.sdk.getInitOptions().debugSetting||{}},enumerable:!1,configurable:!0}),e.prototype.initWebRTCConnect=function(){return o(this,void 0,void 0,(function(){var e,t,n=this;return r(this,(function(i){return this.sdk.log("CloudGamingWebRTC init"),this.peerConnection?(this.sdk.log("please disconnect(this.sdk.destroy()) before init"),[2,this.sdk.onInitSuccess({code:-2,msg:"please disconnect(this.sdk.destroy()) before init"})]):(e=5,t=function(){return o(n,void 0,void 0,(function(){var n,i=this;return r(this,(function(s){switch(s.label){case 0:if(this.isMobileGame&&!this.sdk.getInitOptions().mobileVpx&&!(0,l.canReceiveH264)())return setTimeout((function(){return o(i,void 0,void 0,(function(){var n;return r(this,(function(i){switch(i.label){case 0:return 0!=(e-=1)?[3,2]:(n=this,[4,this.newWebRtcConnect()]);case 1:return n.clientSideDescription=i.sent(),this.sdk.onInitSuccess({code:-1,description:this.clientSideDescription}),[2];case 2:return[4,t()];case 3:return i.sent(),[2]}}))}))}),100),this.sdk.onWebrtcStatusChange({code:-2}),[2];s.label=1;case 1:return s.trys.push([1,3,,4]),n=this,[4,this.newWebRtcConnect()];case 2:return n.clientSideDescription=s.sent(),this.sdk.onInitSuccess({code:0,msg:"ok",description:this.clientSideDescription}),[3,4];case 3:return s.sent(),this.sdk.onInitSuccess({code:-1,msg:"your browser without webrtc support",description:this.clientSideDescription}),[3,4];case 4:return[2]}}))}))},t(),[2])}))}))},e.prototype.sendKmData=function(e){this.idleTimes=0,this.latestActionTime=+new Date,this.debugSetting.showSendKmData&&console.log("sendKmData",e),this.dataChannelSend(this.kmDataChannel,e)},e.prototype.sendAckData=function(e){var t=e.data,n=void 0===t?p:t,i=e.retry,o=void 0===i?0:i,r=e.callback,s=void 0===r?l.noop:r,a=e.interval,c=void 0===a?1e3:a,d=n.type;"cursor_state"!==d&&(this.latestActionTime=+new Date,this.idleTimes=0);var u=(0,l.getSequence)();this.dataChannelSendWithCallback({dataChannel:this.ackDataChannel,ackMsg:{seq:u,data:n},retry:o,callback:s,interval:c}),this.debugSetting.showSendAckData&&("cursor_state"===d||console.log("sendAckData:",n,u))},e.prototype.sendCloudDeviceData=function(e){this.debugSetting.showSendCloudDeviceData&&console.log("sendCloudDeviceData",e),this.dataChannelSend(this.cloudDeviceDataChannel,e)},e.prototype.connect=function(e){var t,n,i;void 0===e&&(e=""),this.sdk.log("connect->"),this.sdk.showStats.setServerSessionTime(+new Date);var o=+new Date;if(o-this.connectBeginTime<5e3)return this.sdk.log("connect too frequently, last is ".concat(Math.ceil((o-this.connectBeginTime)/1e3),"s")),this.clearPeerConnection(),void this.sdk.onConnectFailed({code:d.CONNECT_FAILED_CODE.TOO_FREQUENTLY,msg:"connect too frequently"});"connected"!==(null===(t=this.peerConnection)||void 0===t?void 0:t.connectionState)&&"connecting"!==(null===(n=this.peerConnection)||void 0===n?void 0:n.connectionState)||this.sdk.log("peerConnection status is ".concat(null===(i=this.peerConnection)||void 0===i?void 0:i.connectionState,", please clear current connection before call this.sdk.start()")),this.connectBeginTime=o,this.connectTimeoutCount=0,this.connectStatus=d.STATUS.CONNECTING;try{this.serverSideDescription=c.Base64.decode(e)}catch(e){throw"serverSession is not base64 string format"}this.serverSideDescription?this.onAnswer(this.serverSideDescription):this.sdk.onWebrtcStatusChange({code:-1,msg:"set server description failed, please try again later."})},e.prototype.getClientSideDescription=function(){this.clientSideDescription||console.error("webrtc is not initialized");try{return c.Base64.encode(JSON.stringify(this.clientSideDescription))}catch(e){console.error("clientSideDescription is not jsonString or encoding failure")}},e.prototype.newWebRtcConnect=function(){var e;return o(this,void 0,void 0,(function(){var t,n,i,o=this;return r(this,(function(r){switch(r.label){case 0:try{this.peerConnection=new RTCPeerConnection({sdpSemantics:"unified-plan"})}catch(e){if(this.sdk.log("new RTCPeerConnection error",e),"ReferenceError"===e.name&&e.message.includes("RTCPeerConnection"))throw this.sdk.onWebrtcStatusChange({code:255,msg:"your browser without webrtc support"}),console.log("your browser without webrtc support"),"your browser without webrtc support";return[2]}return this.connectStatus=d.STATUS.CONNECTING,this.peerConnection.ontrack=function(e){return o.onTrack(e)},this.peerConnection.onconnectionstatechange=function(){var e;o.sdk.log("onconnectionstatechange",null===(e=o.peerConnection)||void 0===e?void 0:e.connectionState)},this.peerConnection.oniceconnectionstatechange=function(){return o.onIceConnectionStateChange()},this.peerConnection.onicecandidate=function(){},this.peerConnection.onnegotiationneeded=function(){o.sdk.log("onnegotiationneeded")},(null===navigator||void 0===navigator?void 0:navigator.mediaDevices)&&(navigator.mediaDevices.ondevicechange=function(e){o.sdk.onDeviceChange(e)}),this.createKmDataChannel(),this.createHbDataChannel(),this.createAckDataChannel(),this.createSvrDataChannel(),this.createCloudDeviceDataChannel(),"slave"!==(null===(e=this.sdk.getController())||void 0===e?void 0:e.type)&&this.sdk.showStats.toggleMetricReportBulk(!0),t=this.sdk.getInitOptions(),n=t.mic,i=t.camera,null===this.mic&&(this.mic=n),null===this.camera&&(this.camera=i),[4,this.createOffer({mic:this.mic,camera:this.camera})];case 1:return[2,r.sent()]}}))}))},e.prototype.startHeartbeatReport=function(){var e=this;clearInterval(this.heartbeatTimer),this.sdk.log("startHeartbeatReport ->"),this.heartbeatTimer=setInterval((function(){return o(e,void 0,void 0,(function(){var e,t,n;return r(this,(function(i){switch(i.label){case 0:return[4,null===(n=this.peerConnection)||void 0===n?void 0:n.getStats(null)];case 1:return e=i.sent(),t=[],null==e||e.forEach((function(e){void 0===e&&(e={}),"inbound-rtp"!==e.type&&"track"!==e.type||t.push(e)})),0===t.length&&(t=[{type:"inbound-rtp",mediaType:"video"},{type:"track",jitterBufferDelay:100*Math.random()%30+10}]),this.sdk.showStats.setStat(t,e),this.reportStat(),[2]}}))}))}),1e3)},e.prototype.getCursorShowStatus=function(){return!(!this.sdk.getIsMobileGame()&&"touch"!==this.sdk.pageEvent.getClientInteractMode())||this.showCursor},e.prototype.mouseDeltaMove=function(){return this.remoteCursorMode===d.CURSOR_MODE.REMOTE_SRC_POS||this.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS},e.prototype.lockMouse=function(e){var t,n,i;return o(this,void 0,void 0,(function(){var o;return r(this,(function(r){switch(r.label){case 0:if("touch"===this.sdk.pageEvent.getClientInteractMode())return[2];if(!e)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,null===(n=(t=this.sdk.getVideoElement()).requestPointerLock)||void 0===n?void 0:n.call(t)];case 2:return r.sent(),[3,4];case 3:return o=r.sent(),this.sdk.log("requestPointerLock error",o),this.sdk.onEvent({type:"pointerlockerror"}),[3,4];case 4:return[3,6];case 5:try{null===(i=document.exitPointerLock)||void 0===i||i.call(document)}catch(e){this.sdk.log("exitPointerLock error",e)}r.label=6;case 6:return this.remoteCursorMode===d.CURSOR_MODE.REMOTE_SRC_POS&&(e?this.sdk.pageEvent.setDropMouseEvent(!1):this.sdk.pageEvent.setDropMouseEvent(!0)),[2]}}))}))},e.prototype.isMouseLocked=function(){return document.pointerLockElement===this.sdk.getVideoElement()},e.prototype.setForceShowCursor=function(e){this.forceShowCursor=e},e.prototype.setForceLockCursor=function(e){this.forceLockCursor=e},e.prototype.getForceShowCursor=function(){return this.forceShowCursor},e.prototype.clearPeerConnection=function(){if(this.mediaStream&&(this.mediaStream.getTracks().forEach((function(e){e.stop()})),this.mediaStream=null),this.dataChannelCallbacks={},this.peerConnection){this.kmDataChannel&&(this.kmDataChannel.close(),this.kmDataChannel=null),this.hbDataChannel&&(this.hbDataChannel.close(),this.hbDataChannel=null),this.ackDataChannel&&(this.ackDataChannel.close(),this.ackDataChannel=null),this.cdDataChannel&&(this.cdDataChannel.close(),this.cdDataChannel=null),this.svrDataChannel&&(this.svrDataChannel.close(),this.svrDataChannel=null),this.customDataChannel.size&&(this.customDataChannel.forEach((function(e){return e.close()})),this.customDataChannel.clear()),this.videoTransceiver&&(this.switchTrack({type:"video",status:"remove",userMedia:this.cameraMediaStream}),this.videoTransceiver=null),this.audioTransceiver&&(this.switchTrack({type:"audio",status:"remove",userMedia:this.micMediaStream}),this.audioTransceiver=null),this.peerConnection.close(),this.peerConnection.ontrack=null,this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onicecandidate=null,this.peerConnection=null;var e=this.sdk.getVideoElement();(null==e?void 0:e.srcObject)&&(e.srcObject=null)}this.clientSideDescription=null,this.serverSideDescription=null,clearInterval(this.heartbeatTimer),this.checkMouseShowInterval&&(clearInterval(this.checkMouseShowInterval),this.checkMouseShowInterval=null),this.sdk.showStats.toggleMetricReportBulk(!1),this.sdk.pageEvent.clearEvent(),this.receivedOnloadedmetadataCallback=null},e.prototype.disconnected=function(e){var t,n=e.message,i=void 0===n?"":n,o=e.code,r=void 0===o?null:o;this.sdk.log("disconnected",r,i),this.connectStatus=d.STATUS.DISCONNECTED,this.keepLastFrame&&(null===(t=this.sdk.getVideoElement())||void 0===t||t.pause()),r===d.RTC_CODE.OTHER_KICK&&this.sdk.getRestartElement()&&(this.sdk.getRestartElement().style.display="block"),this.clearPeerConnection(),this.sdk.getInitOptions().reconnect&&r===d.RTC_CODE.NEED_RECONNECT?this.reconnect({message:i}):(this.sdk.log("destroy code: ".concat(r," and clear reconnect token")),this.sdk.watchdog.setReconnectInfo({serverIp:"",token:""})),this.sdk.onDisconnect({code:r,msg:i}),this.sdk.log("call onDisconnect, code",r)},e.prototype.reconnect=function(e){var t=e.message,n=void 0===t?"":t;this.sdk.log("reconnect, setup reconnect server_ip=".concat(this.sdk.gameConfig.getServerSideDescription().server_ip," and token=").concat(this.token)),this.sdk.watchdog.setReconnectInfo({serverIp:this.sdk.gameConfig.getServerSideDescription().server_ip,token:this.token}),this.sdk.watchdog.autoReconnect({message:n})},e.prototype.getRemoteCursorState=function(e){this.sendAckData({data:{type:e}})},e.prototype.getIdleTime=function(){return+new Date-this.latestActionTime},e.prototype.checkUserIdle=function(){var e=this.getIdleTime();if(e>this.idleThreshold){var t=Math.floor(e/this.idleThreshold);t>this.idleTimes&&(this.sdk.getController()||(this.sdk.onNetworkChange({status:"idle",times:t}),this.sdk.onEvent({type:"idle",data:{times:t}})),this.idleTimes=t)}},e.prototype.setCursorMode=function(e){var t=this,n=e;e===d.CURSOR_MODE.REMOTE_SRC_POS&&(n=d.CURSOR_MODE.REMOTE_SRC);var i=n===d.CURSOR_MODE.REMOTE_DRAW;if(this.sendAckData({data:{type:"set_cursor",show:n},callback:function(){t.setCursorShowStatus(!i)}}),this.remoteCursorMode=e,e===d.CURSOR_MODE.REMOTE_SRC||e===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS?this.createCdDataChannel():this.cdDataChannel&&(this.cdDataChannel.close(),this.cdDataChannel=null),e===d.CURSOR_MODE.LOCAL){var o=this.sdk.getVideoElement();o&&(this.sdk.log("videoElement.style.cursor will set to origin style",this.originCursorStyle),o.style.cursor="url(".concat(this.originCursorStyle,") ").concat(this.hotSpot.x," ").concat(this.hotSpot.y,", auto"))}e===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS&&this.lockMouse(!0)},e.prototype.getCursorMode=function(){return this.remoteCursorMode},e.prototype.getCursorHotSpot=function(){return this.hotSpot},e.prototype.setMobileCursorScale=function(e){this.mobileCursorScale=e},e.prototype.getDisplayRect=function(){var e,t=(null===(e=this.sdk.getVideoElement())||void 0===e?void 0:e.getBoundingClientRect())||p,n=t.width,i=void 0===n?0:n,o=t.height,r=void 0===o?0:o,s=t.left,a=void 0===s?0:s,c=t.top;return{left:a,top:void 0===c?0:c,width:i,height:r,pixelRatio:window.devicePixelRatio||1}},e.prototype.setDefaultCursorImage=function(e){if((0,l.isMobile)()){var t=this.sdk.getCursorElement();"dot"===e?(t.style.width="3px",t.style.height="3px",t.style.borderRadius="50%",t.style.backgroundColor="#2dc7ef"):(t.style.width="26px",t.style.height="26px",t.style.backgroundImage="url(".concat(e,")"))}else{var n=this.sdk.getVideoElement();this.originCursorStyle=null!=e?e:"",n.style.cursor="url(".concat(e,") ").concat(this.hotSpot.x," ").concat(this.hotSpot.y,", auto")}},e.prototype.toggleStatisticsView=function(){var e=document.querySelector("#__vconsole");this.sdk.showStats.show(!this.sdk.showStats.isShowing()),e&&(e.style.display=this.sdk.showStats.isShowing()?"":"none")},e.prototype.setNewConnectTimeout=function(e){void 0===e&&(e=60),this.newConnectTimeout=e},e.prototype.setNoflowTimeout=function(e){void 0===e&&(e=10),this.noflowTimeout=e},e.prototype.setKeepLastFrame=function(e){void 0===e&&(e=!1),this.keepLastFrame=e},e.prototype.setMobileShowCursor=function(e){void 0===e&&(e=!0),this.mobileShowCursor=e},e.prototype.setGameStatus=function(e){this.gameStatus=e},e.prototype.getIsMobileGame=function(){return this.isMobileGame},e.prototype.createCustomDataChannel=function(e){var t,n,i,s=e.destPort,a=void 0===s?1:s,c=e.onMessage,d=void 0===c?l.noop:c,u=e.onClose,h=void 0===u?l.noop:u,p=e.onError,f=void 0===p?l.noop:p,m=e.label,v=void 0===m?"":m,g=e.protocol,y=void 0===g?"text":g;return o(this,void 0,Promise,(function(){var e,o=this;return r(this,(function(r){switch(r.label){case 0:return"open"!==(null===(t=this.ackDataChannel)||void 0===t?void 0:t.readyState)?[2,{code:1,msg:"ack dataChannel does not open, please try again later."}]:(v||(v="cs_".concat(a)),this.sdk.log("start createCustomDataChannel, destPort: ".concat(a,", ackDataChannel state: ").concat(null===(n=this.ackDataChannel)||void 0===n?void 0:n.readyState,", label: ").concat(v,", protocol: ").concat(y)),(e=null===(i=this.peerConnection)||void 0===i?void 0:i.createDataChannel(v))?(e.onmessage=function(e){var t,n;o.sdk.log("dataChannel:".concat(v," onmessage"),"string"==typeof e.data?null===(t=e.data)||void 0===t?void 0:t.length:null===(n=e.data)||void 0===n?void 0:n.byteLength),d(e.data)},e.onclose=function(e){return h(e)},e.onerror=function(e){return f(e)},this.customDataChannel.set(a,e),[4,new Promise((function(e){o.sendAckData({data:{type:"udp_trans",dest_port:a,protocol:y,label:v},callback:function(t){var n=t.data;o.sdk.log("createCustomDataChannel label:".concat(v," destPort:").concat(a," success"),n),e({code:n.code,msg:n.msg})}}),o.sdk.log("customDataChannels",o.customDataChannel),setTimeout((function(){e({code:3,msg:"request timeout, please try again later."})}),5e3)}))]):[3,2]);case 1:return[2,r.sent()];case 2:return this.sdk.log("createCustomDataChannel fail"),[2,{code:1}]}}))}))},e.prototype.sendCustomDataChannelMessage=function(e){var t=e.destPort,n=void 0===t?0:t,i=e.msg,o=void 0===i?"":i,r=this.customDataChannel.get(n);"open"===(null==r?void 0:r.readyState)&&(this.sdk.log("sendCustomDataChannelMessage",o.length,n,null==r?void 0:r.readyState),r.send(o))},e.prototype.setTrackEnable=function(e){var t=e.type,n=void 0===t?"audio":t,i=e.enable,o=void 0===i||i;if(this.sdk.log("setTrackEnable type",n,"enable",o),"audio"===n)return this.audioTransceiver.sender?(this.audioTransceiver.sender.track.enabled=o,this.sdk.log("audioTransceiver.sender",this.audioTransceiver.sender,o),{code:0}):{code:1,message:"audioTransceiver.sender is null"}},e.prototype.switchTrack=function(e){var t,n,i,o,r=e.type,s=e.status,a=e.userMedia;if(this.sdk.log("switchTrack type",r,"status",s),"audio"===r){if(this.audioTransceiver.sender){if("add"===s){var c=null===(t=null==a?void 0:a.getAudioTracks())||void 0===t?void 0:t[0];this.audioTransceiver.sender.replaceTrack(c)}return"remove"===s&&(this.audioTransceiver.sender.replaceTrack(null),null===(n=null==a?void 0:a.getAudioTracks()[0])||void 0===n||n.stop()),{code:0,message:"success"}}return{code:1,message:"audioTransceiver.sender is null"}}if("video"===r)return this.videoTransceiver.sender?("add"===s&&(c=null===(i=null==a?void 0:a.getVideoTracks())||void 0===i?void 0:i[0],this.videoTransceiver.sender.replaceTrack(c)),"remove"===s&&(this.videoTransceiver.sender.replaceTrack(null),null===(o=null==a?void 0:a.getVideoTracks()[0])||void 0===o||o.stop()),{code:0,message:"success"}):{code:2,message:"videoTransceiver.sender is null"}},e.prototype.getMediaStream=function(){return this.mediaStream},e.prototype.getUserMedia=function(){var e,t,n=new MediaStream;return null===(e=this.cameraMediaStream)||void 0===e||e.getTracks().forEach((function(e){n.addTrack(e)})),null===(t=this.micMediaStream)||void 0===t||t.getTracks().forEach((function(e){n.addTrack(e)})),n},e.prototype.switchMic=function(e){var t,n=e.status,i=e.profile;return o(this,void 0,Promise,(function(){var e,o,s,a,c,d;return r(this,(function(r){switch(r.label){case 0:return this.sdk.log("switchMic status",n),"open"!==n?[3,4]:(null===(t=this.audioTransceiver.sender)||void 0===t?void 0:t.track)?(this.sdk.log("mic opened, audioTransceiver sender",this.audioTransceiver.sender),[3,4]):[3,1];case 1:return r.trys.push([1,3,,4]),e=this,[4,this.createUserMedia({mic:null==i||i})];case 2:return e.micMediaStream=r.sent(),o=this.switchTrack({type:"audio",status:"add",userMedia:this.micMediaStream}),c=o.code,d=o.message,this.mic=i,this.sdk.onGetUserMediaStatusChange({msg:"mic open",type:"mic",userMedia:this.micMediaStream}),this.sendAckData({data:{type:"switch_mic",status:"open"}}),[2,{code:c,msg:d,userMedia:this.micMediaStream}];case 3:return s=r.sent(),this.sdk.onGetUserMediaStatusChange({msg:s,type:"mic"}),[2,{code:1,msg:s,userMedia:null}];case 4:return"close"===n?(a=this.switchTrack({type:"audio",status:"remove",userMedia:this.micMediaStream}),c=a.code,d=a.message,this.mic=!1,this.sdk.onGetUserMediaStatusChange({msg:"mic close",type:"mic"}),this.sendAckData({data:{type:"switch_mic",status:"close"}}),[2,{code:c,msg:d,userMedia:null}]):[2]}}))}))},e.prototype.switchCamera=function(e){var t,n=e.status,i=e.profile;return o(this,void 0,Promise,(function(){var e,o,s,a,c,d;return r(this,(function(r){switch(r.label){case 0:if(this.sdk.log("switchCamera status",n),"open"!==n)return[3,4];if(null===(t=this.videoTransceiver.sender)||void 0===t?void 0:t.track)return this.sdk.log("camera opened, videoTransceiver sender",this.videoTransceiver.sender),[2,{code:1,msg:"camera opened",userMedia:null}];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this,[4,this.createUserMedia({camera:null==i||i})];case 2:return e.cameraMediaStream=r.sent(),o=this.switchTrack({type:"video",status:"add",userMedia:this.cameraMediaStream}),c=o.code,d=o.message,this.camera=i,this.sdk.onGetUserMediaStatusChange({msg:"camera open",type:"camera",userMedia:this.cameraMediaStream}),this.sendAckData({data:{type:"switch_camera",status:"open"}}),[2,{code:c,msg:d,userMedia:this.cameraMediaStream}];case 3:return s=r.sent(),this.sdk.onGetUserMediaStatusChange({msg:s,type:"camera"}),[2,{code:1,msg:s,userMedia:null}];case 4:return"close"!==n?[3,6]:(a=this.switchTrack({type:"video",status:"remove",userMedia:this.cameraMediaStream}),c=a.code,d=a.message,this.camera=!1,this.sendAckData({data:{type:"switch_camera",status:"close"}}),[4,(0,l.sleep)(500)]);case 5:return r.sent(),this.sdk.onGetUserMediaStatusChange({msg:"camera close",type:"camera"}),[2,{code:c,msg:d,userMedia:this.cameraMediaStream}];case 6:return[2]}}))}))},e.prototype.setMicProfile=function(e){var t,n;return o(this,void 0,Promise,(function(){var i,o;return r(this,(function(r){switch(r.label){case 0:if(this.sdk.log("setMicProfile",e),!this.mic)return this.sdk.log("please open mic"),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),i=this,[4,this.createUserMedia({mic:e})];case 2:return i.micMediaStream=r.sent(),this.micMediaStream?(null===(t=this.audioTransceiver.sender)||void 0===t||t.replaceTrack(null===(n=this.micMediaStream.getAudioTracks())||void 0===n?void 0:n[0]),this.sdk.onGetUserMediaStatusChange({msg:"setMicProfile success",type:"mic",userMedia:this.micMediaStream}),[2,{code:0,msg:"success",userMedia:this.micMediaStream}]):[3,4];case 3:return o=r.sent(),this.sdk.onGetUserMediaStatusChange({msg:o,type:"mic"}),[2,{code:1,msg:o,userMedia:null}];case 4:return[2]}}))}))},e.prototype.setCameraProfile=function(e){var t,n;return o(this,void 0,Promise,(function(){var i,o;return r(this,(function(r){switch(r.label){case 0:if(this.sdk.log("setCameraProfile",e),!this.camera)return this.sdk.log("please open camera"),[2];if("string"==typeof e&&e===this.cameraProfile.type)return this.sdk.log("profile is same as last value"),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),i=this,[4,this.createUserMedia({camera:e})];case 2:return i.cameraMediaStream=r.sent(),this.cameraMediaStream?(null===(t=this.videoTransceiver.sender)||void 0===t||t.replaceTrack(null===(n=this.cameraMediaStream.getVideoTracks())||void 0===n?void 0:n[0]),this.sdk.onGetUserMediaStatusChange({msg:"setCameraProfile success",type:"camera",userMedia:this.cameraMediaStream}),[2,{code:0,msg:"success",userMedia:this.cameraMediaStream}]):[3,4];case 3:return o=r.sent(),this.sdk.onGetUserMediaStatusChange({msg:o,type:"camera"}),[2,{code:1,msg:o,userMedia:null}];case 4:return[2]}}))}))},e.prototype.setCameraBitrate=function(e){return o(this,void 0,void 0,(function(){var t,n;return r(this,(function(i){switch(i.label){case 0:if(!("RTCRtpSender"in window)||!("setParameters"in window.RTCRtpSender.prototype))return[3,7];if(!this.videoTransceiver.sender)return[3,5];(t=this.videoTransceiver.sender.getParameters()).encodings||(t.encodings=[{}]),"unlimited"===e?delete t.encodings[0].maxBitrate:t.encodings[0].maxBitrate=1e3*e,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.videoTransceiver.sender.setParameters(t)];case 2:return i.sent(),this.sdk.log("setCameraBitrate success ".concat("number"==typeof e?e:"unlimited"," kbps")),[3,4];case 3:return n=i.sent(),this.sdk.log("setCameraBitrate error",n),[3,4];case 4:return[3,6];case 5:this.sdk.log("camera sender is not found"),i.label=6;case 6:return[3,8];case 7:this.sdk.log("can not find RTCRtpSender in window"),i.label=8;case 8:return[2]}}))}))},e.prototype.getDevices=function(){return o(this,void 0,void 0,(function(){var e,t,n;return r(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,navigator.mediaDevices.enumerateDevices()];case 1:return e=i.sent(),this.sdk.log("getDevices",e),t=null==e?void 0:e.filter((function(e){return e.kind.includes("input")&&"default"!==e.deviceId})),this.sdk.log("inputDevices",t),[2,t];case 2:throw n=i.sent(),this.sdk.log("getDevices error",n),n;case 3:return[2]}}))}))},e.prototype.getRequestId=function(){return this.requestId},e.prototype.getWebrtcConnectStatus=function(){return this.connectStatus},e.prototype.renegotiation=function(e){return o(this,void 0,void 0,(function(){var t,n,i;return r(this,(function(o){switch(o.label){case 0:if(this.sdk.log("renegotiation"),!(0,l.supportRenegotiation)())return this.sdk.log("renegotiation not support"),this.sdk.log("ios version is",(0,l.getIOSVersion)()),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),this.sdk.log("renegotiation setRemoteDescription"),[4,this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:e,type:"offer"}))];case 2:return o.sent(),[3,4];case 3:return t=o.sent(),this.sdk.log("renegotiation setRemoteDescription exception->",t,t.message),this.sdk.onWebrtcStatusChange({code:-1,msg:"setRemoteDescription failed."}),[3,4];case 4:return o.trys.push([4,7,,8]),[4,this.peerConnection.createAnswer()];case 5:return n=o.sent(),this.sdk.log("renegotiation setLocalDescription"),[4,this.peerConnection.setLocalDescription(n)];case 6:return o.sent(),this.sendAckData({data:{type:"user_update",sdp:n.sdp}}),[3,8];case 7:return i=o.sent(),this.sdk.log("renegotiation setLocalDescription exception->",i,i.message),[3,8];case 8:return[2]}}))}))},e.prototype.onAnswer=function(e){var t,n;return void 0===e&&(e=""),o(this,void 0,void 0,(function(){var i,o,s,a,c,u,h,p,f,m,v,g,y;return r(this,(function(r){switch(r.label){case 0:r.trys.push([0,5,,6]),i=JSON.parse(e),o=i.role,s=i.game_config,a=i.feature_switch,c=i.input_seat,u=i.code,h=i.message,p=i.screen_config,f=i.plat,m=i.video,v=i.request_id,this.sdk.log("onAnswer-> serverSideDescriptionObject",i),this.requestId=v,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:i.sdp,type:"answer"}))];case 2:return r.sent(),this.sdk.gameConfig.setGameConfig(s),this.sdk.gameConfig.setRole(o),this.sdk.gameConfig.setSeatIndex(c),this.sdk.gameConfig.setServerSideDescription(i),this.sdk.setServerSideDescription({serverSideDescription:i}),this.sdk.gameConfig.setFeatureSwitch(a),[3,4];case 3:return g=r.sent(),this.sdk.log("setRemoteDescription exception->",g),this.sdk.onWebrtcStatusChange({code:-1,msg:"setRemoteDescription 失败，请稍后重试."}),[3,4];case 4:return!f||"android"!==f&&"Android"!==f||(this.isMobileGame=!0,this.sdk.pageEvent.remoteScreenResolutionChange({width:null!==(t="portrait"===(null==p?void 0:p.orientation)?null==p?void 0:p.width:null==p?void 0:p.height)&&void 0!==t?t:0,height:null!==(n="portrait"===(null==p?void 0:p.orientation)?null==p?void 0:p.height:null==p?void 0:p.width)&&void 0!==n?n:0,left:0,top:0})),this.sdk.onWebrtcStatusChange({code:u>1e3?d.ANSWER_SDP_CODE.PROXY_ERROR:u,msg:h}),(0,l.isMobile)()?this.sdk.pageEvent.initOrientationDetector():this.sdk.getIsMobileGame()&&"landscape"===(null==p?void 0:p.orientation)&&(null==m?void 0:m.height)>(null==m?void 0:m.width)&&(this.sdk.pageEvent.setRemoteOrientation(p.orientation),this.sdk.pageEvent.setVideoOrientation({deg:270,rotateMountPoint:!0})),this.sdk.onConfigurationChange({screen_config:p}),[3,6];case 5:return y=r.sent(),this.sdk.log("parse serverSideDescription error",y),this.sdk.onWebrtcStatusChange({code:-1,msg:"parse serverSideDescription error"}),[3,6];case 6:return[2]}}))}))},e.prototype.createUserMedia=function(e){var t=e.mic,n=void 0!==t&&t,s=e.camera,a=void 0!==s&&s;return o(this,void 0,void 0,(function(){var e,t,o,s,c,d,u,p;return r(this,(function(r){switch(r.label){case 0:if(!n)return[3,4];this.sdk.log("createUserMedia mic",n),"object"==typeof n&&(this.micProfile=i(i({},this.micProfile),n)),this.sdk.log("micProfile",this.micProfile),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:"boolean"==typeof n?n:this.micProfile})];case 2:return[2,r.sent()];case 3:throw e=r.sent(),this.sdk.log("getUserMedia mic error",e,null==e?void 0:e.name),e.name;case 4:if(!a)return[3,8];if(this.sdk.log("createUserMedia camera",a),t=null,"string"==typeof a&&(Object.keys(h.CameraProfile).includes(a)?this.cameraProfile=h.CameraProfile[a]:this.sdk.log("".concat(a," is not included in camera profile types, use default settings"))),"object"==typeof a&&(this.cameraProfile=i(i({},this.cameraProfile),a)),o=this.cameraProfile,s=o.width,c=o.height,d=o.frameRate,"user"===(u=o.deviceId)||"environment"===u){if(!(0,l.isMobile)())return this.sdk.log("PC use default settings"),[2,this.cameraMediaStream];t={facingMode:{exact:u}}}else t={width:{ideal:s},height:{ideal:c},frameRate:d,deviceId:u};"boolean"==typeof a&&(t=a),this.sdk.log("cameraConstraints",t),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,navigator.mediaDevices.getUserMedia({video:t})];case 6:return[2,r.sent()];case 7:throw p=r.sent(),this.sdk.log("getUserMedia camera error",p,null==p?void 0:p.name),p.name;case 8:return[2]}}))}))},e.prototype.createOffer=function(e){var t=e.mic,n=void 0!==t&&t,i=e.camera,s=void 0!==i&&i;return o(this,void 0,void 0,(function(){var e,t;return r(this,(function(i){switch(i.label){case 0:return this.sdk.log("create offer","mic",n,"camera",s),this.videoTransceiver=this.peerConnection.addTransceiver("video",{direction:"sendrecv"}),this.audioTransceiver=this.peerConnection.addTransceiver("audio",{direction:"sendrecv"}),n?[4,this.switchMic({status:"open",profile:n})]:[3,2];case 1:i.sent(),i.label=2;case 2:return s?[4,this.switchCamera({status:"open",profile:s})]:[3,4];case 3:i.sent(),i.label=4;case 4:return i.trys.push([4,7,,8]),e=this.onOffer,[4,this.peerConnection.createOffer()];case 5:return[4,e.apply(this,[i.sent()])];case 6:return[2,i.sent()];case 7:return t=i.sent(),this.sdk.log("create offer error",t),this.disconnected({message:"create offer is failed",code:d.RTC_CODE.CREATE_OFFER_FAILED}),[3,8];case 8:return[2]}}))}))},e.prototype.onOffer=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o,s,a;return r(this,(function(r){switch(r.label){case 0:this.sdk.log("onOffer->",e),t=e.sdp,n=e.type,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.peerConnection.setLocalDescription({type:n,sdp:t})];case 2:return r.sent(),i=this.peerConnection.localDescription,o=(0,l.checkProfileLevelId)(i.sdp),this.sdk.log("available profile-level-ids: ",o.join(",")),s=this.sdk.getInitOptions().remoteDesktopResolution,this.clientSideDescription={sdp:t,type:n,deviceInfo:{platform:(0,l.isMobile)()?"mobile":"pc",user_agent:(0,l.is360)()?"".concat(null===navigator||void 0===navigator?void 0:navigator.userAgent," 360 browser"):null===navigator||void 0===navigator?void 0:navigator.userAgent},sdkType:"JS",desktopResolution:(null==s?void 0:s.width)&&(null==s?void 0:s.height)?"".concat(s.width,"x").concat(null==s?void 0:s.height):null},[2,this.clientSideDescription];case 3:throw a=r.sent(),this.sdk.log("onOffer exception->",null==a?void 0:a.message,null==a?void 0:a.name),null==a?void 0:a.message;case 4:return[2]}}))}))},e.prototype.checkAckDataChannelStatus=function(){var e,t,n=this;this.sdk.log("checkAckDataChannelStatus",null===(e=this.ackDataChannel)||void 0===e?void 0:e.readyState),"open"===(null===(t=this.ackDataChannel)||void 0===t?void 0:t.readyState)?(clearInterval(this.ackDataChannelTimer),this.ackDataChannelTimer=null,this.onLoadedMetaData()):this.ackDataChannelTimer||(this.ackDataChannelTimer=setInterval((function(){n.checkAckDataChannelStatus()}),500))},e.prototype.onTrack=function(e){var t=this;if(this.sdk.log("onTrack",e.track.kind,e.track),"audio"===e.track.kind&&e.track.label.includes("|")){var n=s(e.track.label.split("|"),2),i=n[0],o=n[1];return this.sdk.log("on audio Track",e.track.label,i,o,e.streams[0].id),this.sdk.gameConfig.setHostUserId(i),this.sdk.createAudioAndAddTrack({id:o,source:e.streams[0]})}this.mediaStream||(this.mediaStream=new MediaStream),"video"===e.track.kind&&0===this.mediaStream.getVideoTracks().length&&(this.sdk.log("add video stream"),this.mediaStream.addTrack(e.track)),"audio"===e.track.kind&&0===this.mediaStream.getAudioTracks().length&&(this.sdk.log("add audio stream"),this.mediaStream.addTrack(e.track),(0,l.isHuawei)()&&this.sdk.createAudioAndAddTrack({id:"tcg-audio-huawei",source:this.mediaStream}));var r=this.sdk.getVideoElement();r&&(r.srcObject||(r.srcObject=this.mediaStream),"video"===e.track.kind&&(this.sdk.log("on video Track"),"onloadedmetadata"in HTMLVideoElement.prototype?(this.sdk.log("onloadedmetadata in HTMLVideoElement.prototype"),r.onloadedmetadata=function(){t.receivedOnloadedmetadataCallback||(t.sdk.log("onloadedmetadata callback"),t.receivedOnloadedmetadataCallback=!0,t.checkAckDataChannelStatus())},setTimeout((function(){t.receivedOnloadedmetadataCallback||(t.sdk.log("onloadedmetadata timeout, check status"),t.receivedOnloadedmetadataCallback=!0,t.checkAckDataChannelStatus())}),1e3)):this.checkAckDataChannelStatus()))},e.prototype.onLoadedMetaData=function(){var e,t,n,i=this;if(this.sdk.log("onLoadedMetaData->"),this.connectStatus===d.STATUS.DISCONNECTED)return this.sdk.log("connectStatus is disconnected, onLoadedMetaData return");this.sdk.getCloudGamingContainerElement()&&(this.sdk.getCloudGamingContainerElement().style.display="flex"),this.sdk.getProgressBarElement()&&(this.sdk.getProgressBarElement().style.display="none"),this.sdk.getRestartElement()&&(this.sdk.getRestartElement().style.display="none"),this.sdk.getVideoElement().focus(),null===(n=null===(t=null===(e=this.sdk.getVideoElement())||void 0===e?void 0:e.play())||void 0===t?void 0:t.then((function(){i.sdk.log("video play success"),i.sdk.onEvent({type:"autoplay",data:{code:0,message:"video play success"}}),i.sdk.reshapeWindow()})))||void 0===n||n.catch((function(e){i.sdk.log("video play error, ",e,e.name),i.sdk.onEvent({type:"autoplay",data:{code:-1,message:e}})})),this.sdk.showStats.setConnectSuccessTime(+new Date),this.connectStatus=d.STATUS.ESTABLISHED,this.checkMouseShowInterval||(this.checkMouseShowInterval=setInterval((function(){i.checkUserIdle()}),100)),this.startHeartbeatReport(),this.sdk.onWebrtcStatsChange(d.PAGE_STATS.PLAYING),this.sdk.onConnectSuccess({code:0,seat_index:this.sdk.gameConfig.getConfig().seat_index,role:this.sdk.gameConfig.getConfig().role})},e.prototype.onIceConnectionStateChange=function(){if(this.sdk.log("onIceConnectionStateChange",this.peerConnection.iceConnectionState),this.peerConnection){if("connected"===this.peerConnection.iceConnectionState&&(this.sdk.showStats.setIceConnectedTime(+new Date),this.sdk.onEvent({type:"ice_state",data:{value:"connected"}})),"disconnected"===this.peerConnection.iceConnectionState){if(this.sdk.onEvent({type:"ice_state",data:{value:"disconnected"}}),this.sdk.getController())return this.sdk.log("The ICE disconnected, do not reconnect in group control mode."),void this.disconnected({message:"The ICE disconnected, please check the network.",code:d.RTC_CODE.CONNECT_FAILED});this.sdk.log("The ICE disconnected, please check the network."),this.sdk.log("Follow the link, https://cloud.tencent.com/document/product/1547/75988, and check your network."),this.disconnected({message:"The ICE disconnected, please check the network.",code:d.RTC_CODE.NEED_RECONNECT}),this.sdk.onEvent({type:"ice_state",data:{value:"disconnected"}})}}else this.sdk.log("The peerConnection disconnected")},e.prototype.createKmDataChannel=function(){var e=this;this.sdk.log("start createKmDataChannel"),this.kmDataChannel=this.peerConnection.createDataChannel(d.DATACHANNEL.KM,{ordered:!0,maxRetransmits:10}),this.kmDataChannel.onmessage=function(t){return e.onKmMessage(t)},this.kmDataChannel.onopen=function(t){return e.onDataChannelOpen(t)},this.kmDataChannel.onclose=function(t){return e.onDataChannelClose(t)},this.kmDataChannel.onerror=function(t){return e.onDataChannelError(t)}},e.prototype.createHbDataChannel=function(){var e=this;this.sdk.log("start createHbDataChannel"),this.hbDataChannel=this.peerConnection.createDataChannel(d.DATACHANNEL.HB,{ordered:!0,maxRetransmits:0}),this.hbDataChannel.onmessage=function(t){return e.onHbMessage(t)},this.hbDataChannel.onopen=function(t){return e.onDataChannelOpen(t)},this.hbDataChannel.onclose=function(t){return e.onDataChannelClose(t)},this.hbDataChannel.onerror=function(t){return e.onDataChannelError(t)}},e.prototype.createAckDataChannel=function(){var e=this;this.sdk.log("start createAckDataChannel"),this.ackDataChannel=this.peerConnection.createDataChannel(d.DATACHANNEL.ACK,{ordered:!0,maxRetransmits:10}),this.ackDataChannel.onmessage=function(t){return e.onAckMessage(t)},this.ackDataChannel.onopen=function(t){return e.onDataChannelOpen(t)},this.ackDataChannel.onclose=function(t){return e.onDataChannelClose(t)},this.ackDataChannel.onerror=function(t){return e.onDataChannelError(t)}},e.prototype.createCdDataChannel=function(){var e,t=this;this.sdk.log("start createCdDataChannel"),this.cdDataChannel=null===(e=this.peerConnection)||void 0===e?void 0:e.createDataChannel(d.DATACHANNEL.CD,{ordered:!0,maxRetransmits:0}),this.cdDataChannel&&(this.cdDataChannel.onmessage=function(e){return t.onCdMessage(e)},this.cdDataChannel.onopen=function(e){return t.onDataChannelOpen(e)},this.cdDataChannel.onclose=function(e){return t.onDataChannelClose(e)},this.cdDataChannel.onerror=function(e){return t.onDataChannelError(e)})},e.prototype.createSvrDataChannel=function(){var e,t=this;this.sdk.log("start createSvrDataChannel"),this.svrDataChannel=null===(e=this.peerConnection)||void 0===e?void 0:e.createDataChannel(d.DATACHANNEL.SV,{ordered:!0,maxRetransmits:0}),this.svrDataChannel&&(this.svrDataChannel.onmessage=function(e){return t.onSvrMessage(e)},this.svrDataChannel.onopen=function(e){return t.onDataChannelOpen(e)},this.svrDataChannel.onclose=function(e){return t.onDataChannelClose(e)},this.svrDataChannel.onerror=function(e){return t.onDataChannelError(e)})},e.prototype.createCloudDeviceDataChannel=function(){var e,t=this;this.sdk.log("start createCloudDeviceDataChannel"),this.cloudDeviceDataChannel=null===(e=this.peerConnection)||void 0===e?void 0:e.createDataChannel(d.DATACHANNEL.CLOUD_DEVICE,{ordered:!0,maxRetransmits:0}),this.cloudDeviceDataChannel&&(this.cloudDeviceDataChannel.onmessage=function(e){return t.onCloudDeviceMessage(e)},this.cloudDeviceDataChannel.onopen=function(e){return t.onDataChannelOpen(e)},this.cloudDeviceDataChannel.onclose=function(e){return t.onDataChannelClose(e)},this.cloudDeviceDataChannel.onerror=function(e){return t.onDataChannelError(e)})},e.prototype.onDataChannelError=function(e){var t=e||{},n=t.target,i=t.error;this.sdk.log("".concat(n.label," datachannel error->"),null==i?void 0:i.message)},e.prototype.onDataChannelOpen=function(e){var t=(e||{}).target;this.sdk.log("".concat(t.label," datachannel open->"),t.readyState,t.label),"hb"===t.label&&this.startHeartbeatReport()},e.prototype.onDataChannelClose=function(e){var t=(e||{}).target;this.sdk.log("".concat(t.label," datachannel close->"),t.readyState)},e.prototype.onKmMessage=function(e){var t=JSON.parse(e.data);this.debugSetting.showOnKmMessage&&console.log("onKmMessage",t);var n=t.screen_width,i=t.screen_height,o=t.screen_left,r=t.screen_top,s=t.cursor_showing;this.sdk.pageEvent.remoteScreenResolutionChange({width:n,height:i,left:o,top:r}),this.sdk.showStats.setCpuAndGpuUsage({cpu:t.cpu_usage,gpu:t.gpu_usage}),this.setCursorShowStatus(null==s||s)},e.prototype.onHbMessage=function(e){var t=JSON.parse(e.data),n=t.token,i=t.code,o=t.user_id,r=t.timestamp,s=t.message,a=t.stream_push_state;if(n&&(this.token=n),this.debugSetting.showOnHbMessage&&console.log("onHbMessage",t),i>=0&&(this.sdk.log("onHbMessage",s),this.disconnected({message:s,code:i})),o&&this.sdk.onNetworkChange({status:"stats",stats:t}),r){var c=+new Date-+r;this.sdk.showStats.setRTT(c)&&(o?this.sdk.gameConfig.getServerSideDescription().user_id===o&&this.sdk.onNetworkChange({status:"jitter",data:{value:c,message:"NETWORK_JITTER"}}):this.sdk.onNetworkChange({status:"jitter",data:{value:c,message:"NETWORK_JITTER"}}))}this.streamPushStat!==a&&(this.streamPushStat=a,this.sdk.onStreamPushStateChange({stream_push_state:this.streamPushStat}))},e.prototype.onAckMessage=function(e){try{var t=JSON.parse(e.data),n=t.data,i=void 0===n?p:n,o=t.seq;if(this.debugSetting.showOnAckMessage&&("cursor_state"===i.type||"keys_clean"===i.type||console.log("onAckMessage",i,o)),"seats_info_sync"===i.type)return;var r=this.dataChannelCallbacks[o];if(o&&(this.sdk.showStats.setInputEnd(o),r)){var s=r.callback;delete this.dataChannelCallbacks[o],this.dataChannelRetryTimers[o]&&(clearTimeout(this.dataChannelRetryTimers[o]),delete this.dataChannelRetryTimers[o]),null==s||s({code:0,msg:"on ack message",data:i})}switch(i.type){case"cursor_state":if(!i.state)return;this.setCursorShowStatus("showing"===i.state);break;case"game_launched":this.sdk.log("game_launched",i),this.sdk.onNetworkChange({status:"gamelaunched",data:{begin:i.launch_begin,finish:i.launch_complete}});break;case"input_seat":this.sdk.log("got new input_seat",i),this.sdk.gameConfig.setSeatIndex(i.input_seat);break;case"user_state":this.sdk.log("user state update",i),this.sdk.onMultiPlayerChange({user_state:{user_id:i.user_id,state:i.state}});break;case"open_url":this.sdk.log("got open_url",i),this.sdk.onNetworkChange({status:"openurl",data:{value:i.url}}),this.sdk.onEvent({type:"openurl",data:{value:i.url}});break;case"vmaf_test":default:break;case"user_sdk_update":this.sdk.log("user_sdk_update",i),this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:i.sdp,type:"answer"}));break;case"user_update":this.sdk.log("user_update"),this.renegotiation(i.sdp);break;case"sync_seats":this.sdk.log("sync_seats",i),r||this.sdk.onMultiPlayerChange({seats_info:{players:i.players,viewers:i.viewers}});var a=this.sdk.gameConfig.getServerSideDescription().user_id,c=i.players.find((function(e){return e.name===a}));c&&(0!==c.mic_status&&1!==c.mic_status||this.setTrackEnable({type:"audio",enable:!1}),2===c.mic_status&&this.setTrackEnable({type:"audio",enable:!0}));break;case"submit_seat_change":this.sdk.log("submit_seat_change",i),r||this.sdk.onMultiPlayerChange({submit_seat_change:{user_id:i.user_id,to_role:i.to_role,seat_index:i.seat_index}});break;case"cursor_pos":if(this.remoteCursorMode===d.CURSOR_MODE.REMOTE_SRC_POS){var l=i.x,u=i.y,h=this.sdk.pageEvent.transferLocalScale({width:l-this.hotSpot.x,height:u-this.hotSpot.y}),f=h.width,m=h.height;this.sdk.pageEvent.updateCursorPosition({displayX:f,displayY:m})}}}catch(e){this.sdk.log("onAckMessage exception->",null==e?void 0:e.message)}},e.prototype.onCdMessage=function(e){var t=this,n=e.data;if(n)try{var i=JSON.parse(n),o=i.data,r=i.hotspotx,s=void 0===r?0:r,a=i.hotspoty,c=void 0===a?0:a;this.debugSetting.showOnCdMessage&&this.sdk.log("onCdMessage image data->".concat(o.length," ").concat((0,u.default)(o)),"hotspotx",s,"hotspoty",c),this.hotSpot.x=s,this.hotSpot.y=c;var h="data:image/png;base64,".concat(o);this.remoteCursorImage=h;var p=new Image;p.onload=function(){if(t.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS)(e=t.sdk.getCursorElement()).style.backgroundImage="url(".concat(h,")"),e.style.top="auto",e.style.left="auto",t.resizeMobileCursor({width:p.width,height:p.height});else if((0,l.isMobile)()||t.remoteCursorMode===d.CURSOR_MODE.REMOTE_SRC_POS){var e;(e=t.sdk.getCursorElement()).style.backgroundImage="url(".concat(h,")"),t.resizeMobileCursor({width:16,height:16})}else{var n=t.sdk.getVideoElement();n&&(n.style.cursor="url(".concat(h,") ").concat(t.hotSpot.x," ").concat(t.hotSpot.y,", auto"))}},p.onerror=function(e){this.sdk.log("onCdMessage image data load failed",e)},p.src=h}catch(e){this.sdk.log("onCdMessage data parse failed",e)}else this.sdk.log("onCdMessage no data")},e.prototype.onSvrMessage=function(e){var t=e.data;if(t)try{var n=JSON.parse(t),o=n.type,r=n.data;switch(this.debugSetting.showOnSvMessage&&this.sdk.log("onSvMessage","type: ",o,"data",t),o){case"game_start_complete":this.sdk.onGameStartComplete(r);break;case"game_stopped":this.sdk.onGameStop(r);break;case"archive_load_status":this.sdk.onLoadGameArchive(r);break;case"archive_save_status":this.sdk.onSaveGameArchive(r);break;case"metric_sig_key":this.sdk.gameConfig.setServerSideDescription(i(i({},this.sdk.gameConfig.getServerSideDescription()),{sig_key:r.sig_key}));break;case"screen_config_change":this.sdk.onConfigurationChange({screen_config:r});break;case"hit_input":var s=r,a=s.field_type,c=s.status;this.sdk.onInputStatusChange({field_type:a,status:c});break;case"camera_status":var d=r.status;"open_front"===d&&this.switchCamera({status:"open",profile:(0,l.isMobile)()?{deviceId:"user"}:this.getIsMobileGame()?{width:720,height:1280}:null}),"open_back"===d&&this.switchCamera({status:"open",profile:(0,l.isMobile)()?{deviceId:"environment"}:this.getIsMobileGame()?{width:720,height:1280}:null})}}catch(e){this.sdk.log("onSvMessage data parse failed",e)}else this.sdk.log("onSvMessage no data")},e.prototype.onCloudDeviceMessage=function(e){var t=e.data;if(t)try{var n=JSON.parse(t),i=n.type,o=n.data;this.debugSetting.showOnCloudDeviceMessage&&this.sdk.log("onCloudDeviceData","type: ",i,"data",t,"cloudDeviceData",o)}catch(e){this.sdk.log("onCloudDeviceData data parse failed",e)}else this.sdk.log("onCloudDeviceData no data")},e.prototype.resizeMobileCursor=function(e){var t=e.width,n=void 0===t?16:t,i=e.height,o=void 0===i?16:i,r=this.sdk.getCursorElement();r.style.width="".concat(Math.round(n*this.mobileCursorScale),"px"),r.style.height="".concat(Math.round(o*this.mobileCursorScale),"px"),r.style.borderRadius=null,r.style.backgroundColor=null},e.prototype.reportStat=function(){var e=this.sdk.showStats.getStats(),t=e.fps;if(this.connectStatus===d.STATUS.CONNECTING&&(this.connectTimeoutCount+=1,this.connectTimeoutCount>=this.newConnectTimeout&&(this.sdk.log("connect timeout, no-flow notify"),this.sdk.onNetworkChange({status:"noflow"}),this.sdk.onEvent({type:"noflow"}),this.sdk.getController()||this.disconnected({message:"connect timeout, please reconnect",code:d.RTC_CODE.NEED_RECONNECT}),this.connectTimeoutCount=0)),this.connectStatus===d.STATUS.ESTABLISHED&&(0===t&&"playing"===this.gameStatus?(this.noFlowCount+=1,this.noFlowCount>=this.noflowTimeout&&(this.sdk.log("noFlowCount reach, no-flow notify"),this.sdk.onNetworkChange({status:"noflowcenter"}),this.sdk.onEvent({type:"noflowcenter"}),this.noFlowCount=0)):this.noFlowCount=0),!this.hbDataChannel)return this.sdk.log("hbDataChannel has been closed");if(e.timestamp=+new Date,this.connectStatus!==d.STATUS.DISCONNECTED){var n=e.fps,o=e.delay,r=e.bit_rate,s=e.packet_lost,a=e.nack,c=e.packet_received,l=i(i({},e),{fps:"".concat(n),delay:"".concat(o),bit_rate:"".concat(8*r),packet_lost:"".concat(s),nack:"".concat(a),packet_received:"".concat(c)});this.dataChannelSend(this.hbDataChannel,l),this.debugSetting.showSendHbData&&console.log("sendHbData",l),this.sdk.onNetworkChange({status:"stats",stats:e}),this.sdk.onEvent({type:"webrtc_stats",data:e})}this.sdk.showStats.addReportStat()},e.prototype.dataChannelSend=function(e,t){"open"===(null==e?void 0:e.readyState)&&e.send(JSON.stringify(t))},e.prototype.dataChannelSendWithCallback=function(e){var t=this,n=e.dataChannel,i=void 0===n?null:n,o=e.ackMsg,r=void 0===o?p:o,s=e.retry,a=void 0===s?0:s,c=e.callback,d=void 0===c?l.noop:c,u=e.interval,h=void 0===u?1e3:u;if("open"===(null==i?void 0:i.readyState))try{var f=r.seq;if(f||(f=(0,l.getSequence)(),this.sdk.showStats.setInputStart(f)),i.send(JSON.stringify(r)),this.dataChannelCallbacks[f]={ackMsg:r,retry:a,callback:d,interval:h,retryAction:function(){if(!t.dataChannelCallbacks[f])return t.sdk.log(i.label,f,"ackItem not exist");var e=t.dataChannelCallbacks[f];if(e.retry>=1||-1===e.retry)t.sdk.log(i.label,f,"ackItem retry, remain ".concat(e.retry," times")),e.retry=e.retry>=1?e.retry-1:e.retry,t.dataChannelSendWithCallback({dataChannel:i,ackMsg:e.ackMsg,retry:e.retry,callback:e.callback,interval:e.interval});else{var n=e.callback;delete t.dataChannelCallbacks[f],t.dataChannelRetryTimers[f]&&(t.sdk.showStats.setInputEnd(f),clearTimeout(t.dataChannelRetryTimers[f]),delete t.dataChannelRetryTimers[f],t.sdk.log("ack msg timer timeout clear:",f)),n({code:1,msg:"send ack message timeout"}),t.sdk.log("send ack message timeout:",f)}}},a>0){var m=setTimeout((function(){var e;null===(e=t.dataChannelCallbacks[f])||void 0===e||e.retryAction()}),h);this.dataChannelRetryTimers[f]=m}}catch(e){this.sdk.log("ack msg exception:",e)}},e.prototype.setCursorShowStatus=function(e){var t,n;if(this.connectStatus===d.STATUS.ESTABLISHED){this.forceShowCursor?this.lockMouse(!1):this.forceLockCursor?this.lockMouse(!0):e?this.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS?this.sdk.getCursorElement().style.display="block":this.lockMouse(!1):this.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS?this.sdk.getCursorElement().style.display="none":this.lockMouse(!0),this.forceLockCursor?this.showCursor=!1:(e!==this.showCursor&&(this.sdk.log("cursor show stat will set to",e),this.sdk.onCursorShowStatChange({oldStatus:this.showCursor,newStatus:e})),this.showCursor=e);var i=null===(t=this.sdk)||void 0===t?void 0:t.getVideoElement(),o=null===(n=this.sdk)||void 0===n?void 0:n.getCursorElement();if(this.remoteCursorMode!==d.CURSOR_MODE.REMOTE_SRC_POS){if(this.remoteCursorMode===d.CURSOR_MODE.REMOTE_DRAW)return i.style.cursor="none";i&&(this.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS?i.style.cursor="auto":e||this.forceShowCursor||"touch"===this.sdk.pageEvent.getClientInteractMode()?i.style.cursor="url(".concat(this.remoteCursorImage?this.remoteCursorImage:this.originCursorStyle,") ").concat(this.hotSpot.x," ").concat(this.hotSpot.y,", auto"):i.style.cursor="none"),(0,l.isMobile)()&&((e||this.forceShowCursor||"touch"===this.sdk.pageEvent.getClientInteractMode())&&this.mobileShowCursor?o.style.display="block":o.style.display="none")}else(e||this.forceShowCursor)&&this.mobileShowCursor?o.style.display="block":o.style.display="none"}},e}();t.default=f},4711:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__decorate||function(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},d=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var p=n(9418),f=n(2484),m=n(1743),v=n(1587),g=h(n(7329)),y=s(n(6363)),C=h(n(7023)),b=function(){function e(e){var t=e.sdk,n=this;this.moveSensitivity=1,this.touchesForDelta=null,this.touchesIdentifierMap=new Map,this.touchesMap=new Map,this.touchState=null,this.mousePosition={x:0,y:0,movementX:0,movementY:0,remoteX:0,remoteY:0},this.remoteMousePosition={x:0,y:0,sent:!1},this.enableMousemoveV2=!0,this.tabletModeLastPosition=null,this.kmStatus={keyboard:!0,mouse:!0},this.enablePaste=!0,this.keyboardPressedKeys=new Map,this.wheeling=!1,this.deltaMoveToCalcX=0,this.deltaMoveToCalcY=0,this.escPressTime=null,this.tabletMode=!1,this.clickToFullscreen=!1,this.clickBodyToPlay=!0,this.mutedVideo=!1,this.webDraftLevel=p.WEB_DRAFT_LEVEL.CLOSE_HIGH_FREQUENCY,this.enableEventIntercept=!0,this.videoWidth=0,this.videoHeight=0,this.videoLeft=0,this.videoTop=0,this.videoStatus="pause",this.remoteScreenWidth=0,this.remoteScreenHeight=0,this.remoteScreenLeft=0,this.remoteScreenTop=0,this.remoteOrientation="portrait",this.dropMouseEvent=!1,this.videoOrientation=0,this.pageOrientation=null,this.resizeObserver=null,this.doubleTap=!1,this.doubleTapResponse=[],this.addKMHandlerFlag=!1,this.clientInteractMode="cursor",this.visibilityState="visible",this.sdk=null,this.transformMouseOffset={x:0,y:0},window.addEventListener("online",(function(e){n.onNetwork(e)}),!1),window.addEventListener("offline",(function(e){n.onNetwork(e)}),!1),this.onTouch=this.onTouch.bind(this),this.onResize=this.onResize.bind(this),this.onBodyClick=this.onBodyClick.bind(this),this.onVideoPlaying=this.onVideoPlaying.bind(this),this.onVideoPause=this.onVideoPause.bind(this),this.onVideoEnd=this.onVideoEnd.bind(this),this.onVideoElementClick=this.onVideoElementClick.bind(this),this.onOrientationChange=this.onOrientationChange.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),this.onFocusChange=this.onFocusChange.bind(this),this.sdk=t}return e.prototype.init=function(e){var t,n,i,o,r;this.tabletMode=e.tabletMode,this.clickToFullscreen=e.clickToFullscreen,this.clickBodyToPlay=null===(t=e.clickBodyToPlay)||void 0===t||t,this.webDraftLevel=null!==(n=e.webDraftLevel)&&void 0!==n?n:p.WEB_DRAFT_LEVEL.CLOSE_HIGH_FREQUENCY,this.enableEventIntercept=null===(i=e.enableEventIntercept)||void 0===i||i,this.clientInteractMode=e.clientInteractMode||"cursor",this.enablePaste=null!==(o=e.enablePaste)&&void 0!==o?o:this.enablePaste,this.enableMousemoveV2=null===(r=e.enableMousemoveV2)||void 0===r||r},e.prototype.clearEvent=function(){this.resizeObserver=null,window.removeEventListener("resize",this.onResize,!1),window.removeEventListener("visibilitychange",this.onVisibilityChange,!1),window.removeEventListener("orientationchange",this.onOrientationChange,!1),window.removeEventListener("focus",this.onFocusChange,!1),window.removeEventListener("blur",this.onFocusChange,!1),document.body.removeEventListener("click",this.onBodyClick,!1),this.sdk.getVideoElement()&&(this.sdk.getVideoElement().removeEventListener("playing",this.onVideoPlaying,!1),this.sdk.getVideoElement().removeEventListener("pause",this.onVideoPause,!1),this.sdk.getVideoElement().removeEventListener("ended",this.onVideoEnd,!1),this.sdk.getVideoElement().removeEventListener("click",this.onVideoElementClick,!1))},e.prototype.addEventHandler=function(){var e=this;this.addKMHandler(),this.addTouchHandler(),(0,m.isMobile)()||this.sdk.gamepad.addGamepadHandler(),document.body.removeEventListener("click",this.onBodyClick,!1),document.body.addEventListener("click",this.onBodyClick,!1),this.sdk.getVideoElement().removeEventListener("playing",this.onVideoPlaying,!1),this.sdk.getVideoElement().addEventListener("playing",this.onVideoPlaying,!1),this.sdk.getVideoElement().removeEventListener("pause",this.onVideoPause,!1),this.sdk.getVideoElement().addEventListener("pause",this.onVideoPause,!1),this.sdk.getVideoElement().removeEventListener("ended",this.onVideoEnd,!1),this.sdk.getVideoElement().addEventListener("ended",this.onVideoEnd,!1),this.sdk.getVideoElement().removeEventListener("click",this.onVideoElementClick,!1),this.sdk.getVideoElement().addEventListener("click",this.onVideoElementClick,!1),window.removeEventListener("orientationchange",this.onOrientationChange,!1),window.addEventListener("orientationchange",this.onOrientationChange,!1),window.addEventListener("resize",this.onResize,!1),document.addEventListener("pointerlockerror",(function(){e.sdk.onEvent({type:"pointerlockerror"})}),!1),this.sdk.cloudGamingWebRTC.sendKmData({type:"mousedeltamove",x:1,y:1})},e.prototype.initOrientationDetector=function(){this.addOrientationDetector()},e.prototype.setTabletMode=function(e){this.tabletMode=e},e.prototype.setMoveSensitivity=function(e){this.moveSensitivity=1/e},e.prototype.getMoveSensitivity=function(){return this.moveSensitivity},e.prototype.remoteScreenResolutionChange=function(e){var t=e.width,n=e.height,i=e.left,o=e.top;this.remoteScreenWidth===t&&this.remoteScreenHeight===n&&this.remoteScreenLeft===i&&this.remoteScreenTop===o||(this.remoteScreenWidth=t,this.remoteScreenHeight=n,this.remoteScreenLeft=i,this.remoteScreenTop=o,this.sdk.onRemoteScreenResolutionChange({width:t,height:n,top:o,left:i}),this.sdk.log("remoteScreenResolutionChange->".concat(t," ").concat(n," ").concat(i," ").concat(o," ")),this.reshapeWindow())},e.prototype.getRemoteOrientation=function(){return this.remoteOrientation},e.prototype.setRemoteOrientation=function(e){this.remoteOrientation=e},e.prototype.clearRemoteKeys=function(){this.sdk.cloudGamingWebRTC.sendAckData({data:{type:"keys_clean"}})},e.prototype.transferLocalScale=function(e){var t=e.width,n=void 0===t?1:t,i=e.height,o=void 0===i?1:i,r=this.videoWidth/this.remoteScreenWidth*n,s=this.videoHeight/this.remoteScreenHeight*o;return 90===this.videoOrientation&&(r=this.videoHeight/this.remoteScreenWidth*o,s=this.videoWidth/this.remoteScreenHeight*n),{width:r,height:s}},e.prototype.mouseMove=function(e,t,n,i){var o,r,s=this.sdk.cloudGamingWebRTC.getDisplayRect(),a=s.left,c=s.top,d=s.width,l=s.height;if(this.tabletMode?(this.tabletModeLastPosition||(this.tabletModeLastPosition={x:n,y:i}),this.mousePosition.x=this.mousePosition.x+(n-this.tabletModeLastPosition.x),this.mousePosition.y=this.mousePosition.y+(i-this.tabletModeLastPosition.y),this.mousePosition.x<=a&&(this.mousePosition.x=a),this.mousePosition.x>=d+a&&(this.mousePosition.x=d+a),this.mousePosition.y<=c&&(this.mousePosition.y=c),this.mousePosition.y>=l+c&&(this.mousePosition.y=l+c),this.tabletModeLastPosition={x:n,y:i}):this.mousePosition={x:n,y:i,movementX:n-this.mousePosition.x,movementY:i-this.mousePosition.y},90===this.videoOrientation?(o=this.mousePosition.y-c,r=this.videoWidth-this.mousePosition.x+a):(o=this.mousePosition.x-a,r=this.mousePosition.y-c),this.updateCursorPosition({displayX:o,displayY:r}),"touchstart"===t)if(this.sdk.cloudGamingWebRTC.getCursorShowStatus()){var u=this.moveTo(o,r),h=u.remoteX,p=u.remoteY;this.enableMousemoveV2?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove_v2",x:h,y:p}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove",x:h,y:p})}else this.sdk.log("cursor is not showing, cursor will not move");if("touchmove"===t)if(this.sdk.cloudGamingWebRTC.getCursorShowStatus()){var f=this.moveTo(o,r);h=f.remoteX,p=f.remoteY,this.enableMousemoveV2?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove_v2",x:h,y:p}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove",x:h,y:p})}else{var m=this.deltaMoveTo(this.mousePosition.movementX,this.mousePosition.movementY),v=m.remoteDeltaX,g=m.remoteDeltaY;90===this.videoOrientation?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousedeltamove",x:g,y:-v}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousedeltamove",x:v,y:g})}"touchend"!==t&&"touchcancel"!==t||(this.tabletModeLastPosition=null)},e.prototype.mobileTouchMove=function(e){var t=e.finger_id,n=e.event_type,i=e.x,o=e.y,r=e.width,s=e.height,a=e.timestamp;this.sdk.cloudGamingWebRTC.sendKmData({type:"event_touch",finger_id:t,event_type:n,x:i,y:o,width:r,height:s,timestamp:a})},e.prototype.fullscreen=function(e){var t;return void 0===e&&(e=document.documentElement),a(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:this.sdk.log("enter fullscreen"),n.label=1;case 1:return n.trys.push([1,6,,7]),y.default.requestFullscreen?[4,e[y.default.requestFullscreen]()]:[3,3];case 2:return n.sent(),[3,5];case 3:return[4,e.webkitEnterFullScreen()];case 4:n.sent(),n.label=5;case 5:return[3,7];case 6:throw n.sent();case 7:if(!(0,y.getInIframe)())try{null===(t=null===navigator||void 0===navigator?void 0:navigator.keyboard)||void 0===t||t.lock(["Escape","F11"])}catch(e){this.sdk.log("lockKeyboard",e)}return[2]}}))}))},e.prototype.exitFullscreen=function(e){var t,n;return void 0===e&&(e=document.documentElement),a(this,void 0,void 0,(function(){return c(this,(function(i){return this.sdk.log("exit fullscreen"),y.default.exitFullscreen?null===(n=null===(t=document[y.default.exitFullscreen]())||void 0===t?void 0:t.catch)||void 0===n||n.call(t,(function(e){return console.log("exit full screen failed, ",null==e?void 0:e.message)})):e.webkitExitFullScreen(),[2]}))}))},e.prototype.resetLastPosition=function(e){var t=e.x,n=void 0===t?0:t,i=e.y,o=void 0===i?0:i;this.mousePosition.x=n,this.mousePosition.y=o},e.prototype.updateCursorPosition=function(e){var t=e.displayX,n=e.displayY,i=this.sdk.getCursorElement();90===this.videoOrientation?(t>this.videoHeight&&(t=this.videoHeight),n>this.videoWidth&&(n=this.videoWidth)):(t>this.videoWidth&&(t=this.videoWidth),n>this.videoHeight&&(n=this.videoHeight)),t<0&&(t=0),n<0&&(n=0),i&&(i.style.top="".concat(n+(90===this.videoOrientation?this.videoLeft:this.videoTop),"px"),i.style.left="".concat(t+(90===this.videoOrientation?this.videoTop:this.videoLeft),"px"),i.style.zIndex="100")},e.prototype.setDropMouseEvent=function(e){this.dropMouseEvent=e},e.prototype.setWebDraftLevel=function(e){void 0===e&&(e=0),this.webDraftLevel=e},e.prototype.setEnableEventIntercept=function(e){void 0===e&&(e=!0),this.enableEventIntercept=e},e.prototype.setVideoOrientation=function(e){var t,n=e.deg,i=void 0===n?0:n,o=e.rotateContainer,r=void 0===o||o,s=e.rotateMountPoint,a=void 0!==s&&s;if(this.sdk.log("setVideoOrientation",i,r,a),this.videoOrientation=i,(0,m.dispatchEvent)({name:"this.sdk:VideoOrientation",data:{deg:i,rotateContainer:r,rotateMountPoint:a}}),r||a){var c=document.querySelector("html");a&&(c=this.sdk.getIsMobileGame()&&!(0,m.isMobile)()?this.sdk.getCloudGamingContainerElement():document.getElementById(null===(t=this.sdk.getInitOptions())||void 0===t?void 0:t.mount)),c?(90===i&&(c.className=c.className.includes("rotate-html-90")?c.className:"".concat(c.className," rotate-html-90")),270===i&&(c.className=c.className.includes("rotate-html-270")?c.className:"".concat(c.className," rotate-html-270")),0===i?a?(c.className=c.className.split(" rotate-html-".concat(this.sdk.getIsMobileGame()&&this.isPortraitStream?"270":"90")).join(""),c.style.width="100%",c.style.height="100%"):r&&(c.className="",c.style.width=null,c.style.height=null):(0,m.isMobile)()?(this.sdk.getIsMobileGame()||a)&&(window.innerHeight>window.innerWidth?(c.style.width="".concat(window.innerHeight,"px"),c.style.height="".concat(window.innerWidth,"px")):setTimeout((function(){c.style.width="".concat(window.innerHeight,"px"),c.style.height="".concat(window.innerWidth,"px")}),100)):(c.style.width="".concat(window.innerHeight,"px"),c.style.height="".concat(window.innerWidth,"px"))):this.sdk.log("setVideoOrientation -> can not find mount point")}this.reshapeWindow()},e.prototype.getPageOrientation=function(){return this.pageOrientation},e.prototype.reshapeWindow=function(){var e=this;this.sdk.log("reshapeWindow");var t=this.sdk.getVideoElement();if(t){var n=this.sdk.getCloudGamingContainerElement(),i=this.sdk.getInitOptions().fullVideoToScreen,o=void 0===i||i;t.videoWidth&&t.videoHeight&&n.clientWidth>t.videoWidth&&n.clientHeight>t.videoHeight&&o&&(n.clientWidth/n.clientHeight>t.videoWidth/t.videoHeight?(t.style.height="100%",t.style.width=null):(t.style.width="100%",t.style.height=null)),(n.clientWidth<t.videoWidth||n.clientHeight<t.videoHeight)&&(t.style.width=null,t.style.height=null);var r=function(){var n=t.getBoundingClientRect(),i=n.width,o=n.height,r=n.top,s=n.left;e.videoWidth=i,e.videoHeight=o,e.videoLeft=s,e.videoTop=r,e.sdk.log("videoResolutionChange-> width: ".concat(e.videoWidth,", height: ").concat(e.videoHeight,", left: ").concat(e.videoLeft,", top: ").concat(e.videoTop))};r(),this.resizeObserver||(this.resizeObserver=new g.default((function(){r()})),this.resizeObserver.observe(t))}},e.prototype.setKMStatus=function(e){var t=e.keyboard,n=void 0===t||t,i=e.mouse,o=void 0===i||i;this.kmStatus={keyboard:n,mouse:o}},e.prototype.setPaste=function(e){this.enablePaste=e},e.prototype.setVideoMuted=function(e){this.mutedVideo=e},e.prototype.setClientInteractMode=function(e){void 0===e&&(e="cursor"),this.clientInteractMode=e},e.prototype.getClientInteractMode=function(){return this.clientInteractMode},e.prototype.addKMHandler=function(){var e=this;this.addKMHandlerFlag||(this.addKMHandlerFlag=!0,(0,m.isMobile)()||(this.webDraftLevel===p.WEB_DRAFT_LEVEL.CLOSE_HIGH_FREQUENCY?document.addEventListener("mousemove",(function(t){e.onMouseMove(t)}),!1):document.addEventListener("pointermove",(function(t){e.onMouseMove(t)}),!1),document.addEventListener("mousedown",(function(t){e.onMouseDown(t)}),!1),document.addEventListener("mouseup",(function(t){e.onMouseUp(t)}),!1)),document.addEventListener("wheel",(function(t){e.onWheel(t)}),!1),document.addEventListener("keydown",(function(t){e.onKeyEvent(t)}),!1),document.addEventListener("keyup",(function(t){e.onKeyEvent(t)}),!1),document.addEventListener("keypress",(function(){e.onKeyPress()}),!1),document.addEventListener("contextmenu",(function(t){e.onContextMenu(t)}),!1),document.addEventListener("fullscreenchange",(function(){if((0,m.isFullScreen)()){e.sdk.log("enter fullscreenChange");try{e.sdk.getVideoElement().focus()}catch(t){e.sdk.log("fullscreenChange error,",t)}}e.reshapeWindow()}),!1),window.addEventListener("visibilitychange",(function(){e.onVisibilityChange()}),!1),window.addEventListener("focus",(function(){e.onFocusChange()}),!1),window.addEventListener("blur",(function(){e.onFocusChange()}),!1),document.addEventListener("pointerlockchange",(function(){e.pointerlockchange()})),document.addEventListener("paste",(function(t){e.onPaste(t)})))},e.prototype.addTouchHandler=function(){var e=this.sdk.getCloudGamingContainerElement();e.removeEventListener("touchmove",this.onTouch,!1),e.removeEventListener("touchstart",this.onTouch,!1),e.removeEventListener("touchend",this.onTouch,!1),e.removeEventListener("touchcancel",this.onTouch,!1),e.addEventListener("touchmove",this.onTouch,!1),e.addEventListener("touchstart",this.onTouch,!1),e.addEventListener("touchend",this.onTouch,!1),e.addEventListener("touchcancel",this.onTouch,!1),document.addEventListener("gesturestart",(function(e){e.preventDefault()}))},e.prototype.onResize=function(e){var t=this;this.sdk.log("onresize",e),setTimeout((function(){t.reshapeWindow()}),0)},e.prototype.addOrientationDetector=function(){var e=this,t=this.sdk.getInitOptions(),n=t.autoRotateContainer,i=t.autoRotateMountPoint,o=window.matchMedia("(orientation: portrait)"),r=function(t){if(t.matches){e.pageOrientation="portrait",(n||i)&&e.setVideoOrientation({deg:e.sdk.getIsMobileGame()&&e.isPortraitStream?0:90,rotateContainer:n,rotateMountPoint:i});try{e.sdk.onOrientationChange({type:"portrait"})}catch(t){e.sdk.log("onOrientationChange callback error",t)}}else{e.pageOrientation="landscape",(n||i)&&e.setVideoOrientation({deg:e.sdk.getIsMobileGame()&&e.isPortraitStream?270:0,rotateContainer:n,rotateMountPoint:i});try{e.sdk.onOrientationChange({type:"landscape"})}catch(t){e.sdk.log("onOrientationChange callback error",t)}}};r(o),o.addListener(r)},Object.defineProperty(e.prototype,"isPortraitStream",{get:function(){var e=this.sdk.getRemoteStreamResolution(),t=e.width;return e.height>t},enumerable:!1,configurable:!0}),e.prototype.onVisibilityChange=function(){var e=this;this.clearRemoteKeys(),this.sdk.log("visibilitychange",document.hidden?"hidden":"visible"),document.hidden?(this.visibilityState="hidden",(0,m.isMobile)()&&(this.touchesIdentifierMap.clear(),this.sdk.clearRemoteKeys(),setTimeout((function(){e.sdk.getIsMobileGame()||e.sdk.sendMouseEvent({type:"mouseleft",down:!1}),e.touchesMap.clear()}),100))):this.visibilityState="visible",this.sdk.onVisibilityChange({status:this.visibilityState})},e.prototype.onNetwork=function(e){this.sdk.log("onNetwork",e.type),this.sdk.onNetworkChange({status:e.type})},e.prototype.onFocusChange=function(){this.clearRemoteKeys()},e.prototype.pointerlockchange=function(){},e.prototype.onPaste=function(e){console.log("onPaste",e,e.clipboardData.getData("text/plain"))},e.prototype.onContextMenu=function(e){e.preventDefault()},e.prototype.transferRemotePosition=function(e){var t=e.displayX,n=void 0===t?1:t,i=e.displayY,o=void 0===i?1:i,r=e.moveSensitivity,s=void 0===r?1:r,a=Math.round(n*this.remoteScreenWidth/this.videoWidth/s)+this.remoteScreenLeft,c=Math.round(o*this.remoteScreenHeight/this.videoHeight/s)+this.remoteScreenTop;return 90!==this.videoOrientation&&270!==this.videoOrientation||(a=Math.round(n*this.remoteScreenWidth/this.videoHeight/s)+this.remoteScreenLeft,c=Math.round(o*this.remoteScreenHeight/this.videoWidth/s)+this.remoteScreenTop),{x:a,y:c}},e.prototype.transferRemotePositionV2=function(e){var t=e.displayX,n=void 0===t?1:t,i=e.displayY,o=void 0===i?1:i,r=e.moveSensitivity,s=void 0===r?1:r,a=n/this.videoWidth/s,c=o/this.videoHeight/s;return 90!==this.videoOrientation&&270!==this.videoOrientation||(a=n/this.videoHeight/s,c=o/this.videoWidth/s),{x:Math.round(8192*a),y:Math.round(8192*c)}},e.prototype.transferRemotePositionDeltaMove=function(e){var t=e.displayX,n=void 0===t?1:t,i=e.displayY,o=void 0===i?1:i,r=e.moveSensitivity,s=void 0===r?1:r,a=n*this.remoteScreenWidth/this.videoWidth/s,c=o*this.remoteScreenHeight/this.videoHeight/s,d=a+this.transformMouseOffset.x,l=c+this.transformMouseOffset.y,u=Math.round(d)+this.remoteScreenLeft,h=Math.round(l)+this.remoteScreenTop;if(this.transformMouseOffset.x=d-Math.round(d),this.transformMouseOffset.y=l-Math.round(l),90===this.videoOrientation||270===this.videoOrientation){var p=n*this.remoteScreenWidth/this.videoHeight/s,f=o*this.remoteScreenHeight/this.videoWidth/s;u=Math.round(p)+this.remoteScreenLeft,h=Math.round(f)+this.remoteScreenTop,this.transformMouseOffset.x=Math.round(p)-p,this.transformMouseOffset.y=Math.round(f)-f}return{x:u,y:h}},Object.defineProperty(e.prototype,"touchesList",{get:function(){var e,t,n=[];if(this.touchesMap.size)try{for(var i=d(this.touchesMap.values()),o=i.next();!o.done;o=i.next()){var r=o.value;n.push(r)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),e.prototype.onTouch=function(e){var t,n,i=this,o=e.type,r=e.timeStamp,s=e.targetTouches,a=e.changedTouches,c=function(e){var t=e.pageX,n=e.pageY,s=e.identifier,a=h.transferRemotePosition({displayX:t-h.videoLeft,displayY:n-h.videoTop}),c=a.x,d=a.y;c-=h.remoteScreenLeft,d-=h.remoteScreenTop;var f=h.touchesForDelta||{lastX:c,lastY:d},m=(c-f.lastX)/h.moveSensitivity,v=(d-f.lastY)/h.moveSensitivity;if(h.touchesForDelta={lastX:c,lastY:d},"touchstart"===o&&(u([],l(h.touchesIdentifierMap.values()),!1).includes(h.touchesIdentifierMap.size)?h.touchesIdentifierMap.set(s,h.touchesIdentifierMap.size+1):h.touchesIdentifierMap.set(s,h.touchesIdentifierMap.size)),h.sdk.cloudGamingWebRTC.getIsMobileGame()||"touch"===h.clientInteractMode){var g=o;if(270===h.videoOrientation){var y=h.transferRemotePosition({displayX:h.videoHeight-n+h.videoTop,displayY:t-h.videoLeft}),C=y.x,b=y.y;c=C-h.remoteScreenLeft,d=b-h.remoteScreenTop}if(90===h.videoOrientation){var S=h.transferRemotePosition({displayX:n-h.videoTop,displayY:h.videoWidth-t+h.videoLeft});C=S.x,b=S.y,c=C-h.remoteScreenLeft,d=b-h.remoteScreenTop}if("touch"===h.clientInteractMode&&(c>h.remoteScreenWidth&&(c=h.remoteScreenWidth),d>h.remoteScreenHeight&&(d=h.remoteScreenHeight),c<0&&(c=0),d<0&&(d=0)),h.mobileTouchMove({finger_id:h.touchesIdentifierMap.get(s),event_type:p.TOUCH_EVENT_TYPE[g],x:c,y:d,width:h.remoteScreenWidth,height:h.remoteScreenHeight,timestamp:r}),"touch"===h.clientInteractMode){var k=void 0,T=void 0;90===h.videoOrientation?(k=n-h.videoTop,T=h.videoWidth-t+h.videoLeft):(k=t-h.videoLeft,T=n-h.videoTop),h.updateCursorPosition({displayX:k,displayY:T})}}var E={id:s,type:o,x:c,y:d,pageX:t,pageY:n,movementX:m,movementY:v};h.touchesMap.set(s,E),"touchend"!==o&&"touchcancel"!==o||(h.touchesIdentifierMap.delete(s),setTimeout((function(){i.touchesMap.delete(s)}),100)),"touchstart"!==o||h.sdk.cloudGamingWebRTC.getIsMobileGame()||(h.doubleTapResponse.push(E),h.doubleTap?h.sdk.onDoubleTap(h.doubleTapResponse):(h.doubleTap=!0,setTimeout((function(){i.doubleTap=!1,i.doubleTapResponse=[]}),300)))},h=this;try{for(var f=d("touchend"===o||"touchcancel"===o||this.sdk.cloudGamingWebRTC.getIsMobileGame()||"touch"===this.clientInteractMode?a:s),m=f.next();!m.done;m=f.next())c(m.value)}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}this.sdk.cloudGamingWebRTC.getIsMobileGame()||"touch"===this.clientInteractMode||this.sdk.onTouchEvent(this.touchesList)},e.prototype.onMouseMove=function(e){var t,n;if(!1!==this.kmStatus.mouse&&!this.dropMouseEvent){var i="getCoalescedEvents"in e?e.getCoalescedEvents():[e],o=null;this.webDraftLevel===p.WEB_DRAFT_LEVEL.UNPACKAGE_SEND&&i.length>3?(this.sdk.log("webDraftLevel 1, event length is ".concat(i.length,", only pick 3 events")),i.splice(0,i.length-3)):this.webDraftLevel===p.WEB_DRAFT_LEVEL.PACKAGE_SEND&&(this.sdk.log("webDraftLevel 2, event length is ".concat(i.length,", will send seq events")),o=[]);try{for(var r=d(i),s=r.next();!s.done;s=r.next()){var a=s.value,c=a.offsetX,l=a.offsetY,u=a.movementX,h=a.movementY,f=c,m=l;if(f<0&&(f=0),m<0&&(m=0),this.sdk.cloudGamingWebRTC.getCursorMode()===p.CURSOR_MODE.FRONT_DRAW_DELTA_POS)if(this.sdk.cloudGamingWebRTC.isMouseLocked()){if(!this.remoteMousePosition.sent){var v=this.remoteMousePosition,g=v.x,y=v.y;this.enableMousemoveV2?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove_v2",x:g,y}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove",x:g,y}),this.remoteMousePosition.sent=!0}var C=this.deltaMoveTo(u,h),b=C.remoteDeltaX,S=C.remoteDeltaY;this.sdk.cloudGamingWebRTC.sendKmData({type:"mousedeltamove",x:b,y:S}),this.drawMouseDeltaPosition(u,h)}else{var k=this.moveTo(f,m),T=k.remoteX,E=k.remoteY;this.remoteMousePosition.x=T,this.remoteMousePosition.y=E,this.remoteMousePosition.sent=!1,this.mousePosition.deltaX=f,this.mousePosition.deltaY=m}else if(this.sdk.cloudGamingWebRTC.mouseDeltaMove()||!this.sdk.cloudGamingWebRTC.getCursorShowStatus()){var w=this.deltaMoveTo(u,h);b=w.remoteDeltaX,S=w.remoteDeltaY,o?o.push({type:"mousedeltamove",x:b,y:S}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousedeltamove",x:b,y:S})}else{var R=this.moveTo(f,m);if(T=R.remoteX,E=R.remoteY,o)this.enableMousemoveV2?o.push({type:"mousemove_v2",x:T,y:E}):o.push({type:"mousemove",x:T,y:E});else if(this.sdk.cloudGamingWebRTC.getIsMobileGame()||"touch"===this.clientInteractMode){if(this.mousePosition.remoteX=T,this.mousePosition.remoteY=E,"touch"===this.clientInteractMode&&this.touchState!==p.TOUCH_EVENT_TYPE.touchstart)return;this.mobileTouchMove({finger_id:0,event_type:p.TOUCH_EVENT_TYPE.touchmove,x:T,y:E,width:this.remoteScreenWidth,height:this.remoteScreenHeight,timestamp:+new Date})}else this.enableMousemoveV2?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove_v2",x:T,y:E}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove",x:T,y:E})}this.mousePosition.x=f,this.mousePosition.y=m}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}this.webDraftLevel===p.WEB_DRAFT_LEVEL.PACKAGE_SEND&&this.sdk.cloudGamingWebRTC.sendKmData({type:"key_seq",keys:o.map((function(e){return JSON.stringify(e)}))})}},e.prototype.drawMouseDeltaPosition=function(e,t){var n=this.sdk.cloudGamingWebRTC.getCursorShowStatus();this.sdk.getCursorElement().style.display=n?"block":"none";var i=this.sdk.cloudGamingWebRTC.getDisplayRect(),o=i.width,r=i.height;this.mousePosition.deltaX=this.mousePosition.deltaX+e,this.mousePosition.deltaY=this.mousePosition.deltaY+t,this.mousePosition.deltaX<=0&&(this.mousePosition.deltaX=0),this.mousePosition.deltaX>=o&&(this.mousePosition.deltaX=o),this.mousePosition.deltaY<=0&&(this.mousePosition.deltaY=0),this.mousePosition.deltaY>=r&&(this.mousePosition.deltaY=r);var s=this.sdk.cloudGamingWebRTC.getCursorHotSpot();this.updateCursorPosition({displayX:this.mousePosition.deltaX-s.x,displayY:this.mousePosition.deltaY-s.y})},e.prototype.moveTo=function(e,t){if(this.enableMousemoveV2&&!this.sdk.getIsMobileGame()&&"touch"!==this.clientInteractMode){var n=this.transferRemotePositionV2({displayX:e,displayY:t});return{remoteX:n.x,remoteY:n.y}}var i=this.transferRemotePosition({displayX:e,displayY:t}),o=i.x,r=i.y;return o>=this.remoteScreenWidth+this.remoteScreenLeft&&(o=this.remoteScreenWidth+this.remoteScreenLeft-1),o<0&&(o=0),r>=this.remoteScreenHeight+this.remoteScreenTop&&(r=this.remoteScreenHeight+this.remoteScreenTop-1),r<0&&(r=0),{remoteX:o,remoteY:r}},e.prototype.deltaMoveTo=function(e,t){var n=this.transferRemotePositionDeltaMove({displayX:e,displayY:t,moveSensitivity:this.moveSensitivity}),i=n.x,o=n.y,r=i-this.remoteScreenLeft,s=o-this.remoteScreenTop;return this.deltaMoveToCalcX+=r,this.deltaMoveToCalcY+=s,this.deltaMoveToCalcX<0&&(this.deltaMoveToCalcX=0),this.deltaMoveToCalcY<0&&(this.deltaMoveToCalcY=0),this.deltaMoveToCalcX>this.remoteScreenWidth&&(this.deltaMoveToCalcX=this.remoteScreenWidth),this.deltaMoveToCalcY>this.remoteScreenHeight&&(this.deltaMoveToCalcX=this.remoteScreenHeight),{remoteDeltaX:r,remoteDeltaY:s}},e.prototype.isRightClick=function(e){return"which"in e?3===e.which:"button"in e?2===e.button:void 0},e.prototype.determineButtonType=function(e){var t;return null!==(t=["mouseleft","mousemiddle","mouseright","mousebackward","mouseforward","unused","unused"][e.button])&&void 0!==t?t:""},e.prototype.onMouseDown=function(e){if(!1!==this.kmStatus.mouse){if(this.sdk.cloudGamingWebRTC.getIsMobileGame()||"touch"===this.clientInteractMode){var t=this.mousePosition,n=t.remoteX,i=t.remoteY;this.mobileTouchMove({finger_id:0,event_type:p.TOUCH_EVENT_TYPE.touchstart,x:n,y:i,width:this.remoteScreenWidth,height:this.remoteScreenHeight,timestamp:+new Date}),this.touchState=p.TOUCH_EVENT_TYPE.touchstart}else this.sdk.cloudGamingWebRTC.sendKmData({type:this.determineButtonType(e),down:!0}),this.isRightClick(e)&&this.tryToCursorLock();3!==e.button&&4!==e.button||e.preventDefault()}},e.prototype.onMouseUp=function(e){if(!1!==this.kmStatus.mouse)if(this.sdk.cloudGamingWebRTC.getIsMobileGame()||"touch"===this.clientInteractMode){var t=this.mousePosition,n=t.remoteX,i=t.remoteY;this.mobileTouchMove({finger_id:0,event_type:p.TOUCH_EVENT_TYPE.touchend,x:n,y:i,width:this.remoteScreenWidth,height:this.remoteScreenHeight,timestamp:+new Date}),this.touchState=p.TOUCH_EVENT_TYPE.touchend}else this.sdk.cloudGamingWebRTC.sendKmData({type:this.determineButtonType(e),down:!1})},e.prototype.onWheel=function(e){var t,n=this,i=Math.abs(e.deltaY)>=Math.abs(e.deltaX)?"vertical":"horizontal";if(null===(t=C.default.ua)||void 0===t?void 0:t.includes("Mac")){if(!0===this.wheeling)return;this.wheeling=!0,"vertical"===i&&this.sdk.cloudGamingWebRTC.sendKmData({type:"mousescroll",delta:e.deltaY}),"horizontal"===i&&this.sdk.cloudGamingWebRTC.sendKmData({type:"mousehorizontalscroll",delta:e.deltaX}),setTimeout((function(){n.wheeling=!1}),100)}else"vertical"===i&&this.sdk.cloudGamingWebRTC.sendKmData({type:"mousescroll",delta:e.deltaY}),"horizontal"===i&&this.sdk.cloudGamingWebRTC.sendKmData({type:"mousehorizontalscroll",delta:e.deltaX})},e.prototype.onKeyEvent=function(e){var t,n,i,o=this;if(e.preventDefault(),!1!==this.kmStatus.keyboard){var r=e.which||e.keyCode,s=e.ctrlKey,a=e.altKey,c=e.type,d=e.metaKey,h=e.location,p=e.key;if("keyup"===c){if(s){if(r===v.KEYCODE.Space)return this.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:r,down:!0}),void setTimeout((function(){o.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:r,down:!1})}),10);r===v.KEYCODE.Backquote&&this.sdk.cloudGamingWebRTC.toggleStatisticsView()}r===v.KEYCODE.Escape&&(+new Date-this.escPressTime>300&&this.sdk.cloudGamingWebRTC.lockMouse(!1),this.escPressTime=null),(null===(t=C.default.ua)||void 0===t?void 0:t.includes("Mac"))&&"Meta"===p&&u([],l(this.keyboardPressedKeys.keys()),!1).forEach((function(e){e!==v.KEYCODE.LeftWindowKey&&e!==v.KEYCODE.SelectKey&&o.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:e,down:!1}),o.keyboardPressedKeys.delete(e)}))}if("keydown"===c){if((null===(n=C.default.ua)||void 0===n?void 0:n.includes("Mac"))&&this.keyboardPressedKeys.set(r,e),r===v.KEYCODE.X&&a||r===v.KEYCODE.Escape?(r===v.KEYCODE.X&&a&&this.sdk.cloudGamingWebRTC.lockMouse(!1),r===v.KEYCODE.Escape&&(this.escPressTime||(this.escPressTime=+new Date))):this.tryToCursorLock(),this.enablePaste&&(d||s)&&r===v.KEYCODE.V)return void(navigator.clipboard?navigator.clipboard.readText().then((function(e){o.sdk.sendText(e)})).catch((function(e){o.sdk.log("Failed to read clipboard contents: ",e),o.sdk.onEvent({type:"readclipboarderror",data:{message:e.message}})})):this.sdk.onEvent({type:"readclipboarderror"}));if(a&&r===v.KEYCODE.F4)return void this.sdk.log("alt + f4 is forbidden")}if((null===(i=C.default.ua)||void 0===i?void 0:i.includes("Mac"))&&r===v.KEYCODE.CapsLock)return this.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:r,down:!0}),void setTimeout((function(){o.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:r,down:!1})}),10);this.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:r,down:"keydown"===c,location:h})}},e.prototype.onKeyPress=function(){},e.prototype.onBodyClick=function(){var e=this;if(this.clickBodyToPlay){var t=this.sdk.getVideoElement();if(t&&this.sdk.cloudGamingWebRTC.getWebrtcConnectStatus()===p.STATUS.ESTABLISHED){this.mutedVideo||(t.muted=!1);try{"pause"===this.videoStatus&&t.pause(),t.play().catch((function(t){e.sdk.log("onbody click play error",t)}))}catch(e){this.sdk.log("play video error",e)}}var n=this.sdk.getHuaweiAudioElement();n&&(this.mutedVideo||(n.muted=!1),n.play()),(0,m.isMobile)()||(0,m.isFullScreen)()||!this.clickToFullscreen||(this.sdk.log("click to fullscreen->",this.clickToFullscreen),this.fullscreen())}},e.prototype.onVideoPlaying=function(e){this.sdk.log("video state",e.type),this.videoStatus="playing",this.reshapeWindow(),this.sdk.onEvent({type:"video_state",data:{code:0,message:"playing"}})},e.prototype.onVideoPause=function(e){this.sdk.log("video state",e.type),this.videoStatus="pause",this.sdk.onEvent({type:"video_state",data:{code:1,message:"pause"}})},e.prototype.onVideoEnd=function(e){this.sdk.log("video state",e.type),this.videoStatus="pause",this.sdk.onEvent({type:"video_state",data:{code:2,message:"ended"}})},e.prototype.onVideoElementClick=function(){this.sdk.getVideoElement().focus(),this.sdk.cloudGamingWebRTC.getCursorMode()===p.CURSOR_MODE.FRONT_DRAW_DELTA_POS&&this.sdk.cloudGamingWebRTC.lockMouse(!0)},e.prototype.onOrientationChange=function(){var e=this;this.sdk.log("orientationchange"),setTimeout((function(){e.reshapeWindow()}),0)},e.prototype.tryToCursorLock=function(){if(!this.sdk.cloudGamingWebRTC.getForceShowCursor()){var e=document.pointerLockElement;e||this.sdk.cloudGamingWebRTC.getCursorShowStatus()&&!this.sdk.cloudGamingWebRTC.mouseDeltaMove()||(this.sdk.cloudGamingWebRTC.lockMouse(!0),this.sdk.log("tryToCursorLock",e,"forceShowCursor",this.sdk.cloudGamingWebRTC.getForceShowCursor()),this.sdk.log("toggleMouseLock true, auto run requestPointerLock"))}},r([(0,f.interceptUserEvent)()],e.prototype,"onTouch",null),r([(0,f.interceptUserEvent)()],e.prototype,"onMouseMove",null),r([(0,f.interceptUserEvent)()],e.prototype,"onMouseDown",null),r([(0,f.interceptUserEvent)()],e.prototype,"onMouseUp",null),r([(0,f.interceptUserEvent)()],e.prototype,"onWheel",null),r([(0,f.interceptUserEvent)("keyEvent")],e.prototype,"onKeyEvent",null),e}();t.default=b},9531:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(4993)),a=n(9418),c=n(3578),d=r(n(4206)),l=n(5262),u=function(){function e(e){var t=e.sdk,n=this;this.token="",this.serverIp="",this.retryTimes=0,this.maxRetryTimes=10,this.retryInterval=6e3,this.sdk=null,this.startRetry=function(e){var t=e.message;n.sdk.log("startRetry, times",n.retryTimes),setTimeout((function(){if(n.retryTimes>=n.maxRetryTimes)return n.sdk.cloudGamingWebRTC.clearPeerConnection(),s.default.onConnectFailed({code:a.CONNECT_FAILED_CODE.EXCEEDED_LIMIT_RERTY_TIMES,msg:"Retries exceeded"});n.autoReconnect({message:t}),n.retryTimes=n.retryTimes+1,s.default.onConnectFailed({code:a.CONNECT_FAILED_CODE.AUTO_RECONNECTING,msg:"auto connecting"})}),n.retryInterval),n.sdk.log("Watchdog, reconnect proxy failed, try again")},this.sdk=t}return e.prototype.autoReconnect=function(e){var t=e.message;return i(this,void 0,void 0,(function(){var e,n,i,r,u,h,p,f,m,v,g,y,C,b;return o(this,(function(o){switch(o.label){case 0:return this.serverIp&&this.token?(this.sdk.cloudGamingWebRTC.clearPeerConnection(),[4,this.sdk.cloudGamingWebRTC.newWebRtcConnect()]):(this.sdk.log("Watchdog, autoReconnect, serverIp:".concat(this.serverIp," or token:").concat(this.token," is not set, abort")),[2,s.default.onConnectFailed({code:a.RTC_CODE.CONNECT_FAILED,msg:"reconnect failed"})]);case 1:o.sent(),this.sdk.cloudGamingWebRTC.startHeartbeatReport(),e=this.sdk.cloudGamingWebRTC.getClientSideDescription(),n=this.sdk.gameConfig.getServerSideDescription(),i=n.user_id,r=n.server_port,u=r||7392,o.label=2;case 2:return o.trys.push([2,4,,5]),this.sdk.log("Watchdog, reconnect, serverIp:".concat(this.serverIp,", token:").concat(this.token)),l.config.lite?[2,this.sdk.log("lite sdk can not auto reconnect")]:(h="https://cgproxy.cloud-gaming.myqcloud.com/reconnect?host=".concat(this.serverIp,"&port=").concat(u,"&token=").concat(this.token,"&uid=").concat(i),l.config.privatization.server&&(h="http://".concat(this.serverIp,":").concat(u,"/cloud_gaming/reconnect?host=").concat(this.serverIp,"&port=").concat(u,"&token=").concat(this.token,"&uid=").concat(i)),[4,d.default.post(h,c.Base64.decode(e))]);case 3:return p=o.sent().data,m=(f=void 0===p?{}:p).Code,v=f.ServerSession,this.sdk.log("Watchdog, reconnect response code: ".concat(m)),0===m?(g=this.checkServerSession(v),y=g.code,C=g.message,0===y?(this.sdk.log("Watchdog, reconnect proxy success"),this.sdk.cloudGamingWebRTC.connect(c.Base64.encode(v)),this.retryTimes=0):(this.sdk.cloudGamingWebRTC.clearPeerConnection(),s.default.onConnectFailed({code:y,msg:C}),this.sdk.log("Watchdog, reconnect proxy failed"))):this.startRetry({message:t}),[3,5];case 4:return b=o.sent(),this.sdk.log("Watchdog post error",b),this.startRetry({message:null==b?void 0:b.message}),[3,5];case 5:return[2]}}))}))},e.prototype.setReconnectInfo=function(e){var t=e.serverIp,n=void 0===t?"":t,i=e.token,o=void 0===i?"":i;this.serverIp=n,this.token=o},e.prototype.checkServerSession=function(e){try{var t=JSON.parse(e),n=t.code,i=t.WebrtcResponse,o=t.Code,r=t.Msg,s=t.message,a=null!=n?n:o,c=s||r||(null==i?void 0:i.Msg);return this.sdk.log("Watchdog, server session code: ".concat(a,", message: ").concat(c)),{code:a,message:c}}catch(e){this.sdk.log("Watchdog, parse ServerSession error")}},e}();t.default=u},2343:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(4206)),c=n(1743),d=n(5262),l=s(n(7023)),u=s(n(4652)),h=n(7461),p=function(){function e(e){var t=e.sdk;this.inputDelay=0,this.inputSeqMap={},this.rttSum=0,this.rttCount=0,this.rttArray=[],this.rtt=0,this.rawRTT=0,this.latency={times:0,status:null},this.fps=null,this.delay=null,this.cpu="0",this.bitrate=null,this.lastBytesRevc=0,this.packetLost=null,this.nack=null,this.packetsReceived=null,this.framesDecoded=null,this.framesDropped=null,this.framesReceived=null,this.firCount=null,this.pliCount=null,this.decodems=null,this.interfameDelayMaxMs=null,this.frameWidth=null,this.frameHeight=null,this.jitterBuffer=0,this.lastFramesReceived=0,this.gpu="",this.audioFps=null,this.audioLevel=0,this.audioBitrate=null,this.audioLastBytesRevc=0,this.audioPacketsLost=null,this.audioPacketsReceived=null,this.audioNack=null,this.metricBulk=[],this.reportTimer=null,this.serverSessionCost=0,this.connectSuccessTimeCost=0,this.iceConnectedCost=0,this.sdk=null,this.sdk=t}return e.prototype.isShowing=function(){return!!this.getQcloudStatElement()&&"none"!==this.getQcloudStatElement().style.display},e.prototype.show=function(e){this.getQcloudStatElement()&&(this.getQcloudStatElement().style.display=e?"block":"none")},e.prototype.getStats=function(){var e=(this.sdk.gameConfig.getServerSideDescription()||c.empty).user_id;return{fps:this.fps,delay:this.delay,rtt:this.rtt,cpu:this.cpu,load_cost_time:this.connectSuccessTimeCost-this.serverSessionCost,bit_rate:this.bitrate,packet_lost:this.packetLost,nack:this.nack,packet_received:this.packetsReceived,gpu:this.gpu,input_delay:this.inputDelay,user_id:e,timestamp:+new Date}},e.prototype.setStat=function(e,t){var n,i,o,s,a,d=[],u=[];e.forEach((function(e){"inbound-rtp"===e.type&&("video"!==e.mediaType&&"video"!==e.kind||u.push(e),"audio"!==e.mediaType&&"audio"!==e.kind||d.push(e)),"track"===e.type&&(e.frameHeight||e.frameWidth||"video"===e.kind)&&u.push(e),"track"!==e.type||e.frameHeight&&e.frameWidth||d.push(e)}));try{for(var p=r(u),f=p.next();!f.done;f=p.next()){var m=f.value,v=m.type,g=m.frameWidth,y=void 0===g?0:g,C=m.frameHeight,b=void 0===C?0:C,S=m.framesPerSecond,k=m.framerateMean,T=m.totalDecodeTime,E=void 0===T?0:T,w=m.framesDropped,R=void 0===w?0:w,_=m.firCount,P=void 0===_?0:_,D=m.pliCount,M=void 0===D?0:D,O=m.jitterBufferDelay,x=void 0===O?0:O,A=m.packetsLost,I=void 0===A?null:A,L=m.bytesReceived,N=void 0===L?0:L,G=m.nackCount,W=void 0===G?0:G,F=m.packetsReceived,j=void 0===F?0:F,B=m.framesReceived,U=void 0===B?0:B,H=m.jitter,V=m.totalInterFrameDelay,K=void 0===V?0:V,q=m.codecId,z=void 0===q?"":q,Y=m.remoteSource,X=m.transportId,J=m.framesDecoded,$=void 0===J?0:J,Z=m.jitterBufferEmittedCount,Q=void 0===Z?0:Z;if(Q||(Q=1),$||($=1),"track"===v&&(Y&&this.modifyStatElement({name:"Resolution",tag:"video-resolution",stat:"".concat(y,"x").concat(b),point:"qcloud-video"}),!(null===(a=l.default.name)||void 0===a?void 0:a.toLowerCase().includes("safari"))&&S||!Y||(this.fps=U-this.lastFramesReceived,this.modifyStatElement({name:"FPS",tag:"video-fps",stat:"".concat(this.fps),point:"qcloud-video"}),this.lastFramesReceived=U),this.jitterBuffer=(0,c.getFixedDecimal)(x/Q*1e3),this.modifyStatElement({name:"JitterBuffer",tag:"video-jitter-buffer",stat:"".concat(this.jitterBuffer,"ms"),point:"qcloud-video"})),"inbound-rtp"===v){this.modifyStatElement({name:"Resolution",tag:"video-resolution",stat:"".concat(y,"x").concat(b),point:"qcloud-video"}),this.frameWidth===y&&this.frameHeight===b||(this.frameWidth=y,this.frameHeight=b,this.sdk.onVideoStreamConfigChange({width:y,height:b}),this.sdk.log("video stream resolution changed ->".concat(y," ").concat(b)));var ee=((null==t?void 0:t.get(z))||{}).mimeType,te=void 0===ee?"":ee;this.modifyStatElement({name:"Codec",tag:"video-codec",stat:te,point:"qcloud-video"}),S&&(this.fps=S,this.modifyStatElement({name:"FPS",tag:"video-fps",stat:"".concat(this.fps),point:"qcloud-video"})),k&&(this.fps=Math.floor(k),this.modifyStatElement({name:"FPS",tag:"video-fps",stat:"".concat(this.fps),point:"qcloud-video"}),this.jitterBuffer=Math.floor(1e3*H),this.modifyStatElement({name:"JitterBuffer",tag:"video-jitter-buffer",stat:"".concat(this.jitterBuffer,"ms"),point:"qcloud-video"})),this.bitrate=N-this.lastBytesRevc;var ne=(0,c.getFixedDecimal)(+this.bitrate/1024/1024*8);this.modifyStatElement({name:"VideoBitrate",tag:"video-bitrates",stat:"".concat(ne,"Mbit/s"),point:"qcloud-video"}),this.lastBytesRevc=N,this.packetLost=I<0?0:I,this.modifyStatElement({name:"PacketLost",tag:"video-packet-lost",stat:"".concat(this.packetLost),point:"qcloud-video"}),this.nack=W,this.modifyStatElement({name:"NACK",tag:"video-nack",stat:"".concat(this.nack),point:"qcloud-video"}),this.jitterBuffer=(0,c.getFixedDecimal)(x/Q*1e3),this.modifyStatElement({name:"JitterBuffer",tag:"video-jitter-buffer",stat:"".concat(this.jitterBuffer,"ms"),point:"qcloud-video"}),this.delay=(0,c.getFixedDecimal)(+(E/$*1e3+this.jitterBuffer)),this.modifyStatElement({name:"Delay",tag:"video-delay",stat:"".concat(this.delay,"ms"),point:"qcloud-video"}),this.packetsReceived=j,this.framesDecoded=$,this.framesDropped=R,this.framesReceived=U,this.decodems=Math.floor(E/$*1e3),this.interfameDelayMaxMs=Math.floor(K/$*1e3),this.firCount=P,this.pliCount=M;var ie=(this.sdk.gameConfig.getFeatureSwitch()||{}).network_event_script;if(ie){var oe=ie.notify_threshold,re=void 0===oe?5:oe,se=(0,h.computeLatency)({packetsReceived:j,packetsLost:I,nack:W,rtt:this.rttArray,featureSwitch:this.sdk.gameConfig.getFeatureSwitch()});this.latency.status===se?(this.latency.times=this.latency.times+1,this.latency.times===re&&this.latency.status!==h.NetworkStatus.NETWORK_NORMAL&&(this.sdk.onNetworkChange({status:"latency",data:{value:se,message:h.NetworkStatus[se]}}),this.sdk.onEvent({type:"latency",data:{value:se,message:h.NetworkStatus[se]}}),this.latency.times=0)):(this.latency.status=se,this.latency.times=0)}var ae=((null==t?void 0:t.get(X))||{}).selectedCandidatePairId,ce=void 0===ae?"":ae,de=(ce&&((null==t?void 0:t.get(ce))||{})).currentRoundTripTime,le=void 0===de?0:de;this.rawRTT=le}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}try{for(var ue=r(d),he=ue.next();!he.done;he=ue.next()){var pe=he.value,fe=(v=pe.type,pe.packetsLost),me=(I=void 0===fe?0:fe,pe.packetsReceived),ve=(j=void 0===me?0:me,pe.bytesReceived),ge=(N=void 0===ve?0:ve,pe.audioLevel),ye=void 0===ge?0:ge,Ce=pe.nackCount,be=(W=void 0===Ce?0:Ce,pe.codecId);if(z=void 0===be?"":be,"inbound-rtp"===v){this.audioPacketsLost=I,this.audioPacketsReceived=j;var Se=((null==t?void 0:t.get(z))||{}).mimeType;(te=void 0===Se?"":Se)&&(this.modifyStatElement({name:"Codec",tag:"audio-codec",stat:te,point:"qcloud-audio"}),this.audioBitrate=N-this.audioLastBytesRevc,ne=(0,c.getFixedDecimal)(+this.audioBitrate/1024/1024*8),this.modifyStatElement({name:"AudioBitrate",tag:"audio-bitrates",stat:"".concat(ne,"Mbit/s"),point:"qcloud-audio"}),this.audioLastBytesRevc=N,this.modifyStatElement({name:"PacketLost",tag:"audio-packet-lost",stat:"".concat(this.audioPacketsLost),point:"qcloud-audio"}),this.audioNack=W,this.modifyStatElement({name:"NACK",tag:"audio-nack",stat:"".concat(this.audioNack),point:"qcloud-audio"})),"track"===v&&this.modifyStatElement({name:"AudioLevel",tag:"audio-level",stat:"".concat((0,c.getFixedDecimal)(ye)),point:"qcloud-audio"})}}}catch(e){o={error:e}}finally{try{he&&!he.done&&(s=ue.return)&&s.call(ue)}finally{if(o)throw o.error}}},e.prototype.setInputStart=function(e){this.inputSeqMap[e]=(new Date).getTime()},e.prototype.setInputEnd=function(e){void 0===e&&(e=0),this.inputSeqMap[e]&&(this.inputDelay=Math.round((+new Date-this.inputSeqMap[e])/2),delete this.inputSeqMap[e])},e.prototype.setRTT=function(e){this.rtt=e,this.modifyStatElement({name:"RTT",tag:"video-rtt",stat:"".concat(e.toString(),"ms"),point:"qcloud-video"}),5===this.rttArray.length&&this.rttArray.shift(),this.rttArray.push(e),this.rttSum+=e,this.rttCount+=1;var t=e/(this.rttSum/this.rttCount)>2;return this.rttCount>60&&(this.rttSum=0,this.rttCount=0),t},e.prototype.setCpuAndGpuUsage=function(e){var t=e.cpu,n=void 0===t?"0":t,i=e.gpu,o=void 0===i?"":i;this.cpu=n,this.modifyStatElement({name:"CpuUsage",tag:"cpu-usage",stat:n,point:"qcloud-info"}),this.gpu=o,this.modifyStatElement({name:"GpuUsage",tag:"gpu-usage",stat:o,point:"qcloud-info"})},e.prototype.setStaticStat=function(){var e,t=this,n=this.sdk.gameConfig.getServerSideDescription(),i=n.server_ip,o=n.region,r=n.instance_type,s=n.host_name,a=n.request_id;if(this.modifyStatElement({name:"Version",tag:"sdk-version",stat:d.config.version,point:"qcloud-info"}),this.modifyStatElement({name:"ServerIp",tag:"server-ip",stat:i,point:"qcloud-info"}),this.modifyStatElement({name:"Region",tag:"region",stat:o,point:"qcloud-info"}),this.modifyStatElement({name:"InstanceType",tag:"instance-type",stat:r,point:"qcloud-info"}),setTimeout((function(){t.modifyStatElement({name:"RequestId",tag:"request-id",stat:a,point:"qcloud-info"})}),2e3),!document.querySelector(".qcloud-host")&&this.sdk.cloudGamingWebRTC.getIsMobileGame()){var c=document.createElement("div");c.className="qcloud-stat-row qcloud-host",c.innerHTML="<div class='qcloud-stat-left'>HostName</div><div class='qcloud-stat-right'>".concat(s,"</div>"),null===(e=this.getQcloudStatElement())||void 0===e||e.appendChild(c)}},e.prototype.modifyStatElement=function(e){var t,n,i,o=e.name,r=void 0===o?"":o,s=e.tag,a=void 0===s?"":s,c=e.stat,d=void 0===c?"":c,l=e.point,u=void 0===l?null:l;if(null===(t=this.getQcloudStatElement())||void 0===t?void 0:t.querySelector(".qcloud-".concat(a)))this.getQcloudStatElement()&&(this.getQcloudStatElement().querySelector(".qcloud-".concat(a," .qcloud-stat-right")).innerHTML=d);else{var h=document.createElement("div");h.className="qcloud-stat-row qcloud-".concat(a),h.innerHTML="<div class='qcloud-stat-left'>".concat(r,"</div><div class='qcloud-stat-right'>").concat(d,"</div>"),null===(i=null===(n=this.getQcloudStatElement())||void 0===n?void 0:n.querySelector(".".concat(u)))||void 0===i||i.appendChild(h)}},e.prototype.setServerSessionTime=function(e){var t=this;this.serverSessionCost=e,setTimeout((function(){t.modifyStatElement({name:"ServerSessionTime",tag:"server-session",stat:"".concat((0,c.getFixedDecimal)((e-t.sdk.initStartTime)/1e3),"s"),point:"qcloud-info"})}),0)},e.prototype.setIceConnectedTime=function(e){this.iceConnectedCost=e},e.prototype.setConnectSuccessTime=function(e){this.connectSuccessTimeCost=e,this.modifyStatElement({name:"ConnectSuccessTime",tag:"connect-success",stat:"".concat((0,c.getFixedDecimal)((e-this.sdk.initStartTime)/1e3),"s"),point:"qcloud-info"})},e.prototype.addReportStat=function(){var e,t,n,i,o,r=this.sdk.gameConfig.getServerSideDescription(),s=r.server_ip,a=r.request_id,c=r.server_version,u=r.user_id;this.metricBulk.push({user_id:u,request_id:a,server_ip:s,server_version:c,timestamp:+new Date,bit_rate:8*this.bitrate,packet_lost:this.packetLost,packet_received:this.packetsReceived,bytes_received:this.lastBytesRevc,audio_packet_lost:this.audioPacketsLost,audio_packet_received:this.audioPacketsReceived,fps:this.fps,delay:this.delay,nack:this.nack,cpu:+this.cpu,gpu:this.gpu,load_cost_time:this.iceConnectedCost-this.serverSessionCost,first_frame:this.connectSuccessTimeCost-this.serverSessionCost,jitter_buffer:this.jitterBuffer,input_delay:this.inputDelay,rtt:this.rtt,frame_decoded:this.framesDecoded,frame_dropped:this.framesDropped,frame_received:this.framesReceived,render_frame_rate:this.framesDecoded,receive_frame_rate:this.framesReceived,decoded_frame_rate:this.framesDecoded,decode_ms:this.decodems,version:"".concat(d.config.version),platform:"0",pli_count:this.pliCount,fir_count:this.firCount,browser:"".concat(null===(e=l.default.os)||void 0===e?void 0:e.family,"/").concat(null===(t=l.default.os)||void 0===t?void 0:t.version,"/").concat(l.default.name),app_id:"".concat(null!==(i=null===(n=this.sdk.gameConfig.getServerSideDescription())||void 0===n?void 0:n.app_id)&&void 0!==i?i:0),game_id:null===(o=this.sdk.gameConfig.getServerSideDescription())||void 0===o?void 0:o.game_id,raw_rtt:1e3*this.rawRTT})},e.prototype.toggleMetricReportBulk=function(e){var t=this;e?(clearInterval(this.reportTimer),this.reportTimer=setInterval((function(){t.metricReportBulk(),t.sdk.reportLogInner()}),1e4)):(clearInterval(this.reportTimer),this.sdk.reportLogInner())},e.prototype.metricReportBulk=function(){return i(this,void 0,void 0,(function(){var e,t,n,i,r,s,c,l;return o(this,(function(o){switch(o.label){case 0:e=JSON.stringify({metric:"cg_client_stat",bulk:this.metricBulk}),t=this.sdk.gameConfig.getServerSideDescription().sig_key,n=null;try{n=t&&(0,u.default)(e.slice(0,128),t).toString()}catch(e){this.sdk.log("encode sig_key error",e)}i=n?" https://metrics-cloud-gaming.crtrcloud.com/report_metric_bulk?sig=".concat(n):" https://metrics-cloud-gaming.crtrcloud.com/report_metric_bulk",o.label=1;case 1:return o.trys.push([1,3,,4]),d.config.lite?[2,this.sdk.log("lite sdk can not report state")]:d.config.privatization.server?[2]:[4,a.default.post(i,e)];case 2:return r=o.sent(),s=r.status,c=r.data,200===s||this.sdk.log("metricReportBulk failed",c),this.metricBulk=[],[3,4];case 3:return l=o.sent(),this.sdk.log("catch metricReportBulk failed",l.message,l.name),[3,4];case 4:return[2]}}))}))},e.prototype.getQcloudStatElement=function(){var e;return null===(e=this.sdk.mountPoint)||void 0===e?void 0:e.querySelector(".qcloud-stat")},e}();t.default=p},869:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MOUNT_POINT_CSS=t.HTML_STRING=t.HTML_STATS=void 0,t.HTML_STATS='\n<div class="qcloud-stat">\n  \n  <div class="qcloud-video">\n    <div class="qcloud-stat-video">\n      <div class="qcloud-stat-left">Video</div>\n    </div>\n  </div>\n\n  <div class="qcloud-audio">\n    <div class="qcloud-stat-audio">\n      <div class="qcloud-stat-left">Audio</div>\n    </div>\n  </div>\n\n  <div class="qcloud-info">\n    <div class="qcloud-stat-info">\n      <div class="qcloud-stat-left">Info</div>\n    </div>\n  </div>\n\n</div>',t.HTML_STRING='\n<div class="cloud-gaming-container" tabindex="-1">\n  <video class="video-stream" tabindex="-1" playsinline webkit-playsinline x5-playsinline autoplay muted preload="auto"></video>\n  <div class="cursor" id="cursor"></div>\n</div>\n\n'.concat(t.HTML_STATS,'\n\n<div class="progress-bar-container">\n  <div class="spinner"> </div>\n  <p class="starting">正在启动云渲染服务</p>\n  <p id="speed" class="starting"></p>\n</div>\n\n<a class="restart" href="javascript:window.location.reload();">重新连接</a>'),t.MOUNT_POINT_CSS="\n.cloud-gaming-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n  display: none;\n  background-size: cover !important; /* stylelint-disable-line */\n}\n.qcloud-stat {\n  position: absolute;\n  right: 10px;\n  top: 0px;\n  line-height: 18px;\n  padding: 5px 10px;\n  z-index: 5;\n  color: #eee;\n  background: rgba(0, 0, 0, .5);\n  border-radius: 5px;\n  text-align: left;\n  font-size: 12px;\n  pointer-events: none;\n  display: none;\n  flex-direction: column;\n  width: 220px;\n  -webkit-transform: translateZ(0);\n  transform: translateZ(0);\n}\n.qcloud-request-id {\n  pointer-events: all;\n}\n.qcloud-stat-left {\n  width: 120px;\n}\n.qcloud-stat-right {\n  flex: 1;\n}\n.qcloud-stat-row {\n  text-align: left;\n  display: flex;\n}\n\n@keyframes spinner {\n  to {transform: rotate(360deg);}\n}\n.progress-bar-container {\n  text-align: center;\n  position: absolute;\n  width: 40%;\n  height: 15%;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.starting {\n  color:white;\n  font-weight:bold;\n  margin-top:30px;\n}\n.spinner:before {\n  content: '';\n  box-sizing: border-box;\n  position: absolute;\n  top: 60px;\n  width: 20px;\n  height: 20px;\n  margin-top: -5px;\n  margin-left: -10px;\n  border-radius: 50%;\n  border: 4px solid #ccc;\n  border-top-color: #000;\n  animation: spinner .6s linear infinite;\n}\n.restart {\n  position: absolute;\n  width: 350px;\n  text-align: center;\n  height: 30px;\n  line-height: 30px;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  align-items: center;\n  font-size: 24px;\n  color: #fff;\n  display: none;\n}\n.cursor {\n  position: absolute;\n  width: 0px;\n  height: 0px;\n  top: 0px;\n  left: 0px;\n  z-index: 1;\n  background-size: cover;\n  display: none;\n}\n.audio-stream {\n  width: 0px;\n}\n.video-stream {\n  max-width: 100%;\n  max-height: 100%;\n  outline: none;\n  border: 0;\n}\n.video-stream:focus {\n  outline :none;\n}\n.rotate-html-90 {\n  transform: rotate(90deg);\n  transform-origin: left top;\n  width: 100vh;\n  width: 100svh;\n  height: 100vw;\n  overflow-x: hidden;\n  position: absolute;\n  top: 0;\n  left: 100%;\n}\n.rotate-html-270 {\n  transform: rotate(270deg);\n  transform-origin: left top;\n  overflow-x: hidden;\n  position: absolute;\n  top: 100%;\n  left: 0;\n}"},5922:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=c(n(4206)),l=n(1743),u=c(n(4652)),h=n(5262),p=function(){function e(){this.logStr=[],this.allLogs=[],this.externalLogHandler=l.noop,this.serverSideDescription={},this.loggerConfig={mount:null}}return e.prototype.initLoggerConfig=function(e){this.loggerConfig=e},e.prototype.setServerSideDescription=function(e){var t=e.serverSideDescription;this.serverSideDescription=t},e.prototype.log=function(){for(var e,t,n,i,o,c,d=[],u=0;u<arguments.length;u++)d[u]=arguments[u];(null===(i=null===(n=this.loggerConfig)||void 0===n?void 0:n.debugSetting)||void 0===i?void 0:i.showLog)&&console.log.apply(console,s([],r(d),!1));var h="";try{for(var p=a(d),f=p.next();!f.done;f=p.next()){var m=f.value;h+="".concat("object"==typeof m?JSON.stringify(m):m," ")}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}var v=this.serverSideDescription,g=v.request_id,y=void 0===g?"":g,C=v.server_ip,b=void 0===C?"":C,S=v.user_id,k=void 0===S?"":S,T=null!==(o=b||y)&&void 0!==o?o:"";h="[TCG/".concat(T,"][").concat(k,"]:").concat(h),null===(c=this.externalLogHandler)||void 0===c||c.call(this,h);var E=new Date,w={timestamp:+E,server_ip:b,request_id:y,user_id:k,content:"".concat((0,l.formatTime)(E,"yyyy-mm-dd hh:ii:ss")," ").concat(h,"\n")};this.logStr.push(w),this.allLogs.push({request_id:w.request_id,user_id:w.user_id,content:w.content})},e.prototype.getLog=function(){var e=this.serverSideDescription,t=e.request_id,n=void 0===t?"":t,i=e.server_ip,o=void 0===i?"":i;return this.logStr.forEach((function(e){e.server_ip||(e.server_ip=o),e.request_id||(e.request_id=n)})),this.logStr},e.prototype.getAllLogs=function(){var e=this.serverSideDescription.request_id,t=void 0===e?"":e;return this.allLogs.forEach((function(e){e.request_id||(e.request_id=t)})),this.allLogs},e.prototype.reportLogInner=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2,this.metricLogReport(this.getLog())]}))}))},e.prototype.setExternalLog=function(e){void 0===e&&(e=l.noop),this.externalLogHandler=e},e.prototype.metricLogReport=function(e){return i(this,void 0,void 0,(function(){var t,n,i,r,s,a,c,l;return o(this,(function(o){switch(o.label){case 0:if(0===this.logStr.length)return[2];t=JSON.stringify({metric:"cg_client_log",bulk:e}),n=this.serverSideDescription.sig_key,i=null;try{i=n&&(0,u.default)(t.slice(0,128),n).toString()}catch(e){this.log("encode sig_key error",e)}r=i?"https://metrics-cloud-gaming.crtrcloud.com/report_log_bulk?sig=".concat(i):"https://metrics-cloud-gaming.crtrcloud.com/report_log_bulk",o.label=1;case 1:return o.trys.push([1,3,,4]),h.config.lite?[2,this.log("lite sdk can not report logs")]:h.config.privatization.server?[2]:[4,d.default.post(r,t)];case 2:return s=o.sent(),a=s.status,c=s.data,200===a?(this.log("metricReportLog",c),this.logStr=[],[2,c]):(this.log("metricReportLog failed",null==c?void 0:c.message),[2,{code:-1,message:"failed"}]);case 3:return l=o.sent(),this.log("catch metricReportLog failed",l.message,l.name),[2,{code:-1,message:"failed"}];case 4:return[2]}}))}))},e}();t.default=p},2484:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interceptUserEvent=void 0,t.interceptUserEvent=function(e){return function(t,n,i){void 0===t&&(t=null);var o=i.value;return i.value=function(){for(var t,n,i,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];var a=["video-stream","cursor"];"keyEvent"===e&&a.push("cloud-gaming-container");var c=r[0].target.className,d=(null===(t=this.sdk)||void 0===t?void 0:t.getInitOptions()).mount,l=(null===(i=null===(n=r[0].target.parentNode)||void 0===n?void 0:n.parentNode)||void 0===i?void 0:i.id)===d;l&&(this.enableEventIntercept&&!a.includes(c)||o.apply(this,r))},i}}},6363:function(e,t){"use strict";var n,i,o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getInIframe=t.supportFullScreen=void 0;var s,a={},c=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],d=o(c,1)[0];try{for(var l=r(c),u=l.next();!u.done;u=l.next()){var h=u.value;if(h[1]in document){s=h;break}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}if(s)for(var p=0;p<s.length;p++)a[d[p]]=s[p];t.default=a,t.supportFullScreen=function(e){if("function"==typeof e.webkitEnterFullScreen){var t=navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},t.getInIframe=function(){return window.self!==window.top}},7461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeLatency=t.NetworkStatus=t.variance=void 0,t.variance=function(e){if(void 0===e&&(e=[]),!e.length)return 0;var t=e.reduce((function(e,t){return e+t}),0),n=e.length,i=t/n,o=0;return e.forEach((function(e){o+=(e-i)*(e-i)})),o/=n,Math.floor(o)};var n,i={packetsReceived:0,packetsLost:0,nack:0,rttAverage:0,rttVariance:0,nackRate:0,packetsLostRate:0};!function(e){e[e.NETWORK_NORMAL=0]="NETWORK_NORMAL",e[e.NETWORK_CONGESTION=1]="NETWORK_CONGESTION",e[e.NACK_RISING=2]="NACK_RISING",e[e.HIGH_DELAY=3]="HIGH_DELAY",e[e.NETWORK_JITTER=4]="NETWORK_JITTER"}(n||(t.NetworkStatus=n={})),t.computeLatency=function(e){var o=e.packetsReceived,r=void 0===o?0:o,s=e.packetsLost,a=void 0===s?0:s,c=e.nack,d=void 0===c?0:c,l=e.rtt,u=void 0===l?[]:l,h=e.featureSwitch,p=void 0===h?{}:h,f=r-i.packetsReceived;i.packetsReceived=r;var m=a-i.packetsLost;i.packetsLost=a,i.packetsLostRate=m/f;var v=a-i.nack;i.nack=d,i.nackRate=v/f,i.rttAverage=u.reduce((function(e,t){return e+t}),0)/u.length,i.rttVariance=(0,t.variance)(u);var g=p.network_event_script,y=void 0===g?{}:g,C=y.loss_rate_threshold,b=y.nack_rate_threshold,S=y.rtt_avg_threshold,k=y.rtt_dev_threshold;return i.packetsLostRate>C?n.NETWORK_CONGESTION:i.nackRate>b?n.NACK_RISING:i.rttAverage>S?n.HIGH_DELAY:i.rttVariance>k?n.NETWORK_JITTER:n.NETWORK_NORMAL}},1743:function(e,t,n){"use strict";var i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.supportRenegotiation=t.getIOSVersion=t.getFakeInput=t.empty=t.getSequence=t.getFixedDecimal=t.is360=t.canReceiveH264=t.checkProfileLevelId=t.getSearch=t.noop=t.dispatchEvent=t.formatTime=t.addZero=t.sleep=t.checkBrowser=t.isHuawei=t.isIOS=t.isHarmony=t.isAndroid=t.isMobile=t.isFullScreen=t.isWegameChrome=t.codeMap=void 0;var s=r(n(7023));t.codeMap={0:{key:48,shift:!1},")":{key:48,shift:!0},1:{key:49,shift:!1},"!":{key:49,shift:!0},2:{key:50,shift:!1},"@":{key:50,shift:!0},3:{key:51,shift:!1},"#":{key:51,shift:!0},4:{key:52,shift:!1},$:{key:52,shift:!0},5:{key:53,shift:!1},"%":{key:53,shift:!0},6:{key:54,shift:!1},"^":{key:54,shift:!0},7:{key:55,shift:!1},"&":{key:55,shift:!0},8:{key:56,shift:!1},"*":{key:56,shift:!0},9:{key:57,shift:!1},"(":{key:57,shift:!0},a:{key:65,shift:!1},A:{key:65,shift:!0},b:{key:66,shift:!1},B:{key:66,shift:!0},c:{key:67,shift:!1},C:{key:67,shift:!0},d:{key:68,shift:!1},D:{key:68,shift:!0},e:{key:69,shift:!1},E:{key:69,shift:!0},f:{key:70,shift:!1},F:{key:70,shift:!0},g:{key:71,shift:!1},G:{key:71,shift:!0},h:{key:72,shift:!1},H:{key:72,shift:!0},i:{key:73,shift:!1},I:{key:73,shift:!0},j:{key:74,shift:!1},J:{key:74,shift:!0},k:{key:75,shift:!1},K:{key:75,shift:!0},l:{key:76,shift:!1},L:{key:76,shift:!0},m:{key:77,shift:!1},M:{key:77,shift:!0},n:{key:78,shift:!1},N:{key:78,shift:!0},o:{key:79,shift:!1},O:{key:79,shift:!0},p:{key:80,shift:!1},P:{key:80,shift:!0},q:{key:81,shift:!1},Q:{key:81,shift:!0},r:{key:82,shift:!1},R:{key:82,shift:!0},s:{key:83,shift:!1},S:{key:83,shift:!0},t:{key:84,shift:!1},T:{key:84,shift:!0},u:{key:85,shift:!1},U:{key:85,shift:!0},v:{key:86,shift:!1},V:{key:86,shift:!0},w:{key:87,shift:!1},W:{key:87,shift:!0},x:{key:88,shift:!1},X:{key:88,shift:!0},y:{key:89,shift:!1},Y:{key:89,shift:!0},z:{key:90,shift:!1},Z:{key:90,shift:!0},"=":{key:187,shift:!1},"+":{key:187,shift:!0},",":{key:188,shift:!1},"<":{key:188,shift:!0},"-":{key:189,shift:!1},_:{key:189,shift:!0},".":{key:190,shift:!1},">":{key:190,shift:!0},"/":{key:191,shift:!1},"?":{key:191,shift:!0},"`":{key:192,shift:!1},"~":{key:192,shift:!0},"[":{key:219,shift:!1},"{":{key:219,shift:!0},"\\":{key:220,shift:!1},"|":{key:220,shift:!0},"]":{key:221,shift:!1},"}":{key:221,shift:!0},"'":{key:222,shift:!1},'"':{key:222,shift:!0},"↑":{key:38,shift:!1},"↓":{key:40,shift:!1},"←":{key:37,shift:!1},"→":{key:39,shift:!1},Home:{key:36,shift:!1},Ctrl:{key:17,shift:!1},Alt:{key:18,shift:!1},Win:{key:91,shift:!1},NumLock:{key:144,shift:!1},Tab:{key:9,shift:!1},CapsLock:{key:20,shift:!1},Shift:{key:16,shift:!1},Enter:{key:13,shift:!1},BackSpace:{key:8,shift:!1},Insert:{key:45,shift:!1},Delete:{key:46,shift:!1},PageUp:{key:33,shift:!1},PageDown:{key:34,shift:!1},End:{key:35,shift:!1},PrintScreen:{key:42,shift:!1},ScrollLock:{key:145,shift:!1},PauseBreak:{key:19,shift:!1},Space:{key:32,shift:!1},Esc:{key:27,shift:!1},F1:{key:112,shift:!1},F2:{key:113,shift:!1},F3:{key:114,shift:!1},F4:{key:115,shift:!1},F5:{key:116,shift:!1},F6:{key:117,shift:!1},F7:{key:118,shift:!1},F8:{key:119,shift:!1},F9:{key:120,shift:!1},F10:{key:121,shift:!1},F11:{key:122,shift:!1},F12:{key:123,shift:!1},"^0":{key:96,shift:!1},"^1":{key:97,shift:!1},"^2":{key:98,shift:!1},"^3":{key:99,shift:!1},"^4":{key:100,shift:!1},"^5":{key:101,shift:!1},"^6":{key:102,shift:!1},"^7":{key:103,shift:!1},"^8":{key:104,shift:!1},"^9":{key:105,shift:!1},"^.":{key:110,shift:!1},"^+":{key:107,shift:!1},"^/":{key:111,shift:!1},"^*":{key:106,shift:!1},"^-":{key:109,shift:!1},"^Enter":{key:108,shift:!1},"^,":{key:188,shift:!1}},t.isWegameChrome=function(){return!(!window.external||!window.external.callcpp)},t.isFullScreen=function(){return!(!document.fullscreenElement&&!document.webkitIsFullScreen)},t.isMobile=function(){return!!(/Android|iPhone|iPad|iOS|Phone/i.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>0)},t.isAndroid=function(){var e,t;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===e?void 0:e.includes("Android"))||(null===(t=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===t?void 0:t.includes("Adr"))},t.isHarmony=function(){var e,t;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===e?void 0:e.includes("OpenHarmony"))||(null===(t=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===t?void 0:t.includes("ArkWeb"))},t.isIOS=function(){var e,t,n;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===e?void 0:e.includes("iOS"))||(null===(t=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===t?void 0:t.includes("iPhone"))||(null===(n=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===n?void 0:n.includes("iPad"))},t.isHuawei=function(){var e;return null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===e?void 0:e.toLocaleLowerCase().includes("huawei")},t.checkBrowser=function(){var e=navigator.userAgent.toLowerCase();return/micromessenger/gi.test(e)?"wx":/qq/gi.test(e)?"qq":"system"},t.sleep=function(e){return new Promise((function(t){setTimeout(t,e)}))},t.addZero=function(e,t){for(var n=0,i=t-"".concat(e).length;n<i;n++)e="0".concat(e);return"".concat(e)},t.formatTime=function(e,n){return n.replace(/yyyy|YYYY/,e.getFullYear()).replace(/yy|YY/,(0,t.addZero)(e.getFullYear()%100,2)).replace(/mm|MM/,(0,t.addZero)(e.getMonth()+1,2)).replace(/m|M/g,e.getMonth()+1).replace(/dd|DD/,(0,t.addZero)(e.getDate(),2)).replace(/d|D/g,e.getDate()).replace(/hh|HH/,(0,t.addZero)(e.getHours(),2)).replace(/h|H/g,e.getHours()).replace(/ii|II/,(0,t.addZero)(e.getMinutes(),2)).replace(/i|I/g,e.getMinutes()).replace(/ss|SS/,(0,t.addZero)(e.getSeconds(),2)).replace(/s|S/g,e.getSeconds()).replace(/w/g,e.getDay()).replace(/W/g,["日","一","二","三","四","五","六"][e.getDay()])},t.dispatchEvent=function(e){var t=e.name,n=e.data,i=new CustomEvent(t,{bubbles:!0,detail:n});return window.dispatchEvent(i)},t.noop=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.getSearch=function(){var e={};return window.location.search.replace("?","").split("&").forEach((function(t){var n=i(t.split("="),2),o=n[0],r=n[1];e[o]=r})),e},t.checkProfileLevelId=function(e){void 0===e&&(e="");var t=[];return e.split("\r\n").forEach((function(e){e.includes("profile-level-id")&&(e=e.split("profile-level-id").pop().slice(1),t.push(e))})),t},t.canReceiveH264=function(){var e=!1;return window.RTCRtpReceiver&&(null===RTCRtpReceiver||void 0===RTCRtpReceiver?void 0:RTCRtpReceiver.getCapabilities)?(RTCRtpReceiver.getCapabilities("video").codecs.forEach((function(t){"video/H264"!==t.mimeType||(e=!0)})),e):(console.log("RTCRtpReceiver.getCapabilities is not a function"),!0)},t.is360=function(){var e=!1,t=navigator.userAgent,n=function(e,t){var n,i,r=navigator.mimeTypes;try{for(var s=o(r),a=s.next();!a.done;a=s.next())if(a.value[e]===t)return!0}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return!1},i={360:t.indexOf("QihooBrowser")>-1||t.indexOf("QHBrowser")>-1,"360EE":t.indexOf("360EE")>-1,"360SE":t.indexOf("360SE")>-1,"2345Explorer":t.indexOf("2345Explorer")>-1||t.indexOf("Mb2345Browser")>-1||t.indexOf("2345chrome")>-1,Mobile:t.indexOf("Mobi")>-1||t.indexOf("iPh")>-1||t.indexOf("480")>-1};if(window.chrome){var r=t.replace(/^.*Chrome\/([\d]+).*$/,"$1");window.chrome.adblock2345||window.chrome.common2345?i["2345Explorer"]=!0:n("type","application/360softmgrplugin")||n("type","application/mozilla-npqihooquicklogin")||r>36&&window.showModalDialog?e=!0:r>45&&!(e=n("type","application/vnd.chromium.remoting-viewer"))&&r>=69&&(e=n("type","application/hwepass2001.installepass2001")||n("type","application/asx"))}return e},t.getFixedDecimal=function(e,t){return void 0===t&&(t=2),Math.floor(10*e*t)/(10*t)},t.getSequence=function(){return+(+new Date+Math.round(1e4*Math.random()))},t.empty={},t.getFakeInput=function(){return document.getElementById("tcg-fake-input")},t.getIOSVersion=function(){var e,t,n=i(null===(t=null===(e=null===s.default||void 0===s.default?void 0:s.default.os)||void 0===e?void 0:e.version)||void 0===t?void 0:t.split("."),2),o=n[0],r=n[1];return o&&r?+"".concat(o,".").concat(r):0},t.supportRenegotiation=function(){return!((0,t.isIOS)()&&(0,t.getIOSVersion)()<15.4)}},943:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=t},9677:e=>{var t,n;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,i=0;n<e.length;n++,i+=8)t[i>>>5]|=e[n]<<24-i%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],i=0;i<e.length;i+=3)for(var o=e[i]<<16|e[i+1]<<8|e[i+2],r=0;r<4;r++)8*i+6*r<=8*e.length?n.push(t.charAt(o>>>6*(3-r)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],i=0,o=0;i<e.length;o=++i%4)0!=o&&n.push((t.indexOf(e.charAt(i-1))&Math.pow(2,-2*o+8)-1)<<2*o|t.indexOf(e.charAt(i))>>>6-2*o);return n}},e.exports=n},8112:function(e,t,n){var i;e.exports=(i=i||function(e,t){var i;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),"undefined"!=typeof self&&self.crypto&&(i=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(i=globalThis.crypto),!i&&"undefined"!=typeof window&&window.msCrypto&&(i=window.msCrypto),!i&&void 0!==n.g&&n.g.crypto&&(i=n.g.crypto),!i)try{i=n(429)}catch(e){}var o=function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),s={},a=s.lib={},c=a.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},d=a.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,o=e.sigBytes;if(this.clamp(),i%4)for(var r=0;r<o;r++){var s=n[r>>>2]>>>24-r%4*8&255;t[i+r>>>2]|=s<<24-(i+r)%4*8}else for(var a=0;a<o;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(o());return new d.init(t,e)}}),l=s.enc={},u=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var r=t[o>>>2]>>>24-o%4*8&255;i.push((r>>>4).toString(16)),i.push((15&r).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new d.init(n,t/2)}},h=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var r=t[o>>>2]>>>24-o%4*8&255;i.push(String.fromCharCode(r))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new d.init(n,t)}},p=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},f=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,i=this._data,o=i.words,r=i.sigBytes,s=this.blockSize,a=r/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,l=e.min(4*c,r);if(c){for(var u=0;u<c;u+=s)this._doProcessBlock(o,u);n=o.splice(0,c),i.sigBytes-=l}return new d.init(n,l)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),m=(a.Hasher=f.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}}),s.algo={});return s}(Math),i)},4652:function(e,t,n){var i;e.exports=(i=n(8112),n(2232),n(3456),i.HmacSHA256)},3456:function(e,t,n){var i,o,r;e.exports=(o=(i=n(8112)).lib.Base,r=i.enc.Utf8,void(i.algo.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),s=this._iKey=t.clone(),a=o.words,c=s.words,d=0;d<n;d++)a[d]^=1549556828,c[d]^=909522486;o.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))},2232:function(e,t,n){var i;e.exports=(i=n(8112),function(e){var t=i,n=t.lib,o=n.WordArray,r=n.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),i=2;i<=n;i++)if(!(t%i))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var i=2,o=0;o<64;)t(i)&&(o<8&&(a[o]=n(e.pow(i,.5))),c[o]=n(e.pow(i,1/3)),o++),i++}();var d=[],l=s.SHA256=r.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],r=n[2],s=n[3],a=n[4],l=n[5],u=n[6],h=n[7],p=0;p<64;p++){if(p<16)d[p]=0|e[t+p];else{var f=d[p-15],m=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,v=d[p-2],g=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;d[p]=m+d[p-7]+g+d[p-16]}var y=i&o^i&r^o&r,C=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),b=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&u)+c[p]+d[p];h=u,u=l,l=a,a=s+b|0,s=r,r=o,o=i,i=b+(C+y)|0}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+r|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+l|0,n[6]=n[6]+u|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(i/4294967296),n[15+(o+64>>>9<<4)]=i,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(l),t.HmacSHA256=r._createHmacHelper(l)}(Math),i.SHA256)},7408:function(e){e.exports=(()=>{var e={944:function(e){e.exports=(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw s}}}}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var i,o,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return r}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e.d(t,{default:()=>c});var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a(this,e),this.allowExtra=t,this.defaults=new Map,this.types=new Map,this.optional=new Set,this.required=new Set}var t;return(t=[{key:"setDefaults",value:function(e){var t=this;return Object.entries(e).forEach((function(e){var n=o(e,2),i=n[0],r=n[1];return t.defaults.set(i,r)})),this}},{key:"setTypes",value:function(e){var t=this;return Object.entries(e).forEach((function(e){var n=o(e,2),i=n[0],r=n[1];return t.types.set(i,r)})),this}},{key:"setOptional",value:function(e){var t=this;return e.forEach((function(e){return t.optional.add(e)})),this}},{key:"setRequired",value:function(e){var t=this;return e.forEach((function(e){return t.required.add(e)})),this}},{key:"resolve",value:function(e){var t=Object.assign(this.getDefaults(),e);return this.validate(t),t}},{key:"getDefaults",value:function(){var e,t={},n=i(this.defaults);try{for(n.s();!(e=n.n()).done;){var r=o(e.value,2),s=r[0],a=r[1];t[s]=a}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"validate",value:function(e){for(var t in e){if(!this.optionExists(t))throw new Error('Unkown option "'.concat(t,'".'));this.checkType(t,e[t])}var n,o=i(this.required.values());try{for(o.s();!(n=o.n()).done;){var r=n.value;if(void 0===e[r])throw new Error('Option "'.concat(r,'" is required.'))}}catch(e){o.e(e)}finally{o.f()}}},{key:"checkType",value:function(e,t){if(this.types.has(e)){var i=this.types.get(e),o=n(t);if(o!==i)throw new Error('Wrong value for option "'.concat(e,'". Expected type "').concat(i,'" but got "').concat(o,'".'))}}},{key:"optionExists",value:function(e){return!!this.allowExtra||this.defaults.has(e)||this.optional.has(e)||this.required.has(e)||this.types.has(e)}}])&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}();return t.default})()},162:function(e){e.exports=(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>n});var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._events={},this.on=this.addEventListener,this.off=this.removeEventListener}var t;return(t=[{key:"emit",value:function(e,t){if(Object.prototype.hasOwnProperty.call(this._events,e))for(var n=this._events[e],i={type:e,detail:t},o=n.length,r=0;r<o;r++)this.handle(n[r],i)}},{key:"handle",value:function(e,t){e(t)}},{key:"addEventListener",value:function(e,t){Object.prototype.hasOwnProperty.call(this._events,e)||(this._events[e]=[]),this._events[e].indexOf(t)<0&&this._events[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(Object.prototype.hasOwnProperty.call(this._events,e)){var n=this._events[e],i=n.indexOf(t);i>=0&&n.splice(i,1),0===n.length&&delete this._events[e]}}}])&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}();return t.default})()}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{"use strict";n.r(i),n.d(i,{GamepadHandler:()=>p,GamepadListener:()=>S});var e=n(162),t=n.n(e),o=n(944),r=n.n(o);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(p,e);var t,n,i,o,r,s=(o=p,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(o);if(r){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function p(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(this,p),(n=s.call(this)).index=e,n.options=n.constructor.resolveOptions(i),n.sticks=new Array(t.axes.length/2).fill(null).map((function(){return[null,null]})),n.buttons=new Array(t.buttons.length).fill(null),n.updateStick=n.updateStick.bind(u(n)),n.updateButton=n.updateButton.bind(u(n)),n}return t=p,i=[{key:"resolveOptions",value:function(e){var t=void 0!==e.stick,n=void 0!==e.button,i={stick:this.optionResolver.resolve(t?e.stick:n?{}:e),button:this.optionResolver.resolve(n?e.button:t?{}:e)};return i.stick.deadZone=Math.max(Math.min(i.stick.deadZone,1),0),i.button.deadZone=Math.max(Math.min(i.button.deadZone,1),0),i.stick.precision=i.stick.precision?Math.pow(10,i.stick.precision):0,i.button.precision=i.button.precision?Math.pow(10,i.button.precision):0,i}}],(n=[{key:"update",value:function(e){for(var t=0,n=this.sticks.length,i=0;i<n;i++)for(var o=0;o<2;o++)this.updateStick(e,i,o,e.axes[t++]);var r=this.buttons.length;for(t=0;t<r;t++)this.updateButton(e,e.buttons[t],t)}},{key:"updateStick",value:function(e,t,n,i){var o=this.options.stick,r=o.deadZone,s=o.analog,a=o.precision;r&&i<r&&i>-r&&(i=0),s?a&&(i=Math.round(i*a)/a):i=i>0?1:i<0?-1:0,this.sticks[t][n]!==i&&(this.sticks[t][n]=i,this.emit("axis",{gamepad:e,stick:t,axis:n,value:i,index:this.index}))}},{key:"updateButton",value:function(e,t,n){var i=this.options.button,o=i.deadZone,r=i.analog,s=i.precision,a=t.value,c=t.pressed,d=a;o&&t.value<o&&t.value>-o&&(d=0),r?s&&(d=Math.round(d*s)/s):d=c?1:0,this.buttons[n]!==d&&(this.buttons[n]=d,this.emit("button",{gamepad:e,button:n,pressed:c,value:d,index:this.index}))}}])&&c(t.prototype,n),i&&c(t,i),p}(t());p.optionResolver=(new(r())).setDefaults({analog:!0,deadZone:0,precision:0}).setTypes({analog:"boolean",deadZone:"number",precision:"number"});var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callback=t,this.frame=null,this.update=this.update.bind(this)}var t;return(t=[{key:"setCallback",value:function(e){this.callback=e}},{key:"start",value:function(){this.frame||(this.frame=window.requestAnimationFrame(this.update))}},{key:"stop",value:function(){this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=null)}},{key:"update",value:function(){this.frame=window.requestAnimationFrame(this.update),this.callback()}}])&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}();function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?C(e):t}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(r,e);var t,n,i,o=(n=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(n);if(i){var o=b(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return y(this,e)});function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(v(this,r),e=o.call(this),"function"!=typeof navigator.getGamepads)throw new Error("This browser does not support gamepad API.");return e.options=t,e.onAxis=e.onAxis.bind(C(e)),e.update=e.update.bind(C(e)),e.start=e.start.bind(C(e)),e.stop=e.stop.bind(C(e)),e.discover=e.discover.bind(C(e)),e.onButton=e.onButton.bind(C(e)),e.handlers=new Array(4).fill(null),e.loop=new f(e.update),window.addEventListener("error",e.stop),e}return(t=[{key:"start",value:function(){this.loop.start()}},{key:"stop",value:function(){this.loop.stop()}},{key:"update",value:function(){var e=navigator.getGamepads();this.discover(e[0],0),this.discover(e[1],1),this.discover(e[2],2),this.discover(e[3],3)}},{key:"discover",value:function(e,t){e?(this.handlers[t]||this.registerHandler(t,e),this.handlers[t].update(e)):this.handlers[t]&&this.removeGamepad(t)}},{key:"registerHandler",value:function(e,t){if(this.handlers[e])throw new Error("Gamepad #".concat(e," is already registered."));var n=new p(e,t,this.options);this.handlers[e]=n,n.addEventListener("axis",this.onAxis),n.addEventListener("button",this.onButton),this.emit("gamepad:connected",{index:e,gamepad:t}),this.emit("gamepad:".concat(e,":connected"),{index:e,gamepad:t})}},{key:"removeGamepad",value:function(e){if(!this.handlers[e])throw new Error("Gamepad #".concat(e," is not registered."));this.handlers[e].removeEventListener("axis",this.onAxis),this.handlers[e].removeEventListener("button",this.onButton),this.handlers[e]=null,this.emit("gamepad:disconnected",{index:e}),this.emit("gamepad:".concat(e,":disconnected"),{index:e})}},{key:"onAxis",value:function(e){var t=e.detail.index;this.emit("gamepad:axis",e.detail),this.emit("gamepad:".concat(t,":axis"),e.detail),this.emit("gamepad:".concat(t,":axis:").concat(e.detail.axis),e.detail)}},{key:"onButton",value:function(e){var t=e.detail.index;this.emit("gamepad:button",e.detail),this.emit("gamepad:".concat(t,":button"),e.detail),this.emit("gamepad:".concat(t,":button:").concat(e.detail.button),e.detail)}}])&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(r.prototype,t),r}(t())})(),i})()},8809:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},3578:function(e,t,n){"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g&&n.g,e.exports=function(){"use strict";var e,t="3.7.2",n="function"==typeof atob,i="function"==typeof btoa,o="function"==typeof Buffer,r="function"==typeof TextDecoder?new TextDecoder:void 0,s="function"==typeof TextEncoder?new TextEncoder:void 0,a=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),c=(e={},a.forEach((function(t,n){return e[t]=n})),e),d=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,l=String.fromCharCode.bind(String),u="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e,t){return void 0===t&&(t=function(e){return e}),new Uint8Array(Array.prototype.slice.call(e,0).map(t))},h=function(e){return e.replace(/=/g,"").replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"}))},p=function(e){return e.replace(/[^A-Za-z0-9\+\/]/g,"")},f=function(e){for(var t,n,i,o,r="",s=e.length%3,c=0;c<e.length;){if((n=e.charCodeAt(c++))>255||(i=e.charCodeAt(c++))>255||(o=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");r+=a[(t=n<<16|i<<8|o)>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}return s?r.slice(0,s-3)+"===".substring(s):r},m=i?function(e){return btoa(e)}:o?function(e){return Buffer.from(e,"binary").toString("base64")}:f,v=o?function(e){return Buffer.from(e).toString("base64")}:function(e){for(var t=[],n=0,i=e.length;n<i;n+=4096)t.push(l.apply(null,e.subarray(n,n+4096)));return m(t.join(""))},g=function(e,t){return void 0===t&&(t=!1),t?h(v(e)):v(e)},y=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},C=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,b=function(e){return e.replace(C,y)},S=o?function(e){return Buffer.from(e,"utf8").toString("base64")}:s?function(e){return v(s.encode(e))}:function(e){return m(b(e))},k=function(e,t){return void 0===t&&(t=!1),t?h(S(e)):S(e)},T=function(e){return k(e,!0)},E=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,w=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return l(55296+(t>>>10))+l(56320+(1023&t));case 3:return l((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return l((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},R=function(e){return e.replace(E,w)},_=function(e){if(e=e.replace(/\s+/g,""),!d.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));for(var t,n,i,o="",r=0;r<e.length;)t=c[e.charAt(r++)]<<18|c[e.charAt(r++)]<<12|(n=c[e.charAt(r++)])<<6|(i=c[e.charAt(r++)]),o+=64===n?l(t>>16&255):64===i?l(t>>16&255,t>>8&255):l(t>>16&255,t>>8&255,255&t);return o},P=n?function(e){return atob(p(e))}:o?function(e){return Buffer.from(e,"base64").toString("binary")}:_,D=o?function(e){return u(Buffer.from(e,"base64"))}:function(e){return u(P(e),(function(e){return e.charCodeAt(0)}))},M=function(e){return D(x(e))},O=o?function(e){return Buffer.from(e,"base64").toString("utf8")}:r?function(e){return r.decode(D(e))}:function(e){return R(P(e))},x=function(e){return p(e.replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})))},A=function(e){return O(x(e))},I=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}},L=function(){var e=function(e,t){return Object.defineProperty(String.prototype,e,I(t))};e("fromBase64",(function(){return A(this)})),e("toBase64",(function(e){return k(this,e)})),e("toBase64URI",(function(){return k(this,!0)})),e("toBase64URL",(function(){return k(this,!0)})),e("toUint8Array",(function(){return M(this)}))},N=function(){var e=function(e,t){return Object.defineProperty(Uint8Array.prototype,e,I(t))};e("toBase64",(function(e){return g(this,e)})),e("toBase64URI",(function(){return g(this,!0)})),e("toBase64URL",(function(){return g(this,!0)}))},G={version:t,VERSION:"3.7.2",atob:P,atobPolyfill:_,btoa:m,btoaPolyfill:f,fromBase64:A,toBase64:k,encode:k,encodeURI:T,encodeURL:T,utob:b,btou:R,decode:A,isValid:function(e){if("string"!=typeof e)return!1;var t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:g,toUint8Array:M,extendString:L,extendUint8Array:N,extendBuiltins:function(){L(),N()},Base64:{}};return Object.keys(G).forEach((function(e){return G.Base64[e]=G[e]})),G}()},1586:(e,t,n)=>{var i,o,r,s,a;i=n(9677),o=n(943).utf8,r=n(8809),s=n(943).bin,(a=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):o.stringToBytes(e):r(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var n=i.bytesToWords(e),c=8*e.length,d=1732584193,l=-271733879,u=-1732584194,h=271733878,p=0;p<n.length;p++)n[p]=16711935&(n[p]<<8|n[p]>>>24)|4278255360&(n[p]<<24|n[p]>>>8);n[c>>>5]|=128<<c%32,n[14+(c+64>>>9<<4)]=c;var f=a._ff,m=a._gg,v=a._hh,g=a._ii;for(p=0;p<n.length;p+=16){var y=d,C=l,b=u,S=h;d=f(d,l,u,h,n[p+0],7,-680876936),h=f(h,d,l,u,n[p+1],12,-389564586),u=f(u,h,d,l,n[p+2],17,606105819),l=f(l,u,h,d,n[p+3],22,-1044525330),d=f(d,l,u,h,n[p+4],7,-176418897),h=f(h,d,l,u,n[p+5],12,1200080426),u=f(u,h,d,l,n[p+6],17,-1473231341),l=f(l,u,h,d,n[p+7],22,-45705983),d=f(d,l,u,h,n[p+8],7,1770035416),h=f(h,d,l,u,n[p+9],12,-1958414417),u=f(u,h,d,l,n[p+10],17,-42063),l=f(l,u,h,d,n[p+11],22,-1990404162),d=f(d,l,u,h,n[p+12],7,1804603682),h=f(h,d,l,u,n[p+13],12,-40341101),u=f(u,h,d,l,n[p+14],17,-1502002290),d=m(d,l=f(l,u,h,d,n[p+15],22,1236535329),u,h,n[p+1],5,-165796510),h=m(h,d,l,u,n[p+6],9,-1069501632),u=m(u,h,d,l,n[p+11],14,643717713),l=m(l,u,h,d,n[p+0],20,-373897302),d=m(d,l,u,h,n[p+5],5,-701558691),h=m(h,d,l,u,n[p+10],9,38016083),u=m(u,h,d,l,n[p+15],14,-660478335),l=m(l,u,h,d,n[p+4],20,-405537848),d=m(d,l,u,h,n[p+9],5,568446438),h=m(h,d,l,u,n[p+14],9,-1019803690),u=m(u,h,d,l,n[p+3],14,-187363961),l=m(l,u,h,d,n[p+8],20,1163531501),d=m(d,l,u,h,n[p+13],5,-1444681467),h=m(h,d,l,u,n[p+2],9,-51403784),u=m(u,h,d,l,n[p+7],14,1735328473),d=v(d,l=m(l,u,h,d,n[p+12],20,-1926607734),u,h,n[p+5],4,-378558),h=v(h,d,l,u,n[p+8],11,-2022574463),u=v(u,h,d,l,n[p+11],16,1839030562),l=v(l,u,h,d,n[p+14],23,-35309556),d=v(d,l,u,h,n[p+1],4,-1530992060),h=v(h,d,l,u,n[p+4],11,1272893353),u=v(u,h,d,l,n[p+7],16,-155497632),l=v(l,u,h,d,n[p+10],23,-1094730640),d=v(d,l,u,h,n[p+13],4,681279174),h=v(h,d,l,u,n[p+0],11,-358537222),u=v(u,h,d,l,n[p+3],16,-722521979),l=v(l,u,h,d,n[p+6],23,76029189),d=v(d,l,u,h,n[p+9],4,-640364487),h=v(h,d,l,u,n[p+12],11,-421815835),u=v(u,h,d,l,n[p+15],16,530742520),d=g(d,l=v(l,u,h,d,n[p+2],23,-995338651),u,h,n[p+0],6,-198630844),h=g(h,d,l,u,n[p+7],10,1126891415),u=g(u,h,d,l,n[p+14],15,-1416354905),l=g(l,u,h,d,n[p+5],21,-57434055),d=g(d,l,u,h,n[p+12],6,1700485571),h=g(h,d,l,u,n[p+3],10,-1894986606),u=g(u,h,d,l,n[p+10],15,-1051523),l=g(l,u,h,d,n[p+1],21,-2054922799),d=g(d,l,u,h,n[p+8],6,1873313359),h=g(h,d,l,u,n[p+15],10,-30611744),u=g(u,h,d,l,n[p+6],15,-1560198380),l=g(l,u,h,d,n[p+13],21,1309151649),d=g(d,l,u,h,n[p+4],6,-145523070),h=g(h,d,l,u,n[p+11],10,-1120210379),u=g(u,h,d,l,n[p+2],15,718787259),l=g(l,u,h,d,n[p+9],21,-343485551),d=d+y>>>0,l=l+C>>>0,u=u+b>>>0,h=h+S>>>0}return i.endian([d,l,u,h])})._ff=function(e,t,n,i,o,r,s){var a=e+(t&n|~t&i)+(o>>>0)+s;return(a<<r|a>>>32-r)+t},a._gg=function(e,t,n,i,o,r,s){var a=e+(t&i|n&~i)+(o>>>0)+s;return(a<<r|a>>>32-r)+t},a._hh=function(e,t,n,i,o,r,s){var a=e+(t^n^i)+(o>>>0)+s;return(a<<r|a>>>32-r)+t},a._ii=function(e,t,n,i,o,r,s){var a=e+(n^(t|~i))+(o>>>0)+s;return(a<<r|a>>>32-r)+t},a._blocksize=16,a._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var n=i.wordsToBytes(a(e,t));return t&&t.asBytes?n:t&&t.asString?s.bytesToString(n):i.bytesToHex(n)}},7023:function(e,t,n){var i;e=n.nmd(e),function(){"use strict";var o={function:!0,object:!0},r=o[typeof window]&&window||this,s=o[typeof t]&&t,a=o.object&&e&&!e.nodeType&&e,c=s&&a&&"object"==typeof n.g&&n.g;!c||c.global!==c&&c.window!==c&&c.self!==c||(r=c);var d=Math.pow(2,53)-1,l=/\bOpera/,u=Object.prototype,h=u.hasOwnProperty,p=u.toString;function f(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function m(e){return e=b(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:f(e)}function v(e,t){for(var n in e)h.call(e,n)&&t(e[n],n,e)}function g(e){return null==e?f(e):p.call(e).slice(8,-1)}function y(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function C(e,t){var n=null;return function(e,t){var n=-1,i=e?e.length:0;if("number"==typeof i&&i>-1&&i<=d)for(;++n<i;)t(e[n],n);else v(e,t)}(e,(function(i,o){n=t(n,i,o,e)})),n}function b(e){return String(e).replace(/^ +| +$/g,"")}var S=function e(t){var n=r,i=t&&"object"==typeof t&&"String"!=g(t);i&&(n=t,t=null);var o=n.navigator||{},s=o.userAgent||"";t||(t=s);var a,c,d,u,h=i?!!o.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(p.toString()),f="Object",S=i?f:"ScriptBridgingProxyObject",k=i?f:"Environment",T=i&&n.java?"JavaPackage":g(n.java),E=i?f:"RuntimeObject",w=/\bJava/.test(T)&&n.java,R=w&&g(n.environment)==k,_=w?"a":"α",P=w?"b":"β",D=n.document||{},M=n.operamini||n.opera,O=l.test(O=i&&M?M["[[Class]]"]:g(M))?O:M=null,x=t,A=[],I=null,L=t==s,N=L&&M&&"function"==typeof M.version&&M.version(),G=C([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)})),W=C(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],(function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)})),F=U([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),j=C({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},(function(e,n,i){return e||(n[F]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(F)]||RegExp("\\b"+y(i)+"(?:\\b|\\w*\\d)","i").exec(t))&&i})),B=C(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],(function(e,n){var i=n.pattern||y(n);return!e&&(e=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),m(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,i,n.label||n)),e}));function U(e){return C(e,(function(e,n){var i=n.pattern||y(n);return!e&&(e=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(i,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=m(e[0].replace(RegExp(i,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function H(e){return C(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(G&&(G=[G]),/\bAndroid\b/.test(B)&&!F&&(a=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(F=b(a[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),j&&!F?F=U([j]):j&&F&&(F=F.replace(RegExp("^("+y(j)+")[-_.\\s]","i"),j+" ").replace(RegExp("^("+y(j)+")[-_.]?(\\w)","i"),j+" $2")),(a=/\bGoogle TV\b/.exec(F))&&(F=a[0]),/\bSimulator\b/i.test(t)&&(F=(F?F+" ":"")+"Simulator"),"Opera Mini"==W&&/\bOPiOS\b/.test(t)&&A.push("running in Turbo/Uncompressed mode"),"IE"==W&&/\blike iPhone OS\b/.test(t)?(j=(a=e(t.replace(/like iPhone OS/,""))).manufacturer,F=a.product):/^iP/.test(F)?(W||(W="Safari"),B="iOS"+((a=/ OS ([\d_]+)/i.exec(t))?" "+a[1].replace(/_/g,"."):"")):"Konqueror"==W&&/^Linux\b/i.test(B)?B="Kubuntu":j&&"Google"!=j&&(/Chrome/.test(W)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(F))||/\bAndroid\b/.test(B)&&/^Chrome/.test(W)&&/\bVersion\//i.test(t)?(W="Android Browser",B=/\bAndroid\b/.test(B)?B:"Android"):"Silk"==W?(/\bMobi/i.test(t)||(B="Android",A.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&A.unshift("accelerated")):"UC Browser"==W&&/\bUCWEB\b/.test(t)?A.push("speed mode"):"PaleMoon"==W&&(a=/\bFirefox\/([\d.]+)\b/.exec(t))?A.push("identifying as Firefox "+a[1]):"Firefox"==W&&(a=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(B||(B="Firefox OS"),F||(F=a[1])):!W||(a=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(W))?(W&&!F&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(a+"/")+8))&&(W=null),(a=F||j||B)&&(F||j||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(B))&&(W=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(B)?B:a)+" Browser")):"Electron"==W&&(a=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&A.push("Chromium "+a),N||(N=H(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",y(W),"(?:Firefox|Minefield|NetFront)"])),(a=("iCab"==G&&parseFloat(N)>3?"WebKit":/\bOpera\b/.test(W)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(G)&&"WebKit"||!G&&/\bMSIE\b/i.test(t)&&("Mac OS"==B?"Tasman":"Trident")||"WebKit"==G&&/\bPlayStation\b(?! Vita\b)/i.test(W)&&"NetFront")&&(G=[a]),"IE"==W&&(a=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(W+=" Mobile",B="Windows Phone "+(/\+$/.test(a)?a:a+".x"),A.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(W="IE Mobile",B="Windows Phone 8.x",A.unshift("desktop mode"),N||(N=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=W&&"Trident"==G&&(a=/\brv:([\d.]+)/.exec(t))&&(W&&A.push("identifying as "+W+(N?" "+N:"")),W="IE",N=a[1]),L){if("global",u=null!=(d=n)?typeof d.global:"number",/^(?:boolean|number|string|undefined)$/.test(u)||"object"==u&&!d.global)g(a=n.runtime)==S?(W="Adobe AIR",B=a.flash.system.Capabilities.os):g(a=n.phantom)==E?(W="PhantomJS",N=(a=a.version||null)&&a.major+"."+a.minor+"."+a.patch):"number"==typeof D.documentMode&&(a=/\bTrident\/(\d+)/i.exec(t))?(N=[N,D.documentMode],(a=+a[1]+4)!=N[1]&&(A.push("IE "+N[1]+" mode"),G&&(G[1]=""),N[1]=a),N="IE"==W?String(N[1].toFixed(1)):N[0]):"number"==typeof D.documentMode&&/^(?:Chrome|Firefox)\b/.test(W)&&(A.push("masking as "+W+" "+N),W="IE",N="11.0",G=["Trident"],B="Windows");else if(w&&(x=(a=w.lang.System).getProperty("os.arch"),B=B||a.getProperty("os.name")+" "+a.getProperty("os.version")),R){try{N=n.require("ringo/engine").version.join("."),W="RingoJS"}catch(e){(a=n.system)&&a.global.system==n.system&&(W="Narwhal",B||(B=a[0].os||null))}W||(W="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(a=n.process)&&("object"==typeof a.versions&&("string"==typeof a.versions.electron?(A.push("Node "+a.versions.node),W="Electron",N=a.versions.electron):"string"==typeof a.versions.nw&&(A.push("Chromium "+N,"Node "+a.versions.node),W="NW.js",N=a.versions.nw)),W||(W="Node.js",x=a.arch,B=a.platform,N=(N=/[\d.]+/.exec(a.version))?N[0]:null));B=B&&m(B)}if(N&&(a=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(N)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(L&&o.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(I=/b/i.test(a)?"beta":"alpha",N=N.replace(RegExp(a+"\\+?$"),"")+("beta"==I?P:_)+(/\d+\+?/.exec(a)||"")),"Fennec"==W||"Firefox"==W&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(B))W="Firefox Mobile";else if("Maxthon"==W&&N)N=N.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(F))"Xbox 360"==F&&(B=null),"Xbox 360"==F&&/\bIEMobile\b/.test(t)&&A.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(W)&&(!W||F||/Browser|Mobi/.test(W))||"Windows CE"!=B&&!/Mobi/i.test(t))if("IE"==W&&L)try{null===n.external&&A.unshift("platform preview")}catch(e){A.unshift("embedded")}else(/\bBlackBerry\b/.test(F)||/\bBB10\b/.test(t))&&(a=(RegExp(F.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||N)?(B=((a=[a,/BB10/.test(t)])[1]?(F=null,j="BlackBerry"):"Device Software")+" "+a[0],N=null):this!=v&&"Wii"!=F&&(L&&M||/Opera/.test(W)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==W&&/\bOS X (?:\d+\.){2,}/.test(B)||"IE"==W&&(B&&!/^Win/.test(B)&&N>5.5||/\bWindows XP\b/.test(B)&&N>8||8==N&&!/\bTrident\b/.test(t)))&&!l.test(a=e.call(v,t.replace(l,"")+";"))&&a.name&&(a="ing as "+a.name+((a=a.version)?" "+a:""),l.test(W)?(/\bIE\b/.test(a)&&"Mac OS"==B&&(B=null),a="identify"+a):(a="mask"+a,W=O?m(O.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(a)&&(B=null),L||(N=null)),G=["Presto"],A.push(a));else W+=" Mobile";(a=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(a=[parseFloat(a.replace(/\.(\d)$/,".0$1")),a],"Safari"==W&&"+"==a[1].slice(-1)?(W="WebKit Nightly",I="alpha",N=a[1].slice(0,-1)):N!=a[1]&&N!=(a[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(N=null),a[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==a[0]&&537.36==a[2]&&parseFloat(a[1])>=28&&"WebKit"==G&&(G=["Blink"]),L&&(h||a[1])?(G&&(G[1]="like Chrome"),a=a[1]||((a=a[0])<530?1:a<532?2:a<532.05?3:a<533?4:a<534.03?5:a<534.07?6:a<534.1?7:a<534.13?8:a<534.16?9:a<534.24?10:a<534.3?11:a<535.01?12:a<535.02?"13+":a<535.07?15:a<535.11?16:a<535.19?17:a<536.05?18:a<536.1?19:a<537.01?20:a<537.11?"21+":a<537.13?23:a<537.18?24:a<537.24?25:a<537.36?26:"Blink"!=G?"27":"28")):(G&&(G[1]="like Safari"),a=(a=a[0])<400?1:a<500?2:a<526?3:a<533?4:a<534?"4+":a<535?5:a<537?6:a<538?7:a<601?8:a<602?9:a<604?10:a<606?11:a<608?12:"12"),G&&(G[1]+=" "+(a+="number"==typeof a?".x":/[.+]/.test(a)?"":"+")),"Safari"==W&&(!N||parseInt(N)>45)?N=a:"Chrome"==W&&/\bHeadlessChrome/i.test(t)&&A.unshift("headless")),"Opera"==W&&(a=/\bzbov|zvav$/.exec(B))?(W+=" ",A.unshift("desktop mode"),"zvav"==a?(W+="Mini",N=null):W+="Mobile",B=B.replace(RegExp(" *"+a+"$"),"")):"Safari"==W&&/\bChrome\b/.exec(G&&G[1])?(A.unshift("desktop mode"),W="Chrome Mobile",N=null,/\bOS X\b/.test(B)?(j="Apple",B="iOS 4.3+"):B=null):/\bSRWare Iron\b/.test(W)&&!N&&(N=H("Chrome")),N&&0==N.indexOf(a=/[\d.]+$/.exec(B))&&t.indexOf("/"+a+"-")>-1&&(B=b(B.replace(a,""))),B&&-1!=B.indexOf(W)&&!RegExp(W+" OS").test(B)&&(B=B.replace(RegExp(" *"+y(W)+" *"),"")),G&&!/\b(?:Avant|Nook)\b/.test(W)&&(/Browser|Lunascape|Maxthon/.test(W)||"Safari"!=W&&/^iOS/.test(B)&&/\bSafari\b/.test(G[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(W)&&G[1])&&(a=G[G.length-1])&&A.push(a),A.length&&(A=["("+A.join("; ")+")"]),j&&F&&F.indexOf(j)<0&&A.push("on "+j),F&&A.push((/^on /.test(A[A.length-1])?"":"on ")+F),B&&(a=/ ([\d.+]+)$/.exec(B),c=a&&"/"==B.charAt(B.length-a[0].length-1),B={architecture:32,family:a&&!c?B.replace(a[0],""):B,version:a?a[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(a=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(x))&&!/\bi686\b/i.test(x)?(B&&(B.architecture=64,B.family=B.family.replace(RegExp(" *"+a),"")),W&&(/\bWOW64\b/i.test(t)||L&&/\w(?:86|32)$/.test(o.cpuClass||o.platform)&&!/\bWin64; x64\b/i.test(t))&&A.unshift("32-bit")):B&&/^OS X/.test(B.family)&&"Chrome"==W&&parseFloat(N)>=39&&(B.architecture=64),t||(t=null);var V={};return V.description=t,V.layout=G&&G[0],V.manufacturer=j,V.name=W,V.prerelease=I,V.product=F,V.ua=t,V.version=W&&N,V.os=B||{architecture:null,family:null,version:null,toString:function(){return"null"}},V.parse=e,V.toString=function(){return this.description||""},V.version&&A.unshift(N),V.name&&A.unshift(W),B&&W&&(B!=String(B).split(" ")[0]||B!=W.split(" ")[0]&&!F)&&A.push(F?"("+B+")":"on "+B),A.length&&(V.description=A.join(" ")),V}();r.platform=S,void 0===(i=function(){return S}.call(t,n,t,e))||(e.exports=i)}.call(this)},7329:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>T});var i=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,i){return e[0]===t&&(n=i,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),i=this.__entries__[n];return i&&i[1]},t.prototype.set=function(t,n){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,i=e(n,t);~i&&n.splice(i,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,i=this.__entries__;n<i.length;n++){var o=i[n];e.call(t,o[1],o[0])}},t}()}(),o="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,r=void 0!==n.g&&n.g.Math===Math?n.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),s="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(r):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},a=["top","right","bottom","left","width","height","size","weight"],c="undefined"!=typeof MutationObserver,d=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,i=!1,o=0;function r(){n&&(n=!1,e()),i&&c()}function a(){s(r)}function c(){var e=Date.now();if(n){if(e-o<2)return;i=!0}else n=!0,i=!1,setTimeout(a,20);o=e}return c}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){o&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),c?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){o&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;a.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),l=function(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];Object.defineProperty(e,o,{value:t[o],enumerable:!1,writable:!1,configurable:!0})}return e},u=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||r},h=g(0,0,0,0);function p(e){return parseFloat(e)||0}function f(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+p(e["border-"+n+"-width"])}),0)}var m="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof u(e).SVGGraphicsElement}:function(e){return e instanceof u(e).SVGElement&&"function"==typeof e.getBBox};function v(e){return o?m(e)?function(e){var t=e.getBBox();return g(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return h;var i=u(e).getComputedStyle(e),o=function(e){for(var t={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var o=i[n],r=e["padding-"+o];t[o]=p(r)}return t}(i),r=o.left+o.right,s=o.top+o.bottom,a=p(i.width),c=p(i.height);if("border-box"===i.boxSizing&&(Math.round(a+r)!==t&&(a-=f(i,"left","right")+r),Math.round(c+s)!==n&&(c-=f(i,"top","bottom")+s)),!function(e){return e===u(e).document.documentElement}(e)){var d=Math.round(a+r)-t,l=Math.round(c+s)-n;1!==Math.abs(d)&&(a-=d),1!==Math.abs(l)&&(c-=l)}return g(o.left,o.top,a,c)}(e):h}function g(e,t,n,i){return{x:e,y:t,width:n,height:i}}var y=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=g(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=v(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),C=function(e,t){var n,i,o,r,s,a,c,d=(i=(n=t).x,o=n.y,r=n.width,s=n.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(a.prototype),l(c,{x:i,y:o,width:r,height:s,top:o,right:i+r,bottom:s+o,left:i}),c);l(this,{target:e,contentRect:d})},b=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new i,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof u(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new y(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof u(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new C(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),S="undefined"!=typeof WeakMap?new WeakMap:new i,k=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=d.getInstance(),i=new b(t,n,this);S.set(this,i)};["observe","unobserve","disconnect"].forEach((function(e){k.prototype[e]=function(){var t;return(t=S.get(this))[e].apply(t,arguments)}}));const T=void 0!==r.ResizeObserver?r.ResizeObserver:k},2226:(e,t,n)=>{"use strict";var i=n(347);function o(e,t,n,o,r){var s=i.writeRtpDescription(e.kind,t);if(s+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":r||"active"),s+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var c="msid:"+(o?o.id:"-")+" "+a+"\r\n";s+="a="+c,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),s}function r(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},o=function(e,t,n,o){var r=i(e.parameters.apt,n),s=i(t.parameters.apt,o);return r&&s&&r.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(i){for(var r=0;r<t.codecs.length;r++){var s=t.codecs[r];if(i.name.toLowerCase()===s.name.toLowerCase()&&i.clockRate===s.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&s.parameters.apt&&!o(i,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(i.numChannels,s.numChannels),n.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var o=t.headerExtensions[i];if(e.uri===o.uri){n.headerExtensions.push(o);break}}})),n}function s(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function a(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}e.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,n,i,o){var r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=o,e.setTimeout((function(){t._dispatchEvent("track",r)}))}var l=function(n){var o=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){o[e]=r[e].bind(r)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var o="string"==typeof i;return o&&(i=[i]),i=i.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=o?i[0]:i,!!i.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var s=n.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var o=this._createIceAndDtlsTransports();i.iceTransport=o.iceTransport,i.dtlsTransport=o.dtlsTransport}return t||this.transceivers.push(i),i},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var o=0;o<this.transceivers.length;o++)this.transceivers[o].track||this.transceivers[o].kind!==t.kind||(i=this.transceivers[o]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),i.getTracks().forEach((function(e){n.addTrack(e,i)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var i=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var o=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(o,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;o.state=n?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},o.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),o},l.prototype._gather=function(t,n){var o=this,r=this.transceivers[n].iceGatherer;if(!r.onlocalcandidate){var s=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,r.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),r.onlocalcandidate=function(e){if(!(o.usingBundle&&n>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:n};var a=e.candidate,c=!a||0===Object.keys(a).length;if(c)"new"!==r.state&&"gathering"!==r.state||(r.state="completed");else{"new"===r.state&&(r.state="gathering"),a.component=1,a.ufrag=r.getLocalParameters().usernameFragment;var d=i.writeCandidate(a);s.candidate=Object.assign(s.candidate,i.parseCandidate(d)),s.candidate.candidate=d,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var l=i.getMediaSections(o._localDescription.sdp);l[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",o._localDescription.sdp=i.getDescription(o._localDescription.sdp)+l.join("");var u=o.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==o.iceGatheringState&&(o.iceGatheringState="gathering",o._emitGatheringStateChange()),c||o._dispatchEvent("icecandidate",s),u&&(o._dispatchEvent("icecandidate",new Event("icecandidate")),o.iceGatheringState="complete",o._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){r.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,o){var s=r(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:i.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),o&&e.rtpReceiver&&s.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?s.encodings=e.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},l.prototype.setLocalDescription=function(e){var t,n,o=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,o.signalingState)||o._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+o.signalingState));if("offer"===e.type)t=i.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=i.parseRtpParameters(e);o.transceivers[t].localCapabilities=n})),o.transceivers.forEach((function(e,t){o._gather(e.mid,t)}));else if("answer"===e.type){t=i.splitSections(o._remoteDescription.sdp),n=t.shift();var a=i.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var s=o.transceivers[t],c=s.iceGatherer,d=s.iceTransport,l=s.dtlsTransport,u=s.localCapabilities,h=s.remoteCapabilities;if(!(i.isRejected(e)&&0===i.matchPrefix(e,"a=bundle-only").length||s.rejected)){var p=i.getIceParameters(e,n),f=i.getDtlsParameters(e,n);a&&(f.role="server"),o.usingBundle&&0!==t||(o._gather(s.mid,t),"new"===d.state&&d.start(c,p,a?"controlling":"controlled"),"new"===l.state&&l.start(f));var m=r(u,h);o._transceive(s,m.codecs.length>0,!1)}}))}return o._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?o._updateSignalingState("have-local-offer"):o._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(o){var l=this;if(-1===["offer","answer"].indexOf(o.type))return Promise.reject(c("TypeError",'Unsupported type "'+o.type+'"'));if(!s("setRemoteDescription",o.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+o.type+" in state "+l.signalingState));var u={};l.remoteStreams.forEach((function(e){u[e.id]=e}));var h=[],p=i.splitSections(o.sdp),f=p.shift(),m=i.matchPrefix(f,"a=ice-lite").length>0,v=i.matchPrefix(f,"a=group:BUNDLE ").length>0;l.usingBundle=v;var g=i.matchPrefix(f,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(s,c){var d=i.splitLines(s),p=i.getKind(s),g=i.isRejected(s)&&0===i.matchPrefix(s,"a=bundle-only").length,y=d[0].substr(2).split(" ")[2],C=i.getDirection(s,f),b=i.parseMsid(s),S=i.getMid(s)||i.generateIdentifier();if(g||"application"===p&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))l.transceivers[c]={mid:S,kind:p,protocol:y,rejected:!0};else{var k,T,E,w,R,_,P,D,M;!g&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(p,!0));var O,x,A=i.parseRtpParameters(s);g||(O=i.getIceParameters(s,f),(x=i.getDtlsParameters(s,f)).role="client"),P=i.parseRtpEncodingParameters(s);var I=i.parseRtcpParameters(s),L=i.matchPrefix(s,"a=end-of-candidates",f).length>0,N=i.matchPrefix(s,"a=candidate:").map((function(e){return i.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===o.type||"answer"===o.type)&&!g&&v&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==o.type||g)"answer"!==o.type||g||(T=(k=l.transceivers[c]).iceGatherer,E=k.iceTransport,w=k.dtlsTransport,R=k.rtpReceiver,_=k.sendEncodingParameters,D=k.localCapabilities,l.transceivers[c].recvEncodingParameters=P,l.transceivers[c].remoteCapabilities=A,l.transceivers[c].rtcpParameters=I,N.length&&"new"===E.state&&(!m&&!L||v&&0!==c?N.forEach((function(e){a(k.iceTransport,e)})):E.setRemoteCandidates(N)),v&&0!==c||("new"===E.state&&E.start(T,O,"controlling"),"new"===w.state&&w.start(x)),!r(k.localCapabilities,k.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&k.sendEncodingParameters[0].rtx&&delete k.sendEncodingParameters[0].rtx,l._transceive(k,"sendrecv"===C||"recvonly"===C,"sendrecv"===C||"sendonly"===C),!R||"sendrecv"!==C&&"sendonly"!==C?delete k.rtpReceiver:(M=R.track,b?(u[b.stream]||(u[b.stream]=new e.MediaStream),n(M,u[b.stream]),h.push([M,R,u[b.stream]])):(u.default||(u.default=new e.MediaStream),n(M,u.default),h.push([M,R,u.default]))));else{(k=l.transceivers[c]||l._createTransceiver(p)).mid=S,k.iceGatherer||(k.iceGatherer=l._createIceGatherer(c,v)),N.length&&"new"===k.iceTransport.state&&(!L||v&&0!==c?N.forEach((function(e){a(k.iceTransport,e)})):k.iceTransport.setRemoteCandidates(N)),D=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(D.codecs=D.codecs.filter((function(e){return"rtx"!==e.name}))),_=k.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var G,W=!1;"sendrecv"===C||"sendonly"===C?(W=!k.rtpReceiver,R=k.rtpReceiver||new e.RTCRtpReceiver(k.dtlsTransport,p),W&&(M=R.track,b&&"-"===b.stream||(b?(u[b.stream]||(u[b.stream]=new e.MediaStream,Object.defineProperty(u[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(M,"id",{get:function(){return b.track}}),G=u[b.stream]):(u.default||(u.default=new e.MediaStream),G=u.default)),G&&(n(M,G),k.associatedRemoteMediaStreams.push(G)),h.push([M,R,G]))):k.rtpReceiver&&k.rtpReceiver.track&&(k.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===k.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),k.associatedRemoteMediaStreams=[]),k.localCapabilities=D,k.remoteCapabilities=A,k.rtpReceiver=R,k.rtcpParameters=I,k.sendEncodingParameters=_,k.recvEncodingParameters=P,l._transceive(l.transceivers[c],!1,W)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===o.type?"active":"passive"),l._remoteDescription={type:o.type,sdp:o.sdp},"offer"===o.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(u).forEach((function(t){var n=u[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",i)}))}h.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&d(l,t,i,[n])}))}})),h.forEach((function(e){e[2]||d(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var r=n.transceivers.filter((function(e){return"audio"===e.kind})).length,s=n.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(r=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(s=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--r<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));r>0||s>0;)r>0&&(n._createTransceiver("audio"),r--),s>0&&(n._createTransceiver("video"),s--);var d=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(o,r){var s=o.track,a=o.kind,c=o.mid||i.generateIdentifier();o.mid=c,o.iceGatherer||(o.iceGatherer=n._createIceGatherer(r,n.usingBundle));var d=e.RTCRtpSender.getCapabilities(a);t<15019&&(d.codecs=d.codecs.filter((function(e){return"rtx"!==e.name}))),d.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),o.remoteCapabilities&&o.remoteCapabilities.codecs&&o.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),d.headerExtensions.forEach((function(e){(o.remoteCapabilities&&o.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=o.sendEncodingParameters||[{ssrc:1001*(2*r+1)}];s&&t>=15019&&"video"===a&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),o.wantReceive&&(o.rtpReceiver=new e.RTCRtpReceiver(o.dtlsTransport,a)),o.localCapabilities=d,o.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(d+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){d+=o(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+i.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var s=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(s+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var a=i.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,i){if(!(i+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var d=r(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=o(e,d,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(d)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(o,r){if(!n._remoteDescription)return r(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===e.sdpMid){s=d;break}var l=n.transceivers[s];if(!l)return r(c("OperationError","Can not add ICE candidate"));if(l.rejected)return o();var u=Object.keys(e.candidate).length>0?i.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return o();if(u.component&&1!==u.component)return o();if((0===s||s>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!a(l.iceTransport,u))return r(c("OperationError","Can not add ICE candidate"));var h=e.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(t=i.getMediaSections(n._remoteDescription.sdp))[s]+="a="+(u.type?h:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=i.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);o()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var i;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[n]).type]||i.type,t.set(n,e[n])})),t}))}}}));var u=["createOffer","createAnswer"];return u.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},347:e=>{"use strict";var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<i.length;o++)n[(t=i[o].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],o=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substr(12),password:o.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" "),o=3;o<i.length;o++){var r=i[o],s=t.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+r+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(t.parseRtcpFb),n.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));var o=0;return n.codecs.forEach((function(e){e.maxptime>o&&(o=e.maxptime)})),o>0&&(i+="a=maxptime:"+o+"\r\n"),i+="a=rtcp-mux\r\n",n.headerExtensions&&n.headerExtensions.forEach((function(e){i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){var n,i=[],o=t.parseRtpParameters(e),r=-1!==o.fecMechanisms.indexOf("RED"),s=-1!==o.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,d=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(n=d[0][1]),o.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),i.push(t),r&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},i.push(t))}})),0===i.length&&c&&i.push({ssrc:c});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,i.forEach((function(e){e.maxBitrate=l}))),i},t.parseRtcpParameters=function(e){var n={},i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);var o=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=o.length>0,n.compound=0===o.length;var r=t.matchPrefix(e,"a=rtcp-mux");return n.mux=r.length>0,n},t.parseMsid=function(e){var n,i=t.matchPrefix(e,"a=msid:");if(1===i.length)return{stream:(n=i[0].substr(7).split(" "))[0],track:n[1]};var o=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return o.length>0?{stream:(n=o[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,i=t.parseMLine(e),o=t.matchPrefix(e,"a=max-message-size:");o.length>0&&(n=parseInt(o[0].substr(19),10)),isNaN(n)&&(n=65536);var r=t.matchPrefix(e,"a=sctp-port:");if(r.length>0)return{port:parseInt(r[0].substr(12),10),protocol:i.fmt,maxMessageSize:n};if(t.matchPrefix(e,"a=sctpmap:").length>0){var s=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,i){var o=void 0!==n?n:2;return"v=0\r\no="+(i||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,i,o){var r=t.writeRtpDescription(e.kind,n);if(r+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),r+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":"active"),r+="a=mid:"+e.mid+"\r\n",e.direction?r+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?r+="a=sendrecv\r\n":e.rtpSender?r+="a=sendonly\r\n":e.rtpReceiver?r+="a=recvonly\r\n":r+="a=inactive\r\n",e.rtpSender){var s="msid:"+o.id+" "+e.rtpSender.track.id+"\r\n";r+="a="+s,r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,r+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),r},t.getDirection=function(e,n){for(var i=t.splitLines(e),o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),i=0;i<n.length;i++)if(n[i].length<2||"="!==n[i].charAt(1))return!1;return!0},e.exports=t},6994:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>fe});var i={};n.r(i),n.d(i,{fixNegotiationNeeded:()=>O,shimAddTrackRemoveTrack:()=>D,shimAddTrackRemoveTrackWithNative:()=>P,shimGetDisplayMedia:()=>k,shimGetSendersWithDtmf:()=>w,shimGetStats:()=>R,shimGetUserMedia:()=>S,shimMediaStream:()=>T,shimOnTrack:()=>E,shimPeerConnection:()=>M,shimSenderReceiverGetStats:()=>_});var o={};n.r(o),n.d(o,{shimGetDisplayMedia:()=>L,shimGetUserMedia:()=>I,shimPeerConnection:()=>N,shimReplaceTrack:()=>G});var r={};n.r(r),n.d(r,{shimAddTransceiver:()=>q,shimCreateAnswer:()=>X,shimCreateOffer:()=>Y,shimGetDisplayMedia:()=>F,shimGetParameters:()=>z,shimGetUserMedia:()=>W,shimOnTrack:()=>j,shimPeerConnection:()=>B,shimRTCDataChannel:()=>K,shimReceiverGetStats:()=>H,shimRemoveStream:()=>V,shimSenderGetStats:()=>U});var s={};n.r(s),n.d(s,{shimAudioContext:()=>oe,shimCallbacksAPI:()=>Z,shimConstraints:()=>ee,shimCreateOfferLegacy:()=>ie,shimGetUserMedia:()=>Q,shimLocalStreamsAPI:()=>J,shimRTCIceServerUrls:()=>te,shimRemoteStreamsAPI:()=>$,shimTrackEventTransceiver:()=>ne});var a={};n.r(a),n.d(a,{removeExtmapAllowMixed:()=>ue,shimAddIceCandidateNullOrEmpty:()=>he,shimConnectionState:()=>le,shimMaxMessageSize:()=>ce,shimRTCIceCandidate:()=>ae,shimSendThrowTypeError:()=>de});let c=!0,d=!0;function l(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function u(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,o=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return o.apply(this,arguments);const r=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,r),o.apply(this,[e,r])};const r=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return r.apply(this,arguments);if(!this._eventMap[t].has(n))return r.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,r.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function h(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(c=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function p(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(d=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function f(){if("object"==typeof window){if(c)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function m(e,t){d&&console.warn(e+" is deprecated, please use "+t+" instead.")}function v(e){return"[object Object]"===Object.prototype.toString.call(e)}function g(e){return v(e)?Object.keys(e).reduce((function(t,n){const i=v(e[n]),o=i?g(e[n]):e[n],r=i&&!Object.keys(o).length;return void 0===o||r?t:Object.assign(t,{[n]:o})}),{}):e}function y(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?y(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((t=>{y(e,e.get(t),n)}))})))}function C(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;const r=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&r.push(e)})),r.forEach((t=>{e.forEach((n=>{n.type===i&&n.trackId===t.id&&y(e,n,o)}))})),o}const b=f;function S(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"==typeof i.ideal?(e[o("min",n)]=i.ideal,t.optional.push(e),e={},e[o("max",n)]=i.ideal,t.optional.push(e)):(e[o("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},o=function(e,o){if(t.version>=61)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let r=e.video.facingMode;r=r&&("object"==typeof r?r:{ideal:r});const s=t.version<66;if(r&&("user"===r.exact||"environment"===r.exact||"user"===r.ideal||"environment"===r.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===r.exact||"environment"===r.ideal?t=["back","rear"]:"user"!==r.exact&&"user"!==r.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let s=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&n.length&&t.includes("back")&&(s=n[n.length-1]),s&&(e.video.deviceId=r.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=i(e.video),b("chrome: "+JSON.stringify(e)),o(e)}))}e.video=i(e.video)}return b("chrome: "+JSON.stringify(e)),o(e)},r=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){o(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{i&&i(r(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return o(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(r(e))))))}}}function k(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const i=n.video&&n.video.width,o=n.video&&n.video.height,r=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:r||3}},i&&(n.video.mandatory.maxWidth=i),o&&(n.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function T(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function E(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],this.dispatchEvent(o)})),t.stream.getTracks().forEach((n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],this.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else u(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function w(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let o=n.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function R(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,i]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const o=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},r=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const i=function(e){n(r(o(e)))};return t.apply(this,[i,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(r(o(t)))},n])})).then(n,i)}}function _(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>C(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),u(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>C(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach((n=>{n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?i=!0:n=t),t.track===e))),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function P(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),o.apply(this,arguments)}}function D(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return P(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const o=e.RTCPeerConnection.prototype.removeStream;function r(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],o=e._streams[i.id];n=n.replace(new RegExp(o.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function s(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],o=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const o=this.getSenders().find((e=>e.track===t));if(o)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const r=this._streams[n.id];if(r)r.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=r(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>r(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=c.get.apply(this);return""===e.type?e:r(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function M(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function O(e,t){u(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var x=n(2226),A=n.n(x);function I(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e))))}}function L(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function N(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=A()(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((e=>{if(e&&(e.urls||e.url)){let t=e.urls||e.url;e.url&&!e.urls&&m("RTCIceServer.url","RTCIceServer.urls");const i="string"==typeof t;return i&&(t=[t]),t=t.filter((e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))}(e.iceServers,t.version),f("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function G(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function W(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){m("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function F(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function j(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function B(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,o,r]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!o)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(o,r)}}function U(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function H(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),u(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function V(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){m("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function K(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function q(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function z(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Y(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function X(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function J(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function $(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function Z(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,o=t.setLocalDescription,r=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[i]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],o=i.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o};let a=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,n){const i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=a}function Q(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(ee(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function ee(e){return e&&void 0!==e.video?Object.assign({},e,{video:g(e.video)}):e}function te(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(m("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function ne(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ie(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function oe(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var re=n(347),se=n.n(re);function ae(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),i=se().parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,u(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function ce(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=function(e){if(!e||!e.sdp)return!1;const t=se().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=se().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},i=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n},o=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},r=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const o=se().matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const e=i(arguments[0]),t=o(e),n=r(arguments[0],e);let s;s=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function de(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],o=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},u(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function le(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function ue(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function he(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}const pe=function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const n=f,c=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=l(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=l(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=l(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=l(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),d={browserDetails:c,commonShim:a,extractVersion:l,disableLog:h,disableWarnings:p};switch(c.browser){case"chrome":if(!i||!M||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),d;if(null===c.version)return n("Chrome shim can not determine version, not shimming."),d;n("adapter.js shimming chrome."),d.browserShim=i,he(e,c),S(e,c),T(e),M(e,c),E(e),D(e,c),w(e),R(e),_(e),O(e,c),ae(e),le(e),ce(e,c),de(e),ue(e,c);break;case"firefox":if(!r||!B||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),d;n("adapter.js shimming firefox."),d.browserShim=r,he(e,c),W(e,c),B(e,c),j(e),V(e),U(e),H(e),K(e),q(e),z(e),Y(e),X(e),ae(e),le(e),ce(e,c),de(e);break;case"edge":if(!o||!N||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),d;n("adapter.js shimming edge."),d.browserShim=o,I(e),L(e),N(e,c),G(e),ce(e,c),de(e);break;case"safari":if(!s||!t.shimSafari)return n("Safari shim is not included in this adapter release."),d;n("adapter.js shimming safari."),d.browserShim=s,he(e,c),te(e),ie(e),Z(e),J(e),$(e),ne(e),Q(e),oe(e),ae(e),ce(e,c),de(e),ue(e,c);break;default:n("Unsupported browser!")}return d}({window:"undefined"==typeof window?void 0:window}),fe=pe},429:()=>{}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n(4993)})()}));