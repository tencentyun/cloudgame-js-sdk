/*! For license information please see index.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(function(){return(()=>{var e={453:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AndroidInstance=void 0;var a=n(9048),c=s(n(2115)),d=n(9418),u=function(){function e(e){var t=e.sdk;this.groupControl=null,this.operator=null,this.initOptions=null,this.sdk=null,this.sdk=t,this.groupControl=new a.GroupControl({sdk:t}),this.operator=new c.default({sdk:t})}return e.prototype.init=function(e){this.initOptions=r(r({},this.initOptions),e),this.groupControl.init(e.groupControl)},e.prototype.access=function(){},e.prototype.destroy=function(){this.groupControl.destroy()},e.prototype.requestStream=function(e){var t=e.streamName,n=void 0===t?"high":t;this.groupControl.requestStream({streamName:n})},e.prototype.setSyncList=function(e){var t=e.list,n=void 0===t?[]:t;this.groupControl.setSyncList({list:n})},e.prototype.startSync=function(e){var t=e.instanceIds,n=void 0===t?[]:t;this.groupControl.startSync({instanceIds:n})},e.prototype.stopSync=function(){this.groupControl.stopSync()},e.prototype.setMaster=function(e){var t=e.instanceId;this.groupControl.setMaster({instanceId:t})},e.prototype.setImageEvent=function(e){var t=e.interval,n=e.quality;this.groupControl.setImageEvent({interval:t,quality:n})},e.prototype.joinGroupControl=function(e){var t=e.instanceIds,n=e.clientSessions,r=void 0===n?[]:n;this.groupControl.join({instanceIds:t,clientSessions:r})},e.prototype.leaveGroupControl=function(e){var t=e.instanceIds;this.groupControl.leave({instanceIds:t})},e.prototype.transMessage=function(e){var t=e.packageName,n=e.message;this.sdk.cloudGamingWebRTC.sendCloudDeviceData({type:"trans_message",data:{package_name:t,msg:n}})},e.prototype.inputText=function(e){var t=e.content,n=void 0===t?"":t,r=e.mode,i=void 0===r?"append":r,o=e.index_after_override;"webrtc"===this.sdk.streamingMode?this.sdk.cloudGamingWebRTC.sendAckData({data:{type:"input_text",content:n,mode:i,index_after_override:o}}):this.sdk.cloudGamingWebsocket.dataChannelSend({label:d.DATACHANNEL.ACK,data:{type:"input_text",content:n,mode:i}})},e.prototype.switchIME=function(e){var t=e.ime;"webrtc"===this.sdk.streamingMode?this.sdk.cloudGamingWebRTC.sendAckData({data:{type:"switch_ime",ime:t}}):this.sdk.cloudGamingWebsocket.dataChannelSend({label:d.DATACHANNEL.ACK,data:{type:"switch_ime",ime:t}}),this.sdk.pageEvent.IMEType=t},e.prototype.distributeApp=function(e){var t=e.packageName;"webrtc"===this.sdk.streamingMode?this.sdk.cloudGamingWebRTC.sendCloudDeviceData({type:"distribute_app",data:{package_name:t}}):this.sdk.cloudGamingWebsocket.dataChannelSend({label:d.DATACHANNEL.CLOUD_DEVICE,data:{type:"distribute_app",data:{package_name:t}}})},e.prototype.preserveCleanApp=function(e){var t=e.preservePackageNames;"webrtc"===this.sdk.streamingMode?this.sdk.cloudGamingWebRTC.sendCloudDeviceData({type:"preserve_clean_app",data:{preserve_package_names:t}}):this.sdk.cloudGamingWebsocket.dataChannelSend({label:d.DATACHANNEL.CLOUD_DEVICE,data:{type:"preserve_clean_app",data:{preserve_package_names:t}}})},e.prototype.keepFrontApp=function(e){var t=e.packageName,n=e.enable;"webrtc"===this.sdk.streamingMode?this.sdk.cloudGamingWebRTC.sendCloudDeviceData({type:"keep_front_app",data:{package_name:t,enable:n}}):this.sdk.cloudGamingWebsocket.dataChannelSend({label:d.DATACHANNEL.CLOUD_DEVICE,data:{type:"keep_front_app",data:{package_name:t,enable:n}}})},e.prototype.getInstanceImage=function(e){var t=e.instanceId,n=e.quality,r=void 0===n?20:n,i=e.screenshot_width,o=e.screenshot_height;return this.operator.getInstanceImage({instanceId:t,quality:r,screenshot_width:i,screenshot_height:o})},e.prototype.upload=function(e){var t=e.instanceId,n=e.files;return this.operator.upload({instanceId:t,files:n})},e.prototype.uploadMedia=function(e){var t=e.instanceId,n=e.files;return this.operator.uploadMedia({instanceId:t,files:n})},e.prototype.getInstanceDownloadAddress=function(e){var t=e.instanceId,n=e.path;return this.operator.getInstanceDownloadAddress({instanceId:t,path:n})},e.prototype.getInstanceDownloadLogcatAddress=function(e){var t=e.instanceId,n=e.recentDays;return this.operator.getInstanceDownloadLogcatAddress({instanceId:t,recentDays:n})},e.prototype.setLocation=function(e){var t;return i(this,void 0,void 0,(function(){return o(this,(function(n){return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?[2,this.operator.batchTask({taskType:"ModifyGPS",params:e})]:[2,{Code:1,Message:"params object is empty"}]}))}))},e.prototype.setResolution=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"ModifyResolution",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.paste=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"Paste",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.setSensor=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"ModifySensor",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.sendClipboard=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"SendClipboard",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.shake=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"Shake",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.sendTransMessage=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"SendTransMessage",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.describeInstanceProperties=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"DescribeInstanceProperties",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.modifyInstanceProperties=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"ModifyInstanceProperties",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.listUserApps=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"ListUserApps",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.modifyKeepFrontAppStatus=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"ModifyKeepFrontAppStatus",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.describeKeepFrontAppStatus=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"DescribeKeepFrontAppStatus",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.unInstallByPackageName=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"UnInstallByPackageName",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.startApp=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"StartApp",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.stopApp=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"StopApp",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.clearAppData=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"ClearAppData",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.enableApp=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"EnableApp",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.disableApp=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"DisableApp",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.startCameraMediaPlay=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"StartCameraMediaPlay",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.stopCameraMediaPlay=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"StopCameraMediaPlay",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.describeCameraMediaPlayStatus=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"DescribeCameraMediaPlayStatus",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.displayCameraImage=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"DisplayCameraImage",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.addKeepAliveList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"AddKeepAliveList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.removeKeepAliveList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"RemoveKeepAliveList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.setKeepAliveList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"SetKeepAliveList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.describeKeepAliveList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"DescribeKeepAliveList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.clearKeepAliveList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"ClearKeepAliveList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.mute=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"Mute",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.mediaSearch=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"MediaSearch",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.reboot=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"Reboot",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.listAllApps=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"ListAllApps",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.moveAppBackground=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"MoveAppBackground",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.addAppInstallBlackList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"AddAppInstallBlackList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.removeAppInstallBlackList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"RemoveAppInstallBlackList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.setAppInstallBlackList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"SetAppInstallBlackList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.describeAppInstallBlackList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"DescribeAppInstallBlackList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.clearAppInstallBlackList=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"ClearAppInstallBlackList",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.getNavVisibleStatus=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"GetNavVisibleStatus",params:e}):{Code:1,Message:"params object is empty"}},e.prototype.getSystemMusicVolume=function(e){var t;return(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?this.operator.batchTask({taskType:"GetSystemMusicVolume",params:e}):{Code:1,Message:"params object is empty"}},e}();t.AndroidInstance=u},9048:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.GroupControl=void 0;var c=n(9418),d=function(){function e(e){var t=e.sdk;this.masterInstanceId="",this._instanceIds=[],this._groupControlId="",this.imageEventTimer=null,this.options={image:{interval:1,quality:20}},this.sdk=null,this.sdk=t}return Object.defineProperty(e.prototype,"groupControlId",{get:function(){return this._groupControlId},set:function(e){this._groupControlId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"instanceIds",{get:function(){return a([],s(new Set(this._instanceIds)),!1)},set:function(e){this._instanceIds=a([],s(new Set(e)),!1)},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this.options=r(r({},this.options),e)},e.prototype.start=function(e){var t=e.instanceIds,n=e.serverSessions,r=e.groupControlId;try{this.instanceIds=t;var i=s(t,1)[0];this.masterInstanceId=i,this._groupControlId=r;var o=n[0];this.sdk.cloudGamingWebRTC.connect(o)}catch(e){this.sdk.log("serverSession 解析失败",e)}},e.prototype.startWebSocket=function(e){var t=e.url,n=e.tokenInfos,r=e.instanceIds;this.instanceIds=r;var i=s(r,1)[0];this.masterInstanceId=i,this.sdk.cloudGamingWebsocket.connectGroupControl({url:t,tokenInfos:n})},e.prototype.requestStream=function(e){var t=e.streamName;"websocket"===this.sdk.streamingMode?this.sdk.cloudGamingWebsocket.dataChannelSend({label:c.DATACHANNEL.CLOUD_DEVICE,data:{type:"streaming_request",data:{stream_name:t}}}):this.sdk.cloudGamingWebRTC.sendCloudDeviceData({type:"streaming_request",data:{stream_name:t}})},e.prototype.setSyncList=function(e){var t=e.list,n=void 0===t?[]:t;"websocket"===this.sdk.streamingMode?this.sdk.cloudGamingWebsocket.dataChannelSend({label:c.DATACHANNEL.CLOUD_DEVICE,data:{type:"set_sync_list",data:{user_list:n}}}):this.sdk.cloudGamingWebRTC.sendCloudDeviceData({type:"set_sync_list",data:{user_list:n}})},e.prototype.startSync=function(e){var t=e.instanceIds,n=void 0===t?[]:t;this.setSyncList({list:n.length?n:this.instanceIds})},e.prototype.stopSync=function(){this.setSyncList({list:[]})},e.prototype.setMaster=function(e){var t=e.instanceId;this.masterInstanceId=t,this.sdk.log("setMaster",t),"websocket"===this.sdk.streamingMode?this.sdk.cloudGamingWebsocket.dataChannelSend({label:c.DATACHANNEL.CLOUD_DEVICE,data:{type:"set_master",user:t,data:{status:"on"}}}):this.sdk.cloudGamingWebRTC.sendCloudDeviceData({type:"set_master",user:t,data:{status:"on"}}),this.sdk.playVideo("play")},e.prototype.setImageEvent=function(e){var t=e.interval,n=e.quality;this.sdk.log("setImageEvent","interval",t,"quality",n),this.options.image=r(r({},this.options.image),{interval:t,quality:n}),this._groupControlId&&this.startImageEventInterval()},e.prototype.onConnectSuccess=function(){this.setMaster({instanceId:this.masterInstanceId}),this.setSyncList({list:this.instanceIds}),this.startImageEventInterval()},e.prototype.join=function(e){var t=e.instanceIds,n=e.clientSessions,r=void 0===n?[]:n;return i(this,void 0,void 0,(function(){var e,n,i,c;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),"websocket"!==this.sdk.streamingMode?[3,2]:(e=this.sdk.accessInfo.getTokenInfos({instanceIds:t}),[4,this.sdk.cloudGamingWebsocket.joinGroupControl({tokenInfos:e,groupControlId:this.groupControlId})]);case 1:return o.sent(),[3,5];case 2:return o.trys.push([2,4,,5]),[4,this.sdk.accessInfo.joinWebRTCGroupSession({instanceIds:t,clientSessions:r,groupControlId:this.groupControlId})];case 3:return o.sent().ServerSessions.length,n=this.sdk.accessInfo.getInstancesInfo({instanceIds:t}).InstancesInfo,this.sdk.log("group join, instance ids",t),this.sdk.cloudGamingWebRTC.sendCloudDeviceData({type:"join",data:{group_control_id:this.groupControlId,instances_info:n.map((function(e){return{instance_id:e.InstanceId,data:e.Data}})),client_sessions:r}}),[3,5];case 4:return i=o.sent(),this.sdk.log("join group error",i.message),[3,5];case 5:return this.instanceIds=a(a([],s(this.instanceIds),!1),s(t),!1),this.setSyncList({list:this.instanceIds}),this.startImageEventInterval(),[3,7];case 6:return c=o.sent(),this.sdk.log("join serverSession parse error",c),[3,7];case 7:return[2]}}))}))},e.prototype.leave=function(e){var t=e.instanceIds;this.instanceIds=this.instanceIds.filter((function(e){return!t.includes(e)})),this.setSyncList({list:this.instanceIds}),this.startImageEventInterval()},e.prototype.destroy=function(){clearTimeout(this.imageEventTimer)},e.prototype.startImageEventInterval=function(){var e=this;clearTimeout(this.imageEventTimer);var t=function(){var n=[];e.instanceIds.forEach((function(t){var r;if(e.sdk.androidInstance.operator.getInstanceOperator({instanceId:t}).OperatorAddress){var i=e.sdk.androidInstance.getInstanceImage({instanceId:t,quality:null===(r=e.options.image)||void 0===r?void 0:r.quality}).url;n.push({instanceId:t,url:i})}})),e.sdk.onImageEvent({type:"screenshot",data:n}),e.imageEventTimer=setTimeout((function(){t()}),1e3*e.options.image.interval)};t()},e}();t.GroupControl=d},2115:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof c?c(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var d=n(3139),u=n(6840),l=function(){function e(e){var t=e.sdk;this.sdk=null,this.sdk=t}return e.prototype.getInstanceOperator=function(e){var t=e.instanceId,n=this.sdk.accessInfo.getInstanceAccessInfo({instanceId:t}),r=n.Token,i=void 0===r?"":r,o=n.Zone,s=void 0===o?"":o,a=n.OperatorAddress;return{Token:i,Zone:s,OperatorAddress:void 0===a?"":a,EdgeProxyAddress:n.EdgeProxyAddress}},e.prototype.getInstanceImage=function(e){var t=e.instanceId,n=e.quality,r=void 0===n?20:n,i=e.screenshot_width,o=void 0===i?720:i,s=e.screenshot_height,a=void 0===s?1280:s,c=this.getInstanceOperator({instanceId:t}),d=c.Token,u=c.OperatorAddress,l=c.EdgeProxyAddress;if(d&&u){var h=l||u,p=this.sdk.accessInfo.getInstanceInfoHeader({instanceId:t,method:"GET"}).instanceInfo;return{url:"".concat(h,"/CAIScreenshot?instance_id=").concat(t,"&screenshot_quality=").concat(r,"&token=").concat(d,"&timestamp=").concat(+new Date)+"".concat(o?"&screenshot_width=".concat(o):"")+"".concat(a?"&screenshot_height=".concat(a):"")+"".concat(p||"")}}return{url:null}},e.prototype.upload=function(e){var t=e.instanceId,n=e.files;return i(this,void 0,void 0,(function(){var e,r,s,a,c,d,u,l,h,p,f,m,v,g,y=this;return o(this,(function(b){switch(b.label){case 0:if(e=this.getInstanceOperator({instanceId:t}),r=e.Token,s=e.OperatorAddress,a=e.EdgeProxyAddress,!r||!s)return[3,5];c="".concat(a||s,"/CAIUpload?instance_id=").concat(t,"&token=").concat(r),d={},(u=this.sdk.accessInfo.getInstanceInfoHeader({instanceId:t}).instanceInfo)&&(d["Crtr-Proxy-Instance-Info"]=u),l=new FormData,n.forEach((function(e,t){var n=e.file,r=e.path;return i(y,void 0,void 0,(function(){return o(this,(function(e){return l.append("file_".concat(t+1,"_path"),r),l.append("file_".concat(t+1),n),[2]}))}))})),h={Code:1,Message:"Upload failed",FileStatus:null},b.label=1;case 1:return b.trys.push([1,3,,4]),[4,fetch(c,{body:l,cache:"no-cache",method:"POST",mode:"cors",headers:d}).then((function(e){if(200!==e.status)throw new Error("status Code:".concat(e.status));return e.json()})).catch((function(e){throw new Error("".concat(e.name,": ").concat(e.message))}))];case 2:return p=b.sent(),f=p.Code,m=p.FileStatus,v=p.Msg,h.Code=f,h.Message=v,h.FileStatus=m,[3,4];case 3:return g=b.sent(),h.Code=1,h.Message="".concat(g.name,": ").concat(g.message),[3,4];case 4:return[2,h];case 5:return[2,{Code:2,Message:"Token or OperatorAddress is empty"}]}}))}))},e.prototype.uploadMedia=function(e){var t=e.instanceId,n=e.files;return i(this,void 0,void 0,(function(){var e,r,s,a,c,d,u,l,h,p,f,m,v,g=this;return o(this,(function(y){switch(y.label){case 0:if(e=this.getInstanceOperator({instanceId:t}),r=e.Token,s=e.OperatorAddress,a=e.EdgeProxyAddress,!r||!s)return[3,5];c="".concat(a||s,"/CAIUploadMedia?instance_id=").concat(t,"&token=").concat(r),d={},(u=this.sdk.accessInfo.getInstanceInfoHeader({instanceId:t}).instanceInfo)&&(d["Crtr-Proxy-Instance-Info"]=u),l=new FormData,n.forEach((function(e,t){var n=e.file;return i(g,void 0,void 0,(function(){return o(this,(function(e){return l.append("file_".concat(t+1),n),[2]}))}))})),h={Code:1,Message:"Upload media failed",FileStatus:null},y.label=1;case 1:return y.trys.push([1,3,,4]),[4,fetch(c,{body:l,cache:"no-cache",method:"POST",mode:"cors",headers:d}).then((function(e){if(200!==e.status)throw new Error("status Code:".concat(e.status));return e.json()})).catch((function(e){throw new Error("".concat(e.name,": ").concat(e.message))}))];case 2:return p=y.sent(),f=p.Code,m=p.Msg,h.Code=f,h.Message=m,[3,4];case 3:return v=y.sent(),h.Code=1,h.Message="".concat(v.name,": ").concat(v.message),[3,4];case 4:return[2,h];case 5:return[2,{Code:2,Message:"Token or OperatorAddress is empty"}]}}))}))},e.prototype.getInstanceDownloadAddress=function(e){var t=e.instanceId,n=e.path,r=this.getInstanceOperator({instanceId:t}),i=r.Token,o=r.OperatorAddress,s=r.EdgeProxyAddress;if(i&&o){var a=s||o,c=this.sdk.accessInfo.getInstanceInfoHeader({instanceId:t,method:"GET"}).instanceInfo;return{address:"".concat(a,"/CAIDownload?instance_id=").concat(t,"&path=").concat(n,"&token=").concat(i)+"".concat(c||"")}}return{address:null}},e.prototype.getInstanceDownloadLogcatAddress=function(e){var t=e.instanceId,n=e.recentDays,r=this.getInstanceOperator({instanceId:t}),i=r.Token,o=r.OperatorAddress,s=r.EdgeProxyAddress;if(i&&o){var a=s||o,c=this.sdk.accessInfo.getInstanceInfoHeader({instanceId:t,method:"GET"}).instanceInfo;return{address:"".concat(a,"/CAIDownloadLogcat?instance_id=").concat(t,"&recent_day=").concat(n,"&token=").concat(i)+"".concat(c||"")}}return{address:null}},e.prototype.batchTask=function(e){var t,n,l,h,p=e.taskType,f=e.params;return i(this,void 0,void 0,(function(){var e,i,m,v,g,y,b,k;return o(this,(function(C){switch(C.label){case 0:e={},this.sdk.log("batchTask taskType",p,"batchTask params",f),i=this.getOperatorAddresses({instanceIds:Object.keys(f)}),C.label=1;case 1:C.trys.push([1,7,8,13]),m=function(){var t,n,i,s,l,m,y,k,C,S,_,w,T,E,R,O,M,P,D,x,I,A,L,j;return o(this,(function(o){switch(o.label){case 0:h=b.value,g=!1,t=a(h,2),n=t[0],i=t[1],s="".concat(n,"/CAIOperator/BatchTask"),l={},(m=v.sdk.accessInfo.getInstanceInfoHeader({instanceId:i[0]}).instanceInfo)&&(l.InstanceInfo=m),y=v.sdk.accessInfo.getInstancesInfo({instanceIds:i}).InstancesInfo,k={},C=v.sdk.accessInfo.getTokenInfos({instanceIds:i}),i.forEach((function(e){k[e]="ModifySensor"===p?r(r({},f[e]),{Accuracy:3}):f[e]})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,(0,u.fetchPost)({url:s,data:{RequestID:(0,d.v4)(),TaskType:p,TokenInfos:C,InstancesInfo:y,Params:k},headers:l})];case 2:if(S=o.sent(),_=S.Code,w=S.Message,T=S.SuccResult,E=S.FailResult,0===_)e=r(r(r({},e),T),E);else try{for(I=void 0,R=c(i),O=R.next();!O.done;O=R.next())x=O.value,e[x]={Code:_,Msg:w}}catch(e){I={error:e}}finally{try{O&&!O.done&&(A=R.return)&&A.call(R)}finally{if(I)throw I.error}}return[3,4];case 3:M=o.sent();try{for(L=void 0,P=c(i),D=P.next();!D.done;D=P.next())x=D.value,e[x]={Code:-1,Msg:M.message}}catch(e){L={error:e}}finally{try{D&&!D.done&&(j=P.return)&&j.call(P)}finally{if(L)throw L.error}}return[3,4];case 4:return[2]}}))},v=this,g=!0,y=s(Object.entries(i)),C.label=2;case 2:return[4,y.next()];case 3:return b=C.sent(),(t=b.done)?[3,6]:[5,m()];case 4:C.sent(),C.label=5;case 5:return g=!0,[3,2];case 6:return[3,13];case 7:return k=C.sent(),n={error:k},[3,13];case 8:return C.trys.push([8,,11,12]),g||t||!(l=y.return)?[3,10]:[4,l.call(y)];case 9:C.sent(),C.label=10;case 10:return[3,12];case 11:if(n)throw n.error;return[7];case 12:return[7];case 13:return[2,e]}}))}))},e.prototype.getOperatorAddresses=function(e){var t=this,n=e.instanceIds,r={};return n.forEach((function(e){var n=t.getInstanceOperator({instanceId:e})||{},i=n.OperatorAddress,o=n.EdgeProxyAddress||i;o?r[o]?r[o].push(e):r[o]=[e]:t.sdk.log("getOperatorAddresses instanceId",e,"not found")})),r},e}();t.default=l},5262:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0,t.config={version:"2.1.6",lite:!1,privatization:{server:""}}},8751:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraProfile=void 0,t.CameraProfile={"120p":{width:160,height:120,frameRate:30,bitrate:200,type:"120p"},"180p":{width:320,height:180,frameRate:30,bitrate:350,type:"180p"},"240p":{width:320,height:240,frameRate:30,bitrate:400,type:"240p"},"360p":{width:640,height:360,frameRate:30,bitrate:800,type:"360p"},"480p":{width:640,height:480,frameRate:30,bitrate:900,type:"480p"},"720p":{width:1280,height:720,frameRate:30,bitrate:1500,type:"720p"},"1080p":{width:1920,height:1080,frameRate:30,bitrate:2e3,type:"1080p"}}},9418:(e,t)=>{"use strict";var n,r,i,o,s,a,c,d,u,l,h,p;Object.defineProperty(t,"__esModule",{value:!0}),t.ANSWER_SDP_CODE=t.PROXY_CODE=t.MOUSE_EVENT_TYPE=t.TOUCH_EVENT_TYPE=t.WEB_DRAFT_LEVEL=t.DATACHANNEL=t.CONNECT_FAILED_CODE=t.RTC_CODE=t.CURSOR_MODE=t.STATUS=t.PAGE_STATS=t.STATS=void 0,function(e){e.LOADING="loading",e.PLAYING="playing",e.ENDED="ended"}(n||(t.STATS=n={})),function(e){e.LOADING="loading",e.PLAYING="playing",e.ENDED="ended"}(r||(t.PAGE_STATS=r={})),function(e){e[e.DISCONNECTED=0]="DISCONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.ESTABLISHED=2]="ESTABLISHED"}(i||(t.STATUS=i={})),function(e){e[e.LOCAL=0]="LOCAL",e[e.REMOTE_SRC=1]="REMOTE_SRC",e[e.REMOTE_DRAW=2]="REMOTE_DRAW",e[e.REMOTE_CUSTOM=3]="REMOTE_CUSTOM",e[e.REMOTE_SRC_POS=4]="REMOTE_SRC_POS",e[e.FRONT_DRAW_DELTA_POS=5]="FRONT_DRAW_DELTA_POS"}(o||(t.CURSOR_MODE=o={})),function(e){e[e.CREATE_OFFER_FAILED=-2]="CREATE_OFFER_FAILED",e[e.NEED_RECONNECT=-1]="NEED_RECONNECT",e[e.MANUAL_CLOSE=0]="MANUAL_CLOSE",e[e.OTHER_KICK=1]="OTHER_KICK",e[e.HEARTBEAT_TIMEOUT=2]="HEARTBEAT_TIMEOUT",e[e.CONNECT_FAILED=3]="CONNECT_FAILED",e[e.TOKEN_ERROR=4]="TOKEN_ERROR"}(s||(t.RTC_CODE=s={})),function(e){e[e.TOO_FREQUENTLY=-1]="TOO_FREQUENTLY",e[e.AUTO_RECONNECTING=-2]="AUTO_RECONNECTING",e[e.EXCEEDED_LIMIT_RERTY_TIMES=-3]="EXCEEDED_LIMIT_RERTY_TIMES",e[e.FETCH_ERROR=-4]="FETCH_ERROR",e[e.INVALID_SERVER_SESSION=-5]="INVALID_SERVER_SESSION",e[e.MODE_FORBIDDEN=-6]="MODE_FORBIDDEN"}(a||(t.CONNECT_FAILED_CODE=a={})),function(e){e.ACK="ack",e.HB="hb",e.CD="cd",e.KM="km",e.SVR="svr",e.SV="sv",e.CLOUD_DEVICE="cloud_device"}(c||(t.DATACHANNEL=c={})),function(e){e[e.CLOSE_HIGH_FREQUENCY=0]="CLOSE_HIGH_FREQUENCY",e[e.UNPACKAGE_SEND=1]="UNPACKAGE_SEND",e[e.PACKAGE_SEND=2]="PACKAGE_SEND",e[e.LIMIT_LENGTH=3]="LIMIT_LENGTH"}(d||(t.WEB_DRAFT_LEVEL=d={})),function(e){e[e.touchstart=0]="touchstart",e[e.touchmove=1]="touchmove",e[e.touchend=2]="touchend",e[e.touchcancel=2]="touchcancel"}(u||(t.TOUCH_EVENT_TYPE=u={})),function(e){e[e.mousedown=0]="mousedown",e[e.mousemove=1]="mousemove",e[e.mouseup=2]="mouseup"}(l||(t.MOUSE_EVENT_TYPE=l={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.STREAM_NOT_FOUND=4e3]="STREAM_NOT_FOUND",e[e.STREAM_EXIST=4001]="STREAM_EXIST",e[e.PARAM_ERROR=4002]="PARAM_ERROR",e[e.SERVER_ERROR=5e3]="SERVER_ERROR",e[e.BACK_TO_SOURCE_ERROR=5001]="BACK_TO_SOURCE_ERROR",e[e.BACK_TO_SOURCE_REQ_PARAM_ERROR=5002]="BACK_TO_SOURCE_REQ_PARAM_ERROR",e[e.BACK_TO_SOURCE_RES_PARAM_ERROR=5003]="BACK_TO_SOURCE_RES_PARAM_ERROR"}(h||(t.PROXY_CODE=h={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.BUSY=1]="BUSY",e[e.TOKEN_ERROR=2]="TOKEN_ERROR",e[e.SDP_ERROR=6]="SDP_ERROR",e[e.WAIT_HOST=8]="WAIT_HOST",e[e.PLAYERS_NUMBER_OR_ROLE_LIMIT=9]="PLAYERS_NUMBER_OR_ROLE_LIMIT",e[e.PROXY_ERROR=100]="PROXY_ERROR"}(p||(t.ANSWER_SDP_CODE=p={}))},1587:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.KEYCODE=void 0,function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.CapsLock=20]="CapsLock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Zero=48]="Zero",e[e.ClosedParen=48]="ClosedParen",e[e.One=49]="One",e[e.ExclamationMark=49]="ExclamationMark",e[e.Two=50]="Two",e[e.AtSign=50]="AtSign",e[e.Three=51]="Three",e[e.PoundSign=51]="PoundSign",e[e.Hash=51]="Hash",e[e.Four=52]="Four",e[e.DollarSign=52]="DollarSign",e[e.Five=53]="Five",e[e.PercentSign=53]="PercentSign",e[e.Six=54]="Six",e[e.Caret=54]="Caret",e[e.Hat=54]="Hat",e[e.Seven=55]="Seven",e[e.Ampersand=55]="Ampersand",e[e.Eight=56]="Eight",e[e.Star=56]="Star",e[e.Asterik=56]="Asterik",e[e.Nine=57]="Nine",e[e.OpenParen=57]="OpenParen",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.Numpad0=96]="Numpad0",e[e.Numpad1=97]="Numpad1",e[e.Numpad2=98]="Numpad2",e[e.Numpad3=99]="Numpad3",e[e.Numpad4=100]="Numpad4",e[e.Numpad5=101]="Numpad5",e[e.Numpad6=102]="Numpad6",e[e.Numpad7=103]="Numpad7",e[e.Numpad8=104]="Numpad8",e[e.Numpad9=105]="Numpad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.SemiColon=186]="SemiColon",e[e.Equals=187]="Equals",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.UnderScore=189]="UnderScore",e[e.PlusSign=187]="PlusSign",e[e.ForwardSlash=191]="ForwardSlash",e[e.Tilde=192]="Tilde",e[e.GraveAccent=192]="GraveAccent",e[e.Backquote=192]="Backquote",e[e.OpenBracket=219]="OpenBracket",e[e.ClosedBracket=221]="ClosedBracket",e[e.Quote=222]="Quote"}(n||(t.KEYCODE=n={}))},1252:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.DataChannelProtocols=t.MediaCodecs=void 0,function(e){e[e.opus=101]="opus",e[e.aac=102]="aac",e[e.h264=103]="h264",e[e.h265=104]="h265",e[e.vp8=105]="vp8",e[e.vp9=106]="vp9"}(n||(t.MediaCodecs=n={})),function(e){e[e.open=10]="open",e[e.message=11]="message"}(r||(t.DataChannelProtocols=r={}))},4993:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CloudGamingWebSDK=void 0;var d=c(n(6994)),u=n(5262),l=n(9418),h=c(n(124)),p=c(n(6859)),f=n(869),m=n(1743),v=c(n(3371)),g=c(n(5447)),y=c(n(969)),b=c(n(3241)),k=c(n(2371)),C=c(n(4415)),S=c(n(1862)),_=n(453),w=function(e){function t(){var t=e.call(this)||this;return t.version=u.config.version,t.cloudGamingWebRTC=null,t.pageEvent=null,t.cloudGamingWebsocket=null,t.androidInstance=null,t.accessInfo=null,t.gamepad=null,t.watchdog=null,t.gameConfig=null,t.showStats=null,t.initOptions={mount:null,reconnect:!0,autoSwitchCamera:!0,autoSwitchMic:!0,streaming:{mode:"webrtc",streamName:"high"},androidInstance:{autoRotateOnPC:!0},autoFocusVideo:!1,statsInterval:1},t.uuid=null,t.sdkInitStartTime=null,t._mobileGame=!1,t._accessTime=0,t.cloudGamingWebRTC=new h.default({sdk:t}),t.pageEvent=new p.default({sdk:t}),t.androidInstance=new _.AndroidInstance({sdk:t}),t.accessInfo=new S.default({sdk:t}),t.gamepad=new y.default({sdk:t}),t.watchdog=new b.default({sdk:t}),t.gameConfig=new k.default({sdk:t}),t.showStats=new v.default({sdk:t}),t.cloudGamingWebsocket=new C.default({sdk:t}),t.uuid=+new Date,t}return i(t,e),Object.defineProperty(t.prototype,"mountPoint",{get:function(){return null===document||void 0===document?void 0:document.querySelector("#".concat(this.initOptions.mount))},enumerable:!1,configurable:!0}),t.prototype.init=function(e){return s(this,void 0,void 0,(function(){var t,n,r,i,s,c;return a(this,(function(a){switch(a.label){case 0:return this.initLoggerConfig(e),this.sdkInitStartTime=+new Date,this.initOptions=o(o({},this.initOptions),e),t=e.mount,n=e.loadingText,r=e.showLoading,i=e.restartText,s=e.accessToken,c=e.mobileGame,this._mobileGame=c,this.mountGamePoint({mount:t,loadingText:n,showLoading:r,restartText:i}),this.log("init tcgsdk version->",u.config.version,"options->",e),this.log("webrtc-adapter",d.default.browserDetails.browser,d.default.browserDetails.version),e.onLog&&this.setExternalLog(e.onLog),(null==s?void 0:s.accessInfo)&&this.accessInfo.setInstanceAccessInfo({AccessInfo:s.accessInfo,Token:s.token}),this.pageEvent.init(e),this.showStats.init({mount:this.initOptions.mount}),this.watchdog.init({mount:this.initOptions.mount}),this.androidInstance.init(e),"webrtc"!==this.streamingMode?[3,2]:[4,this.cloudGamingWebRTC.init(e)];case 1:return a.sent(),[3,3];case 2:this.cloudGamingWebsocket.init({mount:this.initOptions.mount}),this.onInitSuccess({code:0,msg:"ok"}),a.label=3;case 3:return this.setDebugMode(e.debugSetting),this.log("init->",this.initOptions),this.log("userAgent",null===navigator||void 0===navigator?void 0:navigator.userAgent),[2]}}))}))},t.prototype.initShowStats=function(){this.showStats=new v.default({sdk:this}),this.showStats.init({mount:this.initOptions.mount})},Object.defineProperty(t.prototype,"streamingMode",{get:function(){var e;return(null===(e=this.initOptions.streaming)||void 0===e?void 0:e.mode)||"webrtc"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initStartTime",{get:function(){return this.cloudGamingWebRTC.webrtcStartTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accessTime",{get:function(){return this._accessTime},set:function(e){this._accessTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobileGame",{get:function(){return this._mobileGame},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mobileGame",{set:function(e){this._mobileGame=e},enumerable:!1,configurable:!0}),t.prototype.getIsMobileGame=function(){return this._mobileGame},t.prototype.getAndroidInstance=function(){return this.androidInstance},t.prototype.getInitOptions=function(){return this.initOptions},t.prototype.getClientSession=function(){return this.cloudGamingWebRTC.getClientSideDescription(!0)},t.prototype.getServerSession=function(e){var t=(void 0===e?m.empty:e).clientId,n=void 0===t?this.initOptions.mount:t;return this.gameConfig.getConfig({clientId:n})},t.prototype.start=function(e){void 0===e&&(e=""),this.accessTime=+new Date,this.showStats.addEventReport({event_code:"start"}),this.cloudGamingWebRTC.connect(e)},t.prototype.setAccessToken=function(e){var t=e.accessInfo,n=e.token;this.accessInfo.setInstanceAccessInfo({AccessInfo:t,Token:n})},t.prototype.access=function(e){var t=e.instanceId,n=void 0===t?"":t,r=e.instanceIds,i=void 0===r?[]:r,o=e.groupControl,c=void 0!==o&&o;return s(this,void 0,void 0,(function(){var e,t,r,o,s,d,u,h,p,f,m,v,g,y,b;return a(this,(function(a){switch(a.label){case 0:if(this.accessTime=+new Date,this.showStats.addEventReport({event_code:"access",i1:c?1:0}),"websocket"===this.streamingMode)return e=this.accessInfo.getInstanceAccessInfo({instanceId:c?i[0]:n}),t=e.Token,r=e.WebSocketAddress,o=e.WebSocketSecureAddress,s=o,"http:"===window.location.protocol&&(s=r),c?(d=this.accessInfo.getTokenInfos({instanceIds:i}),[2,this.androidInstance.groupControl.startWebSocket({tokenInfos:d,url:s,instanceIds:i})]):[2,this.cloudGamingWebsocket.connect({url:s,protocols:["media-v1"],token:t,instanceId:n,videoCodecList:this.initOptions.streaming.videoCodecList})];if(!c)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.accessInfo.createWebRTCGroupSession({instanceIds:i,clientSessions:[this.getClientSession()]})];case 2:return u=a.sent(),h=u.GroupControlId,p=u.ServerSessions,g=u.Code,y=u.Message,0===g?this.androidInstance.groupControl.start({instanceIds:i,groupControlId:h,serverSessions:p}):this.onConnectFailed({code:g,msg:y}),[3,4];case 3:return f=a.sent(),this.onConnectFailed({code:l.CONNECT_FAILED_CODE.FETCH_ERROR,msg:"fetch group server session error, ".concat(f.message)}),[3,4];case 4:return[3,8];case 5:return a.trys.push([5,7,,8]),[4,this.accessInfo.createWebRTCSession({instanceId:n,clientSession:this.getClientSession()})];case 6:return m=a.sent(),v=m.ServerSession,g=m.Code,y=m.Message,0===g?this.cloudGamingWebRTC.connect(v):this.onConnectFailed({code:g,msg:y}),[3,8];case 7:return b=a.sent(),this.onConnectFailed({code:l.CONNECT_FAILED_CODE.FETCH_ERROR,msg:"fetch server session error, ".concat(b.message)}),[3,8];case 8:return[2]}}))}))},t.prototype.destroy=function(e){var t=void 0===e?m.empty:e,n=t.message,r=void 0===n?"主动关闭":n,i=t.code,o=void 0===i?l.RTC_CODE.MANUAL_CLOSE:i;this.log("destroy->","message: ",r,"code: ",o),"webrtc"===this.streamingMode?this.cloudGamingWebRTC.disconnected({message:r,code:o}):this.cloudGamingWebsocket.destroy({message:r,code:o}),this.androidInstance.groupControl.destroy()},t.prototype.reconnect=function(){"webrtc"===this.streamingMode?(this.cloudGamingWebRTC.clearPeerConnection(),this.cloudGamingWebRTC.reconnect({message:"manual reconnect"})):this.cloudGamingWebsocket.reconnect({message:"manual reconnect"})},t.prototype.gameRestart=function(){this.log("gameRestart->"),this.cloudGamingWebRTC.sendAckData({data:{type:"game_op",op:"restart"}}),this.clearRemoteKeys()},t.prototype.gamePause=function(e){var t=(void 0===e?m.empty:e).media;this.log("gamePause->"),this.cloudGamingWebRTC.sendAckData({data:{type:"game_op",op:"pause",media:t}}),this.cloudGamingWebRTC.setGameStatus("pause"),this.clearRemoteKeys()},t.prototype.gameResume=function(e){var t=(void 0===e?m.empty:e).media;this.log("gameResume->"),this.cloudGamingWebRTC.sendAckData({data:{type:"game_op",op:"resume",media:t}}),this.cloudGamingWebRTC.setGameStatus("playing"),this.clearRemoteKeys()},t.prototype.sendKeyboardEvent=function(e){var t=e.key,n=e.down,r=e.location,i=void 0===r?0:r;"websocket"===this.streamingMode?this.cloudGamingWebsocket.dataChannelSend({label:l.DATACHANNEL.KM,data:{type:"keyboard",key:t,down:n,location:i}}):this.cloudGamingWebRTC.sendKmData({type:"keyboard",key:t,down:n,location:i})},t.prototype.sendMouseEvent=function(e){var t=e.type,n=e.down,r=e.delta;this.cloudGamingWebRTC.sendKmData({type:t,down:n,delta:r})},t.prototype.sendGamepadEvent=function(e){var t=e.type,n=e.down,r=e.key,i=e.x,o=e.y;this.cloudGamingWebRTC.sendKmData({type:t,down:n,key:r,x:i,y:o})},t.prototype.sendRawEvent=function(e){switch(this.log("sendRawEvent->",e),"object"!=typeof e&&console.error("data is not an object"),!0){case"keyboard"===e.type:this.sendKeyboardEvent(e);break;case e.type.includes("mouse"):this.sendMouseEvent(e);break;case e.type.includes("gamepad")||e.type.includes("axis")||e.type.includes("lt")||e.type.includes("rt"):this.sendGamepadEvent(e);break;default:this.cloudGamingWebRTC.sendAckData({data:e})}},t.prototype.sendKmData=function(e){this.cloudGamingWebRTC.sendKmData(e)},t.prototype.setMoveSensitivity=function(e){this.log("setMoveSensitivity->",e),"number"!=typeof e&&console.error("input value must be number"),(e-.01<Number.EPSILON||e-100>Number.EPSILON)&&console.error("sensitivity is out of range"),this.pageEvent.setMoveSensitivity(e)},t.prototype.sendSeqRawEvents=function(e){this.log("sendSeqRawEvents->",e),this.cloudGamingWebRTC.sendKmData({type:"key_seq",keys:e.map((function(e){return JSON.stringify(e)}))})},t.prototype.getMoveSensitivity=function(){return this.pageEvent?1/this.pageEvent.getMoveSensitivity():1},t.prototype.setMouseCanLock=function(e){this.log("setMouseCanLock->",e),this.cloudGamingWebRTC.lockMouse(e),this.cloudGamingWebRTC.setForceShowCursor(!e)},t.prototype.lockMouse=function(e){this.log("lockMouse->",e),this.cloudGamingWebRTC.setForceLockCursor(e),this.cloudGamingWebRTC.lockMouse(e)},t.prototype.mouseMove=function(e,t,n,r){this.pageEvent.mouseMove(e,t,n,r)},t.prototype.setRemoteCursor=function(e){void 0===e&&(e=0),this.log("setRemoteCursor->",e),this.cloudGamingWebRTC.setCursorMode(e)},t.prototype.setCursorShowStat=function(e){this.log("setCursorShowStat->",e),this.cloudGamingWebRTC.setForceShowCursor(e)},t.prototype.setCursorShowStatus=function(e){this.log("setCursorShowStat->",e),this.cloudGamingWebRTC.setForceShowCursor(e)},t.prototype.setCursorState=function(e){"forceShow"===e&&(this.cloudGamingWebRTC.setForceShowCursor(!0),this.lockMouse(!1)),"forceLock"===e&&(this.cloudGamingWebRTC.setForceShowCursor(!1),this.lockMouse(!0)),"auto"===e&&(this.cloudGamingWebRTC.setForceShowCursor(!1),this.cloudGamingWebRTC.setForceLockCursor(!1))},t.prototype.getCursorShowStat=function(){return this.log("getCursorShowStat->",this.cloudGamingWebRTC.getCursorShowStatus()),this.cloudGamingWebRTC.getCursorShowStatus()},t.prototype.setMobileCursorScale=function(e){this.log("setMobileCursorScale->",e),this.cloudGamingWebRTC.setMobileCursorScale(e)},t.prototype.setRemoteCursorStyle=function(e){this.log("setRemoteCursorStyle->",e),this.cloudGamingWebRTC.sendAckData({data:{type:"set_pointer_style",style:e}})},t.prototype.clearRemoteKeys=function(){this.log("clearRemoteKeys->"),this.pageEvent.clearRemoteKeys()},t.prototype.resetRemoteCapsLock=function(){this.log("resetRemoteCapsLock->"),this.cloudGamingWebRTC.sendAckData({data:{type:"reset_capslock"}})},t.prototype.setDefaultCursorImage=function(e){this.log("setDefaultCursorImage->",e),e&&this.cloudGamingWebRTC.setDefaultCursorImage(e)},t.prototype.setKMStatus=function(e){var t=e.keyboard,n=void 0===t||t,r=e.mouse,i=void 0===r||r;this.pageEvent.setKMStatus({keyboard:n,mouse:i})},t.prototype.setKeyboardBanList=function(e){var t=e.keyList;this.pageEvent.setKeyboardBanList({keyList:t})},t.prototype.setPaste=function(e){this.pageEvent.setPaste(e)},t.prototype.mobileTouchMove=function(e){var t=e.finger_id,n=e.event_type,r=e.x,i=e.y,o=this.pageEvent.remoteScreenSize,s=o.width,a=o.height;this.pageEvent.mobileTouchMove({finger_id:t,event_type:n,x:r,y:i,width:s,height:a,timestamp:+new Date})},t.prototype.setDebugMode=function(e){var t=void 0===e?{}:e,n=t.showStats,r=void 0!==n&&n,i=t.showLog,s=void 0!==i&&i,a=t.showOnAckMessage,c=void 0!==a&&a,d=t.showOnCdMessage,u=void 0!==d&&d,l=t.showOnHbMessage,h=void 0!==l&&l,p=t.showOnKmMessage,f=void 0!==p&&p,m=t.showOnSvMessage,v=void 0!==m&&m,g=t.showOnCloudDeviceMessage,y=void 0!==g&&g,b=t.showSendAckData,k=void 0!==b&&b,C=t.showSendHbData,S=void 0!==C&&C,_=t.showSendKmData,w=void 0!==_&&_,T=t.showSendCloudDeviceData,E=void 0!==T&&T,R=t.showMuxer,O=void 0!==R&&R;this.showStats.show(r),this.initOptions.debugSetting||(this.initOptions.debugSetting={}),this.initOptions.debugSetting=o(o({},this.initOptions.debugSetting),{showLog:s,showOnAckMessage:c,showOnCdMessage:u,showOnHbMessage:h,showOnKmMessage:f,showOnSvMessage:v,showOnCloudDeviceMessage:y,showSendAckData:k,showSendHbData:S,showSendKmData:w,showSendCloudDeviceData:E,showMuxer:O})},t.prototype.reportLog=function(){return this.log("reportLog, user manual upload"),this.reportLogInner()},t.prototype.setLogHandler=function(e){void 0===e&&(e=m.noop),this.log("setLogHandler"),this.setExternalLog(e)},t.prototype.toggleMetricReportBulk=function(e){void 0===e&&(e=!1),this.showStats.toggleMetricReportBulk(e)},t.prototype.playVideo=function(e){var t=this.getVideoElement();return"play"===e?null==t?void 0:t.play():"pause"===e?null==t?void 0:t.pause():void 0},t.prototype.playAudio=function(e){var t=this.getAudioElement();"play"===e&&(null==t||t.play()),"pause"===e&&(null==t||t.pause());var n=this.getHuaweiAudioElement();n&&("play"===e&&n.play(),"pause"===e&&n.pause())},t.prototype.setVideoOrientation=function(e){var t=void 0===e?{}:e,n=t.deg,r=void 0===n?0:n,i=t.rotateContainer,o=void 0===i||i,s=t.rotateMountPoint,a=void 0!==s&&s;this.log("setVideoOrientation",r,o),this.pageEvent.setVideoOrientation({deg:r,rotateContainer:o,rotateMountPoint:a})},t.prototype.getPageSize=function(){return{width:window.innerWidth,height:window.innerHeight}},t.prototype.setStreamProfile=function(e,t){var n,r;void 0===t&&(t=m.noop),this.log("setStreamProfile->",e);var i=this.pageEvent.getRemoteScreenConfig().deg,s=e.video_width,a=e.video_height;90===i||270===i?null===(n=this.cloudGamingWebRTC)||void 0===n||n.sendAckData({data:o(o({},e),{video_width:a,video_height:s,type:"res_mode"}),callback:t}):null===(r=this.cloudGamingWebRTC)||void 0===r||r.sendAckData({data:o(o({},e),{type:"res_mode"}),callback:t})},t.prototype.getDisplayRect=function(){return this.cloudGamingWebRTC.getDisplayRect()},t.prototype.setVideoVolume=function(e){this.log("setVideoVolume->",e),this.getVideoElement().volume=e,0===e?(this.getVideoElement().muted=!0,"websocket"===this.streamingMode&&(this.getAudioElementWebsocket().muted=!0,this.getAudioElementWebsocket().volume=e),this.pageEvent.setVideoMuted(!0)):(this.getVideoElement().muted=!1,"websocket"===this.streamingMode&&(this.getAudioElementWebsocket().volume=e),this.pageEvent.setVideoMuted(!1),this.playVideo("play"))},t.prototype.setAudioVolume=function(e){this.log("setAudioVolume->",e);var t=this.getHuaweiAudioElement();t&&(this.log("huawei setVideoVolume->",e),t.volume=e);var n=this.getAudioElement();n.volume=e,0===e?(n.muted=!0,"websocket"===this.streamingMode&&(this.getAudioElementWebsocket().muted=!0,this.getAudioElementWebsocket().volume=e),this.pageEvent.setVideoMuted(!0)):(n.muted=!1,"websocket"===this.streamingMode&&(this.getAudioElementWebsocket().volume=e),this.pageEvent.setVideoMuted(!1),this.playAudio("play"))},t.prototype.getAudioVolume=function(){var e;return null!==(e=this.getAudioElement().volume)&&void 0!==e?e:0},t.prototype.getVideoVolume=function(){var e;return null!==(e=this.getVideoElement().volume)&&void 0!==e?e:0},t.prototype.switchMic=function(e){var t=e.status,n=e.profile;return this.cloudGamingWebRTC.switchMic({status:t,profile:n})},t.prototype.switchCamera=function(e){var t=e.status,n=e.profile;return this.cloudGamingWebRTC.switchCamera({status:t,profile:n})},t.prototype.setMicProfile=function(e){return this.cloudGamingWebRTC.setMicProfile(e)},t.prototype.setCameraProfile=function(e){return this.cloudGamingWebRTC.setCameraProfile(e)},t.prototype.getDevices=function(){return this.cloudGamingWebRTC.getDevices()},t.prototype.setPageBackground=function(e){void 0===e&&(e=""),this.log("setPageBackground->",e);var t=this.getCloudGamingStreamContainerElement();t&&(t.style.background="url(".concat(e,")"))},t.prototype.sendText=function(e,t){void 0===e&&(e=""),void 0===t&&(t=m.noop),this.log("sendText",e),"webrtc"===this.streamingMode?this.cloudGamingWebRTC.sendAckData({data:{type:"paste",content:e},callback:t}):this.cloudGamingWebsocket.dataChannelSend({label:l.DATACHANNEL.ACK,data:{type:"paste",content:e}})},t.prototype.setClientInteractMode=function(e){void 0===e&&(e="cursor"),this.log("setClientInteractMode->",e),this.pageEvent.setClientInteractMode(e)},t.prototype.setRemoteDesktopResolution=function(e){var t=this,n=e.width,r=e.height;return this.log("setRemoteDesktopResolution, width",n,"height",r),new Promise((function(e){t.cloudGamingWebRTC.sendAckData({data:{type:"desktop_res",width:Math.floor(n),height:Math.floor(r)},callback:function(t){var n=t.data;e(void 0===n?{code:-1}:n)}})}))},t.prototype.getRemoteStreamResolution=function(){if(this.getVideoElement().videoWidth&&this.getVideoElement().videoHeight)return{width:this.getVideoElement().videoWidth,height:this.getVideoElement().videoHeight};var e=this.gameConfig.getConfig({clientId:this.initOptions.mount}).video,t=void 0===e?{}:e,n=t.width,r=void 0===n?0:n,i=t.height;return{width:r,height:void 0===i?0:i}},t.prototype.reshapeWindow=function(e){void 0===e&&(e="user"),this.pageEvent.reshapeWindow(e)},t.prototype.getUserMedia=function(){return this.cloudGamingWebRTC.getUserMedia()},t.prototype.screenShot=function(e){var t=e.name,n=void 0===t?"tcgsdk-".concat(+new Date):t,r=e.width,i=void 0===r?this.getVideoElement().videoWidth:r,o=e.height,s=void 0===o?this.getVideoElement().videoHeight:o,a=(0,m.createOffscreenCanvas)(i,s);a.getContext("2d").drawImage(this.getVideoElement(),0,0,i,s);var c=document.createElement("a");c.setAttribute("download","".concat(n,".png")),a.toBlob((function(e){var t=URL.createObjectURL(e);c.setAttribute("href",t),c.click()}))},t.prototype.createCustomDataChannel=function(e){var t=e.destPort,n=e.maxRetransmits,r=e.maxPacketLifeTime,i=e.onMessage,o=e.protocol,c=void 0===o?"text":o,d=e.type,u=void 0===d?"":d;return s(this,void 0,void 0,(function(){var e,o,s,d=this;return a(this,(function(a){switch(a.label){case 0:return[4,this.cloudGamingWebRTC.createCustomDataChannel({destPort:t,maxRetransmits:n,maxPacketLifeTime:r,protocol:c,type:u,onMessage:i,onError:function(e){d.log("createCustomDataChannel onerror",e)},onClose:function(e){d.log("createCustomDataChannel onclose",e)}})];case 1:return e=a.sent(),o=e.code,s=e.msg,[2,{sendMessage:function(e){d.cloudGamingWebRTC.sendCustomDataChannelMessage({destPort:t,msg:e})},code:o,msg:s}]}}))}))},t.prototype.getPlayerVolume=function(e){return document.getElementById("".concat(e,"A")).volume},t.prototype.setPlayerVolume=function(e,t){this.log("setPlayerVolume->",t);var n=document.getElementById("".concat(e,"A"));0===t?n.muted=!0:(n.muted=!1,n.volume=t,n.play())},t.prototype.getSeats=function(){var e=this;return new Promise((function(t){e.cloudGamingWebRTC.sendAckData({data:{type:"sync_seats"},callback:function(e){var n=e.code,r=e.data,i=r.players,o=r.viewers;0===n&&t({players:i,viewers:o})}})}))},t.prototype.submitSeatChange=function(e){var t=this,n=e.user_id,r=e.to_role,i=e.seat_index,o=void 0===i?0:i;return new Promise((function(e){t.cloudGamingWebRTC.sendAckData({data:{type:"submit_seat_change",user_id:n,to_role:r,seat_index:o},callback:function(n){var r=n.data,i=void 0===r?{code:-1}:r;t.log("submit_seat_change res",i),e(i)}})}))},t.prototype.seatChange=function(e){var t=this,n=e.user_id,r=e.to_role,i=e.seat_index,o=void 0===i?0:i;return new Promise((function(e){t.cloudGamingWebRTC.sendAckData({data:{type:"seat_change",user_id:n,to_role:r,seat_index:o},callback:function(n){var r=n.data,i=void 0===r?{code:-1}:r;t.log("seat_change res",i),e(i)}})}))},t.prototype.changeMicStatus=function(e){var t=this,n=e.status,r=e.user_id;return new Promise((function(e){t.cloudGamingWebRTC.sendAckData({data:{type:"mic_status",user_id:r,status:n},callback:function(n){var r=n.data,i=void 0===r?{code:-1}:r,o=i.code,s=i.status,a=i.user_id,c=t.gameConfig.getConfig({clientId:t.initOptions.mount}).user_id;0===o&&a===c&&(t.log("changeMicStatus",i),0!==s&&1!==s||a&&t.cloudGamingWebRTC.setTrackEnable({type:"audio",enable:!1}),2===s&&a&&t.cloudGamingWebRTC.setTrackEnable({type:"audio",enable:!0})),e(i)}})}))},t.prototype.onInitSuccess=function(e){var t,n;null===(n=(t=this.initOptions).onInitSuccess)||void 0===n||n.call(t,e),this.trigger("InitSuccess",e)},t.prototype.onConnectSuccess=function(e){var t,n;this.log("onConnectSuccess ->"),null===(n=(t=this.initOptions).onConnectSuccess)||void 0===n||n.call(t,e),this.trigger("ConnectSuccess",e),this.androidInstance.groupControl.groupControlId&&"webrtc"===this.streamingMode&&this.androidInstance.groupControl.onConnectSuccess()},t.prototype.onDisconnect=function(e){var t,n;null===(n=(t=this.initOptions).onDisconnect)||void 0===n||n.call(t,e),this.trigger("Disconnected",e)},t.prototype.onConnectFailed=function(e){var t,n;null===(n=(t=this.initOptions).onConnectFail)||void 0===n||n.call(t,e),this.trigger("ConnectFailed",e),this.showStats.addEventReport({event_code:"session_close",event_result_msg:e.msg,event_result_code:"".concat(e.code)})},t.prototype.onEvent=function(e){var t,n;null===(n=(t=this.initOptions).onEvent)||void 0===n||n.call(t,e),this.trigger("Event",e)},t.prototype.onOrientationChange=function(e){var t,n;null===(n=(t=this.initOptions).onOrientationChange)||void 0===n||n.call(t,e),this.trigger("OrientationChange",e)},t.prototype.onVisibilityChange=function(e){var t,n;null===(n=(t=this.initOptions).onVisibilityChange)||void 0===n||n.call(t,e),this.trigger("VisibilityChange",e)},t.prototype.onNetworkChange=function(e){var t,n;null===(n=(t=this.initOptions).onNetworkChange)||void 0===n||n.call(t,e),this.trigger("NetworkChange",e)},t.prototype.onWebrtcStatusChange=function(e){var t,n,r,i;null===(n=(t=this.initOptions).onWebrtcStat)||void 0===n||n.call(t,e),null===(i=(r=this.initOptions).onWebrtcStatusChange)||void 0===i||i.call(r,e),this.trigger("WebrtcStatusChange",e)},t.prototype.onGameStartComplete=function(e){var t,n;null===(n=(t=this.initOptions).onGameStartComplete)||void 0===n||n.call(t,e),this.trigger("GameStartComplete",e)},t.prototype.onGameStop=function(e){var t,n;null===(n=(t=this.initOptions).onGameStop)||void 0===n||n.call(t,e),this.trigger("GameStop",e)},t.prototype.onLoadGameArchive=function(e){var t,n;null===(n=(t=this.initOptions).onLoadGameArchive)||void 0===n||n.call(t,e),this.trigger("LoadGameArchive",e)},t.prototype.onSaveGameArchive=function(e){var t,n;null===(n=(t=this.initOptions).onSaveGameArchive)||void 0===n||n.call(t,e),this.trigger("SaveGameArchive",e)},t.prototype.onInputStatusChange=function(e){var t,n;null===(n=(t=this.initOptions).onInputStatusChange)||void 0===n||n.call(t,e),this.trigger("InputStatusChange",e)},t.prototype.onTouchEvent=function(e){var t,n;null===(n=(t=this.initOptions).onTouchEvent)||void 0===n||n.call(t,e),this.trigger("TouchEvent",e)},t.prototype.onCursorShowStatChange=function(e){var t,n;null===(n=(t=this.initOptions).onCursorShowStatChange)||void 0===n||n.call(t,e),this.trigger("CursorShowStatChange",e)},t.prototype.onGamepadConnectChange=function(e){var t,n;null===(n=(t=this.initOptions).onGamepadConnectChange)||void 0===n||n.call(t,e),this.trigger("GamepadConnectChange",e)},t.prototype.onConfigurationChange=function(e){var t,n;null===(n=(t=this.initOptions).onConfigurationChange)||void 0===n||n.call(t,e),this.trigger("ConfigurationChange",e)},t.prototype.onRemoteScreenResolutionChange=function(e){var t,n;null===(n=(t=this.initOptions).onRemoteScreenResolutionChange)||void 0===n||n.call(t,e),this.trigger("RemoteScreenResolutionChange",e)},t.prototype.onVideoStreamConfigChange=function(e){var t,n;null===(n=(t=this.initOptions).onVideoStreamConfigChange)||void 0===n||n.call(t,e),this.trigger("VideoStreamConfigChange",e)},t.prototype.onDoubleTap=function(e){var t,n;null===(n=(t=this.initOptions).onDoubleTap)||void 0===n||n.call(t,e),this.trigger("DoubleTap",e)},t.prototype.onStreamPushStateChange=function(e){var t,n;null===(n=(t=this.initOptions).onStreamPushStateChange)||void 0===n||n.call(t,e),this.trigger("StreamPushStateChange",e)},t.prototype.onDeviceChange=function(e){var t,n;this.log("onDeviceChange",Event),null===(n=(t=this.initOptions).onDeviceChange)||void 0===n||n.call(t,e),this.trigger("DeviceChange",e)},t.prototype.onGetUserMediaStatusChange=function(e){var t,n,r=e.msg,i=e.type,o=e.userMedia,s="",a=0;switch(r){case"NotFoundError":case"DevicesNotFoundError":s="NotFoundError",a=1;break;case"NotAllowedError":case"PermissionDeniedError":s="NotAllowedError",a=2;break;case"OverconstrainedError":s="OverconstrainedError",a=3;break;default:s=r}null===(n=(t=this.initOptions).onGetUserMediaStatusChange)||void 0===n||n.call(t,{code:a,msg:s,type:i,userMedia:o}),this.trigger("GetUserMediaStatusChange",{code:a,msg:s,type:i,userMedia:o})},t.prototype.onMultiPlayerChange=function(e){var t,n;null===(n=(t=this.initOptions).onMultiPlayerChange)||void 0===n||n.call(t,e),this.trigger("MultiPlayerChange",e)},t.prototype.onAndroidInstanceEvent=function(e){var t,n;null===(n=(t=this.initOptions).onAndroidInstanceEvent)||void 0===n||n.call(t,e),this.trigger("AndroidInstanceEvent",e)},t.prototype.onImageEvent=function(e){var t,n;null===(n=(t=this.initOptions).onImageEvent)||void 0===n||n.call(t,e),this.trigger("ImageEvent",e)},t.prototype.onWebrtcStatsChange=function(e,t){var n,r,i;if(e===l.PAGE_STATS.PLAYING){this.pageEvent.addEventHandler();var o=this.gameConfig.getConfig({clientId:t}).game_config,s=(void 0===o?m.empty:o).sdk_conf,a=void 0===s?m.empty:s;a||(a=m.empty),this.setDefaultCursorImage(null!==(n=this.initOptions.defaultCursorImgUrl)&&void 0!==n?n:a.default_cursor_url),this.setRemoteCursor(null!==(r=this.initOptions.cursorMode)&&void 0!==r?r:a.cursor_mode),this.setPageBackground(null!==(i=this.initOptions.bgImgUrl)&&void 0!==i?i:a.bgimg_url)}},t.prototype.setFullscreen=function(e,t){return void 0===t&&(t=document.documentElement),s(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:this.log("setFullscreen->",e),n.label=1;case 1:return n.trys.push([1,6,,7]),e?[4,this.pageEvent.fullscreen(t)]:[3,3];case 2:return n.sent(),[3,5];case 3:return[4,this.pageEvent.exitFullscreen(t)];case 4:n.sent(),n.label=5;case 5:return[3,7];case 6:throw n.sent();case 7:return[2]}}))}))},t.prototype.getFullscreen=function(){return(0,m.isFullScreen)()},t.prototype.getPageOrientation=function(){return this.pageEvent.getPageOrientation()},t.prototype.isMobile=function(){return(0,m.isMobile)()},t.prototype.getGameConfig=function(e){var t=(void 0===e?m.empty:e).clientId,n=void 0===t?this.initOptions.mount:t;return this.gameConfig.getConfig({clientId:n}).game_config},t.prototype.supportRenegotiation=function(){return(0,m.supportRenegotiation)()},t.prototype.getRequestId=function(){return this.cloudGamingWebRTC.getRequestId()},t.prototype.getGameMountPoint=function(){return document.getElementById(this.initOptions.mount)},t.prototype.getVideoElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".video-stream")},t.prototype.getAudioElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".audio-stream")},t.prototype.getAudioElementWebsocket=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".cloud-gaming-audio-stream-socket")},t.prototype.getHuaweiAudioElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector("#tcg-audio-huawei")},t.prototype.getProgressBarElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".progress-bar-container")},t.prototype.getCursorElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector("#cursor")},t.prototype.getCloudGamingContainerElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".cloud-gaming-container")},t.prototype.getCloudGamingStreamContainerElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".cloud-gaming-stream-container")},t.prototype.getRestartElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".restart")},t.prototype.createAudioAndAddTrack=function(e){var t=e.id,n=e.source,r=document.getElementById(t);r||((r=document.createElement("audio")).id=t,r.autoplay=!0,r.className="audio-stream",r.setAttribute("playsinline","true"),r.setAttribute("webkit-playsinline","true"),r.setAttribute("x5-playsinline","true")),r.srcObject=n,this.getCloudGamingStreamContainerElement().appendChild(r)},t.prototype.getFakeInputElement=function(){var e;return null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector(".tcg-fake-input")},t.prototype.getClientInteractMode=function(){return this.pageEvent.getClientInteractMode()},t.prototype.getRemoteScreenConfig=function(){return this.pageEvent.getRemoteScreenConfig()},t.prototype.showTouchPosition=function(e){this.cloudGamingWebRTC.sendAckData({data:{type:"show_touch_pos",show:e}})},t.prototype.mountGamePoint=function(e){var t=e.mount,n=void 0===t?"":t,r=e.loadingText,i=void 0===r?"正在启动云渲染":r,o=e.showLoading,s=void 0===o||o,a=e.restartText,c=void 0===a?"重新连接":a,d=document.createElement("style");document.querySelector("head").append(d),d.appendChild(document.createTextNode(f.MOUNT_POINT_CSS));var u=document.getElementById(n);u||console.error("mount point is not found"),u.innerHTML=f.HTML_STRING,s||(console.log("mountPoint",this.mountPoint),this.getProgressBarElement().style.display="none"),u.querySelector(".starting").innerHTML=i,u.querySelector(".restart").innerHTML=c},t}(g.default);t.CloudGamingWebSDK=w;var T=new w;window.TCGSDK=T,t.default=T},1862:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var a=n(3139),c=n(3578),d=n(6840),u={Token:"",Zone:"",OperatorAddress:"",WebSocketAddress:"",WebSocketSecureAddress:"",WebRTCAddress:"",EdgeProxyAddress:"",InstanceInfo:null},l=function(){function e(e){var t=e.sdk;this.sdk=null,this.instanceAccessInfo=new Map,this.accessInfo=[],this.playAPIFetchStart=0,this.sdk=t}return e.prototype.setInstanceAccessInfo=function(e){var t=this,n=e.AccessInfo,r=e.Token,i=o(r.split("_"),1)[0];this.sdk.gameConfig.setAppId({clientId:this.sdk.getInitOptions().mount,appId:+i});try{n=c.Base64.decode(n)}catch(e){this.sdk.log("Decode AccessInfo error",e.message)}try{var a=JSON.parse(n).AccessInfo;this.accessInfo=s(s([],o(this.accessInfo),!1),o(a),!1),null==a||a.forEach((function(e){var n=e.Zone,i=e.InstanceIds,o=e.OperatorAddress,s=e.WebSocketAddress,a=e.WebSocketSecureAddress,c=e.WebRTCAddress,d=e.EdgeProxyAddress,u=e.InstancesInfo,l=void 0===u?[]:u;i.forEach((function(e){var i=(null==l?void 0:l.find((function(t){return t.InstanceId===e})))||{},u=i.Data,h=i.InstanceId,p=null;h&&u&&(p={InstanceId:h,Data:u}),t.instanceAccessInfo.set(e,{Token:r,Zone:n,OperatorAddress:o,WebSocketAddress:s,WebSocketSecureAddress:a,WebRTCAddress:c,EdgeProxyAddress:d,InstanceInfo:p})}))}))}catch(e){this.sdk.log("Parse AccessInfo error",e.message)}},e.prototype.getInstanceAccessInfo=function(e){var t=e.instanceId;return this.instanceAccessInfo.get(t)||u},e.prototype.getTokenInfos=function(e){var t=this,n=e.instanceIds,r=[],i=[];return n.forEach((function(e){var n=t.getInstanceAccessInfo({instanceId:e}).Token;n?r.push({Token:n,AndroidInstanceId:e}):(t.sdk.log("Token is not set",e),i.push(e))})),i.length&&this.sdk.onEvent({type:"token_not_found",data:{instance_ids:i}}),r},e.prototype.createWebRTCSession=function(e){var t=e.instanceId,n=e.clientSession;return r(this,void 0,void 0,(function(){var e,r,o,s,c,u,l,h,p,f,m,v,g,y;return i(this,(function(i){switch(i.label){case 0:if(!t||!n)return[3,5];if(e=this.getInstanceAccessInfo({instanceId:t}),r=e.Token,o=e.WebRTCAddress,s=e.EdgeProxyAddress,!(c=s||o))return[3,4];u="".concat(c,"/play"),l={Authorization:"Bearer ".concat(r)},(h=this.getInstanceInfoHeader({instanceId:t,encode:"url_encode"}).instanceInfo)&&(l["Crtr-Proxy-Instance-Info"]=h),i.label=1;case 1:return i.trys.push([1,3,,4]),this.playAPIFetchStart=+new Date,[4,(0,d.fetchPost)({url:u,data:{RequestID:this.sdk.getRequestId()||(0,a.v4)(),Token:r,AndroidInstanceId:t,ClientSession:n},headers:l})];case 2:return p=i.sent(),f=p.ServerSession,m=p.Code,v=p.Message,g=+new Date-this.playAPIFetchStart,this.sdk.showStats.setAPICost(g),this.sdk.showStats.addEventReport({event_code:"server_api_play",event_result_code:"".concat(m),event_result_msg:v,consume_time:g}),[2,{ServerSession:f,Code:m,Message:v}];case 3:throw y=i.sent(),this.sdk.log("fetch server session error, /play",y.message),y;case 4:this.sdk.log("play requestAddress is not found"),i.label=5;case 5:return this.sdk.log("Create session error, instanceId or clientSession is empty"),[2]}}))}))},e.prototype.createWebRTCGroupSession=function(e){var t=e.instanceIds,n=e.clientSessions;return r(this,void 0,void 0,(function(){var e,r,o,s,c,u,l,h,p,f,m,v,g,y,b,k;return i(this,(function(i){switch(i.label){case 0:if(e=this.getTokenInfos({instanceIds:t}),r=this.getInstanceAccessInfo({instanceId:t[0]}),o=r.Token,s=r.EdgeProxyAddress,c=r.WebRTCAddress,u=this.getInstancesInfo({instanceIds:t}).InstancesInfo,!(l=s||c))return[3,4];h="".concat(l,"/group/play"),p={Authorization:"Bearer ".concat(o)},i.label=1;case 1:return i.trys.push([1,3,,4]),this.playAPIFetchStart=+new Date,[4,(0,d.fetchPost)({url:h,data:{RequestID:(0,a.v4)(),TokenInfos:e,ClientSessions:n,InstancesInfo:u},headers:p})];case 2:return f=i.sent(),m=f.GroupControlId,v=f.ServerSessions,g=f.Code,y=f.Message,this.sdk.log("Create WebRTC GroupSession",m,v),b=+new Date-this.playAPIFetchStart,this.sdk.showStats.setAPICost(b),this.sdk.showStats.addEventReport({event_code:"server_api_group_play",event_result_code:"".concat(g),event_result_msg:y,consume_time:b}),[2,{Code:g,Message:y,GroupControlId:m,ServerSessions:v}];case 3:throw k=i.sent(),this.sdk.log("fetch server session error, /group/play",k.message),k;case 4:return this.sdk.log("requestAddress is not found"),[2]}}))}))},e.prototype.joinWebRTCGroupSession=function(e){var t=e.instanceIds,n=e.clientSessions,o=e.groupControlId;return r(this,void 0,void 0,(function(){var e,r,s,c,u,l,h,p,f,m,v;return i(this,(function(i){switch(i.label){case 0:if(e=this.getTokenInfos({instanceIds:t}),r=this.getInstanceAccessInfo({instanceId:t[0]}),s=r.Token,c=r.WebRTCAddress,u=r.EdgeProxyAddress,l=this.getInstancesInfo({instanceIds:t}).InstancesInfo,!(h=u||c))return[3,4];p="".concat(h,"/group/join"),f={Authorization:"Bearer ".concat(s)},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(0,d.fetchPost)({url:p,data:{RequestID:(0,a.v4)(),GroupControlId:o,TokenInfos:e,ClientSessions:n,InstancesInfo:l},headers:f})];case 2:return m=i.sent().ServerSessions,v=void 0===m?[]:m,this.sdk.log("Join WebRTC GroupSession",v),[2,{ServerSessions:(null==v?void 0:v.length)?v:[]}];case 3:throw i.sent();case 4:return this.sdk.log("group play requestAddress is not found"),[2]}}))}))},e.prototype.getInstancesInfo=function(e){var t=this,n=e.instanceIds,r=[];return n.forEach((function(e){var n=t.getInstanceAccessInfo({instanceId:e}).InstanceInfo;n&&r.push(n)})),{InstancesInfo:r}},e.prototype.getInstanceInfoHeader=function(e){var t=e.instanceId,n=e.method,r=void 0===n?"POST":n,i=e.encode,o=void 0===i?"base64":i,s=this.getInstanceAccessInfo({instanceId:t}).InstanceInfo;if(s){var a=s.InstanceId,d=s.Data,u="";if(a&&d)try{u="url_encode"===o?encodeURIComponent(JSON.stringify({InstanceId:a,Data:d})):c.Base64.encode(JSON.stringify({InstanceId:a,Data:d}))}catch(e){this.sdk.log("stringify instanceInfo string error",e.name,e.message)}else this.sdk.log("InstanceId, Data is not found",a,d);return"GET"===r&&(u="&instance_info=".concat(u)),{instanceInfo:u}}return{instanceInfo:""}},e}();t.default=l},969:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0});var i=n(7408),o=function(){function e(e){var t=e.sdk;this.gamepad="function"==typeof navigator.getGamepads?new i.GamepadListener:null,this.sdk=null,this.sdk=t}return e.prototype.addGamepadHandler=function(){var e=this,t=new Map;t.set(12,1),t.set(13,2),t.set(14,4),t.set(15,8),t.set(2,16384),t.set(3,32768),t.set(0,4096),t.set(1,8192),t.set(8,32),t.set(9,16),t.set(10,64),t.set(11,128),t.set(4,256),t.set(5,512),this.gamepad&&(this.gamepad.on("gamepad:connected",(function(t){var n=t.detail;e.sdk.log("gamepad:connected detail",n);var r=n.index,i=n.gamepad;e.sdk.log("gamepad connect, gamepad index is",r),e.sdk.sendGamepadEvent({type:"gamepadconnect"}),e.sdk.onGamepadConnectChange({status:"gamepadconnect",index:r,gamepad:i})})),this.gamepad.on("gamepad:disconnected",(function(t){var n=t.detail;e.sdk.log("gamepad:disconnected detail",n);var r=n.index;e.sdk.log("gamepad disconnected, gamepad index is",r),e.sdk.sendGamepadEvent({type:"gamepaddisconnect"}),e.sdk.onGamepadConnectChange({status:"gamepaddisconnect",index:r})})),this.gamepad.on("gamepad:button",(function(n){var r=n.detail,i=r.button,o=r.pressed,s=r.value,a=t.get(i);6===i||7===i?(6===i&&e.sdk.sendGamepadEvent({type:"lt",x:parseInt("".concat(255*s),10),down:o}),7===i&&e.sdk.sendGamepadEvent({type:"rt",x:parseInt("".concat(255*s),10),down:o})):e.sdk.sendGamepadEvent({type:"gamepadkey",key:a,down:o})})),this.gamepad.on("gamepad:axis",(function(t){var n=t.detail,i=n.stick,o=n.gamepad,s=r(o.axes,4),a=s[0],c=s[1],d=s[2],u=s[3];0===i&&e.sdk.sendGamepadEvent({type:"axisleft",x:parseInt("".concat(32767*a),10),y:-parseInt("".concat(32767*c),10)}),1===i&&e.sdk.sendGamepadEvent({type:"axisright",x:parseInt("".concat(32767*d),10),y:-parseInt("".concat(32767*u),10)})})),this.gamepad.start())},e}();t.default=o},5447:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},d=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(1743),h=u(n(4652)),p=n(5262),f=n(9045),m=u(n(8995)),v=n(6840),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.logStr=[],t.allLogs=[],t.externalLogHandler=l.noop,t.serverSideDescription={},t.loggerConfig={mount:null},t}return i(t,e),t.prototype.initLoggerConfig=function(e){this.loggerConfig=e},t.prototype.setServerSideDescription=function(e){var t=e.serverSideDescription;this.serverSideDescription=t},t.prototype.log=function(){for(var e,t,n,r,i,o,s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];(null===(r=null===(n=this.loggerConfig)||void 0===n?void 0:n.debugSetting)||void 0===r?void 0:r.showLog)&&console.log.apply(console,c([],a(s),!1));var h="";try{for(var p=d(s),f=p.next();!f.done;f=p.next()){var v=f.value;try{h+="".concat("object"==typeof v?(0,m.default)(v):v," ")}catch(e){console.log("Error stringify object:",e.message)}}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}var g=this.serverSideDescription,y=g.request_id,b=void 0===y?"":y,k=g.server_ip,C=void 0===k?"":k,S=g.user_id,_=void 0===S?"":S,w=null!==(i=C||b)&&void 0!==i?i:"";h="[TCG/".concat(w,"][").concat(_,"]:").concat(h),null===(o=this.externalLogHandler)||void 0===o||o.call(this,h);var T=new Date,E={timestamp:+T,server_ip:C,request_id:b,user_id:_,content:"".concat((0,l.formatTime)(T,"yyyy-mm-dd hh:ii:ss")," ").concat(h,"\n")};this.logStr.push(E),this.allLogs.push({request_id:E.request_id,user_id:E.user_id,content:E.content})},t.prototype.getLog=function(){var e=this.serverSideDescription,t=e.request_id,n=void 0===t?"":t,r=e.server_ip,i=void 0===r?"":r;return this.logStr.forEach((function(e){e.server_ip||(e.server_ip=i),e.request_id||(e.request_id=n)})),this.logStr},t.prototype.getAllLogs=function(){var e=this.serverSideDescription.request_id,t=void 0===e?"":e;return this.allLogs.forEach((function(e){e.request_id||(e.request_id=t)})),this.allLogs},t.prototype.reportLogInner=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.metricLogReport(this.getLog())]}))}))},t.prototype.setExternalLog=function(e){void 0===e&&(e=l.noop),this.externalLogHandler=e},t.prototype.metricLogReport=function(e){return o(this,void 0,void 0,(function(){var t,n,r,i,o,a,c,d,u;return s(this,(function(s){switch(s.label){case 0:if(0===this.logStr.length)return[2];t={metric:"cg_client_log",bulk:e},n=this.serverSideDescription.sig_key,r=null;try{r=n&&(0,h.default)(JSON.stringify(t).slice(0,128),n).toString()}catch(e){this.log("encode sig_key error",e)}i=r?"https://metrics-cloud-gaming.crtrcloud.com/report_log_bulk?sig=".concat(r):"https://metrics-cloud-gaming.crtrcloud.com/report_log_bulk",s.label=1;case 1:return s.trys.push([1,3,,4]),p.config.lite?[2,this.log("lite sdk can not report logs")]:p.config.privatization.server?[2]:[4,(0,v.fetchPost)({url:i,data:t})];case 2:return o=s.sent(),a=o.code,c=o.message,d=void 0===c?"":c,0===a?(this.log("metricReportLog",a,d),this.logStr=[],[2,{code:a,message:d}]):(this.log("metricReportLog failed",d),[2,{code:-1,message:"failed"}]);case 3:return u=s.sent(),this.log("catch metricReportLog failed",u.message,u.name),[2,{code:-1,message:"failed"}];case 4:return[2]}}))}))},t}(f.EventBus);t.default=g},2371:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1743),o=function(){function e(e){var t=e.sdk;this.sdk=null,this.configBatch=new Map,this.sdk=t}return e.prototype.setConfig=function(e){var t=e.clientId,n=e.config,o=n.game_config,s=n.feature_switch,a=void 0===s?i.empty:s;this.setSDKConfig(null==o?void 0:o.sdk_conf),this.configBatch.set(t,r(r({},this.configBatch.get(t)),n)),this.setFeatureSwitch(a,t)},e.prototype.setAppId=function(e){var t=e.clientId,n=e.appId,i=this.configBatch.get(t);(null==i?void 0:i.app_id)||this.configBatch.set(t,r(r({},this.configBatch.get(t)),{app_id:n}))},e.prototype.setSDKConfig=function(e){if(e){var t=this.sdk.getInitOptions().webDraftLevel;"number"==typeof e.webdraft_level&&void 0!==t&&this.sdk.pageEvent.setWebDraftLevel(e.webdraft_level)}},e.prototype.getConfig=function(e){var t=e.clientId;return this.configBatch.get(t)||i.empty},e.prototype.setFeatureSwitch=function(e,t){if(e){var n=e.network_event_script;n&&(n=JSON.parse(n)),this.configBatch.set(t,r(r({},this.configBatch.get(t)),{feature_switch:{network_event_script:n}}))}},e}();t.default=o},1428:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=a(n(266)),l=d(n(8763)),h=n(9320),p=function(e){function t(t,n){var r=e.call(this,"buffer")||this;return r.bufferType=null,r.queue=new Uint8Array,r.cleaning=!1,r.pendingCleaning=0,r.cleanOffset=10,r.cleanRanges=[],r.sourceBuffer=null,r.needDestroyBuffer=!1,r.bufferType=n,r.sourceBuffer=t,r.sourceBuffer.addEventListener("updateend",(function(){r.pendingCleaning>0&&(r.initCleanup(r.pendingCleaning),r.pendingCleaning=0),r.cleaning=!1,r.cleanRanges.length?r.doCleanup():r.needDestroyBuffer&&(r.destroyBuffer(),r.needDestroyBuffer=!1)})),r.sourceBuffer.addEventListener("error",(function(e){u.log("sourceBuffer on error",e),r.dispatch("error",{type:r.bufferType,name:"buffer",error:"buffer error"})})),r}return i(t,e),t.prototype.destroy=function(){this.sourceBuffer.updating?this.needDestroyBuffer=!0:this.destroyBuffer(),this.queue=null,this.sourceBuffer=null,this.offAll()},t.prototype.destroyBuffer=function(){var e;if((null===(e=this.sourceBuffer.buffered)||void 0===e?void 0:e.length)&&!this.cleaning)for(var t=0;t<this.sourceBuffer.buffered.length;++t){var n=this.sourceBuffer.buffered.start(t),r=this.sourceBuffer.buffered.end(t);this.sourceBuffer.remove(n,r)}},t.prototype.doCleanup=function(){if(this.cleanRanges.length){var e=c(this.cleanRanges.shift(),2),t=e[0],n=e[1];u.log("".concat(this.bufferType," remove range [").concat(t," - ").concat(n,")")),this.cleaning=!0,this.sourceBuffer.remove(t,n)}else this.cleaning=!1},t.prototype.initCleanup=function(e){var t;try{if(this.sourceBuffer.updating)return void(this.pendingCleaning=e);if((null===(t=this.sourceBuffer.buffered)||void 0===t?void 0:t.length)&&!this.cleaning){for(var n=0;n<this.sourceBuffer.buffered.length;++n){var r=this.sourceBuffer.buffered.start(n),i=this.sourceBuffer.buffered.end(n);e-r>this.cleanOffset&&r<(i=e-this.cleanOffset)&&this.cleanRanges.push([r,i])}this.doCleanup()}}catch(e){u.error("Error occured while cleaning ".concat(this.bufferType," buffer - ").concat(e.name,": ").concat(e.message))}},t.prototype.doAppend=function(){if(this.queue.length&&this.sourceBuffer&&!this.sourceBuffer.updating)try{this.sourceBuffer.appendBuffer(this.queue),this.queue=new Uint8Array}catch(t){var e="unexpectedError";u.log("doAppend error, ",t,t.name),"QuotaExceededError"===t.name?(u.log("".concat(this.bufferType," buffer quota full")),e="QuotaExceeded"):(u.error("Error occured while appending ".concat(this.bufferType," buffer - ").concat(t.name,": ").concat(t.message)),e="InvalidStateError"),this.dispatch("error",{type:this.bufferType,name:e,error:"buffer error"})}},t.prototype.feed=function(e){this.queue=(0,h.appendByteArray)(this.queue,e),this.doAppend()},t}(l.default);t.default=p},1424:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(5860)),c=n(6976),d=n(3739),u=n(9320),l=s(n(8763)),h=n(1382),p=n(7832),f=n(3790),m=function(e){function t(){var t=e.call(this,"remuxer")||this;return t.tracks={},t.initialized=!1,t.trackTypes=[],t.videoSeq=1,t.audioSeq=1,t.timescale=1e3,t.mediaDuration=0,t.opusConfig={sampleRate:48e3,channels:2,bitDepth:16,duration:960},t}return i(t,e),t.prototype.addTrack=function(e,t){var n=(void 0===t?{}:t).config;if("avc"===e&&(this.tracks.avc=new d.H264Remuxer(this.timescale,this.mediaDuration),this.trackTypes.push("avc")),"hevc"===e&&(this.tracks.hevc=new f.H265Remuxer(this.timescale,this.mediaDuration),this.trackTypes.push("hevc")),"aac"===e){var r=new c.AACRemuxer(this.timescale,this.mediaDuration);this.tracks.aac=r,this.trackTypes.push("aac")}"opus"===e&&(this.tracks.opus=new h.OpusRemuxer,this.trackTypes.push("opus"),this.opusConfig=n)},t.prototype.reset=function(){var e,t;try{for(var n=o(this.trackTypes),r=n.next();!r.done;r=n.next()){var i=r.value;this.tracks[i].resetTrack()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.initialized=!1},t.prototype.destroy=function(){this.tracks={},this.offAll()},t.prototype.isReady=function(){var e,t;try{for(var n=o(this.trackTypes),r=n.next();!r.done;r=n.next()){var i=r.value;if(!this.tracks[i].readyToDecode||!this.tracks[i].samples.length)return!1}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!0},t.prototype.remux=function(e){var t=e.avc,n=e.hevc,r=e.aac,i=e.opus;(null==t?void 0:t.length)>0&&this.tracks.avc.remux(t),(null==n?void 0:n.length)>0&&this.tracks.hevc.remux(n),(null==r?void 0:r.length)>0&&this.tracks.aac.remux(r),(null==i?void 0:i.length)>0&&this.tracks.opus.remux(i),this.flush(Object.keys(e))},t.prototype.flush=function(e){if(this.initialized){var t,n;if(e.includes("opus")&&(null==(n=(t=this.tracks.opus).getPayload())?void 0:n.byteLength)){var r={type:"opus",payload:p.ISOBMFFContainerInstance.getMediaSegment({frames:[{data:n}],sequenceNumber:this.audioSeq,baseMediaDecodeTime:t.dts,track:t.mp4track}),dts:t.dts};this.dispatch("buffer",r),t.flush(),this.audioSeq=this.audioSeq+1}if(e.includes("avc")&&(null==(n=(t=this.tracks.avc).getPayload())?void 0:n.byteLength)){var i=a.default.moof(this.videoSeq,t.dts,t.mp4track),o=a.default.mdat(n);r={type:"avc",payload:(0,u.appendByteArray)(i,o),dts:t.dts,fps:t.mp4track.fps},this.dispatch("buffer",r),t.flush(),this.videoSeq=this.videoSeq+1}e.includes("hevc")&&(null==(n=(t=this.tracks.hevc).getPayload())?void 0:n.byteLength)&&(i=a.default.moof(this.videoSeq,t.dts,t.mp4track),o=a.default.mdat(n),r={type:"hevc",payload:(0,u.appendByteArray)(i,o),dts:t.dts,fps:t.mp4track.fps},this.dispatch("buffer",r),t.flush(),this.videoSeq=this.videoSeq+1)}else this.isReady()&&(this.dispatch("ready"),this.initSegment(),this.initialized=!0,this.flush(e))},t.prototype.initSegment=function(){var e,t;try{for(var n=o(this.trackTypes),r=n.next();!r.done;r=n.next()){var i=r.value,s=null;if("avc"===i&&(a.default.initTypes(),s=a.default.initSegment([this.tracks.avc.mp4track],this.mediaDuration,this.timescale)),"hevc"===i&&(a.default.initTypes(),s=a.default.initSegment([this.tracks.hevc.mp4track],this.mediaDuration,this.timescale)),"opus"===i){var c=this.opusConfig,d=c.sampleRate,u=c.channels,l=c.bitDepth;c.duration,s=p.ISOBMFFContainerInstance.getInitializationSegment({header:{sampleRate:d,channels:u,bitDepth:l,preSkip:3840,inputSampleRate:d,outputGain:0,channelMappingFamily:0}})}var h={type:i,payload:s,eventType:"init"};this.dispatch("buffer",h)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t}(l.default);t.default=m},6618:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(5614)),d=function(e){function t(t,n){var r=void 0===n?{}:n,i=r.contents,o=r.children;return e.call(this,{name:t,contents:i,children:o})||this}return i(t,e),t.prototype.buildContents=function(){return s(s(s([],o(this._lengthBytes),!1),o(c.default.stringToByteArray(this._name)),!1),o(e.prototype.buildContents.call(this)),!1)},t.prototype.buildLength=function(){return this._length||(this._length=4+this._name.length+e.prototype.buildLength.call(this),this._lengthBytes=c.default.getUint32(this._length)),this._length},t}(c.default);t.default=d},5614:function(e,t){"use strict";var n=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){var t=e.name,n=e.contents,r=void 0===n?[]:n,i=e.children,o=void 0===i?[]:i;this._name=null,this._contents=null,this._children=null,this._name=t,this._contents=r,this._children=o}return e.stringToByteArray=function(e){return i([],r(e),!1).map((function(e){return e.charCodeAt(0)}))},e.getFloat64=function(e){var t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e),t},e.getUint64=function(e){var t=new Uint8Array(8);return new DataView(t.buffer).setBigUint64(0,BigInt(e)),t},e.getUint32=function(e){var t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t},e.getUint16=function(e){var t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e),t},e.getInt16=function(e){var t=new Uint8Array(2);return new DataView(t.buffer).setInt16(0,e),t},e.flatten=function(t){var r,i,s,a,c,d;return n(this,(function(n){switch(n.label){case 0:n.trys.push([0,7,8,9]),r=o(t),i=r.next(),n.label=1;case 1:return i.done?[3,6]:(s=i.value,Array.isArray(s)?[5,o(e.flatten(s))]:[3,3]);case 2:return n.sent(),[3,5];case 3:return[4,s];case 4:n.sent(),n.label=5;case 5:return i=r.next(),[3,1];case 6:return[3,9];case 7:return a=n.sent(),c={error:a},[3,9];case 8:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(c)throw c.error}return[7];case 9:return[2]}}))},Object.defineProperty(e.prototype,"contents",{get:function(){var t,n,r=new Uint8Array(this.length),i=this.buildContents(),s=0;try{for(var a=o(e.flatten(i)),c=a.next();!c.done;c=a.next()){var d=c.value;"object"!=typeof d?(r[s]=d,s++):(r.set(d,s),s+=d.length)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.buildLength()},enumerable:!1,configurable:!0}),e.prototype.buildContents=function(){return i([this._contents],r(this._children.map((function(e){return e.buildContents()}))),!1)},e.prototype.buildLength=function(){return(Array.isArray(this._contents)?this._contents.reduce((function(e,t){return e+(void 0===t.length?1:t.length)}),0):void 0===this._contents.length?1:this._contents.length)+this._children.reduce((function(e,t){return e+t.length}),0)},e.prototype.addChild=function(e){this._children.push(e)},e}();t.default=s},5993:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(5614)),d=function(e){function t(t,n){var r=void 0===n?{}:n,i=r.contents,o=r.tags;return e.call(this,{name:t,contents:i,children:o})||this}return i(t,e),t.getLength=function(e){var t=c.default.getUint32(e);return t.every((function(e,t,n){return 0===e&&(n[t]=128,!0)})),t},t.prototype.buildContents=function(){return s(s([this._name],o(this._lengthBytes),!1),o(e.prototype.buildContents.call(this)),!1)},t.prototype.buildLength=function(){if(!this._length){var n=e.prototype.buildLength.call(this);this._lengthBytes=t.getLength(n),this._length=1+n+this._lengthBytes.length}return this._length},t.prototype.addTag=function(e){this.addChild(e)},t}(c.default);t.default=d},7832:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ISOBMFFContainerInstance=void 0;var s=n(2674),a=o(n(5614)),c=o(n(6618)),d=o(n(5993)),u=function(){function e(e){this.codec="opus",this.codec=e}return e.prototype.getInitializationSegment=function(e){var t=e.header;return new a.default({children:[new c.default("ftyp",{contents:[c.default.stringToByteArray("iso5"),0,0,2,0,c.default.stringToByteArray("iso6mp41")]}),new c.default("moov",{children:[new c.default("mvhd",{contents:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2]}),new c.default("trak",{children:[new c.default("tkhd",{contents:[0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0]}),new c.default("mdia",{children:[new c.default("mdhd",{contents:[0,0,0,0,0,0,0,0,0,0,0,0,c.default.getUint32(t.sampleRate),0,0,0,0,85,196,0,0]}),new c.default("hdlr",{contents:[0,0,0,0,c.default.stringToByteArray("mhlr"),c.default.stringToByteArray("soun"),0,0,0,0,0,0,0,0,0,0,0,0,0]}),new c.default("minf",{children:[new c.default("stbl",{children:[new c.default("stsd",{contents:[0,0,0,0,0,0,0,1],children:[this.getCodecBox(t)]}),new c.default("stts",{contents:[0,0,0,0,0,0,0,0]}),new c.default("stsc",{contents:[0,0,0,0,0,0,0,0]}),new c.default("stsz",{contents:[0,0,0,0,0,0,0,0,0,0,0,0]}),new c.default("stco",{contents:[0,0,0,0,0,0,0,0]})]})]})]})]}),new c.default("mvex",{children:[new c.default("trex",{contents:[0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]})]})]})]}).contents},e.prototype.getMediaSegment=function(e){var t=e.frames,n=e.sequenceNumber,i=e.baseMediaDecodeTime,o=e.track.samples,s=r(o,1)[0],d=s.flags,u=s.duration,l=s.size,h=s.cts,p=function(){var e,t,n=new Uint8Array(4+o.length);for(t=0;t<o.length;t++)e=o[t].flags,n[t+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return new c.default("sdtp",{contents:n})}();return new a.default({children:[new c.default("moof",{children:[new c.default("mfhd",{contents:[0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]}),new c.default("traf",{children:[new c.default("tfhd",{contents:[0,2,0,0,0,0,0,1]}),new c.default("tfdt",{contents:[0,0,0,0,c.default.getUint32(i)]}),new c.default("trun",{contents:[0,0,15,1,c.default.getUint32(t.length),c.default.getUint32(92+p.length+16*t.length),c.default.getUint32(u),c.default.getUint32(l),d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,61440&d.degradPrio,15&d.degradPrio,c.default.getUint32(h)]}),p]})]}),new c.default("mdat",{contents:this.getFrameData(t)})]}).contents},e.prototype.getCodecBox=function(e){switch(this.codec){case s.MP3:return this.getMp4a(e,107);case s.MP4A_40_2:return this.getMp4a(e,64);case s.OPUS:return this.getOpus(e);case s.FLAC:return this.getFlaC(e)}},e.prototype.getOpus=function(e){var t=e.sampleRate,n=void 0===t?48e3:t,r=e.channels,i=void 0===r?2:r,o=e.bitDepth,s=void 0===o?16:o,a=e.preSkip,d=void 0===a?0:a,u=e.inputSampleRate,l=void 0===u?48e3:u,h=e.outputGain,p=void 0===h?0:h,f=e.channelMappingFamily,m=void 0===f?0:f,v=e.streamCount,g=void 0===v?0:v,y=e.coupledStreamCount,b=void 0===y?0:y,k=e.channelMappingTable,C=void 0===k?0:k;return new c.default("Opus",{contents:[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,s,0,0,0,0,c.default.getUint16(n),0,0],children:[new c.default("dOps",{contents:[0,i,c.default.getUint16(d),c.default.getUint32(l),c.default.getInt16(p),m,0!==m?[g,b,C]:[]]})]})},e.prototype.getFlaC=function(e){return new c.default("fLaC",{contents:[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channels,0,e.bitDepth,0,0,0,0,c.default.getUint16(e.sampleRate),0,0],children:[new c.default("dfLa",{contents:i([0,0,0,0],r(e.streamInfo||[128,0,0,34,c.default.getUint16(e.blockSize),c.default.getUint16(e.blockSize),0,0,0,0,0,0,c.default.getUint32(e.sampleRate<<12|e.channels<<8|e.bitDepth-1<<4),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),!1)})]})},e.prototype.getMp4a=function(e,t){var n=new d.default(4,{contents:[t,21,0,0,0,0,0,0,0,0,0,0,0]});return 64===t&&n.addTag(new d.default(5,{contents:e.audioSpecificConfig})),new c.default("mp4a",{contents:[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channels,0,16,0,0,0,0,c.default.getUint16(e.sampleRate),0,0],children:[new c.default("esds",{contents:[0,0,0,0],children:[new d.default(3,{contents:[0,1,0],tags:[n,new d.default(6,{contents:2})]})]})]})},e.prototype.getSamplesPerFrame=function(e){return this.codec===s.MP4A_40_2?e.map((function(e){var t=e.data,n=e.header;return c.default.getUint32(t.length-n.length)})):e.map((function(e){var t=e.data;return c.default.getUint32(t.length)}))},e.prototype.getFrameData=function(e){return this.codec===s.MP4A_40_2?e.map((function(e){var t=e.data,n=e.header;return t.subarray(n.length)})):e.map((function(e){return e.data}))},e}();t.default=u;var l=new u(s.OPUS);t.ISOBMFFContainerInstance=l},2674:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MSE_AUDIO_WRAPPER=t.AUDIO_WEBM=t.AUDIO_MP4=t.OPUS=t.VORBIS=t.FLAC=t.MP4A_40_2=t.MP3=t.WEBM=t.MP4=void 0,t.MP4="mp4",t.WEBM="webm",t.MP3="mp3",t.MP4A_40_2="mp4a.40.2",t.FLAC="flac",t.VORBIS="vorbis",t.OPUS="opus";var n="audio/",r=";codecs=";t.AUDIO_MP4=n+t.MP4+r,t.AUDIO_WEBM=n+t.WEBM+r,t.MSE_AUDIO_WRAPPER="mse-audio-wrapper"},5236:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return a(t,e),t},d=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=c(n(266)),h=n(4530),p=n(9320),f=n(7122),m=n(251),v=u(n(8763)),g=u(n(1424)),y=u(n(1428)),b=n(1743),k=n(7857),C=n(9680),S=function(e){function t(t){var n,r,i,s=this;return(s=e.call(this,"muxer")||this).isMSESupported=null,s.node=null,s.mseReady=null,s.mseEnded=null,s.videoStarted=null,s.interval=null,s.mediaSource=null,s.url=null,s.options={node:"",mode:null,flushingTime:0,maxDelay:100,clearBuffer:!0,fps:30,readFpsFromTrack:!1,debug:!1,opusConfig:{SampleRate:48e3,SampleFormat:16,Channels:2,PcmFrameSize:960},onReady:b.noop,onData:b.noop,onError:b.noop,onMissingVideoFrames:b.noop,onMissingAudioFrames:b.noop,onEvent:b.noop},s.isReset=!1,s.frameDuration=1e3/s.options.fps|0,s.remuxController=null,s.bufferControllers=null,s.lastCleaningTime=null,s.kfPosition=null,s.kfCounter=null,s.options=o(o({},s.options),t),s.options.debug&&l.setLogger(),s.frameDuration=1e3/s.options.fps|0,s.remuxController=new g.default,(null===(n=s.options.mode)||void 0===n?void 0:n.avc)&&s.remuxController.addTrack("avc"),(null===(r=s.options.mode)||void 0===r?void 0:r.hevc)&&s.remuxController.addTrack("hevc"),(null===(i=s.options.mode)||void 0===i?void 0:i.opus)&&s.remuxController.addTrack("opus",{config:{sampleRate:s.options.opusConfig.SampleRate,channels:s.options.opusConfig.Channels,bitDepth:s.options.opusConfig.SampleFormat,duration:s.options.opusConfig.PcmFrameSize}}),s.initData(),s.remuxController.on("buffer",s.onBuffer.bind(s)),s.remuxController.on("ready",s.createBuffer.bind(s)),s.initBrowser(),s}return i(t,e),t.isSupported=function(e){var t;return null===(t=window.MediaSource)||void 0===t?void 0:t.isTypeSupported(e)},t.prototype.feed=function(e){var t={};if(e&&this.remuxController){var n,r=e.avc,i=e.hevc,o=e.aac,s=e.opus,a=e.duration,c=void 0===a?0:a,d=e.compositionTimeOffset;if(r&&this.options.mode.avc&&((n=(0,p.extractNALu)(r)).length>0?t.avc=this.getVideoFrames(n,c,d):"function"==typeof this.options.onMissingVideoFrames&&this.options.onMissingVideoFrames.call(null,e)),i&&this.options.mode.hevc&&((n=(0,p.extractNALu)(i)).length>0?t.hevc=this.getHevcVideoFrames(n,c,d):"function"==typeof this.options.onMissingVideoFrames&&this.options.onMissingVideoFrames.call(null,e)),o&&this.options.mode.aac){var u=m.AACParser.extractAAC(o);u.length>0?t.aac=this.getAudioFrames(u,c):(l.log("Failed to extract audio data from:",o),"function"==typeof this.options.onMissingAudioFrames&&this.options.onMissingAudioFrames.call(null,e))}if(s&&this.options.mode.opus){if(!this.options.mode.opus)return;t.opus=this.getOpusFrames([s],this.options.opusConfig.PcmFrameSize)}this.remuxController.remux(t)}},t.prototype.destroy=function(){var e,t,n,r;this.stopInterval(),this.remuxController&&(this.remuxController.destroy(),this.remuxController=null),this.bufferControllers&&(null===(e=this.bufferControllers.avc)||void 0===e||e.destroy(),null===(t=this.bufferControllers.hevc)||void 0===t||t.destroy(),null===(n=this.bufferControllers.aac)||void 0===n||n.destroy(),null===(r=this.bufferControllers.opus)||void 0===r||r.destroy(),this.bufferControllers=null,this.endMSE()),this.node=null,this.mseReady=!1,this.videoStarted=!1,this.mediaSource=null},t.prototype.reset=function(){var e,t,n,r;this.stopInterval(),this.isReset=!0,this.node.pause(),this.remuxController&&this.remuxController.reset(),this.bufferControllers&&(null===(e=this.bufferControllers.avc)||void 0===e||e.destroy(),null===(t=this.bufferControllers.hevc)||void 0===t||t.destroy(),null===(n=this.bufferControllers.aac)||void 0===n||n.destroy(),null===(r=this.bufferControllers.opus)||void 0===r||r.destroy(),this.bufferControllers=null,this.endMSE()),this.initData(),this.initBrowser(),l.log("Muxer was reset")},t.prototype.playCurrent=function(){var e,t;if((null===(t=null===(e=this.node)||void 0===e?void 0:e.buffered)||void 0===t?void 0:t.length)>0&&!this.node.seeking){var n=this.node.buffered.end(0);this.node.currentTime=n-.001}},t.prototype.getVideoResolution=function(e){var t,n=e.type,r=null===(t=this.remuxController.tracks[n])||void 0===t?void 0:t.mp4track;return{width:r.width,height:r.height}},t.prototype.initData=function(){this.lastCleaningTime=Date.now(),this.kfPosition=[],this.kfCounter=0,this.startInterval()},t.prototype.initBrowser=function(){"string"==typeof this.options.node&&""===this.options.node&&l.error("no video element were found to render, provide a valid video element"),this.node="string"==typeof this.options.node?document.querySelector(this.options.node):this.options.node,this.mseReady=!1,this.setupMSE()},t.prototype.setupMSE=function(){if(window.MediaSource=window.MediaSource||window.WebKitMediaSource||window.ManagedMediaSource,!window.MediaSource)throw"Oops! Browser does not support Media Source Extension or Managed Media Source (IOS 17+).";if(this.isMSESupported=!!window.MediaSource,this.mediaSource=new window.MediaSource,this.url=URL.createObjectURL(this.mediaSource),window.MediaSource===window.ManagedMediaSource)try{this.node.removeAttribute("src"),this.node.disableRemotePlayback=!0;var e=document.createElement("source");e.type="video/mp4",e.src=this.url,this.node.appendChild(e),this.node.load()}catch(e){console.log("ManagedMediaSource error",e),this.node.src=this.url}else this.node.src=this.url;this.mseEnded=!1,this.mediaSource.addEventListener("sourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("sourceclose",this.onMSEClose.bind(this)),this.mediaSource.addEventListener("webkitsourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("webkitsourceclose",this.onMSEClose.bind(this))},t.prototype.endMSE=function(){if(!this.mseEnded)try{this.mseEnded=!0,this.mediaSource.endOfStream()}catch(e){l.log("mediaSource is not available to end",e)}},t.prototype.getVideoFrames=function(e,t,n){var r,i,o=[],s=[],a=!1;try{for(var c=d(e),u=c.next();!u.done;u=c.next()){var l=u.value,p=new h.NALU(l);p.type()!==h.NALU.IDR&&p.type()!==h.NALU.NDR||f.H264Parser.parseHeader(p),s.push(p),a=p.isKeyframe(),p.isvcl&&p.isfmb&&(o.push({units:s,keyFrame:a,duration:t||this.frameDuration,compositionTimeOffset:n}),this.kfCounter=this.kfCounter+1,a&&this.options.clearBuffer&&this.kfPosition.push(this.kfCounter*(t||this.frameDuration)/1e3))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return o},t.prototype.getHevcVideoFrames=function(e,t,n){var r,i,o=[],s=[],a=!1;try{for(var c=d(e),u=c.next();!u.done;u=c.next()){var l=u.value,h=new k.NALU265(l);h.type()!==k.NALU265.IDR&&h.type()!==k.NALU265.NDR||C.H265Parser.parseHeader(h),s.push(h),a=h.isKeyframe(),h.isvcl&&(o.push({units:s,keyFrame:a,duration:t||this.frameDuration,compositionTimeOffset:n}),this.kfCounter=this.kfCounter+1,a&&this.options.clearBuffer&&this.kfPosition.push(this.kfCounter*(t||this.frameDuration)/1e3))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return o},t.prototype.getAudioFrames=function(e,t){var n,r,i,o=[],s=0;try{for(var a=d(e),c=a.next();!c.done;c=a.next()){var u=c.value;o.push({units:u})}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i=t?t/o.length|0:this.frameDuration,s=t?t-i*o.length:0,o.forEach((function(e){e.duration=i,s>0&&(e.duration=e.duration+1,s-=1)})),o},t.prototype.getOpusFrames=function(e,t){var n,r,i=[];try{for(var o=d(e),s=o.next();!s.done;s=o.next()){var a=s.value;i.push({unit:a,duration:t})}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},t.prototype.createBuffer=function(){var e;if(this.mseReady&&(null===(e=this.remuxController)||void 0===e?void 0:e.isReady())&&!this.bufferControllers)for(var n in this.bufferControllers={},this.remuxController.tracks){var r=n,i=this.remuxController.tracks[r],o="opus"===n||"aac"===n?"audio":"video";if(!t.isSupported("".concat(o,'/mp4; codecs="').concat(i.mp4track.codec,'"')))return l.error("Browser does not support codec"),!1;var s=this.mediaSource.addSourceBuffer("".concat(o,'/mp4; codecs="').concat(i.mp4track.codec,'"'));this.bufferControllers[r]=new y.default(s,r),this.bufferControllers[r].on("error",this.onBufferError.bind(this))}},t.prototype.startInterval=function(){var e=this;this.interval=setInterval((function(){e.cancelDelay()}),1e3)},t.prototype.stopInterval=function(){this.interval&&clearInterval(this.interval)},t.prototype.cancelDelay=function(){var e;if((null===(e=this.node.buffered)||void 0===e?void 0:e.length)>0&&!this.node.seeking){var t=this.node.buffered.end(0);t-this.node.currentTime>this.options.maxDelay/1e3&&(this.node.currentTime=t-.001)}},t.prototype.applyAndClearBuffer=function(){this.bufferControllers&&this.clearBuffer()},t.prototype.getSafeClearOffsetOfBuffer=function(e){for(var t,n=(this.options.mode.aac||this.options.mode.opus)&&e||0,r=0;r<this.kfPosition.length&&!(this.kfPosition[r]>=e);r++)t=this.kfPosition[r];return t&&(this.kfPosition=this.kfPosition.filter((function(e){return e<t&&(n=e),e>=t}))),n},t.prototype.clearBuffer=function(){var e,t;if(this.options.clearBuffer&&Date.now()-this.lastCleaningTime>1e4){if(this.bufferControllers.avc||this.bufferControllers.hevc){var n=this.getSafeClearOffsetOfBuffer(this.node.currentTime);null===(e=this.bufferControllers.avc)||void 0===e||e.initCleanup(n),null===(t=this.bufferControllers.hevc)||void 0===t||t.initCleanup(n)}this.bufferControllers.opus&&this.bufferControllers.opus.initCleanup(this.node.currentTime),this.lastCleaningTime=Date.now()}},t.prototype.onBuffer=function(e){var t,n,r,i,o,s,a,c,d,u,h=e.payload,p=e.type,f=e.fps,m=e.eventType;this.options.readFpsFromTrack&&void 0!==f&&this.options.fps!==f&&(this.options.fps=f,this.frameDuration=Math.ceil(1e3/f),l.log("Muxer changed FPS to ".concat(f," from track data"))),this.bufferControllers&&("avc"===p&&(null===(n=null===(t=this.bufferControllers)||void 0===t?void 0:t.avc)||void 0===n||n.feed(h)),"hevc"===p&&(null===(i=null===(r=this.bufferControllers)||void 0===r?void 0:r.hevc)||void 0===i||i.feed(h)),"aac"===p&&(null===(s=null===(o=this.bufferControllers)||void 0===o?void 0:o.aac)||void 0===s||s.feed(h)),"opus"===p&&(null===(c=null===(a=this.bufferControllers)||void 0===a?void 0:a.opus)||void 0===c||c.feed(h))),this.options.onData&&this.options.onData({data:e}),0===this.options.flushingTime&&this.applyAndClearBuffer(),"init"===m&&(null===(u=(d=this.options).onReady)||void 0===u||u.call(d))},t.prototype.onMSEOpen=function(){this.mseReady=!0,URL.revokeObjectURL(this.url)},t.prototype.onMSEClose=function(){this.mseReady=!1,this.videoStarted=!1},t.prototype.onBufferError=function(e){if(l.log("onBufferError",e),"QuotaExceeded"===e.name)return l.log("Muxer cleaning ".concat(e.type," buffer due to QuotaExceeded error")),void this.bufferControllers[e.type].initCleanup(this.node.currentTime);"InvalidStateError"===e.name?this.reset():this.endMSE(),"function"==typeof this.options.onError&&this.options.onError.call(null,e)},t}(v.default);t.default=S},251:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AACParser=void 0;var n=function(){function e(e){this.remuxer=null,this.track=null,this.remuxer=e,this.track=e.mp4track}return Object.defineProperty(e,"samplingRateMap",{get:function(){return[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]},enumerable:!1,configurable:!0}),e.getHeaderLength=function(e){return 1&e[1]?7:9},e.getFrameLength=function(e){return(3&e[3])<<11|e[4]<<3|(224&e[5])>>>5},e.isAACPattern=function(e){return 255===e[0]&&240==(240&e[1])&&0==(6&e[1])},e.extractAAC=function(t){var n,r=0,i=t.byteLength,o=[];if(!e.isAACPattern(t))return console.error("Invalid ADTS audio format"),o;var s=e.getHeaderLength(t);for(e.aacHeader||(e.aacHeader=t.subarray(0,s));r<i;)n=e.getFrameLength(t),o.push(t.subarray(s,n)),t=t.slice(n),r+=n;return o},e.prototype.setAACConfig=function(){var t,n=new Uint8Array(2),r=e.aacHeader;if(r){var i=1+((192&r[2])>>>6),o=(60&r[2])>>>2;t=(1&r[2])<<2,t|=(192&r[3])>>>6,n[0]=i<<3,n[0]|=(14&o)>>1,n[1]|=(1&o)<<7,n[1]|=t<<3,this.track.codec="mp4a.40.".concat(i),this.track.channelCount=t,this.track.config=n,this.remuxer.readyToDecode=!0}},e}();t.AACParser=n},7122:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.H264Parser=void 0;var i=r(n(2195)),o=n(4530),s=function(){function e(e){this.remuxer=null,this.track=null,this.remuxer=e,this.track=e.mp4track}return e.parseHeader=function(e){var t=new i.default(e.getPayload());t.readUByte(),e.isfmb=0===t.readUEG(),e.stype=t.readUEG()},e.prototype.parseNAL=function(e){if(!e)return!1;var t=!1;switch(e.type()){case o.NALU.IDR:case o.NALU.NDR:t=!0;break;case o.NALU.PPS:this.track.pps||(this.parsePPS(e.getPayload()),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&(this.remuxer.readyToDecode=!0)),t=!0;break;case o.NALU.SPS:this.track.sps||(this.parseSPS(e.getPayload()),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&(this.remuxer.readyToDecode=!0)),t=!0;case o.NALU.AUD:case o.NALU.SEI:}return t},e.prototype.skipScalingList=function(e,t){for(var n=8,r=8,i=0;i<t;i++)0!==r&&(r=(n+e.readEG()+256)%256),n=0===r?n:r},e.prototype.readSPS=function(e){var t,n,r,o=new i.default(e),s=0,a=0,c=0,d=0,u=o.readUByte.bind(o),l=o.readBits.bind(o),h=o.readUEG.bind(o),p=o.readBoolean.bind(o),f=o.skipBits.bind(o),m=o.skipEG.bind(o),v=o.skipUEG.bind(o),g=this.skipScalingList.bind(this);u();var y=u();if(l(5),f(3),u(),v(),100===y||110===y||122===y||244===y||44===y||83===y||86===y||118===y||128===y){var b=h();if(3===b&&f(1),v(),v(),f(1),p())for(n=3!==b?8:12,r=0;r<n;r++)p()&&g(r<6?16:64,o)}v();var k=h();if(0===k)h();else if(1===k)for(f(1),m(),m(),t=h(),r=0;r<t;r++)m();v(),f(1);var C=h(),S=h(),_=l(1);0===_&&f(1),f(1),p()&&(s=h(),a=h(),c=h(),d=h());var w=[1,1];if(p()&&p())switch(u()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:w=[u()<<8|u(),u()<<8|u()]}return{width:Math.ceil(16*(C+1)-2*s-2*a),height:(2-_)*(S+1)*16-(_?2:4)*(c+d),pixelRatio:w}},e.prototype.parseSPS=function(e){var t=this.readSPS(new Uint8Array(e));this.track.width=t.width,this.track.height=t.height,this.track.sps=[new Uint8Array(e)],this.track.codec="avc1.";for(var n=new DataView(e.buffer,e.byteOffset+1,4),r=0;r<3;++r){var i=n.getUint8(r).toString(16);i.length<2&&(i="0".concat(i)),this.track.codec+=i}},e.prototype.parsePPS=function(e){this.track.pps=[new Uint8Array(e)]},e}();t.H264Parser=s},9680:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.H265Parser=void 0;var o=i(n(2195)),s=n(7857),a=function(){function e(e){this.remuxer=null,this.track=null,this.remuxer=e,this.track=e.mp4track}return e.parseHeader=function(e){var t=new o.default(e.getPayload());t.readUByte(),e.isfmb=0===t.readUEG(),e.stype=t.readUEG()},e.prototype.parseNAL=function(e){if(!e)return!1;var t=!1;switch(e.type()){case s.NALU265.IDR:case s.NALU265.NDR:t=!0;break;case s.NALU265.PPS:this.track.pps||(this.parsePPS(e.getPayload()),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&this.track.vps&&(this.remuxer.readyToDecode=!0)),t=!0;break;case s.NALU265.SPS:this.track.sps||(this.parseSPS(e.getPayload()),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&this.track.vps&&(this.remuxer.readyToDecode=!0)),t=!0;break;case s.NALU265.VPS:this.track.sps||(this.parseVPS(e.getPayload()),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&this.track.vps&&(this.remuxer.readyToDecode=!0)),t=!0}return t},e.prototype.ebsp2rbsp=function(e){for(var t=new Uint8Array(e.byteLength),n=0,r=0;r<e.byteLength;r++)r>=2&&3===e[r]&&0===e[r-1]&&0===e[r-2]||(t[n]=e[r],n++);return new Uint8Array(t.buffer,0,n)},e.prototype.skipScalingList=function(e,t){for(var n=8,r=8,i=0;i<t;i++)0!==r&&(r=(n+e.readEG()+256)%256),n=0===r?n:r},e.prototype.readVPS=function(e){var t=new o.default(e);return t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6),{numTemporalLayers:t.readBits(3)+1,temporalIdNested:t.readBoolean()}},e.prototype.readSPS=function(e){var t=new o.default(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);var n=t.readBits(3);t.readBoolean();for(var r=t.readBits(2),i=t.readBoolean(),s=t.readBits(5),a=t.readUByte(),c=t.readUByte(),d=t.readUByte(),u=t.readUByte(),l=t.readUByte(),h=t.readUByte(),p=t.readUByte(),f=t.readUByte(),m=t.readUByte(),v=t.readUByte(),g=t.readUByte(),y=[],b=[],k=0;k<n;k++)y.push(t.readBoolean()),b.push(t.readBoolean());if(n>0)for(k=n;k<8;k++)t.readBits(2);for(k=0;k<n;k++)y[k]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),b[k]&&t.readUByte();t.readUEG();var C=t.readUEG();3===C&&t.skipBits(1);var S=t.readUEG(),_=t.readUEG(),w=t.readBoolean(),T=0,E=0,R=0,O=0;w&&(T+=t.readUEG(),E+=t.readUEG(),R+=t.readUEG(),O+=t.readUEG());var M=t.readUEG(),P=t.readUEG(),D=t.readUEG();for(k=t.readBoolean()?0:n;k<=n;k++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(var x=0;x<4;x++)for(var I=0;I<(3===x?2:6);I++)if(t.readBoolean()){var A=Math.min(64,1<<4+(x<<1));for(x>1&&t.readEG(),k=0;k<A;k++)t.readEG()}else t.readUEG();t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());var L=t.readUEG(),j=0;for(k=0;k<L;k++){var B=!1;if(0!==k&&(B=t.readBoolean()),B){k===L&&t.readUEG(),t.readBoolean(),t.readUEG();for(var N=0,U=0;U<=j;U++){var G=t.readBoolean(),F=!1;G||(F=t.readBoolean()),(G||F)&&N++}j=N}else{var W=t.readUEG(),H=t.readUEG();for(j=W+H,U=0;U<W;U++)t.readUEG(),t.readBoolean();for(U=0;U<H;U++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){var V=t.readUEG();for(k=0;k<V;k++){for(U=0;U<D+4;U++)t.readBits(1);t.readBits(1)}}var q=0,K=1,z=1,Y=!0,$=1,X=0;t.readBoolean(),t.readBoolean();var J=!1;if(t.readBoolean()){if(t.readBoolean()){var Q=t.readUByte();Q>0&&Q<16?(K=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][Q-1],z=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][Q-1]):255===Q&&(K=t.readBits(16),z=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),(J=t.readBoolean())&&(T+=t.readUEG(),E+=t.readUEG(),R+=t.readUEG(),O+=t.readUEG()),t.readBoolean()&&($=t.readBits(32),X=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){var Z=t.readBoolean(),ee=t.readBoolean(),te=!1;for((Z||ee)&&((te=t.readBoolean())&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),te&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5)),k=0;k<=n;k++){var ne=!1;(Y=t.readBoolean())||t.readBoolean()?t.readEG():ne=t.readBoolean();var re=ne?1:t.readUEG()+1;if(Z)for(U=0;U<re;U++)t.readUEG(),t.readUEG(),te&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(ee)for(U=0;U<re;U++)t.readUEG(),t.readUEG(),te&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),q=t.readUEG())}var ie=S,oe=_;if(w||J){var se=1,ae=1;1===C?se=ae=2:2===C&&(se=2),ie=S-se*E-se*T,oe=_-ae*O-ae*R}var ce=r?["A","B","C"][r]:"",de=a<<24|c<<16|d<<8|u,ue=0;for(k=0;k<32;k++)ue=(ue|(de>>k&1)<<31-k)>>>0;var le=ue.toString(16);1===s&&"2"===le&&(le="6");var he=i?"H":"L";return{codecString:"hvc1.".concat(ce).concat(s,".").concat(le,".").concat(he).concat(g,".B0"),params:{general_tier_flag:i,general_profile_idc:s,general_profile_space:r,general_profile_compatibility_flags:[a,c,d,u],general_constraint_indicator_flags:[l,h,p,f,m,v],general_level_idc:g,bit_depth:M+8,bit_depth_luma_minus8:M,bit_depth_chroma_minus8:P,min_spatial_segmentation_idc:q,chroma_format_idc:C,frame_rate:{fixed:Y,fps:X/$}},width:ie,height:oe,pixelRatio:[K,z]}},e.prototype.readPPS=function(e){var t=new o.default(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);var n=t.readBoolean(),r=t.readBoolean(),i=1;return r&&n?i=0:r?i=3:n&&(i=2),{parallelismType:i}},e.prototype.parseSPS=function(e){var t=this.readSPS(e);this.track.width=t.width,this.track.height=t.height,this.track.pixelRatio=t.pixelRatio,this.track.codec=t.codecString,this.track.params=r(r({},this.track.params),t.params),this.track.sps=[new Uint8Array(e)],console.log("resolution",this.track.width,this.track.height)},e.prototype.parsePPS=function(e){var t=this.readPPS(e);this.track.params=r(r({},this.track.params),t),this.track.pps=[new Uint8Array(e)]},e.prototype.parseVPS=function(e){this.track.params=r(r({},this.track.params),this.readVPS(e)),this.track.vps=[new Uint8Array(e)]},e}();t.H265Parser=a},6976:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.AACRemuxer=void 0;var c=a(n(266)),d=n(251),u=n(4485),l=function(e){function t(t,n){var r=e.call(this)||this;return r.mp4track={id:u.BaseRemuxer.getTrackID(),type:"audio",channelCount:0,len:0,fragmented:!0,timescale:1e3,duration:0,samples:[],config:"",codec:""},r.dts=0,r.readyToDecode=!1,r.samples=[],r.nextDts=0,r.aac=new d.AACParser(r),r.mp4track.timescale=t,r.mp4track.duration=n,r}return i(t,e),t.prototype.resetTrack=function(){this.readyToDecode=!1,this.mp4track.codec="",this.mp4track.channelCount=0,this.mp4track.config="",this.mp4track.timescale=1e3,this.nextDts=0,this.dts=0},t.prototype.remux=function(e){if(e.length>0)for(var t=0;t<e.length;t++){var n=e[t],r=n.units,i=r.byteLength;this.samples.push({units:r,size:i,duration:n.duration}),this.mp4track.len+=i,this.readyToDecode||this.aac.setAACConfig()}},t.prototype.getPayload=function(){if(!this.isReady())return null;var e,t,n=new Uint8Array(this.mp4track.len),r=0,i=this.mp4track.samples;for(this.dts=this.nextDts;this.samples.length;){var o=this.samples.shift();o.units,(t=o.duration)<=0?(c.log("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(t)),this.mp4track.len-=o.size):(this.nextDts+=t,e={size:o.size,duration:t,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},n.set(o.units,r),r+=o.size,i.push(e))}return i.length?new Uint8Array(n.buffer,0,this.mp4track.len):null},t.prototype.getAacParser=function(){return this.aac},t}(u.BaseRemuxer);t.AACRemuxer=l},4485:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRemuxer=void 0;var n=1,r=function(){function e(){this.mp4track={len:0,samples:[]},this.readyToDecode=!1,this.samples=[]}return e.getTrackID=function(){return n++},e.prototype.flush=function(){this.mp4track.len=0,this.mp4track.samples=[]},e.prototype.isReady=function(){return!(!this.readyToDecode||!this.samples.length)||null},e}();t.BaseRemuxer=r},3739:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.H264Remuxer=void 0;var d=a(n(266)),u=n(7122),l=n(4485),h=function(e){function t(t,n){var r=e.call(this)||this;return r.mp4track={id:l.BaseRemuxer.getTrackID(),type:"video",len:0,fragmented:!0,sps:null,pps:null,codec:"",fps:30,width:0,height:0,timescale:1e3,duration:0,samples:[]},r.readyToDecode=!1,r.dts=0,r.samples=[],r.nextDts=0,r.h264Parser=new u.H264Parser(r),r.mp4track.timescale=t,r.mp4track.duration=n,r}return i(t,e),t.prototype.resetTrack=function(){this.readyToDecode=!1,this.mp4track.sps=null,this.mp4track.pps=null,this.nextDts=0,this.dts=0},t.prototype.remux=function(e){var t,n,r,i;try{for(var o=c(e),s=o.next();!s.done;s=o.next()){var a=s.value,d=0,u=a.units,l=a.keyFrame,h=a.duration,p=a.compositionTimeOffset;try{for(var f=(r=void 0,c(a.units)),m=f.next();!m.done;m=f.next()){var v=m.value;this.h264Parser.parseNAL(v)&&(d+=v.getSize())}}catch(e){r={error:e}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}u.length>0&&this.readyToDecode&&(this.mp4track.len+=d,this.samples.push({units:u,size:d,keyFrame:l,duration:h,compositionTimeOffset:p}))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},t.prototype.getPayload=function(){var e,t;if(!this.isReady())return null;var n=new Uint8Array(this.mp4track.len),r=0;for(this.dts=this.nextDts;this.samples.length;){var i=this.samples.shift(),o=i.units,s=i.size,a=i.duration,u=i.compositionTimeOffset,l=i.keyFrame;if(a<=0)d.log("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(a)),this.mp4track.len-=s;else{this.nextDts+=a;var h={size:s,duration:a,cts:u||0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:l?0:1,dependsOn:l?2:1}};try{for(var p=(e=void 0,c(o)),f=p.next();!f.done;f=p.next()){var m=f.value;n.set(m.getData(),r),r+=m.getSize()}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}this.mp4track.samples.push(h)}}return this.mp4track.samples.length?new Uint8Array(n.buffer,0,this.mp4track.len):null},t}(l.BaseRemuxer);t.H264Remuxer=h},3790:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.H265Remuxer=void 0;var d=a(n(266)),u=n(9680),l=n(4485),h=function(e){function t(t,n){var r=e.call(this)||this;return r.mp4track={id:l.BaseRemuxer.getTrackID(),type:"video",len:0,fragmented:!0,vps:null,sps:null,pps:null,codec:"hvc1.1.6.L150.B0",fps:30,pixelRatio:[0,0],params:{},width:0,height:0,timescale:1e3,duration:0,samples:[]},r.readyToDecode=!1,r.dts=0,r.samples=[],r.nextDts=0,r.h265=new u.H265Parser(r),r.mp4track.timescale=t,r.mp4track.duration=n,r}return i(t,e),t.prototype.resetTrack=function(){this.readyToDecode=!1,this.mp4track.sps=null,this.mp4track.pps=null,this.mp4track.vps=null,this.mp4track.params={},this.nextDts=0,this.dts=0},t.prototype.remux=function(e){var t,n,r,i;try{for(var o=c(e),s=o.next();!s.done;s=o.next()){var a=s.value,d=0,u=a.units,l=a.keyFrame,h=a.duration,p=a.compositionTimeOffset;try{for(var f=(r=void 0,c(a.units)),m=f.next();!m.done;m=f.next()){var v=m.value;this.h265.parseNAL(v)&&(d+=v.getSize())}}catch(e){r={error:e}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}u.length>0&&this.readyToDecode&&(this.mp4track.len+=d,this.samples.push({units:u,size:d,keyFrame:l,duration:h,compositionTimeOffset:p}))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},t.prototype.getPayload=function(){var e,t;if(!this.isReady())return null;var n=new Uint8Array(this.mp4track.len),r=0;for(this.dts=this.nextDts;this.samples.length;){var i=this.samples.shift(),o=i.units,s=i.size,a=i.duration,u=i.compositionTimeOffset,l=i.keyFrame;if(a<=0)d.log("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(a)),this.mp4track.len-=s;else{this.nextDts+=a;var h={size:s,duration:a,cts:u||0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:l?0:1,dependsOn:l?2:1}};try{for(var p=(e=void 0,c(o)),f=p.next();!f.done;f=p.next()){var m=f.value;n.set(m.getData(),r),r+=m.getSize()}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}this.mp4track.samples.push(h)}}return this.mp4track.samples.length?new Uint8Array(n.buffer,0,this.mp4track.len):null},t}(l.BaseRemuxer);t.H265Remuxer=h},1382:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.OpusRemuxer=void 0;var s=n(4485),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mp4track={id:s.BaseRemuxer.getTrackID(),type:"audio",channelCount:2,len:0,timescale:48e3,duration:960,sampleRate:48e3,samples:[],config:{},codec:"opus"},t.dts=0,t.readyToDecode=!1,t.samples=[],t.nextDts=0,t}return i(t,e),t.prototype.resetTrack=function(){this.readyToDecode=!1,this.nextDts=0,this.dts=0},t.prototype.remux=function(e){var t,n;try{for(var r=o(e),i=r.next();!i.done;i=r.next()){var s=i.value,a=s.unit,c=s.duration,d=a.byteLength;this.samples.push({units:a,size:d,duration:c}),this.mp4track.len+=d,this.readyToDecode||(this.readyToDecode=!0)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},t.prototype.getPayload=function(){if(!this.isReady())return null;var e=new Uint8Array(this.mp4track.len),t=0,n=this.mp4track.samples;for(this.dts=this.nextDts;this.samples.length;){var r=this.samples.shift(),i=r.duration,o=r.units,s=r.size;this.nextDts+=i;var a={size:s,duration:i,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};e.set(o,t),t+=s,n.push(a)}return n.length?new Uint8Array(e.buffer,0,this.mp4track.len):null},t}(s.BaseRemuxer);t.OpusRemuxer=a},266:function(e,t){"use strict";var n,r,i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.error=t.log=t.isEnable=t.setLogger=void 0,t.setLogger=function(){n=console.log,r=console.error},t.isEnable=function(){return null!==n},t.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];n&&n.apply(void 0,o([e],i(t),!1))},t.error=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];r&&r.apply(void 0,o([e],i(t),!1))}},8763:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.type="",this.listener={},this.type=e}return e.prototype.on=function(e,t){return this.listener[e]||(this.listener[e]=[]),this.listener[e].push(t),!0},e.prototype.off=function(e,t){if(this.listener[e]){var n=this.listener[e].indexOf(t);return n>-1&&this.listener[e].splice(n,1),!0}return!1},e.prototype.offAll=function(){this.listener={}},e.prototype.dispatch=function(e,t){return!!this.listener[e]&&(this.listener[e].forEach((function(e){e.apply(null,[t])})),!0)},e}();t.default=n},2195:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}return e.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");r.set(e.subarray(n,n+i)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},e.prototype.skipBits=function(e){var t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},e.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;if(e>32&&console.log("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(t=e-t)>0&&this.bitsAvailable?n<<t|this.readBits(t):n},e.prototype.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},e.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},e.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},e.prototype.readBoolean=function(){return 1===this.readBits(1)},e.prototype.readUByte=function(){return this.readBits(8)},e.prototype.readUShort=function(){return this.readBits(16)},e.prototype.readUInt=function(){return this.readBits(32)},e}();t.default=n},5860:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MP4=void 0;var n=function(){function e(){}return e.prototype.init=function(){var e;for(e in this.types={avc1:[],avcC:[],hev1:[],hvcC:[],hvc1:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],Opus:[],dOps:[]},this.types)this.types.hasOwnProperty(e)&&(this.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);this.HDLR_TYPES={video:t,audio:n};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);this.STTS=this.STSC=this.STCO=i,this.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),this.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),this.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),this.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),a=new Uint8Array([0,0,0,1]);this.FTYP=this.box(this.types.ftyp,o,a,o,s),this.DINF=this.box(this.types.dinf,this.box(this.types.dref,r))},e.prototype.box=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r,i=8,o=t.length,s=o;o--;)i+=t[o].byteLength;for((r=new Uint8Array(i))[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=255&i,r.set(e,4),o=0,i=8;o<s;++o)r.set(t[o],i),i+=t[o].byteLength;return r},e.prototype.hdlr=function(e){return this.box(this.types.hdlr,this.HDLR_TYPES[e])},e.prototype.mdat=function(e){return this.box(this.types.mdat,e)},e.prototype.mdhd=function(e,t){return this.box(this.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,85,196,0,0]))},e.prototype.mdia=function(e){return this.box(this.types.mdia,this.mdhd(e.timescale,e.duration),this.hdlr(e.type),this.minf(e))},e.prototype.mfhd=function(e){return this.box(this.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},e.prototype.minf=function(e){return"audio"===e.type?this.box(this.types.minf,this.box(this.types.smhd,this.SMHD),this.DINF,this.stbl(e)):this.box(this.types.minf,this.box(this.types.vmhd,this.VMHD),this.DINF,this.stbl(e))},e.prototype.moof=function(e,t,n){return this.box(this.types.moof,this.mfhd(e),this.traf(n,t))},e.prototype.moov=function(e,t,n){for(var r=e.length,i=[];r--;)i[r]=this.trak(e[r]);return this.box.apply(null,[this.types.moov,this.mvhd(n,t)].concat(i).concat(this.mvex(e)))},e.prototype.mvex=function(e){for(var t=e.length,n=[];t--;)n[t]=this.trex(e[t]);return this.box.apply(null,[this.types.mvex].concat(n))},e.prototype.mvhd=function(e,t){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,e>>24&255,e>>16&255,e>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return this.box(this.types.mvhd,n)},e.prototype.sdtp=function(e){var t,n,r=e.samples||[],i=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)t=r[n].flags,i[n+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return this.box(this.types.sdtp,i)},e.prototype.stbl=function(e){return this.box(this.types.stbl,this.stsd(e),this.box(this.types.stts,this.STTS),this.box(this.types.stsc,this.STSC),this.box(this.types.stsz,this.STSZ),this.box(this.types.stco,this.STCO))},e.prototype.avc1=function(e){var t,n,r,i=[],o=[];for(t=0;t<e.sps.length;t++)r=(n=e.sps[t]).byteLength,i.push(r>>>8&255),i.push(255&r),i=i.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)r=(n=e.pps[t]).byteLength,o.push(r>>>8&255),o.push(255&r),o=o.concat(Array.prototype.slice.call(n));var s=this.box(this.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|e.sps.length].concat(i).concat([e.pps.length]).concat(o))),a=e.width,c=e.height;return this.box(this.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,a>>8&255,255&a,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,98,105,110,101,108,112,114,111,46,114,117,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s)},e.prototype.hvc1=function(e){for(var t=e.params,n=[e.vps,e.sps,e.pps],r=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,+t.frame_rate.fps,3|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]),i=r.length,o=0;o<n.length;o+=1){i+=3;for(var s=0;s<n[o].length;s+=1)i+=2+n[o][s].length}var a=new Uint8Array(i);a.set(r,0),i=r.length;var c=n.length-1;for(o=0;o<n.length;o+=1)for(a.set(new Uint8Array([32+o|(o===c?128:0),0,n[o].length]),i),i+=3,s=0;s<n[o].length;s+=1)a.set(new Uint8Array([n[o][s].length>>8,255&n[o][s].length]),i),i+=2,a.set(n[o][s],i),i+=n[o][s].length;var d=this.box(this.types.hvcC,a),u=e.width,l=e.height;return this.box(this.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,this.box(this.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},e.prototype.esds=function(e){var t=e.config.byteLength,n=new Uint8Array(26+t+3);return n.set([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5,t]),n.set(e.config,26),n.set([6,1,2],26+t),n},e.prototype.mp4a=function(e){var t=e.audiosamplerate;return this.box(this.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),this.box(this.types.esds,this.esds(e)))},e.prototype.dOps=function(e){var t=e.outputChannelCount,n=void 0===t?2:t,r=e.preSkip,i=void 0===r?0:r,o=e.inputSampleRate,s=void 0===o?48e3:o,a=e.outputGain,c=void 0===a?0:a,d=e.channelMappingFamily,u=void 0===d?0:d,l=new Uint8Array(19),h=new DataView(l.buffer);return h.setUint8(0,0),h.setUint8(1,n),h.setUint16(2,i,!1),h.setUint32(4,s,!1),h.setInt16(8,c,!1),h.setUint8(10,u),this.box(this.types.dOps,l)},e.prototype.getUint16=function(e){var t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e),t},e.prototype.Opus=function(e){var t=e.channelCount,n=e.config;return this.box(this.types.Opus,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,this.getUint16(48e3),0,0]),this.dOps(n))},e.prototype.stsd=function(e){return"opus"===e.codec?this.box(this.types.stsd,this.STSD,this.Opus(e)):"audio"===e.type?this.box(this.types.stsd,this.STSD,this.mp4a(e)):e.codec.includes("hvc1")?this.box(this.types.stsd,this.STSD,this.hvc1(e)):this.box(this.types.stsd,this.STSD,this.avc1(e))},e.prototype.tkhd=function(e){var t=e.id,n=e.duration,r=e.width,i=e.height,o=e.volume;return this.box(this.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,o>>0&255,o%1*10>>0&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,i>>8&255,255&i,0,0]))},e.prototype.traf=function(e,t){var n=this.sdtp(e),r=e.id;return this.box(this.types.traf,this.box(this.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),this.box(this.types.tfdt,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t])),this.trun(e,n.length+16+16+8+16+8+8),n)},e.prototype.trak=function(e){return"video"===e.type&&(e.duration=e.duration||4294967295),this.box(this.types.trak,this.tkhd(e),this.mdia(e))},e.prototype.trex=function(e){var t=e.id;return this.box(this.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.prototype.trun=function(e,t){var n,r,i,o,s,a,c=e.samples||[],d=c.length,u=12+16*d,l=new Uint8Array(u);for(t+=8+u,l.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,255&d,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),n=0;n<d;n++)i=(r=c[n]).duration,o=r.size,s=r.flags,a=r.cts,l.set([i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,a>>>24&255,a>>>16&255,a>>>8&255,255&a],12+16*n);return this.box(this.types.trun,l)},e.prototype.initSegment=function(e,t,n){this.types||this.init();var r=this.moov(e,t,n),i=new Uint8Array(this.FTYP.byteLength+r.byteLength);return i.set(this.FTYP),i.set(r,this.FTYP.byteLength),i},e.prototype.initTypes=function(){this.types||this.init()},e}();t.MP4=n;var r=new n;t.default=r},4530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NALU=void 0;var n=function(){function e(t){this.stype=null,this.isfmb=!1,this.isvcl=null,this.payload=null,this.ntype=null,this.payload=t,this.ntype=31&this.payload[0],this.isvcl=this.ntype===e.NDR||this.ntype===e.IDR}return Object.defineProperty(e,"NDR",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IDR",{get:function(){return 5},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SEI",{get:function(){return 6},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SPS",{get:function(){return 7},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PPS",{get:function(){return 8},enumerable:!1,configurable:!0}),Object.defineProperty(e,"AUD",{get:function(){return 9},enumerable:!1,configurable:!0}),e.prototype.type=function(){return this.ntype},e.prototype.isKeyframe=function(){return this.ntype===e.IDR},e.prototype.getPayload=function(){return this.payload},e.prototype.getPayloadSize=function(){return this.payload.byteLength},e.prototype.getSize=function(){return 4+this.getPayloadSize()},e.prototype.getData=function(){var e=new Uint8Array(this.getSize());return new DataView(e.buffer).setUint32(0,this.getSize()-4),e.set(this.getPayload(),4),e},e}();t.NALU=n},7857:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NALU265=void 0;var n=function(){function e(t){this.stype=null,this.isfmb=!1,this.isvcl=null,this.payload=null,this.ntype=null,this.payload=t,this.ntype=this.payload[0]>>1&63,this.isvcl=this.ntype===e.NDR||this.ntype===e.IDR}return Object.defineProperty(e,"NDR",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IDR",{get:function(){return 19},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VPS",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SPS",{get:function(){return 33},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PPS",{get:function(){return 34},enumerable:!1,configurable:!0}),e.prototype.type=function(){return this.ntype},e.prototype.isKeyframe=function(){return this.ntype===e.IDR},e.prototype.getPayload=function(){return this.payload},e.prototype.getPayloadSize=function(){return this.payload.byteLength},e.prototype.getSize=function(){return 4+this.getPayloadSize()},e.prototype.getData=function(){var e=new Uint8Array(this.getSize());return new DataView(e.buffer).setUint32(0,this.getSize()-4),e.set(this.getPayload(),4),e},e}();t.NALU265=n},9320:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractNALu=t.appendByteArray=void 0,t.appendByteArray=function(e,t){var n=new Uint8Array((0|e.byteLength)+(0|t.byteLength));return n.set(e,0),n.set(t,0|e.byteLength),n},t.extractNALu=function(e){for(var t=0,n=e.byteLength,r=[],i=-1;t<n;)t+2<n&&0===e[t]&&0===e[t+1]&&1===e[t+2]?(-1!==i&&r.push(e.slice(i,t)),i=t+3,t+=3):t+3<n&&0===e[t]&&0===e[t+1]&&0===e[t+2]&&1===e[t+3]?(-1!==i&&r.push(e.slice(i,t)),i=t+4,t+=4):t+=1;return-1!==i&&r.push(e.slice(i)),r}},124:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(3578),d=n(9418),u=n(1743),l=a(n(1586)),h=n(8751),p=n(1038),f={},m=function(){function e(e){var t=e.sdk;this.forceShowCursor=!1,this.forceLockCursor=!1,this.showCursor=!0,this.remoteCursorMode=d.CURSOR_MODE.LOCAL,this.mobileCursorScale=1,this.mobileShowCursor=!0,this.originCursorStyle="",this.hotSpot={x:0,y:0},this.remoteCursorImage="",this.token="",this.keepLastFrame=!1,this.serverSideDescription="",this.latestActionTime=+new Date,this.receivedOnloadedmetadataCallback=!1,this.connectBeginTime=0,this.connectTimeoutCount=0,this.connectStatus=d.STATUS.DISCONNECTED,this.heartbeatTimer=null,this.newConnectTimeout=60,this.noflowTimeout=10,this.peerConnection=null,this.kmDataChannel=null,this.ackDataChannel=null,this.hbDataChannel=null,this.cdDataChannel=null,this.svrDataChannel=null,this.cloudDeviceDataChannel=null,this.customDataChannel=new Map,this.ackDataChannelTimer=null,this.mediaStream=null,this.audioMediaStream=null,this.camera=null,this.mic=null,this.cameraMediaStream=null,this.micMediaStream=null,this.audioTransceiver=null,this.videoTransceiver=null,this.cameraProfile=h.CameraProfile["720p"],this.micProfile={sampleRate:44100,echoCancellation:!0,autoGainControl:!0,noiseSuppression:!0,deviceId:null},this.switchCameraRequestQueue=new p.RequestQueue,this.switchCameraRequesting=!1,this.switchMicRequestQueue=new p.RequestQueue,this.switchMicRequesting=!1,this.clientSideDescription=null,this.requestId="",this.firstHitInput=!0,this.dataChannelCallbacks={},this.dataChannelRetryTimers={},this.checkMouseShowInterval=null,this.idleThreshold=3e5,this.idleTimes=0,this.lastInputStatus=!1,this.noFlowCount=0,this.statsThreshold=0,this.gameStatus="playing",this.streamPushStat=null,this._webrtcStartTime=null,this.sdk=null,this.mount=null,this._setRemoteDescriptionTime=null,this.firstFlags={ice:!0,peerConnection:!0,firstFrame:!0},this.sdk=t}return Object.defineProperty(e.prototype,"webrtcStartTime",{get:function(){return this._webrtcStartTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"setRemoteDescriptionTime",{get:function(){return this._setRemoteDescriptionTime},set:function(e){this._setRemoteDescriptionTime=e},enumerable:!1,configurable:!0}),e.prototype.init=function(e){var t,n;return i(this,void 0,void 0,(function(){var r,i,s,a,c;return o(this,(function(o){switch(o.label){case 0:if(this.sdk.log("CloudGamingWebRTC init"),this.forceShowCursor=null!==(t=e.forceShowCursor)&&void 0!==t&&t,this.idleThreshold=e.idleThreshold?1e3*e.idleThreshold:3e5,this.keepLastFrame=null!==(n=e.keepLastFrame)&&void 0!==n&&n,this.mount=e.mount,this.peerConnection)return this.sdk.log("please disconnect(this.sdk.destroy()) before init"),[2,this.sdk.onInitSuccess({code:-2,msg:"please disconnect(this.sdk.destroy()) before init"})];r=(0,u.canReceiveH264)(),i=r.canReceive,s=r.capabilities,this.sdk.log("canReceive",i),this.sdk.log("capabilities.codecs",null==s?void 0:s.codecs),this.sdk.log("capabilities.headerExtensions",null==s?void 0:s.headerExtensions),o.label=1;case 1:return o.trys.push([1,3,,4]),a=this,[4,this.newWebRtcConnect()];case 2:return a.clientSideDescription=o.sent(),this.sdk.onInitSuccess({code:0,msg:"ok",description:this.clientSideDescription}),[3,4];case 3:return c=o.sent(),this.sdk.log("webrtc init error",c.message),this.sdk.onInitSuccess({code:-1,msg:"your browser without webrtc support",description:this.clientSideDescription}),[3,4];case 4:return[2]}}))}))},Object.defineProperty(e.prototype,"debugSetting",{get:function(){return this.sdk.getInitOptions().debugSetting||{}},enumerable:!1,configurable:!0}),e.prototype.sendKmData=function(e){this.idleTimes=0,this.latestActionTime=+new Date,this.debugSetting.showSendKmData&&console.log("sendKmData",e),this.dataChannelSend(this.kmDataChannel,e)},e.prototype.sendAckData=function(e){var t=e.data,n=void 0===t?f:t,r=e.retry,i=void 0===r?0:r,o=e.callback,s=void 0===o?u.noop:o,a=e.interval,c=void 0===a?1e3:a,d=n.type;"cursor_state"!==d&&"keys_clean"!==d&&(this.latestActionTime=+new Date,this.idleTimes=0);var l=(0,u.getSequence)();this.dataChannelSendWithCallback({dataChannel:this.ackDataChannel,ackMsg:{seq:l,data:n},retry:i,callback:s,interval:c}),this.debugSetting.showSendAckData&&("cursor_state"===d||console.log("sendAckData:",n,l))},e.prototype.sendCloudDeviceData=function(e){this.debugSetting.showSendCloudDeviceData&&console.log("sendCloudDeviceData",e),this.dataChannelSend(this.cloudDeviceDataChannel,e)},e.prototype.connect=function(e){var t,n,r;void 0===e&&(e=""),this.sdk.log("connect->"),this.sdk.showStats.setServerSessionTime(+new Date);var i=+new Date;if("connected"===(null===(t=this.peerConnection)||void 0===t?void 0:t.connectionState)||"connecting"===(null===(n=this.peerConnection)||void 0===n?void 0:n.connectionState))return this.sdk.log("peerConnection status is ".concat(null===(r=this.peerConnection)||void 0===r?void 0:r.connectionState,", please clear current connection before call start()")),void this.sdk.onConnectFailed({code:d.CONNECT_FAILED_CODE.TOO_FREQUENTLY,msg:"connect too frequently"});this.connectBeginTime=i,this.connectTimeoutCount=0,this.connectStatus=d.STATUS.CONNECTING;try{this.serverSideDescription=c.Base64.decode(e)}catch(e){throw"serverSession is not base64 string format"}this.serverSideDescription?this.onAnswer(this.serverSideDescription):this.sdk.onWebrtcStatusChange({code:-1,msg:"set server description failed, please try again later."})},e.prototype.getClientSideDescription=function(e){void 0===e&&(e=!0),this.clientSideDescription||console.error("webrtc is not initialized");try{return e?c.Base64.encode(JSON.stringify(this.clientSideDescription)):this.clientSideDescription}catch(e){console.error("clientSideDescription is not jsonString or encoding failure")}},e.prototype.newWebRtcConnect=function(){return i(this,void 0,void 0,(function(){var e,t,n,r=this;return o(this,(function(i){switch(i.label){case 0:i.trys.push([0,2,,3]),this._webrtcStartTime=+new Date,this.sdk.initShowStats();try{this.peerConnection=new RTCPeerConnection({sdpSemantics:"unified-plan"})}catch(e){if(this.sdk.log("new RTCPeerConnection error",e),"ReferenceError"===e.name&&e.message.includes("RTCPeerConnection"))throw this.sdk.onWebrtcStatusChange({code:255,msg:"your browser without webrtc support"}),console.log("your browser without webrtc support"),"your browser without webrtc support";return[2]}return this.connectStatus=d.STATUS.CONNECTING,this.peerConnection.ontrack=function(e){return r.onTrack(e)},this.peerConnection.onconnectionstatechange=function(){return r.onConnectionStateChange()},this.peerConnection.oniceconnectionstatechange=function(){return r.onIceConnectionStateChange()},this.peerConnection.onicecandidate=function(){},this.peerConnection.onnegotiationneeded=function(){r.sdk.log("onnegotiationneeded")},(null===navigator||void 0===navigator?void 0:navigator.mediaDevices)&&(navigator.mediaDevices.ondevicechange=function(e){r.sdk.onDeviceChange(e)}),this.createKmDataChannel(),this.createHbDataChannel(),this.createAckDataChannel(),this.createSvrDataChannel(),this.createCloudDeviceDataChannel(),this.sdk.showStats.toggleMetricReportBulk(!0),e=this.sdk.getInitOptions(),t=e.mic,n=e.camera,null===this.mic&&(this.mic=t),null===this.camera&&(this.camera=n),[4,this.createOffer({mic:this.mic,camera:this.camera})];case 1:return[2,i.sent()];case 2:throw i.sent();case 3:return[2]}}))}))},e.prototype.startHeartbeatReport=function(){var e=this;clearInterval(this.heartbeatTimer),this.sdk.log("startHeartbeatReport ->"),this.heartbeatTimer=setInterval((function(){return i(e,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return[4,null===(n=this.peerConnection)||void 0===n?void 0:n.getStats(null)];case 1:return e=r.sent(),t=[],null==e||e.forEach((function(e){void 0===e&&(e={}),"inbound-rtp"!==e.type&&"track"!==e.type&&"codec"!==e.type&&"candidate-pair"!==e.type||t.push(e)})),0===t.length&&(t=[{type:"inbound-rtp",mediaType:"video"},{type:"track",jitterBufferDelay:100*Math.random()%30+10}]),this.sdk.showStats.setStat(t,e),this.reportStat(),[2]}}))}))}),1e3)},e.prototype.getCursorShowStatus=function(){return!(!this.sdk.isMobileGame&&"touch"!==this.sdk.getClientInteractMode())||this.showCursor},e.prototype.mouseDeltaMove=function(){return this.remoteCursorMode===d.CURSOR_MODE.REMOTE_SRC_POS||this.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS},e.prototype.lockMouse=function(e){var t,n,r;return i(this,void 0,void 0,(function(){var i;return o(this,(function(o){switch(o.label){case 0:if("touch"===this.sdk.getClientInteractMode())return[2];if(!e)return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,null===(n=(t=this.sdk.getVideoElement()).requestPointerLock)||void 0===n?void 0:n.call(t)];case 2:return o.sent(),[3,4];case 3:return i=o.sent(),this.sdk.log("requestPointerLock error",i),this.sdk.onEvent({type:"pointerlockerror"}),[3,4];case 4:return[3,6];case 5:try{null===(r=document.exitPointerLock)||void 0===r||r.call(document)}catch(e){this.sdk.log("exitPointerLock error",e)}o.label=6;case 6:return this.remoteCursorMode===d.CURSOR_MODE.REMOTE_SRC_POS&&(e?this.sdk.pageEvent.setDropMouseEvent(!1):this.sdk.pageEvent.setDropMouseEvent(!0)),[2]}}))}))},e.prototype.isMouseLocked=function(){return document.pointerLockElement===this.sdk.getVideoElement()},e.prototype.setForceShowCursor=function(e){this.forceShowCursor=e},e.prototype.setForceLockCursor=function(e){this.forceLockCursor=e},e.prototype.getForceShowCursor=function(){return this.forceShowCursor},e.prototype.clearPeerConnection=function(){if(this.mediaStream&&(this.mediaStream.getTracks().forEach((function(e){e.stop()})),this.mediaStream=null),this.audioMediaStream&&(this.audioMediaStream.getTracks().forEach((function(e){e.stop()})),this.audioMediaStream=null),this.dataChannelCallbacks={},this.peerConnection){this.kmDataChannel&&(this.kmDataChannel.close(),this.kmDataChannel=null),this.hbDataChannel&&(this.hbDataChannel.close(),this.hbDataChannel=null),this.ackDataChannel&&(this.ackDataChannel.close(),this.ackDataChannel=null),this.cdDataChannel&&(this.cdDataChannel.close(),this.cdDataChannel=null),this.svrDataChannel&&(this.svrDataChannel.close(),this.svrDataChannel=null),this.customDataChannel.size&&(this.customDataChannel.forEach((function(e){return e.close()})),this.customDataChannel.clear()),this.videoTransceiver&&(this.switchTrack({type:"video",status:"remove",userMedia:this.cameraMediaStream}),this.videoTransceiver=null),this.audioTransceiver&&(this.switchTrack({type:"audio",status:"remove",userMedia:this.micMediaStream}),this.audioTransceiver=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection.ontrack=null,this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onicecandidate=null,this.peerConnection=null);var e=this.sdk.getVideoElement();(null==e?void 0:e.srcObject)&&(e.srcObject=null);var t=this.sdk.getAudioElement();(null==t?void 0:t.srcObject)&&(t.srcObject=null)}this.clientSideDescription=null,this.serverSideDescription=null,clearInterval(this.heartbeatTimer),this.checkMouseShowInterval&&(clearInterval(this.checkMouseShowInterval),this.checkMouseShowInterval=null),this.sdk.showStats.toggleMetricReportBulk(!1),this.sdk.pageEvent.clearEvent(),this.receivedOnloadedmetadataCallback=null,this.sdk.log("peerConnection",this.peerConnection)},e.prototype.disconnected=function(e){var t,n=e.message,r=void 0===n?"":n,i=e.code,o=void 0===i?null:i;this.sdk.log("disconnected",o,r),this.connectStatus=d.STATUS.DISCONNECTED,this.keepLastFrame&&(null===(t=this.sdk.getVideoElement())||void 0===t||t.pause()),o===d.RTC_CODE.OTHER_KICK&&this.sdk.getRestartElement()&&(this.sdk.getRestartElement().style.display="block"),this.clearPeerConnection(),this.sdk.getInitOptions().reconnect&&o===d.RTC_CODE.NEED_RECONNECT?this.reconnect({message:r}):(this.sdk.log("destroy code: ".concat(o," and clear reconnect token")),this.sdk.watchdog.setReconnectInfo({serverIp:"",token:""})),this.sdk.onDisconnect({code:o,msg:r}),this.sdk.log("call onDisconnect, code",o)},e.prototype.reconnect=function(e){var t=e.message,n=void 0===t?"":t;this.sdk.log("reconnect, setup reconnect server_ip=".concat(this.gameConfig.server_ip," and token=").concat(this.token)),this.sdk.watchdog.setReconnectInfo({serverIp:this.gameConfig.server_ip,token:this.token}),this.sdk.watchdog.autoReconnect({message:n})},e.prototype.getRemoteCursorState=function(e){this.sendAckData({data:{type:e}})},e.prototype.getIdleTime=function(){return+new Date-this.latestActionTime},e.prototype.checkUserIdle=function(){var e=this.getIdleTime();if(e>this.idleThreshold){var t=Math.floor(e/this.idleThreshold);t>this.idleTimes&&(this.sdk.onNetworkChange({status:"idle",times:t}),this.sdk.onEvent({type:"idle",data:{times:t}}),this.idleTimes=t)}},e.prototype.setCursorMode=function(e){var t=this,n=e;e===d.CURSOR_MODE.REMOTE_SRC_POS&&(n=d.CURSOR_MODE.REMOTE_SRC);var r=n===d.CURSOR_MODE.REMOTE_DRAW;if(this.sendAckData({data:{type:"set_cursor",show:n},callback:function(){t.setCursorShowStatus(!r)}}),this.remoteCursorMode=e,e===d.CURSOR_MODE.REMOTE_SRC||e===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS?this.createCdDataChannel():this.cdDataChannel&&(this.cdDataChannel.close(),this.cdDataChannel=null),e===d.CURSOR_MODE.LOCAL){var i=this.sdk.getVideoElement();i&&(this.sdk.log("videoElement.style.cursor will set to origin style",this.originCursorStyle),i.style.cursor="url(".concat(this.originCursorStyle,") ").concat(this.hotSpot.x," ").concat(this.hotSpot.y,", auto"))}e===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS&&this.lockMouse(!0)},e.prototype.getCursorMode=function(){return this.remoteCursorMode},e.prototype.getCursorHotSpot=function(){return this.hotSpot},e.prototype.setMobileCursorScale=function(e){this.mobileCursorScale=e},e.prototype.getDisplayRect=function(){var e,t=(null===(e=this.sdk.getVideoElement())||void 0===e?void 0:e.getBoundingClientRect())||f,n=t.width,r=void 0===n?0:n,i=t.height,o=void 0===i?0:i,s=t.left,a=void 0===s?0:s,c=t.top;return{left:a,top:void 0===c?0:c,width:r,height:o,pixelRatio:window.devicePixelRatio||1}},e.prototype.setDefaultCursorImage=function(e){if((0,u.isMobile)()){var t=this.sdk.getCursorElement();"dot"===e?(t.style.width="3px",t.style.height="3px",t.style.borderRadius="50%",t.style.backgroundColor="#2dc7ef"):(t.style.width="26px",t.style.height="26px",t.style.backgroundImage="url(".concat(e,")"))}else{var n=this.sdk.getVideoElement();this.originCursorStyle=null!=e?e:"",n.style.cursor="url(".concat(e,") ").concat(this.hotSpot.x," ").concat(this.hotSpot.y,", auto")}},e.prototype.setNewConnectTimeout=function(e){void 0===e&&(e=60),this.newConnectTimeout=e},e.prototype.setNoflowTimeout=function(e){void 0===e&&(e=10),this.noflowTimeout=e},e.prototype.setKeepLastFrame=function(e){void 0===e&&(e=!1),this.keepLastFrame=e},e.prototype.setMobileShowCursor=function(e){void 0===e&&(e=!0),this.mobileShowCursor=e},e.prototype.setGameStatus=function(e){this.gameStatus=e},e.prototype.createCustomDataChannel=function(e){var t,n,r,s=e.destPort,a=void 0===s?1:s,c=e.maxRetransmits,d=e.maxPacketLifeTime,l=e.onMessage,h=void 0===l?u.noop:l,p=e.onClose,f=void 0===p?u.noop:p,m=e.onError,v=void 0===m?u.noop:m,g=e.label,y=void 0===g?"":g,b=e.protocol,k=void 0===b?"text":b,C=e.type,S=void 0===C?"":C;return i(this,void 0,Promise,(function(){var e,i=this;return o(this,(function(o){switch(o.label){case 0:return"open"!==(null===(t=this.ackDataChannel)||void 0===t?void 0:t.readyState)?[2,{code:1,msg:"ack dataChannel does not open, please try again later."}]:(y||(y="cs".concat(S?"_".concat(S):"","_").concat(a)),this.sdk.log("start createCustomDataChannel, destPort: ".concat(a,", ackDataChannel state: ").concat(null===(n=this.ackDataChannel)||void 0===n?void 0:n.readyState,", label: ").concat(y,", protocol: ").concat(k,", maxRetransmits: ").concat(c,", maxRetransmits: ").concat(d)),(e=null===(r=this.peerConnection)||void 0===r?void 0:r.createDataChannel(y,{ordered:!0,maxRetransmits:c,maxPacketLifeTime:d}))?(e.onmessage=function(e){var t,n;i.sdk.log("dataChannel:".concat(y," onmessage"),"string"==typeof e.data?null===(t=e.data)||void 0===t?void 0:t.length:null===(n=e.data)||void 0===n?void 0:n.byteLength),h(e.data)},e.onclose=function(e){return f(e)},e.onerror=function(e){return v(e)},this.customDataChannel.set(a,e),[4,new Promise((function(e){i.sendAckData({data:{type:"udp_trans",dest_port:a,protocol:k,label:y},callback:function(t){var n=t.data;i.sdk.log("createCustomDataChannel label:".concat(y," destPort:").concat(a," success"),n),e({code:n.code,msg:n.msg})}}),i.sdk.log("customDataChannels",i.customDataChannel),setTimeout((function(){e({code:3,msg:"request timeout, please try again later."})}),5e3)}))]):[3,2]);case 1:return[2,o.sent()];case 2:return this.sdk.log("createCustomDataChannel fail"),[2,{code:1}]}}))}))},e.prototype.sendCustomDataChannelMessage=function(e){var t=e.destPort,n=void 0===t?0:t,r=e.msg,i=void 0===r?"":r,o=this.customDataChannel.get(n);"open"===(null==o?void 0:o.readyState)&&(this.sdk.log("sendCustomDataChannelMessage",i.length,n,null==o?void 0:o.readyState),o.send(i))},e.prototype.setTrackEnable=function(e){var t=e.type,n=void 0===t?"audio":t,r=e.enable,i=void 0===r||r;if(this.sdk.log("setTrackEnable type",n,"enable",i),"audio"===n)return this.audioTransceiver.sender?(this.audioTransceiver.sender.track.enabled=i,this.sdk.log("audioTransceiver.sender",this.audioTransceiver.sender,i),{code:0}):{code:1,message:"audioTransceiver.sender is null"}},e.prototype.switchTrack=function(e){var t,n,r,s,a=e.type,c=e.status,d=e.userMedia;return i(this,void 0,Promise,(function(){var e;return o(this,(function(i){switch(i.label){case 0:return this.sdk.log("switchTrack type",a,"status",c),"audio"!==a?[3,6]:this.audioTransceiver.sender?"add"!==c?[3,2]:(e=null===(t=null==d?void 0:d.getAudioTracks())||void 0===t?void 0:t[0],[4,this.audioTransceiver.sender.replaceTrack(e)]):[3,5];case 1:i.sent(),i.label=2;case 2:return"remove"!==c?[3,4]:[4,this.audioTransceiver.sender.replaceTrack(null)];case 3:i.sent(),null===(n=null==d?void 0:d.getAudioTracks()[0])||void 0===n||n.stop(),i.label=4;case 4:return[2,{code:0,message:"success"}];case 5:return[2,{code:1,message:"audioTransceiver.sender is null"}];case 6:return"video"!==a?[3,12]:this.videoTransceiver.sender?"add"!==c?[3,8]:(e=null===(r=null==d?void 0:d.getVideoTracks())||void 0===r?void 0:r[0],[4,this.videoTransceiver.sender.replaceTrack(e)]):[3,11];case 7:i.sent(),i.label=8;case 8:return"remove"!==c?[3,10]:[4,this.videoTransceiver.sender.replaceTrack(null)];case 9:i.sent(),null===(s=null==d?void 0:d.getVideoTracks()[0])||void 0===s||s.stop(),i.label=10;case 10:return[2,{code:0,message:"success"}];case 11:return[2,{code:2,message:"videoTransceiver.sender is null"}];case 12:return[2]}}))}))},e.prototype.getMediaStream=function(){return this.mediaStream},e.prototype.getUserMedia=function(){var e,t,n=new MediaStream;return null===(e=this.cameraMediaStream)||void 0===e||e.getTracks().forEach((function(e){n.addTrack(e)})),null===(t=this.micMediaStream)||void 0===t||t.getTracks().forEach((function(e){n.addTrack(e)})),n},e.prototype.switchMic=function(e){var t,n=e.status,r=e.profile;return i(this,void 0,Promise,(function(){var e,i,s,a,c,d;return o(this,(function(o){switch(o.label){case 0:if(this.sdk.log("switchMic status",n,r),"open"!==n)return[3,5];if(null===(t=this.audioTransceiver.sender)||void 0===t?void 0:t.track)return this.sdk.log("mic opened, audioTransceiver sender",this.audioTransceiver.sender),[2,{code:1,msg:"mic opened",userMedia:null}];o.label=1;case 1:return o.trys.push([1,4,,5]),e=this,[4,this.createUserMedia({mic:null==r||r})];case 2:return e.micMediaStream=o.sent(),[4,this.switchTrack({type:"audio",status:"add",userMedia:this.micMediaStream})];case 3:return i=o.sent(),c=i.code,d=i.message,this.mic=r,this.sdk.onGetUserMediaStatusChange({msg:"mic open",type:"mic",userMedia:this.micMediaStream}),this.sendAckData({data:{type:"switch_mic",status:"open"}}),[2,{code:c,msg:d,userMedia:this.micMediaStream}];case 4:return s=o.sent(),this.sdk.onGetUserMediaStatusChange({msg:s,type:"mic"}),[2,{code:1,msg:s,userMedia:null}];case 5:return"close"!==n?[3,7]:[4,this.switchTrack({type:"audio",status:"remove",userMedia:this.micMediaStream})];case 6:return a=o.sent(),c=a.code,d=a.message,this.mic=!1,this.sdk.onGetUserMediaStatusChange({msg:"mic close",type:"mic"}),this.sendAckData({data:{type:"switch_mic",status:"close"}}),[2,{code:c,msg:d,userMedia:null}];case 7:return[2]}}))}))},e.prototype.switchCamera=function(e){var t,n=e.status,r=e.profile;return i(this,void 0,Promise,(function(){var e,i,s,a,c,d;return o(this,(function(o){switch(o.label){case 0:if(this.sdk.log("switchCamera status",n),"open"!==n)return[3,5];if(null===(t=this.videoTransceiver.sender)||void 0===t?void 0:t.track)return this.sdk.log("camera opened, videoTransceiver sender",this.videoTransceiver.sender),[2,{code:1,msg:"camera opened",userMedia:null}];o.label=1;case 1:return o.trys.push([1,4,,5]),e=this,[4,this.createUserMedia({camera:null==r||r})];case 2:return e.cameraMediaStream=o.sent(),[4,this.switchTrack({type:"video",status:"add",userMedia:this.cameraMediaStream})];case 3:return i=o.sent(),c=i.code,d=i.message,this.camera=r,this.sdk.onGetUserMediaStatusChange({msg:"camera open",type:"camera",userMedia:this.cameraMediaStream}),this.sendAckData({data:{type:"switch_camera",status:"open"}}),[2,{code:c,msg:d,userMedia:this.cameraMediaStream}];case 4:return s=o.sent(),this.sdk.onGetUserMediaStatusChange({msg:s,type:"camera"}),[2,{code:1,msg:s,userMedia:null}];case 5:return"close"!==n?[3,7]:[4,this.switchTrack({type:"video",status:"remove",userMedia:this.cameraMediaStream})];case 6:return a=o.sent(),c=a.code,d=a.message,this.camera=!1,this.sendAckData({data:{type:"switch_camera",status:"close"}}),this.sdk.onGetUserMediaStatusChange({msg:"camera close",type:"camera"}),[2,{code:c,msg:d,userMedia:this.cameraMediaStream}];case 7:return[2]}}))}))},e.prototype.setMicProfile=function(e){var t,n;return i(this,void 0,Promise,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:if(this.sdk.log("setMicProfile",e),!this.mic)return this.sdk.log("please open mic"),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),r=this,[4,this.createUserMedia({mic:e})];case 2:return r.micMediaStream=o.sent(),this.micMediaStream?(null===(t=this.audioTransceiver.sender)||void 0===t||t.replaceTrack(null===(n=this.micMediaStream.getAudioTracks())||void 0===n?void 0:n[0]),this.sdk.onGetUserMediaStatusChange({msg:"setMicProfile success",type:"mic",userMedia:this.micMediaStream}),[2,{code:0,msg:"success",userMedia:this.micMediaStream}]):[3,4];case 3:return i=o.sent(),this.sdk.onGetUserMediaStatusChange({msg:i,type:"mic"}),[2,{code:1,msg:i,userMedia:null}];case 4:return[2]}}))}))},e.prototype.setCameraProfile=function(e){var t,n;return i(this,void 0,Promise,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:if(this.sdk.log("setCameraProfile",e),!this.camera)return this.sdk.log("please open camera"),[2];if("string"==typeof e&&e===this.cameraProfile.type)return this.sdk.log("profile is same as last value"),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),r=this,[4,this.createUserMedia({camera:e})];case 2:return r.cameraMediaStream=o.sent(),this.cameraMediaStream?(null===(t=this.videoTransceiver.sender)||void 0===t||t.replaceTrack(null===(n=this.cameraMediaStream.getVideoTracks())||void 0===n?void 0:n[0]),this.sdk.onGetUserMediaStatusChange({msg:"setCameraProfile success",type:"camera",userMedia:this.cameraMediaStream}),[2,{code:0,msg:"success",userMedia:this.cameraMediaStream}]):[3,4];case 3:return i=o.sent(),this.sdk.onGetUserMediaStatusChange({msg:i,type:"camera"}),[2,{code:1,msg:i,userMedia:null}];case 4:return[2]}}))}))},e.prototype.setCameraBitrate=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:if(!("RTCRtpSender"in window)||!("setParameters"in window.RTCRtpSender.prototype))return[3,7];if(!this.videoTransceiver.sender)return[3,5];(t=this.videoTransceiver.sender.getParameters()).encodings||(t.encodings=[{}]),"unlimited"===e?delete t.encodings[0].maxBitrate:t.encodings[0].maxBitrate=1e3*e,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.videoTransceiver.sender.setParameters(t)];case 2:return r.sent(),this.sdk.log("setCameraBitrate success ".concat("number"==typeof e?e:"unlimited"," kbps")),[3,4];case 3:return n=r.sent(),this.sdk.log("setCameraBitrate error",n),[3,4];case 4:return[3,6];case 5:this.sdk.log("camera sender is not found"),r.label=6;case 6:return[3,8];case 7:this.sdk.log("can not find RTCRtpSender in window"),r.label=8;case 8:return[2]}}))}))},e.prototype.getDevices=function(){return i(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,navigator.mediaDevices.enumerateDevices()];case 1:return e=r.sent(),this.sdk.log("getDevices",e),t=null==e?void 0:e.filter((function(e){return e.kind.includes("input")&&"default"!==e.deviceId})),this.sdk.log("inputDevices",t),[2,t];case 2:throw n=r.sent(),this.sdk.log("getDevices error",n),n;case 3:return[2]}}))}))},e.prototype.getRequestId=function(){return this.requestId},e.prototype.getWebrtcConnectStatus=function(){return this.connectStatus},Object.defineProperty(e.prototype,"gameConfig",{get:function(){return this.sdk.gameConfig.getConfig({clientId:this.mount})},enumerable:!1,configurable:!0}),e.prototype.renegotiation=function(e){return i(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){switch(i.label){case 0:if(this.sdk.log("renegotiation"),!(0,u.supportRenegotiation)())return this.sdk.log("renegotiation not support"),this.sdk.log("ios version is",(0,u.getIOSVersion)()),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),this.sdk.log("renegotiation setRemoteDescription"),this.setRemoteDescriptionTime=+new Date,[4,this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:e,type:"offer"}))];case 2:return i.sent(),[3,4];case 3:return t=i.sent(),this.sdk.log("renegotiation setRemoteDescription exception->",t,t.message),this.sdk.onWebrtcStatusChange({code:-1,msg:"setRemoteDescription failed."}),[3,4];case 4:return i.trys.push([4,7,,8]),[4,this.peerConnection.createAnswer()];case 5:return n=i.sent(),this.sdk.log("renegotiation setLocalDescription"),[4,this.peerConnection.setLocalDescription(n)];case 6:return i.sent(),this.sendAckData({data:{type:"user_update",sdp:n.sdp}}),[3,8];case 7:return r=i.sent(),this.sdk.log("renegotiation setLocalDescription exception->",r,r.message),[3,8];case 8:return[2]}}))}))},e.prototype.onAnswer=function(e){var t,n;return void 0===e&&(e=""),i(this,void 0,void 0,(function(){var r,i,s,a,c,u,l,h,p,f,m,v,g,y,b,k,C,S,_;return o(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,5,,6]),r=JSON.parse(e),this.sdk.log("onAnswer-> serverSideDescriptionObject",r),!r)return[2,this.sdk.onConnectFailed({code:d.CONNECT_FAILED_CODE.INVALID_SERVER_SESSION,msg:"Server session not available "})];i=r.game_config,s=r.code,a=r.message,c=r.screen_config,u=r.plat,l=r.request_id,h=r.server_ip,p=r.region,f=r.instance_id,m=r.instance_type,v=r.host_name,g=r.video_mime_type,y=r.audio_mime_type,this.requestId=l,b=c.orientation,k=c.width,C=c.height,o.label=1;case 1:return o.trys.push([1,3,,4]),this.setRemoteDescriptionTime=+new Date,[4,this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:r.sdp,type:"answer"}))];case 2:return o.sent(),this.sdk.gameConfig.setConfig({clientId:this.mount,config:r}),this.sdk.showStats.setStaticStat({serverIp:h,region:p,instanceId:f,instanceType:m,hostName:v,requestId:l,videoMimeType:g,audioMimeType:y}),this.setGameConfig(i),this.sdk.setServerSideDescription({serverSideDescription:r}),[3,4];case 3:return S=o.sent(),this.sdk.log("setRemoteDescription exception->",S),this.sdk.onWebrtcStatusChange({code:-1,msg:"setRemoteDescription failed."}),this.sdk.onConnectFailed({code:-7,msg:"setRemoteDescription failed."}),[3,4];case 4:return"android"===(null==u?void 0:u.toLocaleLowerCase())&&(this.sdk.mobileGame=!0,this.sdk.pageEvent.remoteScreenResolutionChange({width:null!==(t="portrait"===b?k:C)&&void 0!==t?t:0,height:null!==(n="portrait"===b?C:k)&&void 0!==n?n:0,left:0,top:0})),this.sdk.onWebrtcStatusChange({code:s>1e3?d.ANSWER_SDP_CODE.PROXY_ERROR:s,msg:a}),this.sdk.pageEvent.setRemoteScreenConfig(c),this.sdk.pageEvent.initOrientationDetector(),[3,6];case 5:return _=o.sent(),this.sdk.log("parse serverSideDescription error",_),this.sdk.onWebrtcStatusChange({code:-1,msg:"parse serverSideDescription error"}),[3,6];case 6:return[2]}}))}))},e.prototype.setGameConfig=function(e){void 0===e&&(e=f);var t=e.sdk_conf;if(t){var n=this.sdk.getInitOptions().keepLastFrame;t.connect_timeout&&this.setNewConnectTimeout(t.connect_timeout),t.noflow_timeout&&this.setNoflowTimeout(t.noflow_timeout),t.cursor_scale&&this.setMobileCursorScale(t.cursor_scale),t.cursor_style&&this.sdk.setRemoteCursorStyle(t.cursor_style),"boolean"==typeof t.keep_lastframe&&void 0===n&&this.setKeepLastFrame(t.keep_lastframe),"boolean"==typeof t.mobile_show_cursor&&this.setMobileShowCursor(t.mobile_show_cursor)}},e.prototype.createUserMedia=function(e){var t=e.mic,n=void 0!==t&&t,s=e.camera,a=void 0!==s&&s;return i(this,void 0,void 0,(function(){var e,t,i,s,c,d,l,p,f,m,v;return o(this,(function(o){switch(o.label){case 0:return n?(this.sdk.log("createUserMedia mic",n),e=null,"object"!=typeof n?[3,2]:(this.micProfile=r(r({},this.micProfile),n),p=this.micProfile.deviceId,[4,this.getDevices()])):[3,6];case 1:f=o.sent().map((function(e){return e.deviceId})),this.sdk.log("deviceId",p),this.sdk.log("deviceIds",f),e=r(r({},this.micProfile),{deviceId:f.includes(p)?{exact:p}:void 0}),o.label=2;case 2:"boolean"==typeof n&&(e=n),this.sdk.log("micProfile",this.micProfile),this.sdk.log("micConstraints",e),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,navigator.mediaDevices.getUserMedia({audio:e})];case 4:return[2,o.sent()];case 5:throw t=o.sent(),this.sdk.log("getUserMedia mic error",t,null==t?void 0:t.name),t.name;case 6:return a?(this.sdk.log("createUserMedia camera",a),i=null,"string"==typeof a&&(Object.keys(h.CameraProfile).includes(a)?this.cameraProfile=h.CameraProfile[a]:this.sdk.log("".concat(a," is not included in camera profile types, use default settings"))),"object"==typeof a&&(this.cameraProfile=r(r({},this.cameraProfile),a)),s=this.cameraProfile,c=s.width,d=s.height,l=s.frameRate,p=s.deviceId,!(0,u.isMobile)()||"user"!==p&&"environment"!==p?[3,7]:(i={facingMode:{exact:p}},[3,10])):[3,14];case 7:return o.trys.push([7,9,,10]),[4,this.getDevices()];case 8:return f=o.sent().map((function(e){return e.deviceId})),this.sdk.log("deviceId",p),this.sdk.log("deviceIds",f),i={width:{ideal:c},height:{ideal:d},frameRate:l,deviceId:f.includes(p)?{exact:p}:void 0},[3,10];case 9:return m=o.sent(),this.sdk.log("getDevices error, use default cameraConstraints",m.message),i={width:{ideal:c},height:{ideal:d},frameRate:l},[3,10];case 10:"boolean"==typeof a&&(i=a),this.sdk.log("cameraConstraints",i),o.label=11;case 11:return o.trys.push([11,13,,14]),[4,navigator.mediaDevices.getUserMedia({video:i})];case 12:return[2,o.sent()];case 13:throw v=o.sent(),this.sdk.log("getUserMedia camera error",v,null==v?void 0:v.name),v.name;case 14:return[2]}}))}))},e.prototype.createOffer=function(e){var t=e.mic,n=void 0!==t&&t,r=e.camera,s=void 0!==r&&r;return i(this,void 0,void 0,(function(){var e,t;return o(this,(function(r){switch(r.label){case 0:return this.sdk.log("create offer","mic",n,"camera",s),this.videoTransceiver=this.peerConnection.addTransceiver("video",{direction:"sendrecv"}),this.audioTransceiver=this.peerConnection.addTransceiver("audio",{direction:"sendrecv"}),n?[4,this.switchMic({status:"open",profile:n})]:[3,2];case 1:r.sent(),r.label=2;case 2:return s?[4,this.switchCamera({status:"open",profile:s})]:[3,4];case 3:r.sent(),r.label=4;case 4:return r.trys.push([4,7,,8]),e=this.onOffer,[4,this.peerConnection.createOffer()];case 5:return[4,e.apply(this,[r.sent()])];case 6:return[2,r.sent()];case 7:return t=r.sent(),this.sdk.log("create offer error",t),this.disconnected({message:"create offer is failed",code:d.RTC_CODE.CREATE_OFFER_FAILED}),[3,8];case 8:return[2]}}))}))},e.prototype.onOffer=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,s,a,c,d,l,h,p,f,m,v;return o(this,(function(o){switch(o.label){case 0:this.sdk.log("onOffer->",e),t=e.sdp,n=e.type,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.peerConnection.setLocalDescription({type:n,sdp:t})];case 2:return o.sent(),r=this.peerConnection.localDescription,i=(0,u.checkProfileLevelId)(r.sdp),this.sdk.log("available profile-level-ids: ",i.join(",")),s=this.sdk.getInitOptions(),a=s.remoteDesktopResolution,c=s.streaming,l=(d=void 0===c?{}:c).videoCodecList,h=void 0===l?[]:l,p=d.streamName,f=s.streamProfile,m=s.userId,this.clientSideDescription={sdp:t,type:n,deviceInfo:{platform:(0,u.isMobile)()?"mobile":"pc",user_agent:(0,u.is360)()?"".concat(null===navigator||void 0===navigator?void 0:navigator.userAgent," 360 browser"):null===navigator||void 0===navigator?void 0:navigator.userAgent},sdkType:"JS",desktopResolution:(null==a?void 0:a.width)&&(null==a?void 0:a.height)?"".concat(a.width,"x").concat(null==a?void 0:a.height):null,preferredCodecList:h.map((function(e){return e.toUpperCase()})),streamName:p,streamProfile:f,userId:m},[2,this.clientSideDescription];case 3:throw v=o.sent(),this.sdk.log("onOffer exception->",null==v?void 0:v.message,null==v?void 0:v.name),null==v?void 0:v.message;case 4:return[2]}}))}))},e.prototype.checkAckDataChannelStatus=function(){var e,t,n=this;this.sdk.log("checkAckDataChannelStatus",null===(e=this.ackDataChannel)||void 0===e?void 0:e.readyState),"open"===(null===(t=this.ackDataChannel)||void 0===t?void 0:t.readyState)?(clearInterval(this.ackDataChannelTimer),this.ackDataChannelTimer=null,this.onLoadedMetaData()):this.ackDataChannelTimer||(this.ackDataChannelTimer=setInterval((function(){n.checkAckDataChannelStatus()}),500))},e.prototype.onTrack=function(e){var t=this;if(this.sdk.log("onTrack",e.track.kind,e.track),"audio"===e.track.kind&&e.track.label.includes("|")){var n=s(e.track.label.split("|"),2),r=n[0],i=n[1];return this.sdk.log("on audio Track",e.track.label,r,i,e.streams[0].id),this.sdk.createAudioAndAddTrack({id:i,source:e.streams[0]})}this.mediaStream||(this.mediaStream=new MediaStream),this.audioMediaStream||(this.audioMediaStream=new MediaStream),"video"===e.track.kind&&0===this.mediaStream.getVideoTracks().length&&(this.sdk.log("add video stream"),this.mediaStream.addTrack(e.track)),"audio"===e.track.kind&&0===this.audioMediaStream.getAudioTracks().length&&(this.sdk.log("add audio stream"),this.audioMediaStream.addTrack(e.track),(0,u.isHuawei)()&&this.sdk.createAudioAndAddTrack({id:"tcg-audio-huawei",source:this.audioMediaStream}));var o=this.sdk.getVideoElement();o&&(o.srcObject||(o.srcObject=this.mediaStream),"video"===e.track.kind&&(this.sdk.log("on video Track"),"onloadedmetadata"in HTMLVideoElement.prototype?(this.sdk.log("onloadedmetadata in HTMLVideoElement.prototype"),o.onloadedmetadata=function(){t.receivedOnloadedmetadataCallback||(t.sdk.log("onloadedmetadata callback"),t.receivedOnloadedmetadataCallback=!0,t.checkAckDataChannelStatus())},setTimeout((function(){t.receivedOnloadedmetadataCallback||(t.sdk.log("onloadedmetadata timeout, check status"),t.receivedOnloadedmetadataCallback=!0,t.checkAckDataChannelStatus())}),1e3)):this.checkAckDataChannelStatus()));var a=this.sdk.getAudioElement();a&&(a.srcObject?this.sdk.log("audio srcObject is not null"):a.srcObject=this.audioMediaStream,"audio"===e.track.kind&&this.sdk.log("on audio Track"))},e.prototype.onLoadedMetaData=function(){var e,t,n,r,s,a,c=this;if(this.sdk.log("onLoadedMetaData->"),this.connectStatus===d.STATUS.DISCONNECTED)return this.sdk.log("connectStatus is disconnected, onLoadedMetaData return");this.sdk.getCloudGamingContainerElement()&&(this.sdk.getCloudGamingContainerElement().style.display="flex"),this.sdk.getProgressBarElement()&&(this.sdk.getProgressBarElement().style.display="none"),this.sdk.getRestartElement()&&(this.sdk.getRestartElement().style.display="none"),this.sdk.getInitOptions().autoFocusVideo&&this.sdk.getVideoElement().focus(),null===(n=null===(t=null===(e=this.sdk.getVideoElement())||void 0===e?void 0:e.play())||void 0===t?void 0:t.then((function(){return i(c,void 0,void 0,(function(){var e=this;return o(this,(function(t){switch(t.label){case 0:return this.sdk.log("video play success"),[4,new Promise((function(t){var n=null,r=function(){clearTimeout(n);var i=e.sdk.getVideoElement(),o=i.videoWidth,s=i.videoHeight;if(e.sdk.log("videoWidth",o,"videoHeight",s),o&&s){var a=+new Date-e.sdk.accessTime;e.sdk.log("First frame rendered",o,s,"duration",a),e.sdk.onEvent({type:"first_frame",data:{duration:a,width:o,height:s}}),e.sdk.showStats.setFirstFrameCost(a),e.sdk.showStats.addEventReport({event_code:"first_frame_render",consume_time:a,i1:e.firstFlags.firstFrame?1:0}),e.firstFlags.firstFrame=!1,t(null)}else n=setTimeout((function(){r()}),50)};r()}))];case 1:return t.sent(),this.sdk.onEvent({type:"autoplay",data:{code:0,mediaType:"video",message:"video play success"}}),this.sdk.reshapeWindow("videoPlay"),[2]}}))}))})))||void 0===n||n.catch((function(e){c.sdk.log("video play error, ",e,e.name),c.sdk.onEvent({type:"autoplay",data:{mediaType:"video",code:-1,message:e}})})),null===(a=null===(s=null===(r=this.sdk.getAudioElement())||void 0===r?void 0:r.play())||void 0===s?void 0:s.then((function(){c.sdk.log("audio play success"),c.sdk.onEvent({type:"autoplay",data:{code:0,message:"audio play success",mediaType:"audio"}})})))||void 0===a||a.catch((function(e){c.sdk.log("audio play error, ",e,e.name),c.sdk.onEvent({type:"autoplay",data:{code:-1,message:e,mediaType:"audio"}})})),this.sdk.showStats.setConnectSuccessTime(+new Date),this.connectStatus=d.STATUS.ESTABLISHED,this.checkMouseShowInterval||(this.checkMouseShowInterval=setInterval((function(){c.checkUserIdle()}),100)),this.startHeartbeatReport(),this.sdk.onWebrtcStatsChange(d.PAGE_STATS.PLAYING,this.mount),this.sdk.onConnectSuccess({code:0,seat_index:this.gameConfig.input_seat,role:this.gameConfig.role}),this.sdk.onConfigurationChange({screen_config:this.sdk.getRemoteScreenConfig()})},e.prototype.onConnectionStateChange=function(){var e;this.sdk.log("onconnectionstatechange",null===(e=this.peerConnection)||void 0===e?void 0:e.connectionState),this.peerConnection&&("connected"===this.peerConnection.connectionState&&(this.sdk.showStats.addEventReport({event_code:"peer_connection_change",event_result_msg:this.peerConnection.connectionState,consume_time:+new Date-this.setRemoteDescriptionTime,i1:this.firstFlags.peerConnection?1:0}),this.firstFlags.peerConnection=!1),"disconnected"===this.peerConnection.connectionState&&this.sdk.showStats.addEventReport({event_code:"peer_connection_change",event_result_msg:this.peerConnection.connectionState}),"failed"===this.peerConnection.connectionState&&this.sdk.showStats.addEventReport({event_code:"peer_connection_change",event_result_msg:this.peerConnection.connectionState}))},e.prototype.onIceConnectionStateChange=function(){this.sdk.log("onIceConnectionStateChange",this.peerConnection.iceConnectionState),this.peerConnection?("connected"===this.peerConnection.iceConnectionState&&(this.sdk.showStats.setIceConnectedTime(+new Date),this.sdk.onEvent({type:"ice_state",data:{value:"connected"}}),this.sdk.showStats.addEventReport({event_code:"ice_connection_change",event_result_msg:this.peerConnection.iceConnectionState,consume_time:+new Date-this.setRemoteDescriptionTime,i1:this.firstFlags.ice?1:0}),this.firstFlags.ice=!1),"disconnected"===this.peerConnection.iceConnectionState&&(this.sdk.onEvent({type:"ice_state",data:{value:"disconnected"}}),this.sdk.log("The ICE disconnected, please check the network."),this.sdk.log("Follow the link, https://cloud.tencent.com/document/product/1547/75988, and check your network."),this.disconnected({message:"The ICE disconnected, please check the network.",code:d.RTC_CODE.NEED_RECONNECT}),this.sdk.onEvent({type:"ice_state",data:{value:"disconnected"}}),this.sdk.showStats.addEventReport({event_code:"ice_connection_change",event_result_msg:this.peerConnection.iceConnectionState})),"failed"===this.peerConnection.iceConnectionState&&this.sdk.showStats.addEventReport({event_code:"ice_connection_change",event_result_msg:this.peerConnection.iceConnectionState})):this.sdk.log("The peerConnection disconnected")},e.prototype.createKmDataChannel=function(){var e=this;this.sdk.log("start createKmDataChannel"),this.kmDataChannel=this.peerConnection.createDataChannel(d.DATACHANNEL.KM,{ordered:!0,maxRetransmits:10}),this.kmDataChannel.onmessage=function(t){return e.onKmMessage(t)},this.kmDataChannel.onopen=function(t){return e.onDataChannelOpen(t)},this.kmDataChannel.onclose=function(t){return e.onDataChannelClose(t)},this.kmDataChannel.onerror=function(t){return e.onDataChannelError(t)}},e.prototype.createHbDataChannel=function(){var e=this;this.sdk.log("start createHbDataChannel"),this.hbDataChannel=this.peerConnection.createDataChannel(d.DATACHANNEL.HB,{ordered:!0,maxRetransmits:0}),this.hbDataChannel.onmessage=function(t){return e.onHbMessage(t)},this.hbDataChannel.onopen=function(t){return e.onDataChannelOpen(t)},this.hbDataChannel.onclose=function(t){return e.onDataChannelClose(t)},this.hbDataChannel.onerror=function(t){return e.onDataChannelError(t)}},e.prototype.createAckDataChannel=function(){var e=this;this.sdk.log("start createAckDataChannel"),this.ackDataChannel=this.peerConnection.createDataChannel(d.DATACHANNEL.ACK,{ordered:!0,maxRetransmits:10}),this.ackDataChannel.onmessage=function(t){return e.onAckMessage(t)},this.ackDataChannel.onopen=function(t){return e.onDataChannelOpen(t)},this.ackDataChannel.onclose=function(t){return e.onDataChannelClose(t)},this.ackDataChannel.onerror=function(t){return e.onDataChannelError(t)}},e.prototype.createCdDataChannel=function(){var e,t=this;this.sdk.log("start createCdDataChannel"),this.cdDataChannel=null===(e=this.peerConnection)||void 0===e?void 0:e.createDataChannel(d.DATACHANNEL.CD,{ordered:!0,maxRetransmits:0}),this.cdDataChannel&&(this.cdDataChannel.onmessage=function(e){return t.onCdMessage(e)},this.cdDataChannel.onopen=function(e){return t.onDataChannelOpen(e)},this.cdDataChannel.onclose=function(e){return t.onDataChannelClose(e)},this.cdDataChannel.onerror=function(e){return t.onDataChannelError(e)})},e.prototype.createSvrDataChannel=function(){var e,t=this;this.sdk.log("start createSvrDataChannel"),this.svrDataChannel=null===(e=this.peerConnection)||void 0===e?void 0:e.createDataChannel(d.DATACHANNEL.SVR,{ordered:!0,maxRetransmits:0}),this.svrDataChannel&&(this.svrDataChannel.onmessage=function(e){return t.onSvrMessage(e)},this.svrDataChannel.onopen=function(e){return t.onDataChannelOpen(e)},this.svrDataChannel.onclose=function(e){return t.onDataChannelClose(e)},this.svrDataChannel.onerror=function(e){return t.onDataChannelError(e)})},e.prototype.createCloudDeviceDataChannel=function(){var e,t=this;this.sdk.log("start createCloudDeviceDataChannel"),this.cloudDeviceDataChannel=null===(e=this.peerConnection)||void 0===e?void 0:e.createDataChannel(d.DATACHANNEL.CLOUD_DEVICE,{ordered:!0,maxRetransmits:0}),this.cloudDeviceDataChannel&&(this.cloudDeviceDataChannel.onmessage=function(e){return t.onCloudDeviceMessage(e)},this.cloudDeviceDataChannel.onopen=function(e){return t.onDataChannelOpen(e)},this.cloudDeviceDataChannel.onclose=function(e){return t.onDataChannelClose(e)},this.cloudDeviceDataChannel.onerror=function(e){return t.onDataChannelError(e)})},e.prototype.onDataChannelError=function(e){var t=e||{},n=t.target,r=t.error;this.sdk.log("".concat(n.label," datachannel error->"),null==r?void 0:r.message)},e.prototype.onDataChannelOpen=function(e){var t=(e||{}).target;this.sdk.log("".concat(t.label," datachannel open->"),t.readyState,t.label),"hb"===t.label&&this.startHeartbeatReport()},e.prototype.onDataChannelClose=function(e){var t=(e||{}).target;this.sdk.log("".concat(t.label," datachannel close->"),t.readyState)},e.prototype.onKmMessage=function(e){var t=JSON.parse(e.data);this.debugSetting.showOnKmMessage&&console.log("onKmMessage",t);var n=t.screen_width,r=t.screen_height,i=t.screen_left,o=t.screen_top,s=t.cursor_showing;this.sdk.pageEvent.remoteScreenResolutionChange({width:n,height:r,left:i,top:o}),this.sdk.showStats.setCpuAndGpuUsage({cpu:t.cpu_usage,gpu:t.gpu_usage}),this.setCursorShowStatus(null==s||s)},e.prototype.onHbMessage=function(e){var t=JSON.parse(e.data),n=t.token,r=t.code,i=t.user_id,o=t.timestamp,s=t.message,a=t.stream_push_state;if(n&&(this.token=n),this.debugSetting.showOnHbMessage&&console.log("onHbMessage",t),r>=0&&(this.sdk.log("onHbMessage",s),this.disconnected({message:s,code:r})),i&&this.sdk.onNetworkChange({status:"stats",stats:t}),o){var c=+new Date-+o;this.sdk.showStats.setRTT(c)&&(i?this.gameConfig.user_id===i&&this.sdk.onNetworkChange({status:"jitter",data:{value:c,message:"NETWORK_JITTER"}}):this.sdk.onNetworkChange({status:"jitter",data:{value:c,message:"NETWORK_JITTER"}}))}this.streamPushStat!==a&&(this.streamPushStat=a,this.sdk.onStreamPushStateChange({stream_push_state:this.streamPushStat}))},e.prototype.onAckMessage=function(e){try{var t=JSON.parse(e.data),n=t.data,r=void 0===n?f:n,i=t.seq;if(this.debugSetting.showOnAckMessage&&("cursor_state"===r.type||"keys_clean"===r.type||console.log("onAckMessage",r,i)),"seats_info_sync"===r.type)return;var o=this.dataChannelCallbacks[i];if(i&&(this.sdk.showStats.setInputEnd(i),o)){var s=o.callback;delete this.dataChannelCallbacks[i],this.dataChannelRetryTimers[i]&&(clearTimeout(this.dataChannelRetryTimers[i]),delete this.dataChannelRetryTimers[i]),null==s||s({code:0,msg:"on ack message",data:r})}switch(r.type){case"cursor_state":if(!r.state)return;this.setCursorShowStatus("showing"===r.state);break;case"game_launched":this.sdk.log("game_launched",r),this.sdk.onNetworkChange({status:"gamelaunched",data:{begin:r.launch_begin,finish:r.launch_complete}});break;case"input_seat":this.sdk.log("got new input_seat",r),this.sdk.gameConfig.setConfig({clientId:this.mount,config:{input_seat:r.input_seat}});break;case"user_state":this.sdk.log("user state update",r),this.sdk.onMultiPlayerChange({user_state:{user_id:r.user_id,state:r.state}});break;case"open_url":this.sdk.log("got open_url",r),this.sdk.onNetworkChange({status:"openurl",data:{value:r.url}}),this.sdk.onEvent({type:"openurl",data:{value:r.url}});break;case"vmaf_test":default:break;case"user_sdk_update":this.sdk.log("user_sdk_update",r),this.setRemoteDescriptionTime=+new Date,this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:r.sdp,type:"answer"}));break;case"user_update":this.sdk.log("user_update"),this.renegotiation(r.sdp);break;case"sync_seats":this.sdk.log("sync_seats",r),o||this.sdk.onMultiPlayerChange({seats_info:{players:r.players,viewers:r.viewers}});var a=this.gameConfig.user_id,c=r.players.find((function(e){return e.name===a}));c&&(0!==c.mic_status&&1!==c.mic_status||this.setTrackEnable({type:"audio",enable:!1}),2===c.mic_status&&this.setTrackEnable({type:"audio",enable:!0}));break;case"submit_seat_change":this.sdk.log("submit_seat_change",r),o||this.sdk.onMultiPlayerChange({submit_seat_change:{user_id:r.user_id,to_role:r.to_role,seat_index:r.seat_index}});break;case"cursor_pos":if(this.remoteCursorMode===d.CURSOR_MODE.REMOTE_SRC_POS){var u=r.x,l=r.y,h=this.sdk.pageEvent.transferLocalScale({width:u-this.hotSpot.x,height:l-this.hotSpot.y}),p=h.width,m=h.height;this.sdk.pageEvent.updateCursorPosition({displayX:p,displayY:m})}}}catch(e){this.sdk.log("onAckMessage exception->",null==e?void 0:e.message)}},e.prototype.onCdMessage=function(e){var t=this,n=e.data;if(n)try{var r=JSON.parse(n),i=r.data,o=r.hotspotx,s=void 0===o?0:o,a=r.hotspoty,c=void 0===a?0:a;this.debugSetting.showOnCdMessage&&this.sdk.log("onCdMessage image data->".concat(i.length," ").concat((0,l.default)(i)),"hotspotx",s,"hotspoty",c),this.hotSpot.x=s,this.hotSpot.y=c;var h="data:image/png;base64,".concat(i);this.remoteCursorImage=h;var p=new Image;p.onload=function(){if(t.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS)(e=t.sdk.getCursorElement()).style.backgroundImage="url(".concat(h,")"),e.style.top="auto",e.style.left="auto",t.resizeMobileCursor({width:p.width,height:p.height});else if((0,u.isMobile)()||t.remoteCursorMode===d.CURSOR_MODE.REMOTE_SRC_POS){var e;(e=t.sdk.getCursorElement()).style.backgroundImage="url(".concat(h,")"),t.resizeMobileCursor({width:16,height:16})}else{var n=t.sdk.getVideoElement();n&&(n.style.cursor="url(".concat(h,") ").concat(t.hotSpot.x," ").concat(t.hotSpot.y,", auto"))}},p.onerror=function(e){this.sdk.log("onCdMessage image data load failed",e)},p.src=h}catch(e){this.sdk.log("onCdMessage data parse failed",e)}else this.sdk.log("onCdMessage no data")},e.prototype.onSvrMessage=function(e){var t=e.data;return i(this,void 0,void 0,(function(){var e,n,r,i,s,a,c,d,l,h,p,f,m,v,g,y,b,k,C;return o(this,(function(o){switch(o.label){case 0:if(!t)return[3,48];o.label=1;case 1:switch(o.trys.push([1,46,,47]),e=JSON.parse(t),n=e.type,r=e.data,this.debugSetting.showOnSvMessage&&this.sdk.log("onSvMessage","type: ",n,"data",t),n){case"game_start_complete":return[3,2];case"game_stopped":return[3,3];case"archive_load_status":return[3,4];case"archive_save_status":return[3,5];case"metric_sig_key":return[3,6];case"screen_config_change":return[3,7];case"hit_input":return[3,8];case"ime":return[3,13];case"camera_status":return[3,14];case"mic_status":return[3,31]}return[3,44];case 2:return this.sdk.onGameStartComplete(r),[3,45];case 3:return this.sdk.onGameStop(r),[3,45];case 4:return this.sdk.onLoadGameArchive(r),[3,45];case 5:return this.sdk.onSaveGameArchive(r),[3,45];case 6:return this.sdk.gameConfig.setConfig({clientId:this.mount,config:{metric_key:r.sig_key}}),[3,45];case 7:return i=r,this.sdk.pageEvent.setRemoteScreenConfig(i),[3,45];case 8:return a=(s=r).field_type,c=s.status,d=s.text,l=s.start_index,this.sdk.onInputStatusChange({field_type:a,status:c}),this.sdk.log("ime type",this.sdk.pageEvent.IMEType,this.sdk.isMobileGame),this.sdk.isMobileGame?(h=this.sdk.getFakeInputElement(),"normal_input"!==a?[3,11]:this.firstHitInput?[4,(0,u.sleep)(200)]:[3,10]):[3,12];case 9:o.sent(),o.label=10;case 10:return this.firstHitInput=!1,h.value=d,h.focus(),h.setRangeText("",l,l,"end"),[3,12];case 11:h.blur(),h.value="",o.label=12;case 12:return[3,45];case 13:return p=r.ime_type,this.sdk.pageEvent.IMEType=p,[3,45];case 14:return m=(f=r).status,v=f.height,g=f.width,this.sdk.log("onSvMessage camera_status",m,v,g,this.camera),this.sdk.getInitOptions().autoSwitchCamera?this.switchCameraRequesting?[4,this.switchCameraRequestQueue.startBlocking()]:[3,16]:[3,30];case 15:o.sent(),o.label=16;case 16:this.switchCameraRequesting=!0,o.label=17;case 17:return o.trys.push([17,28,29,30]),"open_front"!==m?[3,21]:this.camera?[4,this.switchCamera({status:"close"})]:[3,19];case 18:o.sent(),o.label=19;case 19:return[4,this.switchCamera({status:"open",profile:(0,u.isMobile)()?{deviceId:"user"}:this.sdk.isMobileGame?{width:720,height:1280}:null})];case 20:o.sent(),o.label=21;case 21:return"open_back"!==m?[3,25]:this.camera?[4,this.switchCamera({status:"close"})]:[3,23];case 22:o.sent(),o.label=23;case 23:return[4,this.switchCamera({status:"open",profile:(0,u.isMobile)()?{deviceId:"environment"}:this.sdk.isMobileGame?{width:720,height:1280}:null})];case 24:o.sent(),o.label=25;case 25:return"close"!==m?[3,27]:[4,this.switchCamera({status:"close"})];case 26:o.sent(),o.label=27;case 27:return this.switchCameraRequesting=!1,[3,30];case 28:return y=o.sent(),this.sdk.log("camera_status switch camera error,",y.message),this.switchCameraRequesting=!1,[3,30];case 29:return this.switchCameraRequesting=!1,this.switchCameraRequestQueue.nextTask(),[7];case 30:return this.sdk.onEvent({type:"camera_status",data:{status:m,width:g,height:v}}),[3,45];case 31:return b=r.status,this.sdk.log("onSvMessage mic_status",b,this.mic),this.sdk.getInitOptions().autoSwitchMic?this.switchMicRequesting?[4,this.switchMicRequestQueue.startBlocking()]:[3,33]:[3,43];case 32:o.sent(),o.label=33;case 33:this.switchMicRequesting=!0,o.label=34;case 34:return o.trys.push([34,41,42,43]),"open"!==b?[3,38]:this.mic?[4,this.switchMic({status:"close"})]:[3,36];case 35:o.sent(),o.label=36;case 36:return[4,this.switchMic({status:"open",profile:this.mic})];case 37:o.sent(),o.label=38;case 38:return"close"!==b?[3,40]:[4,this.switchMic({status:"close"})];case 39:o.sent(),o.label=40;case 40:return[3,43];case 41:return k=o.sent(),this.sdk.log("mic_status switch mic error,",k.message),this.switchMicRequesting=!1,[3,43];case 42:return this.switchMicRequesting=!1,this.switchMicRequestQueue.nextTask(),[7];case 43:return this.sdk.onEvent({type:"mic_status",data:{status:b}}),[3,45];case 44:return[3,45];case 45:return[3,47];case 46:return C=o.sent(),this.sdk.log("onSvMessage data parse failed",C),[3,47];case 47:return[3,49];case 48:this.sdk.log("onSvMessage no data"),o.label=49;case 49:return[2]}}))}))},e.prototype.onCloudDeviceMessage=function(e){var t=e.data;return i(this,void 0,void 0,(function(){var e,n,r,i,s,a,c;return o(this,(function(o){switch(o.label){case 0:if(!t)return[3,18];o.label=1;case 1:switch(o.trys.push([1,16,,17]),e=JSON.parse(t),n=e.type,r=e.data,this.debugSetting.showOnCloudDeviceMessage&&this.sdk.log("onCloudDeviceData","type: ",n,"data",t,"cloudDeviceData",r),n){case"trans_message":return[3,2];case"system_usage":return[3,3];case"clipboard_event":return[3,4];case"notification_event":return[3,9];case"system_status":return[3,10];case"distribute_progress_event":return[3,11];case"join":return[3,12];case"set_sync_list":return[3,13]}return[3,14];case 2:return this.sdk.onAndroidInstanceEvent({type:"trans_message",data:r}),[3,15];case 3:return this.sdk.onAndroidInstanceEvent({type:"system_usage",data:r}),[3,15];case 4:i=!0,s=r.text,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,navigator.clipboard.writeText(s)];case 6:return o.sent(),[3,8];case 7:return a=o.sent(),console.log("navigator.clipboard.writeText failed",a),i=!1,[3,8];case 8:return this.sdk.onAndroidInstanceEvent({type:"clipboard_event",data:{text:s,writeText:i}}),[3,15];case 9:return this.sdk.onAndroidInstanceEvent({type:"notification_event",data:r}),[3,15];case 10:return this.sdk.onAndroidInstanceEvent({type:"system_status",data:r}),[3,15];case 11:return this.sdk.onAndroidInstanceEvent({type:"distribute_progress_event",data:r}),[3,15];case 12:return this.sdk.onAndroidInstanceEvent({type:"join",data:r}),[3,15];case 13:return this.sdk.onAndroidInstanceEvent({type:"set_sync_list",data:r}),[3,15];case 14:return[3,15];case 15:return[3,17];case 16:return c=o.sent(),this.sdk.log("onCloudDeviceData data parse failed",c),[3,17];case 17:return[3,19];case 18:this.sdk.log("onCloudDeviceData no data"),o.label=19;case 19:return[2]}}))}))},e.prototype.resizeMobileCursor=function(e){var t=e.width,n=void 0===t?16:t,r=e.height,i=void 0===r?16:r,o=this.sdk.getCursorElement();o.style.width="".concat(Math.round(n*this.mobileCursorScale),"px"),o.style.height="".concat(Math.round(i*this.mobileCursorScale),"px"),o.style.borderRadius=null,o.style.backgroundColor=null},e.prototype.reportStat=function(){var e=this.sdk.showStats.getStats(),t=e.fps;if(this.connectStatus===d.STATUS.CONNECTING&&(this.connectTimeoutCount+=1,this.connectTimeoutCount>=this.newConnectTimeout&&(this.sdk.log("connect timeout, no-flow notify"),this.sdk.onNetworkChange({status:"noflow"}),this.sdk.onEvent({type:"noflow"}),this.disconnected({message:"connect timeout, please reconnect",code:d.RTC_CODE.NEED_RECONNECT}),this.connectTimeoutCount=0)),this.connectStatus===d.STATUS.ESTABLISHED&&(0===t&&"playing"===this.gameStatus?(this.noFlowCount+=1,this.noFlowCount>=this.noflowTimeout&&(this.sdk.log("noFlowCount reach, no-flow notify"),this.sdk.onNetworkChange({status:"noflowcenter"}),this.sdk.onEvent({type:"noflowcenter"}),this.noFlowCount=0)):this.noFlowCount=0),!this.hbDataChannel)return this.sdk.log("hbDataChannel has been closed");if(e.timestamp=+new Date,this.connectStatus!==d.STATUS.DISCONNECTED){var n=e.fps,i=e.delay,o=e.bit_rate,s=e.packet_lost,a=e.nack,c=e.packet_received,u=r(r({},e),{fps:"".concat(n),delay:"".concat(i),bit_rate:"".concat(8*o),packet_lost:"".concat(s),nack:"".concat(a),packet_received:"".concat(c)});this.dataChannelSend(this.hbDataChannel,u),this.debugSetting.showSendHbData&&console.log("sendHbData",u);var l=this.sdk.getInitOptions().statsInterval;if(this.statsThreshold=this.statsThreshold+1,this.statsThreshold%l==0){this.sdk.onNetworkChange({status:"stats",stats:e}),this.sdk.onEvent({type:"webrtc_stats",data:e});var h=this.sdk.showStats.getMediaStats();this.sdk.onEvent({type:"media_stats",data:h}),this.statsThreshold=0}}this.sdk.showStats.addPerformanceReportStat()},e.prototype.dataChannelSend=function(e,t){"open"===(null==e?void 0:e.readyState)&&e.send(JSON.stringify(t))},e.prototype.dataChannelSendWithCallback=function(e){var t=this,n=e.dataChannel,r=void 0===n?null:n,i=e.ackMsg,o=void 0===i?f:i,s=e.retry,a=void 0===s?0:s,c=e.callback,d=void 0===c?u.noop:c,l=e.interval,h=void 0===l?1e3:l;if("open"===(null==r?void 0:r.readyState))try{var p=o.seq;if(p||(p=(0,u.getSequence)(),this.sdk.showStats.setInputStart(p)),r.send(JSON.stringify(o)),this.dataChannelCallbacks[p]={ackMsg:o,retry:a,callback:d,interval:h,retryAction:function(){if(!t.dataChannelCallbacks[p])return t.sdk.log(r.label,p,"ackItem not exist");var e=t.dataChannelCallbacks[p];if(e.retry>=1||-1===e.retry)t.sdk.log(r.label,p,"ackItem retry, remain ".concat(e.retry," times")),e.retry=e.retry>=1?e.retry-1:e.retry,t.dataChannelSendWithCallback({dataChannel:r,ackMsg:e.ackMsg,retry:e.retry,callback:e.callback,interval:e.interval});else{var n=e.callback;delete t.dataChannelCallbacks[p],t.dataChannelRetryTimers[p]&&(t.sdk.showStats.setInputEnd(p),clearTimeout(t.dataChannelRetryTimers[p]),delete t.dataChannelRetryTimers[p],t.sdk.log("ack msg timer timeout clear:",p)),n({code:1,msg:"send ack message timeout"}),t.sdk.log("send ack message timeout:",p)}}},a>0){var m=setTimeout((function(){var e;null===(e=t.dataChannelCallbacks[p])||void 0===e||e.retryAction()}),h);this.dataChannelRetryTimers[p]=m}}catch(e){this.sdk.log("ack msg exception:",e)}},e.prototype.setCursorShowStatus=function(e){var t,n;if(this.connectStatus===d.STATUS.ESTABLISHED){this.forceShowCursor?this.lockMouse(!1):this.forceLockCursor?this.lockMouse(!0):e?this.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS?this.sdk.getCursorElement().style.display="block":this.lockMouse(!1):this.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS?this.sdk.getCursorElement().style.display="none":this.lockMouse(!0),this.forceLockCursor?this.showCursor=!1:(e!==this.showCursor&&(this.sdk.log("cursor show stat will set to",e),this.sdk.onCursorShowStatChange({oldStatus:this.showCursor,newStatus:e})),this.showCursor=e);var r=null===(t=this.sdk)||void 0===t?void 0:t.getVideoElement(),i=null===(n=this.sdk)||void 0===n?void 0:n.getCursorElement();if(this.remoteCursorMode!==d.CURSOR_MODE.REMOTE_SRC_POS){if(this.remoteCursorMode===d.CURSOR_MODE.REMOTE_DRAW)return r.style.cursor="none";r&&(this.remoteCursorMode===d.CURSOR_MODE.FRONT_DRAW_DELTA_POS?r.style.cursor="auto":e||this.forceShowCursor||"touch"===this.sdk.getClientInteractMode()?r.style.cursor="url(".concat(this.remoteCursorImage?this.remoteCursorImage:this.originCursorStyle,") ").concat(this.hotSpot.x," ").concat(this.hotSpot.y,", auto"):r.style.cursor="none"),(0,u.isMobile)()&&((e||this.forceShowCursor||"touch"===this.sdk.getClientInteractMode())&&this.mobileShowCursor?i.style.display="block":i.style.display="none")}else(e||this.forceShowCursor)&&this.mobileShowCursor?i.style.display="block":i.style.display="none"}},e}();t.default=m},4415:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(3139),a=n(9418),c=n(1252),d=n(1743),u=o(n(5236)),l=function(){function e(e){var t=e.sdk;this.sdk=null,this.token=null,this.instanceId=null,this.url="",this.socket=null,this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder,this.heartbeatTimer=null,this.streamPushStat=null,this.videoState="play",this.videoMuxer=null,this.audioMuxer=null,this.sessionInfo=null,this.lastVideoFrameTimeStamp=0,this.dataChannelCallbacks={},this.dataChannelRetryTimers={},this.mount=null,this.sdk=t}return e.prototype.init=function(e){var t=e.mount;this.mount=t},e.prototype.connect=function(e){var t=e.url,n=e.protocols,o=void 0===n?["media-v1"]:n,s=e.token,a=e.instanceId,c=e.videoCodecList,d=void 0===c?["h264","h265"]:c;return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.token=s,this.instanceId=a,this.url=t,t?[4,this.createSocket({url:"".concat(t,"/play?token=").concat(s,"&instance_id=").concat(a,"&video_codec_list=").concat(d.join(",")),protocols:o})]:[3,2];case 1:return e.sent(),[3,3];case 2:this.sdk.log("websocket connect url is empty",t),e.label=3;case 3:return[2]}}))}))},e.prototype.connectGroupControl=function(e){var t=e.url,n=e.protocols,o=void 0===n?["media-v1"]:n,s=e.tokenInfos,a=e.videoCodecList,c=void 0===a?["h264","h265"]:a;return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.url=t,[4,this.createSocket({url:"".concat(t,"/group/play?video_codec_list=").concat(c.join(",")),protocols:o})];case 1:return 0===e.sent().code&&this.createGroupSession({tokenInfos:s}),[2]}}))}))},e.prototype.joinGroupControl=function(e){var t=e.tokenInfos,n=e.groupControlId;return r(this,void 0,void 0,(function(){return i(this,(function(e){return this.sdk.log("websocket join group session"),this.sendText({Type:"JoinGroupSession",RequestId:(0,s.v4)(),Data:{TokenInfos:t,GroupControlId:n}}),[2]}))}))},e.prototype.dataChannelSend=function(e){var t=e.label,n=e.binary,o=void 0===n?0:n,s=e.data;return r(this,void 0,void 0,(function(){var e,n,r,a,u,l;return i(this,(function(i){switch(i.label){case 0:return e=new Uint8Array([c.DataChannelProtocols.message,o]).buffer,n=this.textEncoder.encode(t).buffer,r=new ArrayBuffer(4),new DataView(r).setUint32(0,n.byteLength),a=this.textEncoder.encode(JSON.stringify(s)).buffer,u=new ArrayBuffer(4),new DataView(u).setUint32(0,a.byteLength),[4,(0,d.concatArrayBuffers)(e,r,n,u,a)];case 1:return l=i.sent(),this.socket.send(l),[2]}}))}))},e.prototype.destroy=function(e){var t,n,r=e.code,i=e.message;this.socket.close(),this.clearIntervals(),this.sdk.onDisconnect({code:r,msg:i}),null===(t=this.videoMuxer)||void 0===t||t.destroy(),null===(n=this.audioMuxer)||void 0===n||n.destroy()},e.prototype.reconnect=function(e){var t=e.message;this.sdk.log("websocket reconnect, message",t),this.connect({token:this.token,url:this.url,instanceId:this.instanceId})},e.prototype.getMuxer=function(e){return"video"===e?this.videoMuxer:"audio"===e?this.audioMuxer:void 0},e.prototype.setMediaState=function(e){var t=e.type,n=e.state;"video"===t&&(this.videoState=n)},e.prototype.createSocket=function(e){var t=e.url,n=e.protocols;return r(this,void 0,void 0,(function(){var e=this;return i(this,(function(r){return[2,new Promise((function(r){e.socket=new WebSocket(t,n),e.socket.binaryType="arraybuffer",e.socket.onopen=function(){e.sdk.log("socket onopen, socket binaryType",e.socket.binaryType),r({code:0,message:"onopen"})},e.socket.onmessage=function(t){var n=t.data;(0,d.isArrayBuffer)(n)?e.onArrayBufferMessage(n):e.onTextMessage(n)},e.socket.onclose=function(t){e.sdk.log("socket onclose",t),e.clearIntervals(),r({code:1,message:"onclose"})},e.socket.onerror=function(t){e.sdk.log("socket onerror",t),e.clearIntervals(),r({code:2,message:"onerror"})}}))]}))}))},e.prototype.onTextMessage=function(e){try{var t=JSON.parse(e),n=t.Type,r=t.Data,i=r.Code;switch(n){case"CreateSession":case"CreateGroupSession":0===i&&this.onCreateSessionSuccess(r)}}catch(e){this.sdk.log("Parse text message error",e)}},e.prototype.onArrayBufferMessage=function(e){var t=new DataView(e),n=t.getUint8(0);if(n===c.MediaCodecs.h264||n===c.MediaCodecs.h265){var r=t.getUint32(1),i=e.slice(5,e.byteLength);this.processVideoFrameBuffer({frame:i,duration:(r-this.lastVideoFrameTimeStamp)/90}),this.lastVideoFrameTimeStamp=r}if(n===c.MediaCodecs.opus&&(i=e.slice(5,e.byteLength),this.processOpusFrameBuffer(i)),n===c.DataChannelProtocols.message){var o=t.getUint32(2),s=e.slice(6,6+o),d=e.slice(2+o+4+4,e.byteLength),u=this.textDecoder.decode(s);i=this.textDecoder.decode(d),u===a.DATACHANNEL.KM&&this.onKmMessage(i),u===a.DATACHANNEL.SV&&this.onSvrMessage(i),u===a.DATACHANNEL.HB&&this.onHbMessage(i),u===a.DATACHANNEL.CLOUD_DEVICE&&this.onCloudDeviceMessage(i),u===a.DATACHANNEL.ACK&&this.onAckMessage(i)}},e.prototype.processVideoFrameBuffer=function(e){var t,n,r,i=e.frame,o=e.duration;"play"===this.videoState&&(null===(t=this.videoMuxer)||void 0===t||t.feed({avc:"h264"===(null===(n=this.sessionInfo)||void 0===n?void 0:n.Video)?new Uint8Array(i):void 0,hevc:"h265"===(null===(r=this.sessionInfo)||void 0===r?void 0:r.Video)?new Uint8Array(i):void 0,duration:o}))},e.prototype.processOpusFrameBuffer=function(e){var t;null===(t=this.audioMuxer)||void 0===t||t.feed({opus:new Uint8Array(e)})},e.prototype.createSession=function(e){var t=e.Token,n=e.InstanceId;this.sdk.log("websocket createSession, instanceId",n),this.sendText({Type:"CreateSession",Data:{Token:t,AndroidInstanceId:n,VideoCodecList:["h264"]}})},e.prototype.createGroupSession=function(e){var t=e.tokenInfos;this.sdk.log("websocket create group session"),this.sendText({Type:"CreateGroupSession",RequestId:(0,s.v4)(),Data:{TokenInfos:t}})},e.prototype.sendText=function(e){this.sdk.log("websocket sendText",e),this.socket.send(JSON.stringify(e))},e.prototype.onCreateSessionSuccess=function(e){var t=this;this.sessionInfo=e;var n=e.Video,r=e.Audio,i=e.GroupControlId;this.sdk.log("Video",n,"Audio",r,"GroupControlId",i),this.sdk.androidInstance.groupControl.groupControlId=i,this.sdk.androidInstance.groupControl.onConnectSuccess(),this.sdk.gameConfig.setConfig({clientId:this.mount,config:{video_mime_type:"video/".concat(n.toLowerCase()),audio_mime_type:"audio/".concat(null==r?void 0:r.Codec.toLowerCase())}});var o="h265"===n?"hevc":"avc";this.videoMuxer=new u.default({node:".".concat(this.mount," .video-stream"),mode:{avc:"h264"===n||void 0,hevc:"h265"===n||void 0},debug:this.debugSetting.showMuxer,onReady:function(){var e,n,r;t.sdk.getCloudGamingContainerElement()&&(t.sdk.getCloudGamingContainerElement().style.display="flex"),t.sdk.getProgressBarElement()&&(t.sdk.getProgressBarElement().style.display="none"),t.sdk.getRestartElement()&&(t.sdk.getRestartElement().style.display="none"),t.startHeartbeatReport(),t.sdk.pageEvent.addEventHandler(),t.sdk.onConnectSuccess({code:0});var i=t.videoMuxer.getVideoResolution({type:o}),s=i.width,a=i.height;t.sdk.showStats.setStaticStat({resolution:"".concat(s,"x").concat(a)}),null===(r=null===(n=null===(e=t.sdk.getVideoElement())||void 0===e?void 0:e.play())||void 0===n?void 0:n.then((function(){t.sdk.log("video play success"),t.sdk.onEvent({type:"autoplay",data:{code:0,message:"video play success"}}),t.sdk.reshapeWindow()})))||void 0===r||r.catch((function(e){t.sdk.log("video play error, ",e,e.name),t.sdk.onEvent({type:"autoplay",data:{code:-1,message:e}})}))}});var s=r.Channels,a=r.SampleRate,c=r.PcmFrameSize;this.audioMuxer=new u.default({node:".".concat(this.mount," .cloud-gaming-audio-stream-socket"),mode:{opus:!0},maxDelay:1e3,opusConfig:{SampleRate:a,SampleFormat:16,Channels:s,PcmFrameSize:c},debug:this.debugSetting.showMuxer})},e.prototype.createDataChannel=function(e){var t=e.label;return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return this.sdk.log("create ".concat(t," data channel")),e=this.textEncoder.encode(t),[4,(0,d.concatArrayBuffers)(new Uint8Array([c.DataChannelProtocols.open]).buffer,e.buffer)];case 1:return n=r.sent(),this.socket.send(n),[2]}}))}))},e.prototype.startHeartbeatReport=function(){var e=this;clearInterval(this.heartbeatTimer),this.sdk.log("startHeartbeatReport ->"),this.heartbeatTimer=setInterval((function(){return r(e,void 0,void 0,(function(){return i(this,(function(e){return this.dataChannelSend({label:a.DATACHANNEL.HB,data:{user_id:this.instanceId,timestamp:+new Date}}),[2]}))}))}),5e3)},Object.defineProperty(e.prototype,"debugSetting",{get:function(){return this.sdk.getInitOptions().debugSetting||{}},enumerable:!1,configurable:!0}),e.prototype.onKmMessage=function(e){try{var t=JSON.parse(e);this.debugSetting.showOnKmMessage&&console.log("onKmMessage",t);var n=t.screen_width,r=t.screen_height,i=t.screen_left,o=t.screen_top;this.sdk.pageEvent.remoteScreenResolutionChange({width:n,height:r,left:i,top:o})}catch(e){this.sdk.log("parse km message error",e)}},e.prototype.onSvrMessage=function(e){if(e)try{var t=JSON.parse(e),n=t.type,r=t.data;switch(this.debugSetting.showOnSvMessage&&this.sdk.log("onSvMessage","type: ",n,"data",e),n){case"metric_sig_key":this.sdk.gameConfig.setConfig({clientId:this.mount,config:{metric_key:r.sig_key}});break;case"screen_config_change":this.sdk.onConfigurationChange({screen_config:r});break;case"hit_input":var i=r,o=i.field_type,s=i.status;this.sdk.onInputStatusChange({field_type:o,status:s});break;case"camera_status":r.status}}catch(e){this.sdk.log("onSvMessage data parse failed",e)}else this.sdk.log("onSvMessage no data")},e.prototype.onHbMessage=function(e){try{var t=JSON.parse(e),n=t.timestamp,r=t.token,i=t.stream_push_state;if(this.debugSetting.showOnHbMessage&&console.log("onHbMessage",t),this.token=r,n){var o=+new Date-+n;this.sdk.showStats.setRTT(o)&&this.sdk.onNetworkChange({status:"jitter",data:{value:o,message:"NETWORK_JITTER"}})}i&&this.streamPushStat!==i&&(this.streamPushStat=i,this.sdk.onStreamPushStateChange({stream_push_state:this.streamPushStat}))}catch(e){this.sdk.log("parse hb message error",e)}},e.prototype.onCloudDeviceMessage=function(e){return r(this,void 0,void 0,(function(){var t,n,r,o,s,a,c,u,l,h;return i(this,(function(i){switch(i.label){case 0:if(!e)return[3,14];i.label=1;case 1:switch(i.trys.push([1,12,,13]),t=JSON.parse(e),n=t.type,r=t.data,this.debugSetting.showOnCloudDeviceMessage&&this.sdk.log("onCloudDeviceData","type: ",n,"data",e,"cloudDeviceData",r),n){case"trans_message":return[3,2];case"system_usage":return[3,3];case"clipboard_event":return[3,4];case"notification_event":return[3,9]}return[3,10];case 2:return this.sdk.onAndroidInstanceEvent({type:"trans_message",data:r}),[3,11];case 3:return this.sdk.onAndroidInstanceEvent({type:"system_usage",data:r}),s=(o=r).cpu_usage,a=o.gpu_usage,this.sdk.showStats.setCpuAndGpuUsage({cpu:"".concat((0,d.getFixedDecimal)(s)),gpu:"".concat((0,d.getFixedDecimal)(a))}),[3,11];case 4:c=!0,u=r.text,i.label=5;case 5:return i.trys.push([5,7,,8]),[4,navigator.clipboard.writeText(u)];case 6:return i.sent(),[3,8];case 7:return l=i.sent(),this.sdk.log("navigator.clipboard.writeText failed",l),c=!1,[3,8];case 8:return this.sdk.onAndroidInstanceEvent({type:"clipboard_event",data:{text:u,writeText:c}}),[3,11];case 9:return this.sdk.onAndroidInstanceEvent({type:"notification_event",data:r}),[3,11];case 10:return[3,11];case 11:return[3,13];case 12:return h=i.sent(),this.sdk.log("onCloudDeviceData data parse failed",h),[3,13];case 13:return[3,15];case 14:this.sdk.log("onCloudDeviceData no data"),i.label=15;case 15:return[2]}}))}))},e.prototype.onAckMessage=function(e){if(e)try{var t=JSON.parse(e),n=t.data,r=void 0===n?d.empty:n,i=t.seq;this.debugSetting.showOnAckMessage&&("cursor_state"===r.type||"keys_clean"===r.type||console.log("onAckMessage",r,i));var o=this.dataChannelCallbacks[i];if(i&&(this.sdk.showStats.setInputEnd(i),o)){var s=o.callback;delete this.dataChannelCallbacks[i],this.dataChannelRetryTimers[i]&&(clearTimeout(this.dataChannelRetryTimers[i]),delete this.dataChannelRetryTimers[i]),null==s||s({code:0,msg:"on ack message",data:r})}"open_url"===r.type&&(this.sdk.log("got open_url",r),this.sdk.onNetworkChange({status:"openurl",data:{value:r.url}}),this.sdk.onEvent({type:"openurl",data:{value:r.url}}))}catch(e){this.sdk.log("onAckMessage exception->",null==e?void 0:e.message)}else this.sdk.log("onAckMessage no data")},e.prototype.clearIntervals=function(){clearInterval(this.heartbeatTimer)},e}();t.default=l},6859:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},d=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},h=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(9418),m=n(2484),v=n(1743),g=n(1587),y=a(n(6363)),b=p(n(7023)),k=function(){function e(e){var t=e.sdk,n=this;this.moveSensitivity=1,this.touchesForDelta=null,this.touchesIdentifierMap=new Map,this.touchesMap=new Map,this.touchState=null,this.mousePosition={x:0,y:0,movementX:0,movementY:0,remoteX:0,remoteY:0},this.remoteMousePosition={x:0,y:0,sent:!1},this.mouseClickPosition={x:0,y:0},this.mouseState=null,this.enableMouseEventOnMobile=!1,this.enableMousemoveV2=!0,this.tabletModeLastPosition=null,this.kmStatus={keyboard:!0,mouse:!0},this.keyboardBanList=[],this.enablePaste=!0,this.keyboardPressedKeys=new Map,this.wheeling=!1,this.deltaMoveToCalcX=0,this.deltaMoveToCalcY=0,this.escPressTime=null,this.clickToFullscreen=!1,this.clickBodyToPlay=!0,this.mutedVideo=!1,this.webDraftLevel=f.WEB_DRAFT_LEVEL.CLOSE_HIGH_FREQUENCY,this.enableEventIntercept=!0,this.videoWidth=0,this.videoHeight=0,this.videoLeft=0,this.videoTop=0,this.videoStatus="pause",this.audioStatus="pause",this.remoteScreenWidth=0,this.remoteScreenHeight=0,this.remoteScreenLeft=0,this.remoteScreenTop=0,this.remoteScreenConfig=null,this.dropMouseEvent=!1,this.videoOrientation=0,this.pageOrientation=null,this.resizeObserver=null,this.mountResizeObserver=null,this.doubleTap=!1,this.doubleTapResponse=[],this.addKMHandlerFlag=!1,this.clientInteractMode="cursor",this.visibilityState="visible",this.sdk=null,this.transformMouseOffset={x:0,y:0},this.mount=null,this.ime=null,this._inputConfig={isComposing:!1,selectionStart:null},window.addEventListener("online",(function(e){n.onNetwork(e)}),!1),window.addEventListener("offline",(function(e){n.onNetwork(e)}),!1),this.onTouch=this.onTouch.bind(this),this.onResize=this.onResize.bind(this),this.onBodyClick=this.onBodyClick.bind(this),this.onVideoPlaying=this.onVideoPlaying.bind(this),this.onVideoPause=this.onVideoPause.bind(this),this.onVideoEnd=this.onVideoEnd.bind(this),this.onAudioPlaying=this.onAudioPlaying.bind(this),this.onAudioPause=this.onAudioPause.bind(this),this.onAudioEnd=this.onAudioEnd.bind(this),this.onVideoElementClick=this.onVideoElementClick.bind(this),this.onOrientationChange=this.onOrientationChange.bind(this),this.onFakeInputChange=this.onFakeInputChange.bind(this),this.onFakeInputFocus=this.onFakeInputFocus.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),this.onFocusChange=this.onFocusChange.bind(this),this.sdk=t}return e.prototype.init=function(e){var t,n,r,i,o,s;this.clickToFullscreen=e.clickToFullscreen,this.clickBodyToPlay=null===(t=e.clickBodyToPlay)||void 0===t||t,this.webDraftLevel=null!==(n=e.webDraftLevel)&&void 0!==n?n:f.WEB_DRAFT_LEVEL.CLOSE_HIGH_FREQUENCY,this.enableEventIntercept=null===(r=e.enableEventIntercept)||void 0===r||r,this.clientInteractMode=e.clientInteractMode||"cursor",this.enablePaste=null!==(i=e.enablePaste)&&void 0!==i?i:this.enablePaste,this.enableMousemoveV2=null===(o=e.enableMousemoveV2)||void 0===o||o,this.enableMouseEventOnMobile=null!==(s=e.enableMouseEventOnMobile)&&void 0!==s&&s,this.mount=e.mount},e.prototype.clearEvent=function(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.mountResizeObserver&&(this.mountResizeObserver.disconnect(),this.mountResizeObserver=null),window.removeEventListener("resize",this.onResize,!1),window.removeEventListener("visibilitychange",this.onVisibilityChange,!1),window.removeEventListener("orientationchange",this.onOrientationChange,!1),window.removeEventListener("focus",this.onFocusChange,!1),window.removeEventListener("blur",this.onFocusChange,!1),document.body.removeEventListener("click",this.onBodyClick,!1),this.sdk.getVideoElement()&&(this.sdk.getVideoElement().removeEventListener("playing",this.onVideoPlaying,!1),this.sdk.getVideoElement().removeEventListener("pause",this.onVideoPause,!1),this.sdk.getVideoElement().removeEventListener("ended",this.onVideoEnd,!1),this.sdk.getVideoElement().removeEventListener("click",this.onVideoElementClick,!1)),this.sdk.getAudioElement()&&(this.sdk.getAudioElement().removeEventListener("playing",this.onAudioPlaying,!1),this.sdk.getAudioElement().removeEventListener("pause",this.onAudioPause,!1),this.sdk.getAudioElement().removeEventListener("ended",this.onAudioEnd,!1))},e.prototype.addEventHandler=function(){var e=this;this.addKMHandler(),this.addTouchHandler(),(0,v.isMobile)()||this.sdk.gamepad.addGamepadHandler(),document.body.removeEventListener("click",this.onBodyClick,!1),document.body.addEventListener("click",this.onBodyClick,!1),this.sdk.getVideoElement().removeEventListener("playing",this.onVideoPlaying,!1),this.sdk.getVideoElement().addEventListener("playing",this.onVideoPlaying,!1),this.sdk.getVideoElement().removeEventListener("pause",this.onVideoPause,!1),this.sdk.getVideoElement().addEventListener("pause",this.onVideoPause,!1),this.sdk.getVideoElement().removeEventListener("ended",this.onVideoEnd,!1),this.sdk.getVideoElement().addEventListener("ended",this.onVideoEnd,!1),this.sdk.getVideoElement().removeEventListener("click",this.onVideoElementClick,!1),this.sdk.getVideoElement().addEventListener("click",this.onVideoElementClick,!1),this.sdk.getAudioElement().removeEventListener("playing",this.onAudioPlaying,!1),this.sdk.getAudioElement().addEventListener("playing",this.onAudioPlaying,!1),this.sdk.getAudioElement().removeEventListener("pause",this.onAudioPause,!1),this.sdk.getAudioElement().addEventListener("pause",this.onAudioPause,!1),this.sdk.getAudioElement().removeEventListener("ended",this.onAudioEnd,!1),this.sdk.getAudioElement().addEventListener("ended",this.onAudioEnd,!1),window.removeEventListener("orientationchange",this.onOrientationChange,!1),window.addEventListener("orientationchange",this.onOrientationChange,!1),window.addEventListener("resize",this.onResize,!1),document.addEventListener("pointerlockerror",(function(){e.sdk.onEvent({type:"pointerlockerror"})}),!1)},Object.defineProperty(e.prototype,"IMEType",{get:function(){return this.ime},set:function(e){this.ime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputConfig",{get:function(){return this._inputConfig},set:function(e){this._inputConfig=r(r({},this._inputConfig),e)},enumerable:!1,configurable:!0}),e.prototype.initOrientationDetector=function(){this.sdk.isMobileGame?this.addCloudGamingMountOrientationDetector():(0,v.isMobile)()&&this.addOrientationDetector()},e.prototype.setMoveSensitivity=function(e){this.moveSensitivity=1/e},e.prototype.getMoveSensitivity=function(){return this.moveSensitivity},e.prototype.remoteScreenResolutionChange=function(e){var t=e.width,n=e.height,r=e.left,i=e.top;this.remoteScreenWidth===t&&this.remoteScreenHeight===n&&this.remoteScreenLeft===r&&this.remoteScreenTop===i||(this.remoteScreenWidth=t,this.remoteScreenHeight=n,this.remoteScreenLeft=r,this.remoteScreenTop=i,this.sdk.onRemoteScreenResolutionChange({width:t,height:n,top:i,left:r}),this.sdk.log("remoteScreenResolutionChange->".concat(t," ").concat(n," ").concat(r," ").concat(i," ")),this.reshapeWindow("remoteScreenResolutionChange"))},e.prototype.getRemoteScreenConfig=function(){return this.remoteScreenConfig},e.prototype.setRemoteScreenConfig=function(e){var t=e.degree,n=e.orientation,i=0;"landscape"===n&&(i=270),"portrait"===n&&(i=0),"0_degree"===t&&(i=0),"90_degree"===t&&(i=270),"180_degree"===t&&(i=180),"270_degree"===t&&(i=90),this.remoteScreenConfig=r(r({},e),{deg:i}),this.sdk.cloudGamingWebRTC.getWebrtcConnectStatus()===f.STATUS.ESTABLISHED&&this.sdk.onConfigurationChange({screen_config:this.remoteScreenConfig}),this.cloudGamingMountResizeHandler()},e.prototype.clearRemoteKeys=function(){this.sdk.cloudGamingWebRTC.sendAckData({data:{type:"keys_clean"}})},e.prototype.transferLocalScale=function(e){var t=e.width,n=void 0===t?1:t,r=e.height,i=void 0===r?1:r,o=this.videoWidth/this.remoteScreenWidth*n,s=this.videoHeight/this.remoteScreenHeight*i;return 90===this.videoOrientation&&(o=this.videoHeight/this.remoteScreenWidth*i,s=this.videoWidth/this.remoteScreenHeight*n),{width:o,height:s}},e.prototype.mouseMove=function(e,t,n,r){var i,o,s=this.sdk.cloudGamingWebRTC.getDisplayRect(),a=s.left,c=s.top;if(this.mousePosition={x:n,y:r,movementX:n-this.mousePosition.x,movementY:r-this.mousePosition.y},90===this.videoOrientation?(i=this.mousePosition.y-c,o=this.videoWidth-this.mousePosition.x+a):(i=this.mousePosition.x-a,o=this.mousePosition.y-c),this.updateCursorPosition({displayX:i,displayY:o}),"touchstart"===t)if(this.sdk.cloudGamingWebRTC.getCursorShowStatus()){var d=this.moveTo(i,o),u=d.remoteX,l=d.remoteY;this.enableMousemoveV2?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove_v2",x:u,y:l}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove",x:u,y:l})}else this.sdk.log("cursor is not showing, cursor will not move");if("touchmove"===t)if(this.sdk.cloudGamingWebRTC.getCursorShowStatus()){var h=this.moveTo(i,o);u=h.remoteX,l=h.remoteY,this.enableMousemoveV2?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove_v2",x:u,y:l}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove",x:u,y:l})}else{var p=this.deltaMoveTo(this.mousePosition.movementX,this.mousePosition.movementY),f=p.remoteDeltaX,m=p.remoteDeltaY;90===this.videoOrientation?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousedeltamove",x:m,y:-f}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousedeltamove",x:f,y:m})}"touchend"!==t&&"touchcancel"!==t||(this.tabletModeLastPosition=null)},e.prototype.mobileTouchMove=function(e){var t=e.finger_id,n=e.event_type,r=e.x,i=e.y,o=e.width,s=e.height,a=e.timestamp;this.sdk.cloudGamingWebRTC.sendKmData({type:"event_touch",finger_id:t,event_type:n,x:r,y:i,width:o,height:s,timestamp:a}),this.sdk.onAndroidInstanceEvent({type:"touch_event",data:{finger_id:t,event_type:n,x:r,y:i,width:o,height:s,timestamp:a}})},e.prototype.mobileTouchMoveWebsocket=function(e){var t=e.finger_id,n=e.event_type,r=e.x,i=e.y,o=e.width,s=e.height,a=e.timestamp;this.sdk.cloudGamingWebsocket.dataChannelSend({label:f.DATACHANNEL.KM,data:{type:"event_touch",finger_id:t,event_type:n,x:r,y:i,width:o,height:s,timestamp:a}})},e.prototype.fullscreen=function(e){var t;return void 0===e&&(e=document.documentElement),c(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:this.sdk.log("enter fullscreen"),n.label=1;case 1:return n.trys.push([1,6,,7]),y.default.requestFullscreen?[4,e[y.default.requestFullscreen]()]:[3,3];case 2:return n.sent(),[3,5];case 3:return[4,e.webkitEnterFullScreen()];case 4:n.sent(),n.label=5;case 5:return[3,7];case 6:throw n.sent();case 7:if(!(0,y.getInIframe)())try{null===(t=null===navigator||void 0===navigator?void 0:navigator.keyboard)||void 0===t||t.lock(["Escape","F11"])}catch(e){this.sdk.log("lockKeyboard",e)}return[2]}}))}))},e.prototype.exitFullscreen=function(e){var t,n;return void 0===e&&(e=document.documentElement),c(this,void 0,void 0,(function(){return d(this,(function(r){return this.sdk.log("exit fullscreen"),y.default.exitFullscreen?null===(n=null===(t=document[y.default.exitFullscreen]())||void 0===t?void 0:t.catch)||void 0===n||n.call(t,(function(e){return console.log("exit full screen failed, ",null==e?void 0:e.message)})):e.webkitExitFullScreen(),[2]}))}))},e.prototype.resetLastPosition=function(e){var t=e.x,n=void 0===t?0:t,r=e.y,i=void 0===r?0:r;this.mousePosition.x=n,this.mousePosition.y=i},e.prototype.updateCursorPosition=function(e){var t=e.displayX,n=e.displayY,r=this.sdk.getCursorElement();90===this.videoOrientation?(t>this.videoHeight&&(t=this.videoHeight),n>this.videoWidth&&(n=this.videoWidth)):(t>this.videoWidth&&(t=this.videoWidth),n>this.videoHeight&&(n=this.videoHeight)),t<0&&(t=0),n<0&&(n=0),r&&(r.style.top="".concat(n+(90===this.videoOrientation?this.videoLeft:this.videoTop),"px"),r.style.left="".concat(t+(90===this.videoOrientation?this.videoTop:this.videoLeft),"px"),r.style.zIndex="100")},e.prototype.setDropMouseEvent=function(e){this.dropMouseEvent=e},e.prototype.setWebDraftLevel=function(e){void 0===e&&(e=0),this.webDraftLevel=e},e.prototype.setEnableEventIntercept=function(e){void 0===e&&(e=!0),this.enableEventIntercept=e},e.prototype.setVideoOrientation=function(e){var t,n=e.deg,r=void 0===n?0:n,i=e.rotateContainer,o=void 0===i||i,s=e.rotateMountPoint,a=void 0!==s&&s;if(this.sdk.log("setVideoOrientation",r,o,a),(0,v.dispatchEvent)({name:"this.sdk:VideoOrientation",data:{deg:r,rotateContainer:o,rotateMountPoint:a}}),o||a){var c=document.querySelector("html");if(a&&(c=this.sdk.isMobileGame?this.sdk.getCloudGamingStreamContainerElement():document.getElementById(null===(t=this.sdk.getInitOptions())||void 0===t?void 0:t.mount)),c)if(c.className=c.className.split(" rotate-html-".concat(this.videoOrientation)).join(""),90===r&&(c.className="".concat(c.className," rotate-html-90")),180===r&&(c.className="".concat(c.className," rotate-html-180")),270===r&&(c.className="".concat(c.className," rotate-html-270")),0===r||180===r)a?(c.style.width=null,c.style.height=null):o&&(c.className="",c.style.width=null,c.style.height=null);else if((0,v.isMobile)())(this.sdk.isMobileGame||a)&&(window.innerHeight>window.innerWidth?(c.style.width="".concat(window.innerHeight,"px"),c.style.height="".concat(window.innerWidth,"px")):setTimeout((function(){c.style.width="".concat(window.innerHeight,"px"),c.style.height="".concat(window.innerWidth,"px")}),100));else if(a){var d=null===document||void 0===document?void 0:document.querySelector("#".concat(this.mount)),u=d.clientWidth,l=d.clientHeight;c.style.width="".concat(l,"px"),c.style.height="".concat(u,"px")}else o&&(c.style.width="".concat(window.innerHeight,"px"),c.style.height="".concat(window.innerWidth,"px"));else this.sdk.log("setVideoOrientation -> can not find mount point")}this.videoOrientation=r,this.reshapeWindow("setVideoOrientation")},e.prototype.getPageOrientation=function(){return this.pageOrientation},e.prototype.reshapeWindow=function(e){var t=this;void 0===e&&(e=""),this.sdk.log("reshapeWindow",e);var n=this.sdk.getVideoElement();if(n){var r=this.sdk.getCloudGamingContainerElement(),i=this.sdk.getInitOptions().fullVideoToScreen,o=void 0===i||i;if(n.videoWidth&&n.videoHeight&&r.clientWidth>n.videoWidth&&r.clientHeight>n.videoHeight&&o&&(r.clientWidth/r.clientHeight>n.videoWidth/n.videoHeight?(n.style.height="100%",n.style.width=null):(n.style.width="100%",n.style.height=null)),(r.clientWidth<n.videoWidth||r.clientHeight<n.videoHeight)&&(n.style.width=null,n.style.height=null),this.sdk.isMobileGame){var s=this.sdk.getCloudGamingStreamContainerElement(),a=s.clientWidth,c=s.clientHeight,d=n.videoWidth;c/a>n.videoHeight/d?(n.style.width="100%",n.style.height=null):(n.style.height="100%",n.style.width=null)}var u=function(){var e=n.getBoundingClientRect(),r=e.width,i=e.height,o=e.top,s=e.left;t.videoWidth=r,t.videoHeight=i,t.videoLeft=s,t.videoTop=o,t.sdk.log("videoResolutionChange-> width: ".concat(t.videoWidth,", height: ").concat(t.videoHeight,", left: ").concat(t.videoLeft,", top: ").concat(t.videoTop))};u(),this.resizeObserver||(this.resizeObserver=new ResizeObserver((function(){u()})),this.resizeObserver.observe(n))}},e.prototype.setKMStatus=function(e){var t=e.keyboard,n=void 0===t||t,r=e.mouse,i=void 0===r||r;this.kmStatus={keyboard:n,mouse:i}},e.prototype.setKeyboardBanList=function(e){var t=e.keyList;this.keyboardBanList=t},e.prototype.setPaste=function(e){this.enablePaste=e},e.prototype.setVideoMuted=function(e){this.mutedVideo=e},e.prototype.setClientInteractMode=function(e){void 0===e&&(e="cursor"),this.clientInteractMode=e},e.prototype.getClientInteractMode=function(){return this.clientInteractMode},e.prototype.getVisibilityState=function(){return this.visibilityState},Object.defineProperty(e.prototype,"remoteScreenSize",{get:function(){return{width:this.remoteScreenWidth,height:this.remoteScreenHeight,top:this.remoteScreenTop,left:this.remoteScreenLeft}},enumerable:!1,configurable:!0}),e.prototype.addKMHandler=function(){var e=this;if(!this.addKMHandlerFlag){this.addKMHandlerFlag=!0,(0,v.isMobile)()&&!this.enableMouseEventOnMobile||(this.webDraftLevel===f.WEB_DRAFT_LEVEL.CLOSE_HIGH_FREQUENCY?document.addEventListener("mousemove",(function(t){"webrtc"===e.sdk.streamingMode?e.onMouseMove(t):e.onMouseMove2(t)}),!1):document.addEventListener("pointermove",(function(t){"webrtc"===e.sdk.streamingMode?e.onMouseMove(t):e.onMouseMove2(t)}),!1),document.addEventListener("mousedown",(function(t){"webrtc"===e.sdk.streamingMode?e.onMouseDown(t):e.onMouseDown2(t)}),!1),document.addEventListener("mouseup",(function(t){"webrtc"===e.sdk.streamingMode?e.onMouseUp(t):e.onMouseUp2(t)}),!1)),document.addEventListener("wheel",(function(t){e.onWheel(t)}),!1),document.addEventListener("keydown",(function(t){e.onKeyEvent(t)}),!1),document.addEventListener("keyup",(function(t){e.onKeyEvent(t)}),!1),document.addEventListener("keypress",(function(){e.onKeyPress()}),!1),document.addEventListener("contextmenu",(function(t){e.onContextMenu(t)}),!1),document.addEventListener("fullscreenchange",(function(){if((0,v.isFullScreen)()){e.sdk.log("enter fullscreenChange");try{e.sdk.getVideoElement().focus()}catch(t){e.sdk.log("fullscreenChange error,",t)}}e.reshapeWindow("fullscreenchange")}),!1),window.addEventListener("visibilitychange",(function(){e.onVisibilityChange()}),!1),window.addEventListener("focus",(function(){e.onFocusChange()}),!1),window.addEventListener("blur",(function(){e.onFocusChange()}),!1),document.addEventListener("pointerlockchange",(function(){e.pointerlockchange()})),document.addEventListener("paste",(function(t){e.onPaste(t)}));var t=this.sdk.getFakeInputElement();t.removeEventListener("input",this.onFakeInputChange,!1),t.addEventListener("input",this.onFakeInputChange,!1),t.addEventListener("focus",this.onFakeInputFocus,!1),t.addEventListener("compositionstart",(function(){e._inputConfig.isComposing=!0})),t.addEventListener("compositionend",(function(){e._inputConfig.isComposing=!1,e.sdk.androidInstance.inputText({content:t.value,mode:"override",index_after_override:e.inputConfig.selectionStart})}))}},e.prototype.addTouchHandler=function(){var e=this.sdk.getCloudGamingContainerElement();e.removeEventListener("touchmove",this.onTouch,!1),e.removeEventListener("touchstart",this.onTouch,!1),e.removeEventListener("touchend",this.onTouch,!1),e.removeEventListener("touchcancel",this.onTouch,!1),e.addEventListener("touchmove",this.onTouch,!1),e.addEventListener("touchstart",this.onTouch,!1),e.addEventListener("touchend",this.onTouch,!1),e.addEventListener("touchcancel",this.onTouch,!1),document.addEventListener("gesturestart",(function(e){e.preventDefault()}))},e.prototype.onResize=function(){var e=this;this.sdk.log("onresize","window.innerWidth",window.innerWidth,"window.innerHeight",window.innerHeight),setTimeout((function(){e.reshapeWindow("onresize")}),0)},e.prototype.addOrientationDetector=function(){var e=this,t=this.sdk.getInitOptions(),n=t.autoRotateContainer,r=t.autoRotateMountPoint,i=window.matchMedia("(orientation: portrait)"),o=function(t){if(t.matches){e.pageOrientation="portrait",(n||r)&&e.setVideoOrientation({deg:e.sdk.isMobileGame&&e.isPortraitStream?0:90,rotateContainer:n,rotateMountPoint:r});try{e.sdk.onOrientationChange({type:"portrait"})}catch(t){e.sdk.log("onOrientationChange callback error",t)}}else{e.pageOrientation="landscape",(n||r)&&e.setVideoOrientation({deg:e.sdk.isMobileGame&&e.isPortraitStream?270:0,rotateContainer:n,rotateMountPoint:r});try{e.sdk.onOrientationChange({type:"landscape"})}catch(t){e.sdk.log("onOrientationChange callback error",t)}}};o(i),i.addListener(o)},e.prototype.cloudGamingMountResizeHandler=function(){var e,t;if(this.sdk.isMobileGame&&this.sdk.getGameMountPoint()){var n=this.getRemoteScreenConfig(),r=n.orientation,i=n.degree,o=0;"landscape"===r&&(o=270),"portrait"===r&&(o=0),"0_degree"===i&&(o=0),"90_degree"===i&&(o=270),"180_degree"===i&&(o=180),"270_degree"===i&&(o=90),(0,v.isMobile)()||(null===(t=null===(e=this.sdk.getInitOptions())||void 0===e?void 0:e.androidInstance)||void 0===t?void 0:t.autoRotateOnPC)&&this.setVideoOrientation({rotateMountPoint:!0,deg:o}),this.reshapeWindow("cloudGamingMountResizeHandler")}},e.prototype.addCloudGamingMountOrientationDetector=function(){var e=this,t=this.sdk.getGameMountPoint();this.mountResizeObserver||(this.mountResizeObserver=new ResizeObserver((function(){e.cloudGamingMountResizeHandler()})),this.mountResizeObserver.observe(t))},Object.defineProperty(e.prototype,"isPortraitStream",{get:function(){var e=this.sdk.getRemoteStreamResolution(),t=e.width;return e.height>t},enumerable:!1,configurable:!0}),e.prototype.onVisibilityChange=function(){var e=this;this.clearRemoteKeys(),this.sdk.log("visibilitychange",document.hidden?"hidden":"visible"),document.hidden?(this.visibilityState="hidden",(0,v.isMobile)()&&(this.touchesIdentifierMap.clear(),this.sdk.clearRemoteKeys(),setTimeout((function(){e.sdk.isMobileGame||e.sdk.sendMouseEvent({type:"mouseleft",down:!1}),e.touchesMap.clear()}),100))):(this.visibilityState="visible","websocket"===this.sdk.streamingMode&&this.sdk.getVideoElement().play()),this.sdk.onVisibilityChange({status:this.visibilityState})},e.prototype.onNetwork=function(e){this.sdk.log("onNetwork",e.type),this.sdk.onNetworkChange({status:e.type})},e.prototype.onFocusChange=function(){this.clearRemoteKeys()},e.prototype.pointerlockchange=function(){},e.prototype.onPaste=function(e){console.log("onPaste",e,e.clipboardData.getData("text/plain"))},e.prototype.onContextMenu=function(e){e.preventDefault()},e.prototype.transferRemotePosition=function(e){var t=e.displayX,n=void 0===t?1:t,r=e.displayY,i=void 0===r?1:r,o=e.moveSensitivity,s=void 0===o?1:o,a=Math.round(n*this.remoteScreenWidth/this.videoWidth/s)+this.remoteScreenLeft,c=Math.round(i*this.remoteScreenHeight/this.videoHeight/s)+this.remoteScreenTop;return 90!==this.videoOrientation&&270!==this.videoOrientation||(a=Math.round(n*this.remoteScreenWidth/this.videoHeight/s)+this.remoteScreenLeft,c=Math.round(i*this.remoteScreenHeight/this.videoWidth/s)+this.remoteScreenTop),{x:a,y:c}},e.prototype.transferRemotePositionV2=function(e){var t=e.displayX,n=void 0===t?1:t,r=e.displayY,i=void 0===r?1:r,o=e.moveSensitivity,s=void 0===o?1:o,a=n/this.videoWidth/s,c=i/this.videoHeight/s;return 90!==this.videoOrientation&&270!==this.videoOrientation||(a=n/this.videoHeight/s,c=i/this.videoWidth/s),{x:Math.round(8192*a),y:Math.round(8192*c)}},e.prototype.transferRemotePositionDeltaMove=function(e){var t=e.displayX,n=void 0===t?1:t,r=e.displayY,i=void 0===r?1:r,o=e.moveSensitivity,s=void 0===o?1:o,a=n*this.remoteScreenWidth/this.videoWidth/s,c=i*this.remoteScreenHeight/this.videoHeight/s,d=a+this.transformMouseOffset.x,u=c+this.transformMouseOffset.y,l=Math.round(d)+this.remoteScreenLeft,h=Math.round(u)+this.remoteScreenTop;if(this.transformMouseOffset.x=d-Math.round(d),this.transformMouseOffset.y=u-Math.round(u),90===this.videoOrientation||270===this.videoOrientation){var p=n*this.remoteScreenWidth/this.videoHeight/s,f=i*this.remoteScreenHeight/this.videoWidth/s;l=Math.round(p)+this.remoteScreenLeft,h=Math.round(f)+this.remoteScreenTop,this.transformMouseOffset.x=Math.round(p)-p,this.transformMouseOffset.y=Math.round(f)-f}return{x:l,y:h}},Object.defineProperty(e.prototype,"touchesList",{get:function(){var e,t,n=[];if(this.touchesMap.size)try{for(var r=u(this.touchesMap.values()),i=r.next();!i.done;i=r.next()){var o=i.value;n.push(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),e.prototype.onTouch=function(e){var t,n,r=this,i=e.type,o=e.timeStamp,s=e.targetTouches,a=e.changedTouches,c=function(e){var t=e.pageX,n=e.pageY,s=e.identifier,a=d.transferRemotePosition({displayX:t-d.videoLeft,displayY:n-d.videoTop}),c=a.x,u=a.y;c-=d.remoteScreenLeft,u-=d.remoteScreenTop;var p=d.touchesForDelta||{lastX:c,lastY:u},m=(c-p.lastX)/d.moveSensitivity,v=(u-p.lastY)/d.moveSensitivity;if(d.touchesForDelta={lastX:c,lastY:u},"touchstart"===i&&(h([],l(d.touchesIdentifierMap.values()),!1).includes(d.touchesIdentifierMap.size)?d.touchesIdentifierMap.set(s,d.touchesIdentifierMap.size+1):d.touchesIdentifierMap.set(s,d.touchesIdentifierMap.size)),d.sdk.isMobileGame||"touch"===d.clientInteractMode){var g=i;if(270===d.videoOrientation){var y=d.transferRemotePosition({displayX:d.videoHeight-n+d.videoTop,displayY:t-d.videoLeft}),b=y.x,k=y.y;c=b-d.remoteScreenLeft,u=k-d.remoteScreenTop}if(90===d.videoOrientation){var C=d.transferRemotePosition({displayX:n-d.videoTop,displayY:d.videoWidth-t+d.videoLeft});b=C.x,k=C.y,c=b-d.remoteScreenLeft,u=k-d.remoteScreenTop}if("touch"===d.clientInteractMode&&(c>d.remoteScreenWidth&&(c=d.remoteScreenWidth),u>d.remoteScreenHeight&&(u=d.remoteScreenHeight),c<0&&(c=0),u<0&&(u=0)),d.mobileTouchMove({finger_id:d.touchesIdentifierMap.get(s),event_type:f.TOUCH_EVENT_TYPE[g],x:c,y:u,width:d.remoteScreenWidth,height:d.remoteScreenHeight,timestamp:o}),"touch"===d.clientInteractMode){var S=void 0,_=void 0;90===d.videoOrientation?(S=n-d.videoTop,_=d.videoWidth-t+d.videoLeft):(S=t-d.videoLeft,_=n-d.videoTop),d.updateCursorPosition({displayX:S,displayY:_})}}var w={id:s,type:i,x:c,y:u,pageX:t,pageY:n,movementX:m,movementY:v};d.touchesMap.set(s,w),"touchend"!==i&&"touchcancel"!==i||(d.touchesIdentifierMap.delete(s),setTimeout((function(){r.touchesMap.delete(s)}),100)),"touchstart"!==i||d.sdk.isMobileGame||(d.doubleTapResponse.push(w),d.doubleTap?d.sdk.onDoubleTap(d.doubleTapResponse):(d.doubleTap=!0,setTimeout((function(){r.doubleTap=!1,r.doubleTapResponse=[]}),300)))},d=this;try{for(var p=u("touchend"===i||"touchcancel"===i||this.sdk.isMobileGame||"touch"===this.clientInteractMode?a:s),m=p.next();!m.done;m=p.next())c(m.value)}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}this.sdk.isMobileGame||"touch"===this.clientInteractMode||this.sdk.onTouchEvent(this.touchesList)},e.prototype.onMouseMove=function(e){var t,n;if(!1!==this.kmStatus.mouse&&!this.dropMouseEvent){var r="getCoalescedEvents"in e?e.getCoalescedEvents():[e],i=null;this.webDraftLevel===f.WEB_DRAFT_LEVEL.UNPACKAGE_SEND&&r.length>3?(this.sdk.log("webDraftLevel 1, event length is ".concat(r.length,", only pick 3 events")),r.splice(0,r.length-3)):this.webDraftLevel===f.WEB_DRAFT_LEVEL.PACKAGE_SEND&&(this.sdk.log("webDraftLevel 2, event length is ".concat(r.length,", will send seq events")),i=[]);try{for(var o=u(r),s=o.next();!s.done;s=o.next()){var a=s.value,c=a.offsetX,d=a.offsetY,l=a.movementX,h=a.movementY,p=c,m=d;if(p<0&&(p=0),m<0&&(m=0),this.sdk.cloudGamingWebRTC.getCursorMode()===f.CURSOR_MODE.FRONT_DRAW_DELTA_POS)if(this.sdk.cloudGamingWebRTC.isMouseLocked()){if(!this.remoteMousePosition.sent){var v=this.remoteMousePosition,g=v.x,y=v.y;this.enableMousemoveV2?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove_v2",x:g,y}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove",x:g,y}),this.remoteMousePosition.sent=!0}var b=this.deltaMoveTo(l,h),k=b.remoteDeltaX,C=b.remoteDeltaY;this.sdk.cloudGamingWebRTC.sendKmData({type:"mousedeltamove",x:k,y:C}),this.drawMouseDeltaPosition(l,h)}else{var S=this.moveTo(p,m),_=S.remoteX,w=S.remoteY;this.remoteMousePosition.x=_,this.remoteMousePosition.y=w,this.remoteMousePosition.sent=!1,this.mousePosition.deltaX=p,this.mousePosition.deltaY=m}else if(this.sdk.cloudGamingWebRTC.mouseDeltaMove()||!this.sdk.cloudGamingWebRTC.getCursorShowStatus()){var T=this.deltaMoveTo(l,h);k=T.remoteDeltaX,C=T.remoteDeltaY,i?i.push({type:"mousedeltamove",x:k,y:C}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousedeltamove",x:k,y:C})}else{var E=this.moveTo(p,m);if(_=E.remoteX,w=E.remoteY,i)this.enableMousemoveV2?i.push({type:"mousemove_v2",x:_,y:w}):i.push({type:"mousemove",x:_,y:w});else if(this.sdk.isMobileGame||"touch"===this.clientInteractMode){if(this.mousePosition.remoteX=_,this.mousePosition.remoteY=w,this.touchState!==f.TOUCH_EVENT_TYPE.touchstart)return;this.mobileTouchMove({finger_id:0,event_type:f.TOUCH_EVENT_TYPE.touchmove,x:_,y:w,width:this.remoteScreenWidth,height:this.remoteScreenHeight,timestamp:+new Date})}else this.enableMousemoveV2?this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove_v2",x:_,y:w}):this.sdk.cloudGamingWebRTC.sendKmData({type:"mousemove",x:_,y:w})}this.mousePosition.x=p,this.mousePosition.y=m}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}this.webDraftLevel===f.WEB_DRAFT_LEVEL.PACKAGE_SEND&&this.sdk.cloudGamingWebRTC.sendKmData({type:"key_seq",keys:i.map((function(e){return JSON.stringify(e)}))})}},e.prototype.onMouseMove2=function(e){var t,n;if(!1!==this.kmStatus.mouse&&!this.dropMouseEvent){var r="getCoalescedEvents"in e?e.getCoalescedEvents():[e];try{for(var i=u(r),o=i.next();!o.done;o=i.next()){var s=o.value,a=s.offsetX,c=s.offsetY,d=a,l=c;d<0&&(d=0),l<0&&(l=0);var h=this.moveTo(d,l),p=h.remoteX,m=h.remoteY;if(this.mousePosition.remoteX=p,this.mousePosition.remoteY=m,this.sdk.isMobileGame&&this.touchState!==f.TOUCH_EVENT_TYPE.touchstart)return;this.mobileTouchMoveWebsocket({finger_id:0,event_type:f.TOUCH_EVENT_TYPE.touchmove,x:p,y:m,width:this.remoteScreenWidth,height:this.remoteScreenHeight,timestamp:+new Date})}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.prototype.drawMouseDeltaPosition=function(e,t){var n=this.sdk.cloudGamingWebRTC.getCursorShowStatus();this.sdk.getCursorElement().style.display=n?"block":"none";var r=this.sdk.cloudGamingWebRTC.getDisplayRect(),i=r.width,o=r.height;this.mousePosition.deltaX=this.mousePosition.deltaX+e,this.mousePosition.deltaY=this.mousePosition.deltaY+t,this.mousePosition.deltaX<=0&&(this.mousePosition.deltaX=0),this.mousePosition.deltaX>=i&&(this.mousePosition.deltaX=i),this.mousePosition.deltaY<=0&&(this.mousePosition.deltaY=0),this.mousePosition.deltaY>=o&&(this.mousePosition.deltaY=o);var s=this.sdk.cloudGamingWebRTC.getCursorHotSpot();this.updateCursorPosition({displayX:this.mousePosition.deltaX-s.x,displayY:this.mousePosition.deltaY-s.y})},e.prototype.moveTo=function(e,t){if(this.enableMousemoveV2&&!this.sdk.isMobileGame&&"touch"!==this.clientInteractMode){var n=this.transferRemotePositionV2({displayX:e,displayY:t});return{remoteX:n.x,remoteY:n.y}}var r=this.transferRemotePosition({displayX:e,displayY:t}),i=r.x,o=r.y;return i>=this.remoteScreenWidth+this.remoteScreenLeft&&(i=this.remoteScreenWidth+this.remoteScreenLeft-1),i<0&&(i=0),o>=this.remoteScreenHeight+this.remoteScreenTop&&(o=this.remoteScreenHeight+this.remoteScreenTop-1),o<0&&(o=0),{remoteX:i,remoteY:o}},e.prototype.deltaMoveTo=function(e,t){var n=this.transferRemotePositionDeltaMove({displayX:e,displayY:t,moveSensitivity:this.moveSensitivity}),r=n.x,i=n.y,o=r-this.remoteScreenLeft,s=i-this.remoteScreenTop;return this.deltaMoveToCalcX+=o,this.deltaMoveToCalcY+=s,this.deltaMoveToCalcX<0&&(this.deltaMoveToCalcX=0),this.deltaMoveToCalcY<0&&(this.deltaMoveToCalcY=0),this.deltaMoveToCalcX>this.remoteScreenWidth&&(this.deltaMoveToCalcX=this.remoteScreenWidth),this.deltaMoveToCalcY>this.remoteScreenHeight&&(this.deltaMoveToCalcX=this.remoteScreenHeight),{remoteDeltaX:o,remoteDeltaY:s}},e.prototype.isRightClick=function(e){return"which"in e?3===e.which:"button"in e?2===e.button:void 0},e.prototype.determineButtonType=function(e){var t;return null!==(t=["mouseleft","mousemiddle","mouseright","mousebackward","mouseforward","unused","unused"][e.button])&&void 0!==t?t:""},e.prototype.onMouseDown=function(e){if(!1!==this.kmStatus.mouse){var t=e.offsetX,n=e.offsetY;if(this.mouseClickPosition={x:t,y:n},this.sdk.isMobileGame||"touch"===this.clientInteractMode){var r=this.determineButtonType(e);if(this.sdk.isMobileGame&&"mouseleft"!==r)return;var i=this.mousePosition,o=i.remoteX,s=i.remoteY;this.mobileTouchMove({finger_id:0,event_type:f.TOUCH_EVENT_TYPE.touchstart,x:o,y:s,width:this.remoteScreenWidth,height:this.remoteScreenHeight,timestamp:+new Date}),this.touchState=f.TOUCH_EVENT_TYPE.touchstart}else this.sdk.cloudGamingWebRTC.sendKmData({type:this.determineButtonType(e),down:!0}),this.mouseState=f.MOUSE_EVENT_TYPE.mousedown,this.isRightClick(e)&&this.tryToCursorLock();3!==e.button&&4!==e.button||e.preventDefault()}},e.prototype.onMouseDown2=function(e){if(!1!==this.kmStatus.mouse){var t=this.mousePosition,n=t.remoteX,r=t.remoteY;this.mobileTouchMoveWebsocket({finger_id:0,event_type:f.TOUCH_EVENT_TYPE.touchstart,x:n,y:r,width:this.remoteScreenWidth,height:this.remoteScreenHeight,timestamp:+new Date}),this.touchState=f.TOUCH_EVENT_TYPE.touchstart,3!==e.button&&4!==e.button||e.preventDefault()}},e.prototype.onMouseUp=function(e){if(!1!==this.kmStatus.mouse)if(this.sdk.isMobileGame||"touch"===this.clientInteractMode){var t=this.determineButtonType(e);if(this.sdk.isMobileGame&&"mouseleft"!==t)return;if(this.touchState===f.TOUCH_EVENT_TYPE.touchstart){var n=this.mousePosition,r=n.remoteX,i=n.remoteY;this.mobileTouchMove({finger_id:0,event_type:f.TOUCH_EVENT_TYPE.touchend,x:r,y:i,width:this.remoteScreenWidth,height:this.remoteScreenHeight,timestamp:+new Date})}this.touchState=f.TOUCH_EVENT_TYPE.touchend}else this.mouseState===f.MOUSE_EVENT_TYPE.mousedown&&this.sdk.cloudGamingWebRTC.sendKmData({type:this.determineButtonType(e),down:!1}),this.mouseState=f.MOUSE_EVENT_TYPE.mouseup},e.prototype.onMouseUp2=function(e){if(!1!==this.kmStatus.mouse){var t=this.mousePosition,n=t.remoteX,r=t.remoteY;this.mobileTouchMoveWebsocket({finger_id:0,event_type:f.TOUCH_EVENT_TYPE.touchend,x:n,y:r,width:this.remoteScreenWidth,height:this.remoteScreenHeight,timestamp:+new Date}),this.touchState=f.TOUCH_EVENT_TYPE.touchend,3!==e.button&&4!==e.button||e.preventDefault()}},e.prototype.onWheel=function(e){var t,n=this,r=e.deltaX,i=e.deltaY,o=Math.abs(i)>=Math.abs(r)?"vertical":"horizontal",s=this.mousePosition,a=s.remoteX,c=s.remoteY,d=function(e){var t=e.delta,r=e.type;n.sdk.cloudGamingWebRTC.sendKmData({type:r,delta:t,x:a,y:c,width:n.remoteScreenWidth,height:n.remoteScreenHeight})};if(null===(t=b.default.ua)||void 0===t?void 0:t.includes("Mac")){if(!0===this.wheeling)return;this.wheeling=!0,"vertical"===o&&d({delta:i,type:"mousescroll"}),"horizontal"===o&&d({delta:r,type:"mousehorizontalscroll"}),setTimeout((function(){n.wheeling=!1}),100)}else"vertical"===o&&d({delta:i,type:"mousescroll"}),"horizontal"===o&&d({delta:r,type:"mousehorizontalscroll"})},e.prototype.onKeyEvent=function(e){var t,n,r,i=this;if(e.preventDefault(),!1!==this.kmStatus.keyboard){var o=e.which||e.keyCode,s=e.ctrlKey,a=e.altKey,c=e.type,d=e.metaKey,u=e.location,p=e.key;if(!this.keyboardBanList.includes(o)){if("keyup"===c){if(s){if(o===g.KEYCODE.Space)return this.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:o,down:!0}),void setTimeout((function(){i.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:o,down:!1})}),10);o===g.KEYCODE.Backquote&&this.sdk.showStats.toggleStatisticsView()}o===g.KEYCODE.Escape&&(+new Date-this.escPressTime>300&&this.sdk.cloudGamingWebRTC.lockMouse(!1),this.escPressTime=null),(null===(t=b.default.ua)||void 0===t?void 0:t.includes("Mac"))&&"Meta"===p&&h([],l(this.keyboardPressedKeys.keys()),!1).forEach((function(e){e!==g.KEYCODE.LeftWindowKey&&e!==g.KEYCODE.SelectKey&&i.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:e,down:!1}),i.keyboardPressedKeys.delete(e)}))}if("keydown"===c){if((null===(n=b.default.ua)||void 0===n?void 0:n.includes("Mac"))&&this.keyboardPressedKeys.set(o,e),o===g.KEYCODE.X&&a||o===g.KEYCODE.Escape?(o===g.KEYCODE.X&&a&&this.sdk.cloudGamingWebRTC.lockMouse(!1),o===g.KEYCODE.Escape&&(this.escPressTime||(this.escPressTime=+new Date))):this.tryToCursorLock(),this.enablePaste&&(d||s)&&o===g.KEYCODE.V)return void(navigator.clipboard?navigator.clipboard.readText().then((function(e){i.sdk.sendText(e)})).catch((function(e){i.sdk.log("Failed to read clipboard contents: ",e),i.sdk.onEvent({type:"readclipboarderror",data:{message:e.message}})})):this.sdk.onEvent({type:"readclipboarderror"}));if(a&&o===g.KEYCODE.F4)return void this.sdk.log("alt + f4 is forbidden")}if((null===(r=b.default.ua)||void 0===r?void 0:r.includes("Mac"))&&o===g.KEYCODE.CapsLock)return this.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:o,down:!0}),void setTimeout((function(){i.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:o,down:!1})}),10);"webrtc"===this.sdk.streamingMode?this.sdk.cloudGamingWebRTC.sendKmData({type:"keyboard",key:o,down:"keydown"===c,location:u}):this.sdk.cloudGamingWebsocket.dataChannelSend({label:f.DATACHANNEL.KM,data:{type:"keyboard",key:o,down:"keydown"===c,location:u}})}}},e.prototype.onKeyPress=function(){},e.prototype.onBodyClick=function(){var e,t=this;if(this.clickBodyToPlay){var n=this.sdk.getVideoElement(),r=this.sdk.getAudioElement();if(n&&this.sdk.cloudGamingWebRTC.getWebrtcConnectStatus()===f.STATUS.ESTABLISHED){this.mutedVideo||(r.muted=!1);try{"pause"===this.videoStatus&&n.pause(),n.play().then((function(){})).catch((function(e){t.sdk.log("onbody click play error",e)})),r.play().catch((function(e){t.sdk.log("onbody click play audio error",e)}))}catch(e){this.sdk.log("play video error",e)}}if("websocket"===this.sdk.streamingMode){var i=document.querySelector(".".concat(this.mount," .cloud-gaming-audio-stream-socket"));n&&n.play().catch((function(e){t.sdk.log("onbody click play error",e)})),i&&(null===(e=this.sdk.cloudGamingWebsocket.getMuxer("video"))||void 0===e||e.playCurrent(),this.mutedVideo||(i.muted=!1),i.play().catch((function(e){t.sdk.log("onbody click play audio error",e)})))}var o=this.sdk.getHuaweiAudioElement();o&&(this.mutedVideo||(o.muted=!1),o.play()),(0,v.isMobile)()||(0,v.isFullScreen)()||!this.clickToFullscreen||(this.sdk.log("click to fullscreen->",this.clickToFullscreen),this.fullscreen())}},e.prototype.onVideoPlaying=function(e){this.videoStatus="playing","webrtc"===this.sdk.streamingMode&&(this.sdk.log("video state",e.type),this.reshapeWindow("onVideoPlaying"),this.sdk.onEvent({type:"video_state",data:{code:0,message:"playing"}}))},e.prototype.onVideoPause=function(e){this.sdk.log("video state",e.type),this.videoStatus="pause",this.sdk.onEvent({type:"video_state",data:{code:1,message:"pause"}})},e.prototype.onVideoEnd=function(e){this.sdk.log("video state",e.type),this.videoStatus="pause",this.sdk.onEvent({type:"video_state",data:{code:2,message:"ended"}})},e.prototype.onAudioPlaying=function(e){this.sdk.log("audio state",e.type),this.audioStatus="playing",this.sdk.onEvent({type:"audio_state",data:{code:0,message:"playing"}})},e.prototype.onAudioPause=function(e){this.sdk.log("audio state",e.type),this.audioStatus="pause",this.sdk.onEvent({type:"audio_state",data:{code:1,message:"pause"}})},e.prototype.onAudioEnd=function(e){this.sdk.log("audio state",e.type),this.audioStatus="pause",this.sdk.onEvent({type:"audio_state",data:{code:2,message:"ended"}})},e.prototype.onVideoElementClick=function(){this.sdk.getVideoElement().focus(),this.sdk.cloudGamingWebRTC.getCursorMode()===f.CURSOR_MODE.FRONT_DRAW_DELTA_POS&&this.sdk.cloudGamingWebRTC.lockMouse(!0)},e.prototype.onFakeInputFocus=function(){if("local"===this.IMEType){var e=this.sdk.getFakeInputElement(),t=this.sdk.getCloudGamingContainerElement();e&&t&&(e.style.top="".concat(this.mouseClickPosition.y+(t.clientHeight-this.videoHeight)/2-5,"px"),e.style.left="".concat(this.mouseClickPosition.x+(t.clientWidth-this.videoWidth)/2,"px"))}},e.prototype.onFakeInputChange=function(e){var t=e.target,n=t.value,r=t.selectionStart;this.inputConfig.selectionStart=r,this.inputConfig.isComposing||this.sdk.androidInstance.inputText({content:n,mode:"override",index_after_override:r})},e.prototype.onOrientationChange=function(){var e=this;this.sdk.log("orientationchange"),setTimeout((function(){e.reshapeWindow("onOrientationChange")}),0)},e.prototype.tryToCursorLock=function(){if(!this.sdk.cloudGamingWebRTC.getForceShowCursor()){var e=document.pointerLockElement;e||this.sdk.cloudGamingWebRTC.getCursorShowStatus()&&!this.sdk.cloudGamingWebRTC.mouseDeltaMove()||(this.sdk.cloudGamingWebRTC.lockMouse(!0),this.sdk.log("tryToCursorLock",e,"forceShowCursor",this.sdk.cloudGamingWebRTC.getForceShowCursor()),this.sdk.log("toggleMouseLock true, auto run requestPointerLock"))}},s([(0,m.interceptUserEvent)()],e.prototype,"onContextMenu",null),s([(0,m.interceptUserEvent)()],e.prototype,"onTouch",null),s([(0,m.interceptUserEvent)()],e.prototype,"onMouseMove",null),s([(0,m.interceptUserEvent)()],e.prototype,"onMouseMove2",null),s([(0,m.interceptUserEvent)()],e.prototype,"onMouseDown",null),s([(0,m.interceptUserEvent)()],e.prototype,"onMouseDown2",null),s([(0,m.interceptUserEvent)()],e.prototype,"onMouseUp2",null),s([(0,m.interceptUserEvent)()],e.prototype,"onWheel",null),s([(0,m.interceptUserEvent)("keyEvent")],e.prototype,"onKeyEvent",null),e}();t.default=k},3371:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},s=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(1743),u=n(5262),l=c(n(7023)),h=c(n(4652)),p=n(7461),f=n(6840),m=n(7829),v=function(){function e(e){var t=e.sdk;this.inputDelay=0,this.inputSeqMap={},this.rttSum=0,this.rttCount=0,this.rttArray=[],this.rtt=0,this.rawRTT=0,this.edgeRTT=0,this.latency={times:0,status:null},this.fps=null,this.delay=null,this.cpu="0",this.bitrate=null,this.lastBytesRevc=0,this.packetLost=null,this.nack=null,this.packetsReceived=null,this.framesDecoded=null,this.framesDropped=null,this.framesReceived=null,this.firCount=null,this.pliCount=null,this.decodems=null,this.interfameDelayMaxMs=null,this.frameWidth=null,this.frameHeight=null,this.packetsLossRate=0,this.codec="",this.jitterBuffer=0,this.lastFramesReceived=0,this.gpu="",this.audioFps=null,this.audioLevel=0,this.audioBitrate=null,this.audioLastBytesRevc=0,this.audioPacketsLost=null,this.audioPacketsReceived=null,this.audioNack=null,this.audioConcealedSamples=0,this.audioConcealmentEvents=0,this.audioJitterBuffer=0,this.audioTotalSamplesReceived=0,this.audioTotalSamplesDuration=0,this.audioSampleRate=0,this.audioChannels=0,this.audioPacketsLossRate=0,this.audioCodec="",this.performanceMetricBulk=[],this.eventMetricBulk=[],this.reportTimer=null,this.serverSessionCost=0,this.connectSuccessTimeCost=0,this.iceConnectedCost=0,this.firstFrameCost=0,this.apiCost=0,this.sdk=null,this.mount=null,this.rttFilter=new m.MedianFilter,this.time=0,this.sdk=t}return Object.defineProperty(e.prototype,"isShowing",{get:function(){return!!this.getQcloudStatElement()&&"none"!==this.getQcloudStatElement().style.display},enumerable:!1,configurable:!0}),e.prototype.init=function(e){var t=e.mount;this.mount=t},e.prototype.show=function(e){this.getQcloudStatElement()&&(this.getQcloudStatElement().style.display=e?"block":"none")},e.prototype.toggleStatisticsView=function(){var e=document.querySelector("#__vconsole");this.show(!this.isShowing),e&&(e.style.display=this.isShowing?"":"none")},e.prototype.getStats=function(){var e=this.sdk.gameConfig.getConfig({clientId:this.mount}).user_id;return{fps:this.fps,delay:this.delay,rtt:this.rtt,raw_rtt:this.rawRTT,edge_rtt:this.edgeRTT,cpu:this.cpu,load_cost_time:this.connectSuccessTimeCost-this.serverSessionCost,bit_rate:this.bitrate,packet_lost:this.packetLost,nack:this.nack,packet_received:this.packetsReceived,gpu:this.gpu,input_delay:this.inputDelay,user_id:e,timestamp:+new Date,first_frame_cost_time:this.firstFrameCost,api_cost_time:this.apiCost}},e.prototype.getMediaStats=function(){return{videoStats:{fps:this.fps,rtt:this.rtt,raw_rtt:this.rawRTT,edge_rtt:this.edgeRTT,bit_rate:(0,d.getFixedDecimal)(+this.bitrate/1024/1024*8),packet_lost:this.packetLost,packet_received:this.packetsReceived,packet_loss_rate:this.packetsLossRate,nack:this.nack,jitter_buffer:this.jitterBuffer,width:this.frameWidth,height:this.frameHeight,codec:this.codec,timestamp:+new Date},audioStats:{sample_rate:this.audioSampleRate,channels:this.audioChannels,bit_rate:(0,d.getFixedDecimal)(+this.audioBitrate/1024/1024*8),packet_lost:this.audioPacketsLost,packet_received:this.audioPacketsReceived,packet_loss_rate:this.audioPacketsLossRate,nack:this.audioNack,jitter_buffer:this.audioJitterBuffer,concealed_samples:this.audioConcealedSamples,concealment_events:this.audioConcealmentEvents,codec:this.audioCodec}}},e.prototype.setStat=function(e,t){var n,r,i,o,s,c=[],u=[];e.forEach((function(e){"inbound-rtp"===e.type&&("video"!==e.mediaType&&"video"!==e.kind||u.push(e),"audio"!==e.mediaType&&"audio"!==e.kind||c.push(e)),"candidate-pair"===e.type&&"succeeded"===e.state&&u.push(e),"track"===e.type&&(e.frameHeight||e.frameWidth||"video"===e.kind)&&u.push(e),"track"!==e.type||e.frameHeight&&e.frameWidth||c.push(e)}));try{for(var h=a(u),f=h.next();!f.done;f=h.next()){var m=f.value,v=m.type,g=m.frameWidth,y=void 0===g?0:g,b=m.frameHeight,k=void 0===b?0:b,C=m.framesPerSecond,S=m.framerateMean,_=m.totalDecodeTime,w=void 0===_?0:_,T=m.framesDropped,E=void 0===T?0:T,R=m.firCount,O=void 0===R?0:R,M=m.pliCount,P=void 0===M?0:M,D=m.jitterBufferDelay,x=void 0===D?0:D,I=m.bytesReceived,A=void 0===I?0:I,L=m.nackCount,j=void 0===L?0:L,B=m.packetsLost,N=void 0===B?0:B,U=m.packetsReceived,G=void 0===U?0:U,F=m.framesReceived,W=void 0===F?0:F,H=m.jitter,V=m.totalInterFrameDelay,q=void 0===V?0:V,K=m.codecId,z=void 0===K?"":K,Y=m.remoteSource,$=m.currentRoundTripTime,X=m.framesDecoded,J=void 0===X?0:X,Q=m.jitterBufferEmittedCount;if((le=void 0===Q?0:Q)||(le=1),J||(J=1),"track"===v&&(Y&&this.modifyStatElement({name:"Resolution",tag:"video-resolution",stat:"".concat(y,"x").concat(k),point:"qcloud-video"}),!(null===(s=l.default.name)||void 0===s?void 0:s.toLowerCase().includes("safari"))&&C||!Y||(this.fps=W-this.lastFramesReceived,this.modifyStatElement({name:"FPS",tag:"video-fps",stat:"".concat(this.fps),point:"qcloud-video"}),this.lastFramesReceived=W),this.jitterBuffer=(0,d.getFixedDecimal)(x/le*1e3),this.modifyStatElement({name:"JitterBuffer",tag:"video-jitter-buffer",stat:"".concat(this.jitterBuffer,"ms"),point:"qcloud-video"})),"inbound-rtp"===v){this.modifyStatElement({name:"Resolution",tag:"video-resolution",stat:"".concat(y,"x").concat(k),point:"qcloud-video"}),this.frameWidth===y&&this.frameHeight===k||(this.frameWidth=y,this.frameHeight=k,this.sdk.onVideoStreamConfigChange({width:y,height:k}),this.sdk.log("video stream resolution changed ->".concat(y," ").concat(k)));var Z=((null==t?void 0:t.get(z))||{}).mimeType,ee=void 0===Z?"":Z;this.modifyStatElement({name:"Codec",tag:"video-codec",stat:ee,point:"qcloud-video"}),this.codec=ee,C&&(this.fps=C,this.modifyStatElement({name:"FPS",tag:"video-fps",stat:"".concat(this.fps),point:"qcloud-video"})),S&&(this.fps=Math.floor(S),this.modifyStatElement({name:"FPS",tag:"video-fps",stat:"".concat(this.fps),point:"qcloud-video"}),this.jitterBuffer=Math.floor(1e3*H),this.modifyStatElement({name:"JitterBuffer",tag:"video-jitter-buffer",stat:"".concat(this.jitterBuffer,"ms"),point:"qcloud-video"})),this.bitrate=A-this.lastBytesRevc;var te=(0,d.getFixedDecimal)(+this.bitrate/1024/1024*8);this.modifyStatElement({name:"VideoBitrate",tag:"video-bitrates",stat:"".concat(te,"Mbit/s"),point:"qcloud-video"}),this.lastBytesRevc=A;var ne=(0,d.getFixedDecimal)((N-this.packetLost)/(G-this.packetsReceived));this.packetsLossRate=ne,this.packetLost=N,this.packetsReceived=G,this.packetLost=N<0?0:N,this.modifyStatElement({name:"PacketLost",tag:"video-packet-lost",stat:"".concat(this.packetLost),point:"qcloud-video"}),this.nack=j,this.modifyStatElement({name:"NACK",tag:"video-nack",stat:"".concat(this.nack),point:"qcloud-video"}),this.jitterBuffer=(0,d.getFixedDecimal)(x/le*1e3),this.modifyStatElement({name:"JitterBuffer",tag:"video-jitter-buffer",stat:"".concat(this.jitterBuffer,"ms"),point:"qcloud-video"}),this.delay=(0,d.getFixedDecimal)(+(w/J*1e3+this.jitterBuffer)),this.modifyStatElement({name:"Delay",tag:"video-delay",stat:"".concat(this.delay,"ms"),point:"qcloud-video"}),this.packetsReceived=G,this.framesDecoded=J,this.framesDropped=E,this.framesReceived=W,this.decodems=Math.floor(w/J*1e3),this.interfameDelayMaxMs=Math.floor(q/J*1e3),this.firCount=O,this.pliCount=P;var re=(this.sdk.gameConfig.getConfig({clientId:this.mount}).feature_switch||{}).network_event_script;if(re){var ie=re.notify_threshold,oe=void 0===ie?5:ie,se=(0,p.computeLatency)({packetsReceived:G,packetsLost:N,nack:j,rtt:this.rttArray,featureSwitch:this.sdk.gameConfig.getConfig({clientId:this.mount}).feature_switch});this.latency.status===se?(this.latency.times=this.latency.times+1,this.latency.times===oe&&this.latency.status!==p.NetworkStatus.NETWORK_NORMAL&&(this.sdk.onNetworkChange({status:"latency",data:{value:se,message:p.NetworkStatus[se]}}),this.sdk.onEvent({type:"latency",data:{value:se,message:p.NetworkStatus[se]}}),this.latency.times=0)):(this.latency.status=se,this.latency.times=0)}}if("candidate-pair"===v){this.rawRTT=1e3*$;var ae=this.sdk.gameConfig.getConfig({clientId:this.mount}).proxy;(null==ae?void 0:ae.proxy_delay)?(this.edgeRTT=Math.max(5,this.rawRTT-ae.proxy_delay),this.edgeRTT=Math.min(this.edgeRTT,this.rawRTT)):this.edgeRTT=this.rawRTT;var ce=this.rttFilter.next(this.edgeRTT);this.edgeRTT=Math.min(ce,this.rawRTT)}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}try{for(var de=a(c),ue=de.next();!ue.done;ue=de.next()){var le,he=ue.value,pe=(v=he.type,he.packetsLost),fe=(N=void 0===pe?0:pe,he.packetsReceived),me=(G=void 0===fe?0:fe,he.bytesReceived),ve=(A=void 0===me?0:me,he.audioLevel),ge=void 0===ve?0:ve,ye=he.nackCount,be=(j=void 0===ye?0:ye,he.codecId),ke=(z=void 0===be?"":be,he.jitterBufferDelay),Ce=(x=void 0===ke?0:ke,he.concealedSamples),Se=void 0===Ce?0:Ce,_e=he.concealmentEvents,we=void 0===_e?0:_e,Te=he.totalSamplesReceived,Ee=he.totalSamplesDuration,Re=he.jitterBufferEmittedCount;if((le=void 0===Re?0:Re)||(le=1),"inbound-rtp"===v){var Oe=(null==t?void 0:t.get(z))||{},Me=Oe.mimeType,Pe=(ee=void 0===Me?"":Me,Oe.channels);if(ee){this.audioConcealedSamples=Se,this.audioConcealmentEvents=we,this.audioChannels=Pe,this.modifyStatElement({name:"Codec",tag:"audio-codec",stat:ee,point:"qcloud-audio"}),this.audioCodec=ee;var De=Math.round((Te-this.audioTotalSamplesReceived)/(Ee-this.audioTotalSamplesDuration));this.audioSampleRate=De,this.audioTotalSamplesDuration=Ee,this.audioTotalSamplesReceived=Te,this.audioBitrate=A-this.audioLastBytesRevc,te=(0,d.getFixedDecimal)(+this.audioBitrate/1024/1024*8),this.modifyStatElement({name:"AudioBitrate",tag:"audio-bitrates",stat:"".concat(te,"Mbit/s"),point:"qcloud-audio"}),this.audioLastBytesRevc=A,this.modifyStatElement({name:"PacketLost",tag:"audio-packet-lost",stat:"".concat(this.audioPacketsLost),point:"qcloud-audio"}),ne=(0,d.getFixedDecimal)((N-this.audioPacketsLost)/(G-this.audioPacketsReceived)),this.audioPacketsLossRate=ne,this.audioPacketsLost=N,this.audioPacketsReceived=G,this.audioNack=j,this.modifyStatElement({name:"NACK",tag:"audio-nack",stat:"".concat(this.audioNack),point:"qcloud-audio"}),this.audioJitterBuffer=(0,d.getFixedDecimal)(x/le*1e3),this.jitterBuffer&&this.modifyStatElement({name:"JitterBuffer",tag:"audio-jitter-buffer",stat:"".concat(this.audioJitterBuffer,"ms"),point:"qcloud-audio"})}"track"===v&&this.modifyStatElement({name:"AudioLevel",tag:"audio-level",stat:"".concat((0,d.getFixedDecimal)(ge)),point:"qcloud-audio"})}}}catch(e){i={error:e}}finally{try{ue&&!ue.done&&(o=de.return)&&o.call(de)}finally{if(i)throw i.error}}},e.prototype.setInputStart=function(e){this.inputSeqMap[e]=(new Date).getTime()},e.prototype.setInputEnd=function(e){void 0===e&&(e=0),this.inputSeqMap[e]&&(this.inputDelay=Math.round((+new Date-this.inputSeqMap[e])/2),delete this.inputSeqMap[e])},e.prototype.setRTT=function(e){this.rtt=e,this.modifyStatElement({name:"RTT",tag:"video-rtt",stat:"".concat(e.toString(),"ms"),point:"qcloud-video"}),5===this.rttArray.length&&this.rttArray.shift(),this.rttArray.push(e),this.rttSum+=e,this.rttCount+=1;var t=e/(this.rttSum/this.rttCount)>2;return this.rttCount>60&&(this.rttSum=0,this.rttCount=0),t},e.prototype.setCpuAndGpuUsage=function(e){var t=e.cpu,n=void 0===t?"":t,r=e.gpu,i=void 0===r?"":r;this.cpu=n,+n&&this.modifyStatElement({name:"CpuUsage",tag:"cpu-usage",stat:n,point:"qcloud-info"}),this.gpu=i,+i&&this.modifyStatElement({name:"GpuUsage",tag:"gpu-usage",stat:i,point:"qcloud-info"})},e.prototype.setStaticStat=function(e){var t,n=e.serverIp,r=void 0===n?"":n,i=e.region,o=void 0===i?"":i,s=e.instanceId,a=void 0===s?"":s,c=e.instanceType,d=void 0===c?"":c,l=e.hostName,h=void 0===l?"":l,p=e.requestId,f=void 0===p?"":p,m=e.videoMimeType,v=void 0===m?"":m,g=e.audioMimeType,y=void 0===g?"":g,b=e.resolution,k=void 0===b?"":b;if(this.modifyStatElement({name:"Version",tag:"sdk-version",stat:u.config.version,point:"qcloud-info"}),r&&this.modifyStatElement({name:"ServerIp",tag:"server-ip",stat:r,point:"qcloud-info"}),o&&this.modifyStatElement({name:"Region",tag:"region",stat:o,point:"qcloud-info"}),a&&this.modifyStatElement({name:"InstanceId",tag:"instance-id",stat:a,point:"qcloud-info"}),d&&this.modifyStatElement({name:"InstanceType",tag:"instance-type",stat:d,point:"qcloud-info"}),f&&this.modifyStatElement({name:"RequestId",tag:"request-id",stat:f,point:"qcloud-info"}),v&&this.modifyStatElement({name:"Codec",tag:"video-codec",stat:v,point:"qcloud-video"}),y&&this.modifyStatElement({name:"Codec",tag:"audio-codec",stat:y,point:"qcloud-audio"}),k&&this.modifyStatElement({name:"Resolution",tag:"video-resolution",stat:k,point:"qcloud-video"}),!document.querySelector(".qcloud-host")&&this.sdk.isMobileGame){var C=document.createElement("div");C.className="qcloud-stat-row qcloud-host",C.innerHTML="<div class='qcloud-stat-left'>HostName</div><div class='qcloud-stat-right'>".concat(h,"</div>"),h&&(null===(t=this.getQcloudStatElement())||void 0===t||t.appendChild(C))}},e.prototype.setServerSessionTime=function(e){this.serverSessionCost=e},e.prototype.setIceConnectedTime=function(e){this.iceConnectedCost=e},e.prototype.setConnectSuccessTime=function(e){this.connectSuccessTimeCost=e,this.modifyStatElement({name:"ConnectSuccessTime",tag:"connect-success",stat:"".concat(e-this.sdk.initStartTime,"ms"),point:"qcloud-info"})},e.prototype.setAPICost=function(e){this.apiCost=e,this.modifyStatElement({name:"APICost",tag:"api-cost",stat:"".concat(e,"ms"),point:"qcloud-info"})},e.prototype.setFirstFrameCost=function(e){this.firstFrameCost=e,this.modifyStatElement({name:"FirstFrameCost",tag:"first-frame",stat:"".concat(e,"ms"),point:"qcloud-info"})},e.prototype.toggleMetricReportBulk=function(e){var t=this;"websocket"!==this.sdk.streamingMode&&(e?(clearInterval(this.reportTimer),this.reportTimer=setInterval((function(){t.metricReportBulk({type:"performance"}),t.metricReportBulk({type:"event"}),t.sdk.reportLogInner()}),1e4)):(clearInterval(this.reportTimer),this.sdk.reportLogInner()))},e.prototype.addPerformanceReportStat=function(){var e,t,n=this.sdk.gameConfig.getConfig({clientId:this.mount}),r=n.server_ip,i=n.request_id,o=n.server_version,s=n.user_id,a=n.app_id,c=n.game_id,d=n.host_name;this.performanceMetricBulk.push({user_id:s,request_id:i,server_ip:r,server_version:o,timestamp:+new Date,bit_rate:8*this.bitrate,packet_lost:this.packetLost,packet_received:this.packetsReceived,bytes_received:this.lastBytesRevc,audio_packet_lost:this.audioPacketsLost,audio_packet_received:this.audioPacketsReceived,fps:this.fps,delay:this.delay,nack:this.nack,cpu:+this.cpu,gpu:this.gpu,load_cost_time:this.iceConnectedCost-this.serverSessionCost,first_frame:this.connectSuccessTimeCost-this.serverSessionCost,jitter_buffer:this.jitterBuffer,input_delay:this.inputDelay,frame_decoded:this.framesDecoded,frame_dropped:this.framesDropped,frame_received:this.framesReceived,render_frame_rate:this.framesDecoded,receive_frame_rate:this.framesReceived,decoded_frame_rate:this.framesDecoded,decode_ms:this.decodems,version:"".concat(u.config.version),platform:"0",pli_count:this.pliCount,fir_count:this.firCount,browser:"".concat(null===(e=l.default.os)||void 0===e?void 0:e.family,"/").concat(null===(t=l.default.os)||void 0===t?void 0:t.version,"/").concat(l.default.name),app_id:"".concat(null!=a?a:0),game_id:c,rtt:this.rtt,raw_rtt:this.rawRTT,edge_rtt:this.edgeRTT,host_name:null!=d?d:"",device_id:null!=i?i:"",first_frame_cost_time:this.firstFrameCost,api_cost_time:this.apiCost,video_codec_name:this.codec,audio_codec_name:this.audioCodec})},e.prototype.addEventReport=function(e){var t=e.event_code,n=void 0===t?"":t,i=e.event_result_code,o=void 0===i?"":i,a=e.event_result_msg,c=void 0===a?"":a,d=e.event_time,u=void 0===d?+new Date:d,l=e.consume_time,h=s(e,["event_code","event_result_code","event_result_msg","event_time","consume_time"]);this.eventMetricBulk.push(r(r(r({},this.getEventCommonProperties()),{event_code:n,event_result_code:o,event_result_msg:c,event_time:u,consume_time:l}),h))},e.prototype.getEventCommonProperties=function(){var e=this.sdk.gameConfig.getConfig({clientId:this.mount}),t=e.app_id,n=e.user_id,r=void 0===n?"":n,i=e.server_ip,o=void 0===i?"":i,s=e.server_version,a=void 0===s?"":s,c=e.host_name,d=void 0===c?"":c,l=e.request_id,h=void 0===l?"":l,p=e.proxy,f=void 0===p?{}:p,m=f.edge,v=void 0===m?"":m,g=f.uploader,y=void 0===g?"":g;return{platform:"0",sdk_version:"".concat(u.config.version),hardware_os:"",os_version:null===navigator||void 0===navigator?void 0:navigator.userAgent,brand:"",model:"",IMEI:"",device_id:"",app_id:"".concat(null!=t?t:0),user_id:r,server_ip:o,server_version:a,host_name:d,request_id:h,timestamp:+new Date,edge:v,uploader:y}},e.prototype.metricReportBulk=function(e){var t=e.type;return i(this,void 0,void 0,(function(){var e,n,r,i,s,a;return o(this,(function(o){switch(o.label){case 0:if(e={},"event"===t){if(0===this.eventMetricBulk.length)return[2];e={metric:"cg_client_event",bulk:this.eventMetricBulk}}"performance"===t&&(e={metric:"cg_client_stat",bulk:this.performanceMetricBulk}),n=this.sdk.gameConfig.getConfig({clientId:this.mount}).sig_key,r=null;try{r=n&&(0,h.default)(JSON.stringify(e).slice(0,128),n).toString()}catch(e){this.sdk.log("encode sig_key error",e)}i=r?" https://metrics-cloud-gaming.crtrcloud.com/report_metric_bulk?sig=".concat(r):" https://metrics-cloud-gaming.crtrcloud.com/report_metric_bulk",o.label=1;case 1:return o.trys.push([1,3,,4]),u.config.lite?[2,this.sdk.log("lite sdk can not report state")]:u.config.privatization.server?[2]:[4,(0,f.fetchPost)({url:i,data:e})];case 2:return 0!==(s=o.sent().code)&&this.sdk.log("metricReportBulk failed",t,s),"performance"===t&&(this.performanceMetricBulk=[]),"event"===t&&(this.eventMetricBulk=[]),[3,4];case 3:return a=o.sent(),this.sdk.log("catch metricReportBulk failed",t,a.message,a.name),[3,4];case 4:return[2]}}))}))},e.prototype.modifyStatElement=function(e){var t,n,r,i=e.name,o=void 0===i?"":i,s=e.tag,a=void 0===s?"":s,c=e.stat,d=void 0===c?"":c,u=e.point,l=void 0===u?null:u;if(null===(t=this.getQcloudStatElement())||void 0===t?void 0:t.querySelector(".qcloud-".concat(a)))this.getQcloudStatElement()&&(this.getQcloudStatElement().querySelector(".qcloud-".concat(a," .qcloud-stat-right")).innerHTML=d);else{var h=document.createElement("div");h.className="qcloud-stat-row qcloud-".concat(a),h.innerHTML="<div class='qcloud-stat-left'>".concat(o,"</div><div class='qcloud-stat-right'>").concat(d,"</div>"),null===(r=null===(n=this.getQcloudStatElement())||void 0===n?void 0:n.querySelector(".".concat(l)))||void 0===r||r.appendChild(h)}},e.prototype.getQcloudStatElement=function(){var e;return null===(e=null===document||void 0===document?void 0:document.querySelector("#".concat(this.mount)))||void 0===e?void 0:e.querySelector(".qcloud-stat")},e}();t.default=v},3241:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9418),s=n(3578),a=n(5262),c=n(6840),d=function(){function e(e){var t=e.sdk,n=this;this.token="",this.serverIp="",this.retryTimes=0,this.maxRetryTimes=10,this.retryInterval=6e3,this.sdk=null,this.mount=null,this.startRetry=function(e){var t=e.message;n.sdk.log("Watchdog, reconnect proxy failed, try again, startRetry, times",n.retryTimes),setTimeout((function(){if(n.retryTimes>=n.maxRetryTimes)return n.sdk.cloudGamingWebRTC.clearPeerConnection(),n.sdk.onConnectFailed({code:o.CONNECT_FAILED_CODE.EXCEEDED_LIMIT_RERTY_TIMES,msg:"Retries exceeded"});n.autoReconnect({message:t}),n.retryTimes=n.retryTimes+1,n.sdk.onConnectFailed({code:o.CONNECT_FAILED_CODE.AUTO_RECONNECTING,msg:"auto connecting"})}),n.retryInterval)},this.sdk=t}return e.prototype.init=function(e){var t=e.mount;this.mount=t},e.prototype.autoReconnect=function(e){var t=e.message;return r(this,void 0,void 0,(function(){var e,n,r,d,u,l,h,p,f,m,v,g,y,b,k,C;return i(this,(function(i){switch(i.label){case 0:return this.sdk.cloudGamingWebRTC.clearPeerConnection(),[4,this.sdk.cloudGamingWebRTC.newWebRtcConnect()];case 1:if(i.sent(),this.sdk.cloudGamingWebRTC.startHeartbeatReport(),this.sdk.showStats.addEventReport({event_code:"auto_reconnect",event_result_msg:t}),this.sdk.accessTime=+new Date,this.sdk.isMobileGame)return[2,this.androidInstanceReconnect({message:t})];if(!this.serverIp||!this.token)return this.sdk.log("Watchdog, autoReconnect, serverIp:".concat(this.serverIp," or token:").concat(this.token," is not set, abort")),[2,this.sdk.onConnectFailed({code:o.RTC_CODE.CONNECT_FAILED,msg:"reconnect failed"})];e=this.sdk.cloudGamingWebRTC.getClientSideDescription(!1),n=this.sdk.gameConfig.getConfig({clientId:this.mount}),r=n.user_id,d=n.server_port,u=n.instance_id,l=d||7392,i.label=2;case 2:return i.trys.push([2,4,,5]),this.sdk.log("Watchdog, reconnect, serverIp:".concat(this.serverIp,", token:").concat(this.token)),a.config.lite?[2,this.sdk.log("lite sdk can not auto reconnect")]:(h="host=".concat(this.serverIp,"&port=").concat(l,"&token=").concat(this.token,"&uid=").concat(r),p=this.sdk.accessInfo.getInstanceAccessInfo({instanceId:u}).WebRTCAddress,f="".concat("https://cgproxy.cloud-gaming.myqcloud.com","/reconnect?").concat(h),p&&(f="".concat(p,"/reconnect?").concat(h)),a.config.privatization.server&&(f="http://".concat(this.serverIp,":").concat(l,"/cloud_gaming/reconnect?").concat(h)),[4,(0,c.fetchPost)({url:f,data:e})]);case 3:return m=i.sent(),v=m.Code,g=m.ServerSession,this.sdk.log("Watchdog, reconnect response code: ".concat(v)),0===v?(y=this.checkServerSession(g),b=y.code,k=y.message,0===b?(this.sdk.log("Watchdog, reconnect proxy success"),this.sdk.cloudGamingWebRTC.connect(s.Base64.encode(g)),this.retryTimes=0):(this.sdk.cloudGamingWebRTC.clearPeerConnection(),this.sdk.onConnectFailed({code:b,msg:k}),this.sdk.log("Watchdog, reconnect proxy failed"))):this.startRetry({message:t}),[3,5];case 4:return C=i.sent(),this.sdk.log("Watchdog post error",C),this.startRetry({message:null==C?void 0:C.message}),[3,5];case 5:return[2]}}))}))},e.prototype.setReconnectInfo=function(e){var t=e.serverIp,n=void 0===t?"":t,r=e.token,i=void 0===r?"":r;this.serverIp=n,this.token=i},e.prototype.checkServerSession=function(e){try{var t=JSON.parse(e),n=t.code,r=t.WebrtcResponse,i=t.Code,o=t.Msg,s=t.message,a=null!=n?n:i,c=s||o||(null==r?void 0:r.Msg);return this.sdk.log("Watchdog, server session code: ".concat(a,", message: ").concat(c)),{code:a,message:c}}catch(e){this.sdk.log("Watchdog, parse ServerSession error")}},e.prototype.androidInstanceReconnect=function(e){var t=e.message;return r(this,void 0,void 0,(function(){var e,n,r,s,a,c;return i(this,(function(i){switch(i.label){case 0:return e=this.sdk.gameConfig.getConfig({clientId:this.mount}).instance_id,this.sdk.log("Watchdog reconnect android instance, instance id is ".concat(e,", message: ").concat(t)),this.sdk.androidInstance.groupControl.groupControlId?(this.sdk.destroy({code:o.CONNECT_FAILED_CODE.MODE_FORBIDDEN,message:"Could not reconnect in group control mode"}),this.sdk.onConnectFailed({code:o.CONNECT_FAILED_CODE.MODE_FORBIDDEN,msg:"Could not reconnect in group control mode"}),[3,7]):[3,1];case 1:if(!e)return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.sdk.accessInfo.createWebRTCSession({instanceId:e,clientSession:this.sdk.getClientSession()})];case 3:return n=i.sent(),r=n.ServerSession,s=n.Code,a=n.Message,this.sdk.log("Watchdog, reconnect response code: ".concat(s,", message: ").concat(a)),0===s?(this.sdk.log("Watchdog, reconnect proxy success"),this.sdk.cloudGamingWebRTC.connect(r),this.retryTimes=0):(this.sdk.log("Watchdog reconnect error",a),this.startRetry({message:a})),[3,5];case 4:return c=i.sent(),this.sdk.log("Watchdog reconnect cache error",c.name,c.message),this.startRetry({message:c.message}),[3,5];case 5:return[3,7];case 6:this.sdk.log("Watchdog reconnect error, instance id is not set"),i.label=7;case 7:return[2]}}))}))},e}();t.default=d},869:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MOUNT_POINT_CSS=t.HTML_STRING=t.HTML_STATS=void 0,t.HTML_STATS='\n<div class="qcloud-stat">\n  \n  <div class="qcloud-video">\n    <div class="qcloud-stat-video">\n      <div class="qcloud-stat-left">Video</div>\n    </div>\n  </div>\n\n  <div class="qcloud-audio">\n    <div class="qcloud-stat-audio">\n      <div class="qcloud-stat-left">Audio</div>\n    </div>\n  </div>\n\n  <div class="qcloud-info">\n    <div class="qcloud-stat-info">\n      <div class="qcloud-stat-left">Info</div>\n    </div>\n  </div>\n\n</div>',t.HTML_STRING='\n<div class="cloud-gaming-container" tabindex="-1">\n\n  <div class="cloud-gaming-stream-container">\n    <video class="video-stream" tabindex="-1" playsinline webkit-playsinline x5-playsinline autoplay muted preload="auto"></video>\n    <audio class="audio-stream" tabindex="-1" playsinline webkit-playsinline x5-playsinline autoplay preload="auto"></audio>\n    <audio class="cloud-gaming-audio-stream-socket" tabindex="-1" playsinline webkit-playsinline x5-playsinline autoplay preload="auto"></audio>\n    <div class="cursor" id="cursor"></div>\n    <input class="tcg-fake-input"></input>\n  </div>\n\n  '.concat(t.HTML_STATS,'\n\n  <div class="progress-bar-container">\n    <div class="spinner"> </div>\n    <p class="starting">正在启动云渲染服务</p>\n    <p id="speed" class="starting"></p>\n  </div>\n\n  <a class="restart" href="javascript:window.location.reload();">重新连接</a>\n</div>'),t.MOUNT_POINT_CSS="\n.cloud-gaming-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  // justify-content: center;\n  // align-items: center;\n  display: none;\n}\n.cloud-gaming-stream-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-size: cover !important;\n}\n.cloud-gaming-audio-stream-socket {\n  display: none;\n}\n.tcg-fake-input {\n  position: absolute;\n  z-index: -5;\n  opacity: 0;\n}\n.qcloud-stat {\n  position: absolute;\n  right: 10px;\n  top: 0px;\n  line-height: 18px;\n  padding: 5px 10px;\n  z-index: 5;\n  color: #eee;\n  background: rgba(0, 0, 0, .5);\n  border-radius: 5px;\n  text-align: left;\n  font-size: 12px;\n  pointer-events: none;\n  display: none;\n  flex-direction: column;\n  width: 220px;\n  -webkit-transform: translateZ(0);\n  transform: translateZ(0);\n}\n.qcloud-request-id, .qcloud-instance-id {\n  pointer-events: all;\n}\n.qcloud-stat-left {\n  width: 120px;\n}\n.qcloud-stat-right {\n  flex: 1;\n}\n.qcloud-stat-row {\n  text-align: left;\n  display: flex;\n}\n\n@keyframes spinner {\n  to {transform: rotate(360deg);}\n}\n.progress-bar-container {\n  text-align: center;\n  position: absolute;\n  width: 40%;\n  height: 15%;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.starting {\n  color:white;\n  font-weight:bold;\n  margin-top:30px;\n}\n.spinner:before {\n  content: '';\n  box-sizing: border-box;\n  position: absolute;\n  top: 60px;\n  width: 20px;\n  height: 20px;\n  margin-top: -5px;\n  margin-left: -10px;\n  border-radius: 50%;\n  border: 4px solid #ccc;\n  border-top-color: #000;\n  animation: spinner .6s linear infinite;\n}\n.restart {\n  position: absolute;\n  width: 350px;\n  text-align: center;\n  height: 30px;\n  line-height: 30px;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  align-items: center;\n  font-size: 24px;\n  color: #fff;\n  display: none;\n}\n.cursor {\n  position: absolute;\n  width: 0px;\n  height: 0px;\n  top: 0px;\n  left: 0px;\n  z-index: 1;\n  background-size: cover;\n  display: none;\n}\n.audio-stream {\n  width: 0px;\n}\n.video-stream {\n  max-width: 100%;\n  max-height: 100%;\n  outline: none;\n  border: 0;\n}\n.video-stream:focus {\n  outline :none;\n}\n.rotate-html-90 {\n  transform: rotate(90deg);\n  transform-origin: left top;\n  width: 100vh;\n  width: 100svh;\n  height: 100vw;\n  overflow-x: hidden;\n  position: absolute;\n  top: 0;\n  left: 100%;\n}\n\n.rotate-html-180 {\n  transform: rotate(180deg);\n  transform-origin: center;\n}\n\n.rotate-html-270 {\n  transform: rotate(270deg);\n  transform-origin: left top;\n  overflow-x: hidden;\n  position: absolute;\n  top: 100%;\n  left: 0;\n}"},6840:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchGet=t.fetchPost=void 0,t.fetchPost=function(e){var t=e.url,o=e.data,s=e.timeout,a=e.headers;return r(void 0,void 0,void 0,(function(){var e,r,c;return i(this,(function(i){switch(i.label){case 0:return e=new AbortController,r=setTimeout((function(){return e.abort()}),null!=s?s:1e4),[4,fetch(t,{body:JSON.stringify(o),cache:"no-cache",credentials:"same-origin",headers:n({"content-type":"application/json"},a),method:"POST",mode:"cors",signal:e.signal}).then((function(e){if(200!==e.status)throw new Error("status Code:".concat(e.status));return e.text()})).then((function(e){try{return JSON.parse(e)}catch(t){return e}})).catch((function(e){throw"AbortError"===e.name?new Error("request timeout"):new Error("".concat(e.name,": ").concat(e.message))}))];case 1:return c=i.sent(),clearTimeout(r),[2,c]}}))}))},t.fetchGet=function(e){var t=e.url,n=e.type,o=void 0===n?"text":n,s=e.timeout,a=void 0===s?1e4:s,c=e.headers;return r(void 0,void 0,void 0,(function(){var e,n,r;return i(this,(function(i){switch(i.label){case 0:return e=new AbortController,n=setTimeout((function(){return e.abort()}),null!=a?a:1e4),[4,fetch(t,{cache:"no-cache",headers:c,method:"GET",mode:"cors",signal:e.signal}).then((function(e){if(200!==e.status)throw new Error("status Code:".concat(e.status));return"image"===o?e.blob():e.text()})).catch((function(e){throw"AbortError"===e.name?new Error("request timeout"):new Error("".concat(e.name,": ").concat(e.message))}))];case 1:return r=i.sent(),clearTimeout(n),[2,r]}}))}))}},2484:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interceptUserEvent=void 0,t.interceptUserEvent=function(e){return function(t,n,r){void 0===t&&(t=null);var i=r.value;return r.value=function(){for(var t,n,r,o,s,a,c,d=[],u=0;u<arguments.length;u++)d[u]=arguments[u];var l=["video-stream","cursor"];"keyEvent"===e&&l.push("cloud-gaming-container");var h=d[0].target.className,p=(null===(t=this.sdk)||void 0===t?void 0:t.getInitOptions()).mount,f=(null===(n=d[0].target.parentNode)||void 0===n?void 0:n.id)===p||(null===(o=null===(r=d[0].target.parentNode)||void 0===r?void 0:r.parentNode)||void 0===o?void 0:o.id)===p||(null===(c=null===(a=null===(s=d[0].target.parentNode)||void 0===s?void 0:s.parentNode)||void 0===a?void 0:a.parentNode)||void 0===c?void 0:c.id)===p;f&&(this.enableEventIntercept&&!l.includes(h)||i.apply(this,d))},r}}},9045:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventBus=void 0;var n=function(){function e(){this._events={}}return e.prototype.clear=function(){this._events={}},e.prototype.on=function(e,t){return this._events[e]||(this._events[e]=[]),this._events[e].push(t)-1},e.prototype.trigger=function(e,t){var n=this;if("error"!==e){var r=this._events[e];(null==r?void 0:r.length)&&r.forEach((function(e){e(t)}))}else setTimeout((function(){var r=n._events[e];(null==r?void 0:r.length)&&r.forEach((function(e){e(t)}))}),100)},e.prototype.off=function(e,t,n){var r=this._events[e];if(null==r?void 0:r.length)if(void 0!==n)r.splice(n,1);else{var i=r.findIndex((function(e){return e===t}));i>-1&&r.splice(i,1)}},e.prototype.offAll=function(){this._events={}},e.prototype.once=function(e,t){var n=this;this._events[e]||(this._events[e]=[]);var r=null,i=function(o){t(o),n.off(e,i,r)};r=this.on(e,i)},e}();t.EventBus=n},6363:function(e,t){"use strict";var n,r,i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getInIframe=t.supportFullScreen=void 0;var s,a={},c=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],d=i(c,1)[0];try{for(var u=o(c),l=u.next();!l.done;l=u.next()){var h=l.value;if(h[1]in document){s=h;break}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}if(s)for(var p=0;p<s.length;p++)a[d[p]]=s[p];t.default=a,t.supportFullScreen=function(e){if("function"==typeof e.webkitEnterFullScreen){var t=navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},t.getInIframe=function(){return window.self!==window.top}},7461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeLatency=t.NetworkStatus=t.variance=void 0,t.variance=function(e){if(void 0===e&&(e=[]),!e.length)return 0;var t=e.reduce((function(e,t){return e+t}),0),n=e.length,r=t/n,i=0;return e.forEach((function(e){i+=(e-r)*(e-r)})),i/=n,Math.floor(i)};var n,r={packetsReceived:0,packetsLost:0,nack:0,rttAverage:0,rttVariance:0,nackRate:0,packetsLostRate:0};!function(e){e[e.NETWORK_NORMAL=0]="NETWORK_NORMAL",e[e.NETWORK_CONGESTION=1]="NETWORK_CONGESTION",e[e.NACK_RISING=2]="NACK_RISING",e[e.HIGH_DELAY=3]="HIGH_DELAY",e[e.NETWORK_JITTER=4]="NETWORK_JITTER"}(n||(t.NetworkStatus=n={})),t.computeLatency=function(e){var i=e.packetsReceived,o=void 0===i?0:i,s=e.packetsLost,a=void 0===s?0:s,c=e.nack,d=void 0===c?0:c,u=e.rtt,l=void 0===u?[]:u,h=e.featureSwitch,p=void 0===h?{}:h,f=o-r.packetsReceived;r.packetsReceived=o;var m=a-r.packetsLost;r.packetsLost=a,r.packetsLostRate=m/f;var v=a-r.nack;r.nack=d,r.nackRate=v/f,r.rttAverage=l.reduce((function(e,t){return e+t}),0)/l.length,r.rttVariance=(0,t.variance)(l);var g=p.network_event_script,y=void 0===g?{}:g,b=y.loss_rate_threshold,k=y.nack_rate_threshold,C=y.rtt_avg_threshold,S=y.rtt_dev_threshold;return r.packetsLostRate>b?n.NETWORK_CONGESTION:r.nackRate>k?n.NACK_RISING:r.rttAverage>C?n.HIGH_DELAY:r.rttVariance>S?n.NETWORK_JITTER:n.NETWORK_NORMAL}},7829:function(e,t){"use strict";var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.MedianFilter=void 0;var i=function(){function e(e){if(void 0===e&&(e=5),this.buffer=[],e%2!=1||e<3)throw new Error("windowSize must be an odd number greater than or equal to 3.");this.windowSize=e}return e.prototype.next=function(e){return null===e||"number"!=typeof e||e<0?0:this.buffer.length<this.windowSize?(this.buffer.push(e),e):(this.buffer.push(e),this.buffer.shift(),r([],n(this.buffer),!1).sort((function(e,t){return e-t}))[Math.floor(this.windowSize/2)])},e.prototype.getBuffer=function(){return r([],n(this.buffer),!1)},e.prototype.reset=function(){this.buffer=[]},e}();t.MedianFilter=i},1038:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestQueue=void 0;var n=function(){function e(){this.requestQueue=[]}return e.prototype.startBlocking=function(){var e,t=new Promise((function(t){return e=t}));return this.requestQueue.push(e),t},e.prototype.nextTask=function(){this.requestQueue.length<=0||this.requestQueue.shift()()},e.prototype.clearQueue=function(){this.requestQueue=[]},e}();t.RequestQueue=n},1743:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isFloat=t.createOffscreenCanvas=t.concatArrayBuffers=t.isArrayBuffer=t.supportRenegotiation=t.getIOSVersion=t.getFakeInput=t.empty=t.getSequence=t.getFixedDecimal=t.is360=t.canReceiveH264=t.checkProfileLevelId=t.getSearch=t.noop=t.dispatchEvent=t.formatTime=t.addZero=t.sleep=t.checkBrowser=t.isHuawei=t.isIOS=t.isHarmony=t.isAndroid=t.isMobile=t.isFullScreen=t.isWegameChrome=t.codeMap=void 0;var d=c(n(7023));t.codeMap={0:{key:48,shift:!1},")":{key:48,shift:!0},1:{key:49,shift:!1},"!":{key:49,shift:!0},2:{key:50,shift:!1},"@":{key:50,shift:!0},3:{key:51,shift:!1},"#":{key:51,shift:!0},4:{key:52,shift:!1},$:{key:52,shift:!0},5:{key:53,shift:!1},"%":{key:53,shift:!0},6:{key:54,shift:!1},"^":{key:54,shift:!0},7:{key:55,shift:!1},"&":{key:55,shift:!0},8:{key:56,shift:!1},"*":{key:56,shift:!0},9:{key:57,shift:!1},"(":{key:57,shift:!0},a:{key:65,shift:!1},A:{key:65,shift:!0},b:{key:66,shift:!1},B:{key:66,shift:!0},c:{key:67,shift:!1},C:{key:67,shift:!0},d:{key:68,shift:!1},D:{key:68,shift:!0},e:{key:69,shift:!1},E:{key:69,shift:!0},f:{key:70,shift:!1},F:{key:70,shift:!0},g:{key:71,shift:!1},G:{key:71,shift:!0},h:{key:72,shift:!1},H:{key:72,shift:!0},i:{key:73,shift:!1},I:{key:73,shift:!0},j:{key:74,shift:!1},J:{key:74,shift:!0},k:{key:75,shift:!1},K:{key:75,shift:!0},l:{key:76,shift:!1},L:{key:76,shift:!0},m:{key:77,shift:!1},M:{key:77,shift:!0},n:{key:78,shift:!1},N:{key:78,shift:!0},o:{key:79,shift:!1},O:{key:79,shift:!0},p:{key:80,shift:!1},P:{key:80,shift:!0},q:{key:81,shift:!1},Q:{key:81,shift:!0},r:{key:82,shift:!1},R:{key:82,shift:!0},s:{key:83,shift:!1},S:{key:83,shift:!0},t:{key:84,shift:!1},T:{key:84,shift:!0},u:{key:85,shift:!1},U:{key:85,shift:!0},v:{key:86,shift:!1},V:{key:86,shift:!0},w:{key:87,shift:!1},W:{key:87,shift:!0},x:{key:88,shift:!1},X:{key:88,shift:!0},y:{key:89,shift:!1},Y:{key:89,shift:!0},z:{key:90,shift:!1},Z:{key:90,shift:!0},"=":{key:187,shift:!1},"+":{key:187,shift:!0},",":{key:188,shift:!1},"<":{key:188,shift:!0},"-":{key:189,shift:!1},_:{key:189,shift:!0},".":{key:190,shift:!1},">":{key:190,shift:!0},"/":{key:191,shift:!1},"?":{key:191,shift:!0},"`":{key:192,shift:!1},"~":{key:192,shift:!0},"[":{key:219,shift:!1},"{":{key:219,shift:!0},"\\":{key:220,shift:!1},"|":{key:220,shift:!0},"]":{key:221,shift:!1},"}":{key:221,shift:!0},"'":{key:222,shift:!1},'"':{key:222,shift:!0},"↑":{key:38,shift:!1},"↓":{key:40,shift:!1},"←":{key:37,shift:!1},"→":{key:39,shift:!1},Home:{key:36,shift:!1},Ctrl:{key:17,shift:!1},Alt:{key:18,shift:!1},Win:{key:91,shift:!1},NumLock:{key:144,shift:!1},Tab:{key:9,shift:!1},CapsLock:{key:20,shift:!1},Shift:{key:16,shift:!1},Enter:{key:13,shift:!1},BackSpace:{key:8,shift:!1},Insert:{key:45,shift:!1},Delete:{key:46,shift:!1},PageUp:{key:33,shift:!1},PageDown:{key:34,shift:!1},End:{key:35,shift:!1},PrintScreen:{key:42,shift:!1},ScrollLock:{key:145,shift:!1},PauseBreak:{key:19,shift:!1},Space:{key:32,shift:!1},Esc:{key:27,shift:!1},F1:{key:112,shift:!1},F2:{key:113,shift:!1},F3:{key:114,shift:!1},F4:{key:115,shift:!1},F5:{key:116,shift:!1},F6:{key:117,shift:!1},F7:{key:118,shift:!1},F8:{key:119,shift:!1},F9:{key:120,shift:!1},F10:{key:121,shift:!1},F11:{key:122,shift:!1},F12:{key:123,shift:!1},"^0":{key:96,shift:!1},"^1":{key:97,shift:!1},"^2":{key:98,shift:!1},"^3":{key:99,shift:!1},"^4":{key:100,shift:!1},"^5":{key:101,shift:!1},"^6":{key:102,shift:!1},"^7":{key:103,shift:!1},"^8":{key:104,shift:!1},"^9":{key:105,shift:!1},"^.":{key:110,shift:!1},"^+":{key:107,shift:!1},"^/":{key:111,shift:!1},"^*":{key:106,shift:!1},"^-":{key:109,shift:!1},"^Enter":{key:108,shift:!1},"^,":{key:188,shift:!1}},t.isWegameChrome=function(){return!(!window.external||!window.external.callcpp)},t.isFullScreen=function(){return!(!document.fullscreenElement&&!document.webkitIsFullScreen)},t.isMobile=function(){return!!(/Android|iPhone|iPad|iOS|Phone/i.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>0)},t.isAndroid=function(){var e,t;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===e?void 0:e.includes("Android"))||(null===(t=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===t?void 0:t.includes("Adr"))},t.isHarmony=function(){var e,t;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===e?void 0:e.includes("OpenHarmony"))||(null===(t=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===t?void 0:t.includes("ArkWeb"))},t.isIOS=function(){var e,t,n;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===e?void 0:e.includes("iOS"))||(null===(t=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===t?void 0:t.includes("iPhone"))||(null===(n=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===n?void 0:n.includes("iPad"))},t.isHuawei=function(){var e;return null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===e?void 0:e.toLocaleLowerCase().includes("huawei")},t.checkBrowser=function(){var e=navigator.userAgent.toLowerCase();return/micromessenger/gi.test(e)?"wx":/qq/gi.test(e)?"qq":"system"},t.sleep=function(e){return new Promise((function(t){setTimeout(t,e)}))},t.addZero=function(e,t){for(var n=0,r=t-"".concat(e).length;n<r;n++)e="0".concat(e);return"".concat(e)},t.formatTime=function(e,n){return n.replace(/yyyy|YYYY/,e.getFullYear()).replace(/yy|YY/,(0,t.addZero)(e.getFullYear()%100,2)).replace(/mm|MM/,(0,t.addZero)(e.getMonth()+1,2)).replace(/m|M/g,e.getMonth()+1).replace(/dd|DD/,(0,t.addZero)(e.getDate(),2)).replace(/d|D/g,e.getDate()).replace(/hh|HH/,(0,t.addZero)(e.getHours(),2)).replace(/h|H/g,e.getHours()).replace(/ii|II/,(0,t.addZero)(e.getMinutes(),2)).replace(/i|I/g,e.getMinutes()).replace(/ss|SS/,(0,t.addZero)(e.getSeconds(),2)).replace(/s|S/g,e.getSeconds()).replace(/w/g,e.getDay()).replace(/W/g,["日","一","二","三","四","五","六"][e.getDay()])},t.dispatchEvent=function(e){var t=e.name,n=e.data,r=new CustomEvent(t,{bubbles:!0,detail:n});return window.dispatchEvent(r)},t.noop=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.getSearch=function(){var e={};return window.location.search.replace("?","").split("&").forEach((function(t){var n=o(t.split("="),2),r=n[0],i=n[1];e[r]=i})),e},t.checkProfileLevelId=function(e){void 0===e&&(e="");var t=[];return e.split("\r\n").forEach((function(e){e.includes("profile-level-id")&&(e=e.split("profile-level-id").pop().slice(1),t.push(e))})),t},t.canReceiveH264=function(){var e=!1;if(window.RTCRtpReceiver&&(null===RTCRtpReceiver||void 0===RTCRtpReceiver?void 0:RTCRtpReceiver.getCapabilities)){var t=RTCRtpReceiver.getCapabilities("video");return t.codecs.forEach((function(t){"video/H264"!==t.mimeType||(e=!0)})),{canReceive:e,capabilities:t}}return console.log("RTCRtpReceiver.getCapabilities is not a function"),{canReceive:e,capabilities:{}}},t.is360=function(){var e=!1,t=navigator.userAgent,n=function(e,t){var n,r,i=navigator.mimeTypes;try{for(var o=s(i),a=o.next();!a.done;a=o.next())if(a.value[e]===t)return!0}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1},r={360:t.indexOf("QihooBrowser")>-1||t.indexOf("QHBrowser")>-1,"360EE":t.indexOf("360EE")>-1,"360SE":t.indexOf("360SE")>-1,"2345Explorer":t.indexOf("2345Explorer")>-1||t.indexOf("Mb2345Browser")>-1||t.indexOf("2345chrome")>-1,Mobile:t.indexOf("Mobi")>-1||t.indexOf("iPh")>-1||t.indexOf("480")>-1};if(window.chrome){var i=t.replace(/^.*Chrome\/([\d]+).*$/,"$1");window.chrome.adblock2345||window.chrome.common2345?r["2345Explorer"]=!0:n("type","application/360softmgrplugin")||n("type","application/mozilla-npqihooquicklogin")||i>36&&window.showModalDialog?e=!0:i>45&&!(e=n("type","application/vnd.chromium.remoting-viewer"))&&i>=69&&(e=n("type","application/hwepass2001.installepass2001")||n("type","application/asx"))}return e},t.getFixedDecimal=function(e,t){return void 0===t&&(t=2),Math.floor(10*e*t)/(10*t)},t.getSequence=function(){return+(+new Date+Math.round(1e4*Math.random()))},t.empty={},t.getFakeInput=function(){return document.getElementById("tcg-fake-input")},t.getIOSVersion=function(){var e,t,n=o(null===(t=null===(e=null===d.default||void 0===d.default?void 0:d.default.os)||void 0===e?void 0:e.version)||void 0===t?void 0:t.split("."),2),r=n[0],i=n[1];return r&&i?+"".concat(r,".").concat(i):0},t.supportRenegotiation=function(){return!((0,t.isIOS)()&&(0,t.getIOSVersion)()<15.4)},t.isArrayBuffer=function(e){return e&&e instanceof ArrayBuffer&&void 0!==e.byteLength},t.concatArrayBuffers=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r(void 0,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,new Blob(a([],o(e),!1)).arrayBuffer()];case 1:return[2,t.sent()]}}))}))},t.createOffscreenCanvas=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n},t.isFloat=function(e){return Number.isFinite(e)&&e%1!=0}},943:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=t},9677:e=>{var t,n;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],o=0;o<4;o++)8*r+6*o<=8*e.length?n.push(t.charAt(i>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&n.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(r))>>>6-2*i);return n}},e.exports=n},8112:function(e,t,n){var r;e.exports=(r=r||function(e,t){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==n.g&&n.g.crypto&&(r=n.g.crypto),!r)try{r=n(429)}catch(e){}var i=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),s={},a=s.lib={},c=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},d=a.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=s<<24-(r+o)%4*8}else for(var a=0;a<i;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(i());return new d.init(t,e)}}),u=s.enc={},l=u.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new d.init(n,t/2)}},h=u.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new d.init(n,t)}},p=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},f=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,i=r.words,o=r.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,u=e.min(4*c,o);if(c){for(var l=0;l<c;l+=s)this._doProcessBlock(i,l);n=i.splice(0,c),r.sigBytes-=u}return new d.init(n,u)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),m=(a.Hasher=f.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}}),s.algo={});return s}(Math),r)},4652:function(e,t,n){var r;e.exports=(r=n(8112),n(2232),n(3456),r.HmacSHA256)},3456:function(e,t,n){var r,i,o;e.exports=(i=(r=n(8112)).lib.Base,o=r.enc.Utf8,void(r.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),s=this._iKey=t.clone(),a=i.words,c=s.words,d=0;d<n;d++)a[d]^=1549556828,c[d]^=909522486;i.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))},2232:function(e,t,n){var r;e.exports=(r=n(8112),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)t(r)&&(i<8&&(a[i]=n(e.pow(r,.5))),c[i]=n(e.pow(r,1/3)),i++),r++}();var d=[],u=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],u=n[5],l=n[6],h=n[7],p=0;p<64;p++){if(p<16)d[p]=0|e[t+p];else{var f=d[p-15],m=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,v=d[p-2],g=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;d[p]=m+d[p-7]+g+d[p-16]}var y=r&i^r&o^i&o,b=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),k=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&u^~a&l)+c[p]+d[p];h=l,l=u,u=a,a=s+k|0,s=o,o=i,i=r,r=k+(b+y)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+u|0,n[6]=n[6]+l|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(u),t.HmacSHA256=o._createHmacHelper(u)}(Math),r.SHA256)},7408:function(e){var t;t=()=>(()=>{var e={944:function(e){e.exports=(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw s}}}}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e.d(t,{default:()=>c});var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a(this,e),this.allowExtra=t,this.defaults=new Map,this.types=new Map,this.optional=new Set,this.required=new Set}var t;return(t=[{key:"setDefaults",value:function(e){var t=this;return Object.entries(e).forEach((function(e){var n=i(e,2),r=n[0],o=n[1];return t.defaults.set(r,o)})),this}},{key:"setTypes",value:function(e){var t=this;return Object.entries(e).forEach((function(e){var n=i(e,2),r=n[0],o=n[1];return t.types.set(r,o)})),this}},{key:"setOptional",value:function(e){var t=this;return e.forEach((function(e){return t.optional.add(e)})),this}},{key:"setRequired",value:function(e){var t=this;return e.forEach((function(e){return t.required.add(e)})),this}},{key:"resolve",value:function(e){var t=Object.assign(this.getDefaults(),e);return this.validate(t),t}},{key:"getDefaults",value:function(){var e,t={},n=r(this.defaults);try{for(n.s();!(e=n.n()).done;){var o=i(e.value,2),s=o[0],a=o[1];t[s]=a}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"validate",value:function(e){for(var t in e){if(!this.optionExists(t))throw new Error('Unkown option "'.concat(t,'".'));this.checkType(t,e[t])}var n,i=r(this.required.values());try{for(i.s();!(n=i.n()).done;){var o=n.value;if(void 0===e[o])throw new Error('Option "'.concat(o,'" is required.'))}}catch(e){i.e(e)}finally{i.f()}}},{key:"checkType",value:function(e,t){if(this.types.has(e)){var r=this.types.get(e),i=n(t);if(i!==r)throw new Error('Wrong value for option "'.concat(e,'". Expected type "').concat(r,'" but got "').concat(i,'".'))}}},{key:"optionExists",value:function(e){return!!this.allowExtra||this.defaults.has(e)||this.optional.has(e)||this.required.has(e)||this.types.has(e)}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();return t.default})()},162:function(e){e.exports=(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>n});var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._events={},this.on=this.addEventListener,this.off=this.removeEventListener}var t;return(t=[{key:"emit",value:function(e,t){if(Object.prototype.hasOwnProperty.call(this._events,e))for(var n=this._events[e],r={type:e,detail:t},i=n.length,o=0;o<i;o++)this.handle(n[o],r)}},{key:"handle",value:function(e,t){e(t)}},{key:"addEventListener",value:function(e,t){Object.prototype.hasOwnProperty.call(this._events,e)||(this._events[e]=[]),this._events[e].indexOf(t)<0&&this._events[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(Object.prototype.hasOwnProperty.call(this._events,e)){var n=this._events[e],r=n.indexOf(t);r>=0&&n.splice(r,1),0===n.length&&delete this._events[e]}}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();return t.default})()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r),n.d(r,{GamepadHandler:()=>p,GamepadListener:()=>S});var e=n(162),t=n.n(e),i=n(944),o=n.n(i);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===s(i)?i:String(i)),r)}var i}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function u(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(p,e);var t,n,r,i,o,s=(i=p,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(i);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function p(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(this,p),(n=s.call(this)).index=e,n.options=n.constructor.resolveOptions(r),n.sticks=new Array(Math.ceil(t.axes.length/2)).fill(null).map((function(){return[null,null]})),n.buttons=new Array(t.buttons.length).fill(null),n.updateStick=n.updateStick.bind(l(n)),n.updateButton=n.updateButton.bind(l(n)),n}return t=p,r=[{key:"resolveOptions",value:function(e){var t=void 0!==e.stick,n=void 0!==e.button,r={stick:this.optionResolver.resolve(t?e.stick:n?{}:e),button:this.optionResolver.resolve(n?e.button:t?{}:e)};return r.stick.deadZone=Math.max(Math.min(r.stick.deadZone,1),0),r.button.deadZone=Math.max(Math.min(r.button.deadZone,1),0),r.stick.precision=r.stick.precision?Math.pow(10,r.stick.precision):0,r.button.precision=r.button.precision?Math.pow(10,r.button.precision):0,r}}],(n=[{key:"update",value:function(e){for(var t=0,n=this.sticks.length,r=0;r<n;r++)for(var i=0;i<2;i++)this.updateStick(e,r,i,e.axes[t++]);var o=this.buttons.length;for(t=0;t<o;t++)this.updateButton(e,e.buttons[t],t)}},{key:"updateStick",value:function(e,t,n,r){var i=this.options.stick,o=i.deadZone,s=i.analog,a=i.precision;o&&r<o&&r>-o&&(r=0),s?a&&(r=Math.round(r*a)/a):r=r>0?1:r<0?-1:0,this.sticks[t][n]!==r&&(this.sticks[t][n]=r,this.emit("axis",{gamepad:e,stick:t,axis:n,value:r,index:this.index}))}},{key:"updateButton",value:function(e,t,n){var r=this.options.button,i=r.deadZone,o=r.analog,s=r.precision,a=t.value,c=t.pressed,d=a;i&&t.value<i&&t.value>-i&&(d=0),o?s&&(d=Math.round(d*s)/s):d=c?1:0,this.buttons[n]!==d&&(this.buttons[n]=d,this.emit("button",{gamepad:e,button:n,pressed:c,value:d,index:this.index}))}}])&&c(t.prototype,n),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),p}(t());function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}p.optionResolver=(new(o())).setDefaults({analog:!0,deadZone:0,precision:0}).setTypes({analog:"boolean",deadZone:"number",precision:"number"});var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callback=t,this.frame=null,this.update=this.update.bind(this)}var t,n;return t=e,(n=[{key:"setCallback",value:function(e){this.callback=e}},{key:"start",value:function(){this.frame||(this.frame=window.requestAnimationFrame(this.update))}},{key:"stop",value:function(){this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=null)}},{key:"update",value:function(){this.frame=window.requestAnimationFrame(this.update),this.callback()}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===f(i)?i:String(i)),r)}var i}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function b(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return k(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(s,e);var t,n,r,i,o=(r=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(r);if(i){var n=C(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return b(this,e)});function s(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(g(this,s),e=o.call(this),"function"!=typeof navigator.getGamepads)throw new Error("This browser does not support gamepad API.");return e.options=t,e.onAxis=e.onAxis.bind(k(e)),e.update=e.update.bind(k(e)),e.start=e.start.bind(k(e)),e.stop=e.stop.bind(k(e)),e.discover=e.discover.bind(k(e)),e.onButton=e.onButton.bind(k(e)),e.handlers=new Array(4).fill(null),e.loop=new m(e.update),window.addEventListener("error",e.stop),e}return t=s,(n=[{key:"start",value:function(){this.loop.start()}},{key:"stop",value:function(){this.loop.stop()}},{key:"update",value:function(){var e=navigator.getGamepads();this.discover(e[0],0),this.discover(e[1],1),this.discover(e[2],2),this.discover(e[3],3)}},{key:"discover",value:function(e,t){e?(this.handlers[t]||this.registerHandler(t,e),this.handlers[t].update(e)):this.handlers[t]&&this.removeGamepad(t)}},{key:"registerHandler",value:function(e,t){if(this.handlers[e])throw new Error("Gamepad #".concat(e," is already registered."));var n=new p(e,t,this.options);this.handlers[e]=n,n.addEventListener("axis",this.onAxis),n.addEventListener("button",this.onButton),this.emit("gamepad:connected",{index:e,gamepad:t}),this.emit("gamepad:".concat(e,":connected"),{index:e,gamepad:t})}},{key:"removeGamepad",value:function(e){if(!this.handlers[e])throw new Error("Gamepad #".concat(e," is not registered."));this.handlers[e].removeEventListener("axis",this.onAxis),this.handlers[e].removeEventListener("button",this.onButton),this.handlers[e]=null,this.emit("gamepad:disconnected",{index:e}),this.emit("gamepad:".concat(e,":disconnected"),{index:e})}},{key:"onAxis",value:function(e){var t=e.detail.index;this.emit("gamepad:axis",e.detail),this.emit("gamepad:".concat(t,":axis"),e.detail),this.emit("gamepad:".concat(t,":axis:").concat(e.detail.axis),e.detail)}},{key:"onButton",value:function(e){var t=e.detail.index;this.emit("gamepad:button",e.detail),this.emit("gamepad:".concat(t,":button"),e.detail),this.emit("gamepad:".concat(t,":button:").concat(e.detail.button),e.detail)}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==v(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===v(i)?i:String(i)),r)}var i}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(t())})(),r})(),e.exports=t()},8809:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},3578:function(e,t,n){"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g&&n.g,e.exports=function(){"use strict";var e,t="3.7.2",n="function"==typeof atob,r="function"==typeof btoa,i="function"==typeof Buffer,o="function"==typeof TextDecoder?new TextDecoder:void 0,s="function"==typeof TextEncoder?new TextEncoder:void 0,a=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),c=(e={},a.forEach((function(t,n){return e[t]=n})),e),d=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,u=String.fromCharCode.bind(String),l="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e,t){return void 0===t&&(t=function(e){return e}),new Uint8Array(Array.prototype.slice.call(e,0).map(t))},h=function(e){return e.replace(/=/g,"").replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"}))},p=function(e){return e.replace(/[^A-Za-z0-9\+\/]/g,"")},f=function(e){for(var t,n,r,i,o="",s=e.length%3,c=0;c<e.length;){if((n=e.charCodeAt(c++))>255||(r=e.charCodeAt(c++))>255||(i=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");o+=a[(t=n<<16|r<<8|i)>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}return s?o.slice(0,s-3)+"===".substring(s):o},m=r?function(e){return btoa(e)}:i?function(e){return Buffer.from(e,"binary").toString("base64")}:f,v=i?function(e){return Buffer.from(e).toString("base64")}:function(e){for(var t=[],n=0,r=e.length;n<r;n+=4096)t.push(u.apply(null,e.subarray(n,n+4096)));return m(t.join(""))},g=function(e,t){return void 0===t&&(t=!1),t?h(v(e)):v(e)},y=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?u(192|t>>>6)+u(128|63&t):u(224|t>>>12&15)+u(128|t>>>6&63)+u(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return u(240|t>>>18&7)+u(128|t>>>12&63)+u(128|t>>>6&63)+u(128|63&t)},b=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,k=function(e){return e.replace(b,y)},C=i?function(e){return Buffer.from(e,"utf8").toString("base64")}:s?function(e){return v(s.encode(e))}:function(e){return m(k(e))},S=function(e,t){return void 0===t&&(t=!1),t?h(C(e)):C(e)},_=function(e){return S(e,!0)},w=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,T=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return u(55296+(t>>>10))+u(56320+(1023&t));case 3:return u((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return u((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},E=function(e){return e.replace(w,T)},R=function(e){if(e=e.replace(/\s+/g,""),!d.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));for(var t,n,r,i="",o=0;o<e.length;)t=c[e.charAt(o++)]<<18|c[e.charAt(o++)]<<12|(n=c[e.charAt(o++)])<<6|(r=c[e.charAt(o++)]),i+=64===n?u(t>>16&255):64===r?u(t>>16&255,t>>8&255):u(t>>16&255,t>>8&255,255&t);return i},O=n?function(e){return atob(p(e))}:i?function(e){return Buffer.from(e,"base64").toString("binary")}:R,M=i?function(e){return l(Buffer.from(e,"base64"))}:function(e){return l(O(e),(function(e){return e.charCodeAt(0)}))},P=function(e){return M(x(e))},D=i?function(e){return Buffer.from(e,"base64").toString("utf8")}:o?function(e){return o.decode(M(e))}:function(e){return E(O(e))},x=function(e){return p(e.replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})))},I=function(e){return D(x(e))},A=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}},L=function(){var e=function(e,t){return Object.defineProperty(String.prototype,e,A(t))};e("fromBase64",(function(){return I(this)})),e("toBase64",(function(e){return S(this,e)})),e("toBase64URI",(function(){return S(this,!0)})),e("toBase64URL",(function(){return S(this,!0)})),e("toUint8Array",(function(){return P(this)}))},j=function(){var e=function(e,t){return Object.defineProperty(Uint8Array.prototype,e,A(t))};e("toBase64",(function(e){return g(this,e)})),e("toBase64URI",(function(){return g(this,!0)})),e("toBase64URL",(function(){return g(this,!0)}))},B={version:t,VERSION:"3.7.2",atob:O,atobPolyfill:R,btoa:m,btoaPolyfill:f,fromBase64:I,toBase64:S,encode:S,encodeURI:_,encodeURL:_,utob:k,btou:E,decode:I,isValid:function(e){if("string"!=typeof e)return!1;var t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:g,toUint8Array:P,extendString:L,extendUint8Array:j,extendBuiltins:function(){L(),j()},Base64:{}};return Object.keys(B).forEach((function(e){return B.Base64[e]=B[e]})),B}()},1586:(e,t,n)=>{var r,i,o,s,a;r=n(9677),i=n(943).utf8,o=n(8809),s=n(943).bin,(a=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):i.stringToBytes(e):o(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var n=r.bytesToWords(e),c=8*e.length,d=1732584193,u=-271733879,l=-1732584194,h=271733878,p=0;p<n.length;p++)n[p]=16711935&(n[p]<<8|n[p]>>>24)|4278255360&(n[p]<<24|n[p]>>>8);n[c>>>5]|=128<<c%32,n[14+(c+64>>>9<<4)]=c;var f=a._ff,m=a._gg,v=a._hh,g=a._ii;for(p=0;p<n.length;p+=16){var y=d,b=u,k=l,C=h;d=f(d,u,l,h,n[p+0],7,-680876936),h=f(h,d,u,l,n[p+1],12,-389564586),l=f(l,h,d,u,n[p+2],17,606105819),u=f(u,l,h,d,n[p+3],22,-1044525330),d=f(d,u,l,h,n[p+4],7,-176418897),h=f(h,d,u,l,n[p+5],12,1200080426),l=f(l,h,d,u,n[p+6],17,-1473231341),u=f(u,l,h,d,n[p+7],22,-45705983),d=f(d,u,l,h,n[p+8],7,1770035416),h=f(h,d,u,l,n[p+9],12,-1958414417),l=f(l,h,d,u,n[p+10],17,-42063),u=f(u,l,h,d,n[p+11],22,-1990404162),d=f(d,u,l,h,n[p+12],7,1804603682),h=f(h,d,u,l,n[p+13],12,-40341101),l=f(l,h,d,u,n[p+14],17,-1502002290),d=m(d,u=f(u,l,h,d,n[p+15],22,1236535329),l,h,n[p+1],5,-165796510),h=m(h,d,u,l,n[p+6],9,-1069501632),l=m(l,h,d,u,n[p+11],14,643717713),u=m(u,l,h,d,n[p+0],20,-373897302),d=m(d,u,l,h,n[p+5],5,-701558691),h=m(h,d,u,l,n[p+10],9,38016083),l=m(l,h,d,u,n[p+15],14,-660478335),u=m(u,l,h,d,n[p+4],20,-405537848),d=m(d,u,l,h,n[p+9],5,568446438),h=m(h,d,u,l,n[p+14],9,-1019803690),l=m(l,h,d,u,n[p+3],14,-187363961),u=m(u,l,h,d,n[p+8],20,1163531501),d=m(d,u,l,h,n[p+13],5,-1444681467),h=m(h,d,u,l,n[p+2],9,-51403784),l=m(l,h,d,u,n[p+7],14,1735328473),d=v(d,u=m(u,l,h,d,n[p+12],20,-1926607734),l,h,n[p+5],4,-378558),h=v(h,d,u,l,n[p+8],11,-2022574463),l=v(l,h,d,u,n[p+11],16,1839030562),u=v(u,l,h,d,n[p+14],23,-35309556),d=v(d,u,l,h,n[p+1],4,-1530992060),h=v(h,d,u,l,n[p+4],11,1272893353),l=v(l,h,d,u,n[p+7],16,-155497632),u=v(u,l,h,d,n[p+10],23,-1094730640),d=v(d,u,l,h,n[p+13],4,681279174),h=v(h,d,u,l,n[p+0],11,-358537222),l=v(l,h,d,u,n[p+3],16,-722521979),u=v(u,l,h,d,n[p+6],23,76029189),d=v(d,u,l,h,n[p+9],4,-640364487),h=v(h,d,u,l,n[p+12],11,-421815835),l=v(l,h,d,u,n[p+15],16,530742520),d=g(d,u=v(u,l,h,d,n[p+2],23,-995338651),l,h,n[p+0],6,-198630844),h=g(h,d,u,l,n[p+7],10,1126891415),l=g(l,h,d,u,n[p+14],15,-1416354905),u=g(u,l,h,d,n[p+5],21,-57434055),d=g(d,u,l,h,n[p+12],6,1700485571),h=g(h,d,u,l,n[p+3],10,-1894986606),l=g(l,h,d,u,n[p+10],15,-1051523),u=g(u,l,h,d,n[p+1],21,-2054922799),d=g(d,u,l,h,n[p+8],6,1873313359),h=g(h,d,u,l,n[p+15],10,-30611744),l=g(l,h,d,u,n[p+6],15,-1560198380),u=g(u,l,h,d,n[p+13],21,1309151649),d=g(d,u,l,h,n[p+4],6,-145523070),h=g(h,d,u,l,n[p+11],10,-1120210379),l=g(l,h,d,u,n[p+2],15,718787259),u=g(u,l,h,d,n[p+9],21,-343485551),d=d+y>>>0,u=u+b>>>0,l=l+k>>>0,h=h+C>>>0}return r.endian([d,u,l,h])})._ff=function(e,t,n,r,i,o,s){var a=e+(t&n|~t&r)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._gg=function(e,t,n,r,i,o,s){var a=e+(t&r|n&~r)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._hh=function(e,t,n,r,i,o,s){var a=e+(t^n^r)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._ii=function(e,t,n,r,i,o,s){var a=e+(n^(t|~r))+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._blocksize=16,a._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var n=r.wordsToBytes(a(e,t));return t&&t.asBytes?n:t&&t.asString?s.bytesToString(n):r.bytesToHex(n)}},7023:function(e,t,n){var r;e=n.nmd(e),function(){"use strict";var i={function:!0,object:!0},o=i[typeof window]&&window||this,s=i[typeof t]&&t,a=i.object&&e&&!e.nodeType&&e,c=s&&a&&"object"==typeof n.g&&n.g;!c||c.global!==c&&c.window!==c&&c.self!==c||(o=c);var d=Math.pow(2,53)-1,u=/\bOpera/,l=Object.prototype,h=l.hasOwnProperty,p=l.toString;function f(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function m(e){return e=k(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:f(e)}function v(e,t){for(var n in e)h.call(e,n)&&t(e[n],n,e)}function g(e){return null==e?f(e):p.call(e).slice(8,-1)}function y(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=d)for(;++n<r;)t(e[n],n);else v(e,t)}(e,(function(r,i){n=t(n,r,i,e)})),n}function k(e){return String(e).replace(/^ +| +$/g,"")}var C=function e(t){var n=o,r=t&&"object"==typeof t&&"String"!=g(t);r&&(n=t,t=null);var i=n.navigator||{},s=i.userAgent||"";t||(t=s);var a,c,d,l,h=r?!!i.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(p.toString()),f="Object",C=r?f:"ScriptBridgingProxyObject",S=r?f:"Environment",_=r&&n.java?"JavaPackage":g(n.java),w=r?f:"RuntimeObject",T=/\bJava/.test(_)&&n.java,E=T&&g(n.environment)==S,R=T?"a":"α",O=T?"b":"β",M=n.document||{},P=n.operamini||n.opera,D=u.test(D=r&&P?P["[[Class]]"]:g(P))?D:P=null,x=t,I=[],A=null,L=t==s,j=L&&P&&"function"==typeof P.version&&P.version(),B=b([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)})),N=b(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],(function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)})),U=W([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),G=b({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},(function(e,n,r){return e||(n[U]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(U)]||RegExp("\\b"+y(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r})),F=b(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],(function(e,n){var r=n.pattern||y(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(r=r[/[\d.]+$/.exec(e)])&&(e="Windows "+r),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),m(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,r,n.label||n)),e}));function W(e){return b(e,(function(e,n){var r=n.pattern||y(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=m(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function H(e){return b(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(B&&(B=[B]),/\bAndroid\b/.test(F)&&!U&&(a=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(U=k(a[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),G&&!U?U=W([G]):G&&U&&(U=U.replace(RegExp("^("+y(G)+")[-_.\\s]","i"),G+" ").replace(RegExp("^("+y(G)+")[-_.]?(\\w)","i"),G+" $2")),(a=/\bGoogle TV\b/.exec(U))&&(U=a[0]),/\bSimulator\b/i.test(t)&&(U=(U?U+" ":"")+"Simulator"),"Opera Mini"==N&&/\bOPiOS\b/.test(t)&&I.push("running in Turbo/Uncompressed mode"),"IE"==N&&/\blike iPhone OS\b/.test(t)?(G=(a=e(t.replace(/like iPhone OS/,""))).manufacturer,U=a.product):/^iP/.test(U)?(N||(N="Safari"),F="iOS"+((a=/ OS ([\d_]+)/i.exec(t))?" "+a[1].replace(/_/g,"."):"")):"Konqueror"==N&&/^Linux\b/i.test(F)?F="Kubuntu":G&&"Google"!=G&&(/Chrome/.test(N)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(U))||/\bAndroid\b/.test(F)&&/^Chrome/.test(N)&&/\bVersion\//i.test(t)?(N="Android Browser",F=/\bAndroid\b/.test(F)?F:"Android"):"Silk"==N?(/\bMobi/i.test(t)||(F="Android",I.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&I.unshift("accelerated")):"UC Browser"==N&&/\bUCWEB\b/.test(t)?I.push("speed mode"):"PaleMoon"==N&&(a=/\bFirefox\/([\d.]+)\b/.exec(t))?I.push("identifying as Firefox "+a[1]):"Firefox"==N&&(a=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(F||(F="Firefox OS"),U||(U=a[1])):!N||(a=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(N))?(N&&!U&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(a+"/")+8))&&(N=null),(a=U||G||F)&&(U||G||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(F))&&(N=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(F)?F:a)+" Browser")):"Electron"==N&&(a=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&I.push("Chromium "+a),j||(j=H(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",y(N),"(?:Firefox|Minefield|NetFront)"])),(a=("iCab"==B&&parseFloat(j)>3?"WebKit":/\bOpera\b/.test(N)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(B)&&"WebKit"||!B&&/\bMSIE\b/i.test(t)&&("Mac OS"==F?"Tasman":"Trident")||"WebKit"==B&&/\bPlayStation\b(?! Vita\b)/i.test(N)&&"NetFront")&&(B=[a]),"IE"==N&&(a=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(N+=" Mobile",F="Windows Phone "+(/\+$/.test(a)?a:a+".x"),I.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(N="IE Mobile",F="Windows Phone 8.x",I.unshift("desktop mode"),j||(j=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=N&&"Trident"==B&&(a=/\brv:([\d.]+)/.exec(t))&&(N&&I.push("identifying as "+N+(j?" "+j:"")),N="IE",j=a[1]),L){if("global",l=null!=(d=n)?typeof d.global:"number",/^(?:boolean|number|string|undefined)$/.test(l)||"object"==l&&!d.global)g(a=n.runtime)==C?(N="Adobe AIR",F=a.flash.system.Capabilities.os):g(a=n.phantom)==w?(N="PhantomJS",j=(a=a.version||null)&&a.major+"."+a.minor+"."+a.patch):"number"==typeof M.documentMode&&(a=/\bTrident\/(\d+)/i.exec(t))?(j=[j,M.documentMode],(a=+a[1]+4)!=j[1]&&(I.push("IE "+j[1]+" mode"),B&&(B[1]=""),j[1]=a),j="IE"==N?String(j[1].toFixed(1)):j[0]):"number"==typeof M.documentMode&&/^(?:Chrome|Firefox)\b/.test(N)&&(I.push("masking as "+N+" "+j),N="IE",j="11.0",B=["Trident"],F="Windows");else if(T&&(x=(a=T.lang.System).getProperty("os.arch"),F=F||a.getProperty("os.name")+" "+a.getProperty("os.version")),E){try{j=n.require("ringo/engine").version.join("."),N="RingoJS"}catch(e){(a=n.system)&&a.global.system==n.system&&(N="Narwhal",F||(F=a[0].os||null))}N||(N="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(a=n.process)&&("object"==typeof a.versions&&("string"==typeof a.versions.electron?(I.push("Node "+a.versions.node),N="Electron",j=a.versions.electron):"string"==typeof a.versions.nw&&(I.push("Chromium "+j,"Node "+a.versions.node),N="NW.js",j=a.versions.nw)),N||(N="Node.js",x=a.arch,F=a.platform,j=(j=/[\d.]+/.exec(a.version))?j[0]:null));F=F&&m(F)}if(j&&(a=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(j)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(L&&i.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(A=/b/i.test(a)?"beta":"alpha",j=j.replace(RegExp(a+"\\+?$"),"")+("beta"==A?O:R)+(/\d+\+?/.exec(a)||"")),"Fennec"==N||"Firefox"==N&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(F))N="Firefox Mobile";else if("Maxthon"==N&&j)j=j.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(U))"Xbox 360"==U&&(F=null),"Xbox 360"==U&&/\bIEMobile\b/.test(t)&&I.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(N)&&(!N||U||/Browser|Mobi/.test(N))||"Windows CE"!=F&&!/Mobi/i.test(t))if("IE"==N&&L)try{null===n.external&&I.unshift("platform preview")}catch(e){I.unshift("embedded")}else(/\bBlackBerry\b/.test(U)||/\bBB10\b/.test(t))&&(a=(RegExp(U.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||j)?(F=((a=[a,/BB10/.test(t)])[1]?(U=null,G="BlackBerry"):"Device Software")+" "+a[0],j=null):this!=v&&"Wii"!=U&&(L&&P||/Opera/.test(N)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==N&&/\bOS X (?:\d+\.){2,}/.test(F)||"IE"==N&&(F&&!/^Win/.test(F)&&j>5.5||/\bWindows XP\b/.test(F)&&j>8||8==j&&!/\bTrident\b/.test(t)))&&!u.test(a=e.call(v,t.replace(u,"")+";"))&&a.name&&(a="ing as "+a.name+((a=a.version)?" "+a:""),u.test(N)?(/\bIE\b/.test(a)&&"Mac OS"==F&&(F=null),a="identify"+a):(a="mask"+a,N=D?m(D.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(a)&&(F=null),L||(j=null)),B=["Presto"],I.push(a));else N+=" Mobile";(a=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(a=[parseFloat(a.replace(/\.(\d)$/,".0$1")),a],"Safari"==N&&"+"==a[1].slice(-1)?(N="WebKit Nightly",A="alpha",j=a[1].slice(0,-1)):j!=a[1]&&j!=(a[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(j=null),a[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==a[0]&&537.36==a[2]&&parseFloat(a[1])>=28&&"WebKit"==B&&(B=["Blink"]),L&&(h||a[1])?(B&&(B[1]="like Chrome"),a=a[1]||((a=a[0])<530?1:a<532?2:a<532.05?3:a<533?4:a<534.03?5:a<534.07?6:a<534.1?7:a<534.13?8:a<534.16?9:a<534.24?10:a<534.3?11:a<535.01?12:a<535.02?"13+":a<535.07?15:a<535.11?16:a<535.19?17:a<536.05?18:a<536.1?19:a<537.01?20:a<537.11?"21+":a<537.13?23:a<537.18?24:a<537.24?25:a<537.36?26:"Blink"!=B?"27":"28")):(B&&(B[1]="like Safari"),a=(a=a[0])<400?1:a<500?2:a<526?3:a<533?4:a<534?"4+":a<535?5:a<537?6:a<538?7:a<601?8:a<602?9:a<604?10:a<606?11:a<608?12:"12"),B&&(B[1]+=" "+(a+="number"==typeof a?".x":/[.+]/.test(a)?"":"+")),"Safari"==N&&(!j||parseInt(j)>45)?j=a:"Chrome"==N&&/\bHeadlessChrome/i.test(t)&&I.unshift("headless")),"Opera"==N&&(a=/\bzbov|zvav$/.exec(F))?(N+=" ",I.unshift("desktop mode"),"zvav"==a?(N+="Mini",j=null):N+="Mobile",F=F.replace(RegExp(" *"+a+"$"),"")):"Safari"==N&&/\bChrome\b/.exec(B&&B[1])?(I.unshift("desktop mode"),N="Chrome Mobile",j=null,/\bOS X\b/.test(F)?(G="Apple",F="iOS 4.3+"):F=null):/\bSRWare Iron\b/.test(N)&&!j&&(j=H("Chrome")),j&&0==j.indexOf(a=/[\d.]+$/.exec(F))&&t.indexOf("/"+a+"-")>-1&&(F=k(F.replace(a,""))),F&&-1!=F.indexOf(N)&&!RegExp(N+" OS").test(F)&&(F=F.replace(RegExp(" *"+y(N)+" *"),"")),B&&!/\b(?:Avant|Nook)\b/.test(N)&&(/Browser|Lunascape|Maxthon/.test(N)||"Safari"!=N&&/^iOS/.test(F)&&/\bSafari\b/.test(B[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(N)&&B[1])&&(a=B[B.length-1])&&I.push(a),I.length&&(I=["("+I.join("; ")+")"]),G&&U&&U.indexOf(G)<0&&I.push("on "+G),U&&I.push((/^on /.test(I[I.length-1])?"":"on ")+U),F&&(a=/ ([\d.+]+)$/.exec(F),c=a&&"/"==F.charAt(F.length-a[0].length-1),F={architecture:32,family:a&&!c?F.replace(a[0],""):F,version:a?a[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(a=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(x))&&!/\bi686\b/i.test(x)?(F&&(F.architecture=64,F.family=F.family.replace(RegExp(" *"+a),"")),N&&(/\bWOW64\b/i.test(t)||L&&/\w(?:86|32)$/.test(i.cpuClass||i.platform)&&!/\bWin64; x64\b/i.test(t))&&I.unshift("32-bit")):F&&/^OS X/.test(F.family)&&"Chrome"==N&&parseFloat(j)>=39&&(F.architecture=64),t||(t=null);var V={};return V.description=t,V.layout=B&&B[0],V.manufacturer=G,V.name=N,V.prerelease=A,V.product=U,V.ua=t,V.version=N&&j,V.os=F||{architecture:null,family:null,version:null,toString:function(){return"null"}},V.parse=e,V.toString=function(){return this.description||""},V.version&&I.unshift(j),V.name&&I.unshift(N),F&&N&&(F!=String(F).split(" ")[0]||F!=N.split(" ")[0]&&!U)&&I.push(U?"("+F+")":"on "+F),I.length&&(V.description=I.join(" ")),V}();o.platform=C,void 0===(r=function(){return C}.call(t,n,t,e))||(e.exports=r)}.call(this)},2226:(e,t,n)=>{"use strict";var r=n(347);function i(e,t,n,i,o){var s=r.writeRtpDescription(e.kind,t);if(s+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),s+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var c="msid:"+(i?i.id:"-")+" "+a+"\r\n";s+="a="+c,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),s=r(t.parameters.apt,i);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var s=t.codecs[o];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),n.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function s(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function a(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}e.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var u=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var s=n.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(u.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(u.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),u.prototype.onicecandidate=null,u.prototype.onaddstream=null,u.prototype.ontrack=null,u.prototype.onremovestream=null,u.prototype.onsignalingstatechange=null,u.prototype.oniceconnectionstatechange=null,u.prototype.onconnectionstatechange=null,u.prototype.onicegatheringstatechange=null,u.prototype.onnegotiationneeded=null,u.prototype.ondatachannel=null,u.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},u.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},u.prototype.getConfiguration=function(){return this._config},u.prototype.getLocalStreams=function(){return this.localStreams},u.prototype.getRemoteStreams=function(){return this.remoteStreams},u.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},u.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},u.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},u.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},u.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},u.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},u.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},u.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},u.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var s=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:n};var a=e.candidate,c=!a||0===Object.keys(a).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),a.component=1,a.ufrag=o.getLocalParameters().usernameFragment;var d=r.writeCandidate(a);s.candidate=Object.assign(s.candidate,r.parseCandidate(d)),s.candidate.candidate=d,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var u=r.getMediaSections(i._localDescription.sdp);u[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+u.join("");var l=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",s),l&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},u.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},u.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},u.prototype._transceive=function(e,n,i){var s=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),i&&e.rtpReceiver&&s.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?s.encodings=e.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},u.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var a=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var s=i.transceivers[t],c=s.iceGatherer,d=s.iceTransport,u=s.dtlsTransport,l=s.localCapabilities,h=s.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||s.rejected)){var p=r.getIceParameters(e,n),f=r.getDtlsParameters(e,n);a&&(f.role="server"),i.usingBundle&&0!==t||(i._gather(s.mid,t),"new"===d.state&&d.start(c,p,a?"controlling":"controlled"),"new"===u.state&&u.start(f));var m=o(l,h);i._transceive(s,m.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},u.prototype.setRemoteDescription=function(i){var u=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!s("setRemoteDescription",i.type,u.signalingState)||u._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+u.signalingState));var l={};u.remoteStreams.forEach((function(e){l[e.id]=e}));var h=[],p=r.splitSections(i.sdp),f=p.shift(),m=r.matchPrefix(f,"a=ice-lite").length>0,v=r.matchPrefix(f,"a=group:BUNDLE ").length>0;u.usingBundle=v;var g=r.matchPrefix(f,"a=ice-options:")[0];return u.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(s,c){var d=r.splitLines(s),p=r.getKind(s),g=r.isRejected(s)&&0===r.matchPrefix(s,"a=bundle-only").length,y=d[0].substr(2).split(" ")[2],b=r.getDirection(s,f),k=r.parseMsid(s),C=r.getMid(s)||r.generateIdentifier();if(g||"application"===p&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))u.transceivers[c]={mid:C,kind:p,protocol:y,rejected:!0};else{var S,_,w,T,E,R,O,M,P;!g&&u.transceivers[c]&&u.transceivers[c].rejected&&(u.transceivers[c]=u._createTransceiver(p,!0));var D,x,I=r.parseRtpParameters(s);g||(D=r.getIceParameters(s,f),(x=r.getDtlsParameters(s,f)).role="client"),O=r.parseRtpEncodingParameters(s);var A=r.parseRtcpParameters(s),L=r.matchPrefix(s,"a=end-of-candidates",f).length>0,j=r.matchPrefix(s,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!g&&v&&c>0&&u.transceivers[c]&&(u._disposeIceAndDtlsTransports(c),u.transceivers[c].iceGatherer=u.transceivers[0].iceGatherer,u.transceivers[c].iceTransport=u.transceivers[0].iceTransport,u.transceivers[c].dtlsTransport=u.transceivers[0].dtlsTransport,u.transceivers[c].rtpSender&&u.transceivers[c].rtpSender.setTransport(u.transceivers[0].dtlsTransport),u.transceivers[c].rtpReceiver&&u.transceivers[c].rtpReceiver.setTransport(u.transceivers[0].dtlsTransport)),"offer"!==i.type||g)"answer"!==i.type||g||(_=(S=u.transceivers[c]).iceGatherer,w=S.iceTransport,T=S.dtlsTransport,E=S.rtpReceiver,R=S.sendEncodingParameters,M=S.localCapabilities,u.transceivers[c].recvEncodingParameters=O,u.transceivers[c].remoteCapabilities=I,u.transceivers[c].rtcpParameters=A,j.length&&"new"===w.state&&(!m&&!L||v&&0!==c?j.forEach((function(e){a(S.iceTransport,e)})):w.setRemoteCandidates(j)),v&&0!==c||("new"===w.state&&w.start(_,D,"controlling"),"new"===T.state&&T.start(x)),!o(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,u._transceive(S,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!E||"sendrecv"!==b&&"sendonly"!==b?delete S.rtpReceiver:(P=E.track,k?(l[k.stream]||(l[k.stream]=new e.MediaStream),n(P,l[k.stream]),h.push([P,E,l[k.stream]])):(l.default||(l.default=new e.MediaStream),n(P,l.default),h.push([P,E,l.default]))));else{(S=u.transceivers[c]||u._createTransceiver(p)).mid=C,S.iceGatherer||(S.iceGatherer=u._createIceGatherer(c,v)),j.length&&"new"===S.iceTransport.state&&(!L||v&&0!==c?j.forEach((function(e){a(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(j)),M=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(M.codecs=M.codecs.filter((function(e){return"rtx"!==e.name}))),R=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var B,N=!1;"sendrecv"===b||"sendonly"===b?(N=!S.rtpReceiver,E=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,p),N&&(P=E.track,k&&"-"===k.stream||(k?(l[k.stream]||(l[k.stream]=new e.MediaStream,Object.defineProperty(l[k.stream],"id",{get:function(){return k.stream}})),Object.defineProperty(P,"id",{get:function(){return k.track}}),B=l[k.stream]):(l.default||(l.default=new e.MediaStream),B=l.default)),B&&(n(P,B),S.associatedRemoteMediaStreams.push(B)),h.push([P,E,B]))):S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),S.associatedRemoteMediaStreams=[]),S.localCapabilities=M,S.remoteCapabilities=I,S.rtpReceiver=E,S.rtcpParameters=A,S.sendEncodingParameters=R,S.recvEncodingParameters=O,u._transceive(u.transceivers[c],!1,N)}}})),void 0===u._dtlsRole&&(u._dtlsRole="offer"===i.type?"active":"passive"),u._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?u._updateSignalingState("have-remote-offer"):u._updateSignalingState("stable"),Object.keys(l).forEach((function(t){var n=l[t];if(n.getTracks().length){if(-1===u.remoteStreams.indexOf(n)){u.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){u._dispatchEvent("addstream",r)}))}h.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&d(u,t,r,[n])}))}})),h.forEach((function(e){e[2]||d(u,e[0],e[1],[])})),e.setTimeout((function(){u&&u.transceivers&&u.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},u.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},u.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},u.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},u.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},u.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},u.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter((function(e){return"audio"===e.kind})).length,s=n.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(o=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(s=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));o>0||s>0;)o>0&&(n._createTransceiver("audio"),o--),s>0&&(n._createTransceiver("video"),s--);var d=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,o){var s=i.track,a=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var d=e.RTCRtpSender.getCapabilities(a);t<15019&&(d.codecs=d.codecs.filter((function(e){return"rtx"!==e.name}))),d.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),d.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var u=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];s&&t>=15019&&"video"===a&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,a)),i.localCapabilities=d,i.sendEncodingParameters=u})),"max-compat"!==n._config.bundlePolicy&&(d+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){d+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var u=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(u)},u.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var s=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(s+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var a=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var d=o(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=i(e,d,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(d)},u.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,o){if(!n._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===e.sdpMid){s=d;break}var u=n.transceivers[s];if(!u)return o(c("OperationError","Can not add ICE candidate"));if(u.rejected)return i();var l=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port))return i();if(l.component&&1!==l.component)return i();if((0===s||s>0&&u.iceTransport!==n.transceivers[0].iceTransport)&&!a(u.iceTransport,l))return o(c("OperationError","Can not add ICE candidate"));var h=e.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[s]+="a="+(l.type?h:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);i()}))},u.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])})),t}))}}}));var l=["createOffer","createAnswer"];return l.forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(l=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),u}},8995:(e,t)=>{"use strict";const{hasOwnProperty:n}=Object.prototype,r=p();r.configure=p,r.stringify=r,r.default=r,t.stringify=r,t.configure=p,e.exports=r;const i=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function o(e){return e.length<5e3&&!i.test(e)?`"${e}"`:JSON.stringify(e)}function s(e,t){if(e.length>200||t)return e.sort(t);for(let t=1;t<e.length;t++){const n=e[t];let r=t;for(;0!==r&&e[r-1]>n;)e[r]=e[r-1],r--;e[r]=n}return e}const a=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function c(e){return void 0!==a.call(e)&&0!==e.length}function d(e,t,n){e.length<n&&(n=e.length);const r=","===t?"":" ";let i=`"0":${r}${e[0]}`;for(let o=1;o<n;o++)i+=`${t}"${o}":${r}${e[o]}`;return i}function u(e,t){let r;if(n.call(e,t)){if(r=e[t],"number"!=typeof r)throw new TypeError(`The "${t}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${t}" argument must be an integer`);if(r<1)throw new RangeError(`The "${t}" argument must be >= 1`)}return void 0===r?1/0:r}function l(e){return 1===e?"1 item":`${e} items`}function h(e){const t=new Set;for(const n of e)"string"!=typeof n&&"number"!=typeof n||t.add(String(n));return t}function p(e){const t=function(e){if(n.call(e,"strict")){const t=e.strict;if("boolean"!=typeof t)throw new TypeError('The "strict" argument must be of type boolean');if(t)return e=>{let t="Object can not safely be stringified. Received type "+typeof e;throw"function"!=typeof e&&(t+=` (${e.toString()})`),new Error(t)}}}(e={...e});t&&(void 0===e.bigint&&(e.bigint=!1),"circularValue"in e||(e.circularValue=Error));const r=function(e){if(n.call(e,"circularValue")){const t=e.circularValue;if("string"==typeof t)return`"${t}"`;if(null==t)return t;if(t===Error||t===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}(e),i=function(e,t){let r;if(n.call(e,t)&&(r=e[t],"boolean"!=typeof r))throw new TypeError('The "bigint" argument must be of type boolean');return void 0===r||r}(e,"bigint"),a=function(e){let t;if(n.call(e,"deterministic")&&(t=e.deterministic,"boolean"!=typeof t&&"function"!=typeof t))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return void 0===t||t}(e),p="function"==typeof a?a:void 0,f=u(e,"maximumDepth"),m=u(e,"maximumBreadth");function v(e,n,d,u,h,g){let y=n[e];switch("object"==typeof y&&null!==y&&"function"==typeof y.toJSON&&(y=y.toJSON(e)),y=u.call(n,e,y),typeof y){case"string":return o(y);case"object":{if(null===y)return"null";if(-1!==d.indexOf(y))return r;let e="",t=",";const n=g;if(Array.isArray(y)){if(0===y.length)return"[]";if(f<d.length+1)return'"[Array]"';d.push(y),""!==h&&(e+=`\n${g+=h}`,t=`,\n${g}`);const r=Math.min(y.length,m);let i=0;for(;i<r-1;i++){const n=v(String(i),y,d,u,h,g);e+=void 0!==n?n:"null",e+=t}const o=v(String(i),y,d,u,h,g);return e+=void 0!==o?o:"null",y.length-1>m&&(e+=`${t}"... ${l(y.length-m-1)} not stringified"`),""!==h&&(e+=`\n${n}`),d.pop(),`[${e}]`}let i=Object.keys(y);const b=i.length;if(0===b)return"{}";if(f<d.length+1)return'"[Object]"';let k="",C="";""!==h&&(t=`,\n${g+=h}`,k=" ");const S=Math.min(b,m);a&&!c(y)&&(i=s(i,p)),d.push(y);for(let n=0;n<S;n++){const r=i[n],s=v(r,y,d,u,h,g);void 0!==s&&(e+=`${C}${o(r)}:${k}${s}`,C=t)}return b>m&&(e+=`${C}"...":${k}"${l(b-m)} not stringified"`,C=t),""!==h&&C.length>1&&(e=`\n${g}${e}\n${n}`),d.pop(),`{${e}}`}case"number":return isFinite(y)?String(y):t?t(y):"null";case"boolean":return!0===y?"true":"false";case"undefined":return;case"bigint":if(i)return String(y);default:return t?t(y):void 0}}function g(e,n,s,a,c,d){switch("object"==typeof n&&null!==n&&"function"==typeof n.toJSON&&(n=n.toJSON(e)),typeof n){case"string":return o(n);case"object":{if(null===n)return"null";if(-1!==s.indexOf(n))return r;const e=d;let t="",i=",";if(Array.isArray(n)){if(0===n.length)return"[]";if(f<s.length+1)return'"[Array]"';s.push(n),""!==c&&(t+=`\n${d+=c}`,i=`,\n${d}`);const r=Math.min(n.length,m);let o=0;for(;o<r-1;o++){const e=g(String(o),n[o],s,a,c,d);t+=void 0!==e?e:"null",t+=i}const u=g(String(o),n[o],s,a,c,d);return t+=void 0!==u?u:"null",n.length-1>m&&(t+=`${i}"... ${l(n.length-m-1)} not stringified"`),""!==c&&(t+=`\n${e}`),s.pop(),`[${t}]`}s.push(n);let u="";""!==c&&(i=`,\n${d+=c}`,u=" ");let h="";for(const e of a){const r=g(e,n[e],s,a,c,d);void 0!==r&&(t+=`${h}${o(e)}:${u}${r}`,h=i)}return""!==c&&h.length>1&&(t=`\n${d}${t}\n${e}`),s.pop(),`{${t}}`}case"number":return isFinite(n)?String(n):t?t(n):"null";case"boolean":return!0===n?"true":"false";case"undefined":return;case"bigint":if(i)return String(n);default:return t?t(n):void 0}}function y(e,n,u,h,v){switch(typeof n){case"string":return o(n);case"object":{if(null===n)return"null";if("function"==typeof n.toJSON){if("object"!=typeof(n=n.toJSON(e)))return y(e,n,u,h,v);if(null===n)return"null"}if(-1!==u.indexOf(n))return r;const t=v;if(Array.isArray(n)){if(0===n.length)return"[]";if(f<u.length+1)return'"[Array]"';u.push(n);let e=`\n${v+=h}`;const r=`,\n${v}`,i=Math.min(n.length,m);let o=0;for(;o<i-1;o++){const t=y(String(o),n[o],u,h,v);e+=void 0!==t?t:"null",e+=r}const s=y(String(o),n[o],u,h,v);return e+=void 0!==s?s:"null",n.length-1>m&&(e+=`${r}"... ${l(n.length-m-1)} not stringified"`),e+=`\n${t}`,u.pop(),`[${e}]`}let i=Object.keys(n);const g=i.length;if(0===g)return"{}";if(f<u.length+1)return'"[Object]"';const b=`,\n${v+=h}`;let k="",C="",S=Math.min(g,m);c(n)&&(k+=d(n,b,m),i=i.slice(n.length),S-=n.length,C=b),a&&(i=s(i,p)),u.push(n);for(let e=0;e<S;e++){const t=i[e],r=y(t,n[t],u,h,v);void 0!==r&&(k+=`${C}${o(t)}: ${r}`,C=b)}return g>m&&(k+=`${C}"...": "${l(g-m)} not stringified"`,C=b),""!==C&&(k=`\n${v}${k}\n${t}`),u.pop(),`{${k}}`}case"number":return isFinite(n)?String(n):t?t(n):"null";case"boolean":return!0===n?"true":"false";case"undefined":return;case"bigint":if(i)return String(n);default:return t?t(n):void 0}}function b(e,n,u){switch(typeof n){case"string":return o(n);case"object":{if(null===n)return"null";if("function"==typeof n.toJSON){if("object"!=typeof(n=n.toJSON(e)))return b(e,n,u);if(null===n)return"null"}if(-1!==u.indexOf(n))return r;let t="";const i=void 0!==n.length;if(i&&Array.isArray(n)){if(0===n.length)return"[]";if(f<u.length+1)return'"[Array]"';u.push(n);const e=Math.min(n.length,m);let r=0;for(;r<e-1;r++){const e=b(String(r),n[r],u);t+=void 0!==e?e:"null",t+=","}const i=b(String(r),n[r],u);return t+=void 0!==i?i:"null",n.length-1>m&&(t+=`,"... ${l(n.length-m-1)} not stringified"`),u.pop(),`[${t}]`}let h=Object.keys(n);const v=h.length;if(0===v)return"{}";if(f<u.length+1)return'"[Object]"';let g="",y=Math.min(v,m);i&&c(n)&&(t+=d(n,",",m),h=h.slice(n.length),y-=n.length,g=","),a&&(h=s(h,p)),u.push(n);for(let e=0;e<y;e++){const r=h[e],i=b(r,n[r],u);void 0!==i&&(t+=`${g}${o(r)}:${i}`,g=",")}return v>m&&(t+=`${g}"...":"${l(v-m)} not stringified"`),u.pop(),`{${t}}`}case"number":return isFinite(n)?String(n):t?t(n):"null";case"boolean":return!0===n?"true":"false";case"undefined":return;case"bigint":if(i)return String(n);default:return t?t(n):void 0}}return function(e,t,n){if(arguments.length>1){let r="";if("number"==typeof n?r=" ".repeat(Math.min(n,10)):"string"==typeof n&&(r=n.slice(0,10)),null!=t){if("function"==typeof t)return v("",{"":e},[],t,r,"");if(Array.isArray(t))return g("",e,[],h(t),r,"")}if(0!==r.length)return y("",e,[],r,"")}return b("",e,[])}}},347:e=>{"use strict";var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));var i=0;return n.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",n.headerExtensions&&n.headerExtensions.forEach((function(e){r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,d=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(n=d[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),r.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&c&&r.push({ssrc:c});var u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=u}))),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(n=parseInt(i[0].substr(19),10)),isNaN(n)&&(n=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};if(t.matchPrefix(e,"a=sctpmap:").length>0){var s=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,r,i){var o=t.writeRtpDescription(e.kind,n);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t},6994:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>fe});var r={};n.r(r),n.d(r,{fixNegotiationNeeded:()=>D,shimAddTrackRemoveTrack:()=>M,shimAddTrackRemoveTrackWithNative:()=>O,shimGetDisplayMedia:()=>S,shimGetSendersWithDtmf:()=>T,shimGetStats:()=>E,shimGetUserMedia:()=>C,shimMediaStream:()=>_,shimOnTrack:()=>w,shimPeerConnection:()=>P,shimSenderReceiverGetStats:()=>R});var i={};n.r(i),n.d(i,{shimGetDisplayMedia:()=>L,shimGetUserMedia:()=>A,shimPeerConnection:()=>j,shimReplaceTrack:()=>B});var o={};n.r(o),n.d(o,{shimAddTransceiver:()=>K,shimCreateAnswer:()=>$,shimCreateOffer:()=>Y,shimGetDisplayMedia:()=>U,shimGetParameters:()=>z,shimGetUserMedia:()=>N,shimOnTrack:()=>G,shimPeerConnection:()=>F,shimRTCDataChannel:()=>q,shimReceiverGetStats:()=>H,shimRemoveStream:()=>V,shimSenderGetStats:()=>W});var s={};n.r(s),n.d(s,{shimAudioContext:()=>ie,shimCallbacksAPI:()=>Q,shimConstraints:()=>ee,shimCreateOfferLegacy:()=>re,shimGetUserMedia:()=>Z,shimLocalStreamsAPI:()=>X,shimRTCIceServerUrls:()=>te,shimRemoteStreamsAPI:()=>J,shimTrackEventTransceiver:()=>ne});var a={};n.r(a),n.d(a,{removeExtmapAllowMixed:()=>le,shimAddIceCandidateNullOrEmpty:()=>he,shimConnectionState:()=>ue,shimMaxMessageSize:()=>ce,shimRTCIceCandidate:()=>ae,shimSendThrowTypeError:()=>de});let c=!0,d=!0;function u(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function l(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function h(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(c=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function p(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(d=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function f(){if("object"==typeof window){if(c)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function m(e,t){d&&console.warn(e+" is deprecated, please use "+t+" instead.")}function v(e){return"[object Object]"===Object.prototype.toString.call(e)}function g(e){return v(e)?Object.keys(e).reduce((function(t,n){const r=v(e[n]),i=r?g(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})}),{}):e}function y(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((r=>{r.endsWith("Id")?y(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((t=>{y(e,e.get(t),n)}))})))}function b(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((n=>{n.type===r&&n.trackId===t.id&&y(e,n,i)}))})),i}const k=f;function C(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let s=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&n.length&&t.includes("back")&&(s=n[n.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=r(e.video),k("chrome: "+JSON.stringify(e)),i(e)}))}e.video=r(e.video)}return k("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{r&&r(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return i(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function S(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function _(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function w(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})),t.stream.getTracks().forEach((n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else l(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function T(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function E(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const r=function(e){n(o(i(e)))};return t.apply(this,[r,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(o(i(t)))},n])})).then(n,r)}}function R(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>b(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),l(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>b(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach((n=>{n.track===e&&(t?r=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?r=!0:n=t),t.track===e))),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function O(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function M(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return O(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function s(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find((e=>e.track===t));if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=r[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=c.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function P(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function D(e,t){l(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var x=n(2226),I=n.n(x);function A(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e))))}}function L(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function j(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=I()(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((e=>{if(e&&(e.urls||e.url)){let t=e.urls||e.url;e.url&&!e.urls&&m("RTCIceServer.url","RTCIceServer.urls");const r="string"==typeof t;return r&&(t=[t]),t=t.filter((e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=r?t[0]:t,!!t.length}}))}(e.iceServers,t.version),f("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function B(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function N(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){m("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function U(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function G(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function F(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return r.apply(this,[e||null]).then((e=>{if(t.version<53&&!i)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(i,o)}}function W(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function H(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),l(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function V(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){m("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function q(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function K(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return r})}function z(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Y(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function $(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function X(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function J(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function Q(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};let a=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=a,a=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=a,a=function(e,t,n){const r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=a}function Z(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(ee(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function ee(e){return e&&void 0!==e.video?Object.assign({},e,{video:g(e.video)}):e}function te(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(m("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function ne(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function re(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function ie(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var oe=n(347),se=n.n(oe);function ae(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=se().parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,l(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function ce(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=function(e){if(!e||!e.sdp)return!1;const t=se().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=se().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},r=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n},i=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=se().matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const e=r(arguments[0]),t=i(e),n=o(arguments[0],e);let s;s=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function de(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},l(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function ue(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function le(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function he(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}const pe=function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const n=f,c=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=u(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=u(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=u(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=u(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),d={browserDetails:c,commonShim:a,extractVersion:u,disableLog:h,disableWarnings:p};switch(c.browser){case"chrome":if(!r||!P||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),d;if(null===c.version)return n("Chrome shim can not determine version, not shimming."),d;n("adapter.js shimming chrome."),d.browserShim=r,he(e,c),C(e,c),_(e),P(e,c),w(e),M(e,c),T(e),E(e),R(e),D(e,c),ae(e),ue(e),ce(e,c),de(e),le(e,c);break;case"firefox":if(!o||!F||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),d;n("adapter.js shimming firefox."),d.browserShim=o,he(e,c),N(e,c),F(e,c),G(e),V(e),W(e),H(e),q(e),K(e),z(e),Y(e),$(e),ae(e),ue(e),ce(e,c),de(e);break;case"edge":if(!i||!j||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),d;n("adapter.js shimming edge."),d.browserShim=i,A(e),L(e),j(e,c),B(e),ce(e,c),de(e);break;case"safari":if(!s||!t.shimSafari)return n("Safari shim is not included in this adapter release."),d;n("adapter.js shimming safari."),d.browserShim=s,he(e,c),te(e),re(e),Q(e),X(e),J(e),ne(e),Z(e),ie(e),ae(e),ce(e,c),de(e),le(e,c);break;default:n("Unsupported browser!")}return d}({window:"undefined"==typeof window?void 0:window}),fe=pe},429:()=>{},3139:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.validate=t.v7=t.v6ToV1=t.v6=t.v5=t.v4=t.v3=t.v1ToV6=t.v1=t.stringify=t.parse=t.NIL=t.MAX=void 0;var r=n(7958);Object.defineProperty(t,"MAX",{enumerable:!0,get:function(){return r.default}});var i=n(2294);Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return i.default}});var o=n(1566);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return o.default}});var s=n(963);Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return s.default}});var a=n(2787);Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return a.default}});var c=n(9614);Object.defineProperty(t,"v1ToV6",{enumerable:!0,get:function(){return c.default}});var d=n(3442);Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return d.default}});var u=n(7051);Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return u.default}});var l=n(4246);Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return l.default}});var h=n(102);Object.defineProperty(t,"v6",{enumerable:!0,get:function(){return h.default}});var p=n(6668);Object.defineProperty(t,"v6ToV1",{enumerable:!0,get:function(){return p.default}});var f=n(7917);Object.defineProperty(t,"v7",{enumerable:!0,get:function(){return f.default}});var m=n(8830);Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return m.default}});var v=n(7725);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return v.default}})},7958:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="ffffffff-ffff-ffff-ffff-ffffffffffff"},7003:(e,t)=>{"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function r(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,i,o,s){return r((a=r(r(t,e),r(i,s)))<<(c=o)|a>>>32-c,n);var a,c}function o(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function c(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(e){const t=new Uint8Array(4*e.length);for(let n=0;n<4*e.length;n++)t[n]=e[n>>2]>>>n%4*8&255;return t}(function(e,t){const i=new Uint32Array(n(t)).fill(0);i.set(e),i[t>>5]|=128<<t%32,i[i.length-1]=t,e=i;let d=1732584193,u=-271733879,l=-1732584194,h=271733878;for(let t=0;t<e.length;t+=16){const n=d,i=u,p=l,f=h;d=o(d,u,l,h,e[t],7,-680876936),h=o(h,d,u,l,e[t+1],12,-389564586),l=o(l,h,d,u,e[t+2],17,606105819),u=o(u,l,h,d,e[t+3],22,-1044525330),d=o(d,u,l,h,e[t+4],7,-176418897),h=o(h,d,u,l,e[t+5],12,1200080426),l=o(l,h,d,u,e[t+6],17,-1473231341),u=o(u,l,h,d,e[t+7],22,-45705983),d=o(d,u,l,h,e[t+8],7,1770035416),h=o(h,d,u,l,e[t+9],12,-1958414417),l=o(l,h,d,u,e[t+10],17,-42063),u=o(u,l,h,d,e[t+11],22,-1990404162),d=o(d,u,l,h,e[t+12],7,1804603682),h=o(h,d,u,l,e[t+13],12,-40341101),l=o(l,h,d,u,e[t+14],17,-1502002290),u=o(u,l,h,d,e[t+15],22,1236535329),d=s(d,u,l,h,e[t+1],5,-165796510),h=s(h,d,u,l,e[t+6],9,-1069501632),l=s(l,h,d,u,e[t+11],14,643717713),u=s(u,l,h,d,e[t],20,-373897302),d=s(d,u,l,h,e[t+5],5,-701558691),h=s(h,d,u,l,e[t+10],9,38016083),l=s(l,h,d,u,e[t+15],14,-660478335),u=s(u,l,h,d,e[t+4],20,-405537848),d=s(d,u,l,h,e[t+9],5,568446438),h=s(h,d,u,l,e[t+14],9,-1019803690),l=s(l,h,d,u,e[t+3],14,-187363961),u=s(u,l,h,d,e[t+8],20,1163531501),d=s(d,u,l,h,e[t+13],5,-1444681467),h=s(h,d,u,l,e[t+2],9,-51403784),l=s(l,h,d,u,e[t+7],14,1735328473),u=s(u,l,h,d,e[t+12],20,-1926607734),d=a(d,u,l,h,e[t+5],4,-378558),h=a(h,d,u,l,e[t+8],11,-2022574463),l=a(l,h,d,u,e[t+11],16,1839030562),u=a(u,l,h,d,e[t+14],23,-35309556),d=a(d,u,l,h,e[t+1],4,-1530992060),h=a(h,d,u,l,e[t+4],11,1272893353),l=a(l,h,d,u,e[t+7],16,-155497632),u=a(u,l,h,d,e[t+10],23,-1094730640),d=a(d,u,l,h,e[t+13],4,681279174),h=a(h,d,u,l,e[t],11,-358537222),l=a(l,h,d,u,e[t+3],16,-722521979),u=a(u,l,h,d,e[t+6],23,76029189),d=a(d,u,l,h,e[t+9],4,-640364487),h=a(h,d,u,l,e[t+12],11,-421815835),l=a(l,h,d,u,e[t+15],16,530742520),u=a(u,l,h,d,e[t+2],23,-995338651),d=c(d,u,l,h,e[t],6,-198630844),h=c(h,d,u,l,e[t+7],10,1126891415),l=c(l,h,d,u,e[t+14],15,-1416354905),u=c(u,l,h,d,e[t+5],21,-57434055),d=c(d,u,l,h,e[t+12],6,1700485571),h=c(h,d,u,l,e[t+3],10,-1894986606),l=c(l,h,d,u,e[t+10],15,-1051523),u=c(u,l,h,d,e[t+1],21,-2054922799),d=c(d,u,l,h,e[t+8],6,1873313359),h=c(h,d,u,l,e[t+15],10,-30611744),l=c(l,h,d,u,e[t+6],15,-1560198380),u=c(u,l,h,d,e[t+13],21,1309151649),d=c(d,u,l,h,e[t+4],6,-145523070),h=c(h,d,u,l,e[t+11],10,-1120210379),l=c(l,h,d,u,e[t+2],15,718787259),u=c(u,l,h,d,e[t+9],21,-343485551),d=r(d,n),u=r(u,i),l=r(l,p),h=r(h,f)}return Uint32Array.of(d,u,l,h)}(function(e){if(0===e.length)return new Uint32Array;const t=new Uint32Array(n(8*e.length)).fill(0);for(let n=0;n<e.length;n++)t[n>>2]|=(255&e[n])<<n%4*8;return t}(e),8*e.length))}},5487:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);t.default={randomUUID:n}},2294:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="00000000-0000-0000-0000-000000000000"},1566:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8830);t.default=function(e){if(!(0,r.default)(e))throw TypeError("Invalid UUID");let t;return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,255&t,(t=parseInt(e.slice(9,13),16))>>>8,255&t,(t=parseInt(e.slice(14,18),16))>>>8,255&t,(t=parseInt(e.slice(19,23),16))>>>8,255&t,(t=parseInt(e.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,255&t)}},6009:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i},1553:(e,t)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0});const r=new Uint8Array(16);t.default=function(){if(!n){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");n=crypto.getRandomValues.bind(crypto)}return n(r)}},7715:(e,t)=>{"use strict";function n(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function r(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520],o=new Uint8Array(e.length+1);o.set(e),o[e.length]=128;const s=(e=o).length/4+2,a=Math.ceil(s/16),c=new Array(a);for(let t=0;t<a;++t){const n=new Uint32Array(16);for(let r=0;r<16;++r)n[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];c[t]=n}c[a-1][14]=8*(e.length-1)/Math.pow(2,32),c[a-1][14]=Math.floor(c[a-1][14]),c[a-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<a;++e){const o=new Uint32Array(80);for(let t=0;t<16;++t)o[t]=c[e][t];for(let e=16;e<80;++e)o[e]=r(o[e-3]^o[e-8]^o[e-14]^o[e-16],1);let s=i[0],a=i[1],d=i[2],u=i[3],l=i[4];for(let e=0;e<80;++e){const i=Math.floor(e/20),c=r(s,5)+n(i,a,d,u)+l+t[i]+o[e]>>>0;l=u,u=d,d=r(a,30)>>>0,a=s,s=c}i[0]=i[0]+s>>>0,i[1]=i[1]+a>>>0,i[2]=i[2]+d>>>0,i[3]=i[3]+u>>>0,i[4]=i[4]+l>>>0}return Uint8Array.of(i[0]>>24,i[0]>>16,i[0]>>8,i[0],i[1]>>24,i[1]>>16,i[1]>>8,i[1],i[2]>>24,i[2]>>16,i[2]>>8,i[2],i[3]>>24,i[3]>>16,i[3]>>8,i[3],i[4]>>24,i[4]>>16,i[4]>>8,i[4])}},963:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeStringify=void 0;const r=n(8830),i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function o(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}t.unsafeStringify=o,t.default=function(e,t=0){const n=o(e,t);if(!(0,r.default)(n))throw TypeError("Stringified UUID is invalid");return n}},2787:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateV1State=void 0;const r=n(1553),i=n(963),o={};function s(e,t,n){return e.msecs??=-1/0,e.nsecs??=0,t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=n.slice(10,16),e.node[0]|=1,e.clockseq=16383&(n[8]<<8|n[9])),e.msecs=t,e}function a(e,t,n,r,i,o,s=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(o){if(s<0||s+16>o.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`)}else o=new Uint8Array(16),s=0;t??=Date.now(),n??=0,r??=16383&(e[8]<<8|e[9]),i??=e.slice(10,16);const a=(1e4*(268435455&(t+=122192928e5))+n)%4294967296;o[s++]=a>>>24&255,o[s++]=a>>>16&255,o[s++]=a>>>8&255,o[s++]=255&a;const c=t/4294967296*1e4&268435455;o[s++]=c>>>8&255,o[s++]=255&c,o[s++]=c>>>24&15|16,o[s++]=c>>>16&255,o[s++]=r>>>8|128,o[s++]=255&r;for(let e=0;e<6;++e)o[s++]=i[e];return o}t.updateV1State=s,t.default=function(e,t,n){let c;const d=e?._v6??!1;if(e){const t=Object.keys(e);1===t.length&&"_v6"===t[0]&&(e=void 0)}if(e)c=a(e.random??e.rng?.()??(0,r.default)(),e.msecs,e.nsecs,e.clockseq,e.node,t,n);else{const e=Date.now(),i=(0,r.default)();s(o,e,i),c=a(i,o.msecs,o.nsecs,d?void 0:o.clockseq,d?void 0:o.node,t,n)}return t??(0,i.unsafeStringify)(c)}},9614:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1566),i=n(963);t.default=function(e){const t=(n="string"==typeof e?(0,r.default)(e):e,Uint8Array.of((15&n[6])<<4|n[7]>>4&15,(15&n[7])<<4|(240&n[4])>>4,(15&n[4])<<4|(240&n[5])>>4,(15&n[5])<<4|(240&n[0])>>4,(15&n[0])<<4|(240&n[1])>>4,(15&n[1])<<4|(240&n[2])>>4,96|15&n[2],n[3],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]));var n;return"string"==typeof e?(0,i.unsafeStringify)(t):t}},3442:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;const r=n(7003),i=n(5646);var o=n(5646);function s(e,t,n,o){return(0,i.default)(48,r.default,e,t,n,o)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return o.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return o.URL}}),s.DNS=i.DNS,s.URL=i.URL,t.default=s},5646:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=t.stringToBytes=void 0;const r=n(1566),i=n(963);function o(e){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t}t.stringToBytes=o,t.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",t.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",t.default=function(e,t,n,s,a,c){const d="string"==typeof n?o(n):n,u="string"==typeof s?(0,r.default)(s):s;if("string"==typeof s&&(s=(0,r.default)(s)),16!==s?.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+d.length);if(l.set(u),l.set(d,u.length),l=t(l),l[6]=15&l[6]|e,l[8]=63&l[8]|128,a){c=c||0;for(let e=0;e<16;++e)a[c+e]=l[e];return a}return(0,i.unsafeStringify)(l)}},7051:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5487),i=n(1553),o=n(963);t.default=function(e,t,n){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();const s=(e=e||{}).random??e.rng?.()??(0,i.default)();if(s.length<16)throw new Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=s[e];return t}return(0,o.unsafeStringify)(s)}},4246:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;const r=n(7715),i=n(5646);var o=n(5646);function s(e,t,n,o){return(0,i.default)(80,r.default,e,t,n,o)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return o.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return o.URL}}),s.DNS=i.DNS,s.URL=i.URL,t.default=s},102:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(963),i=n(2787),o=n(9614);t.default=function(e,t,n){e??={},n??=0;let s=(0,i.default)({...e,_v6:!0},new Uint8Array(16));if(s=(0,o.default)(s),t){for(let e=0;e<16;e++)t[n+e]=s[e];return t}return(0,r.unsafeStringify)(s)}},6668:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1566),i=n(963);t.default=function(e){const t=(n="string"==typeof e?(0,r.default)(e):e,Uint8Array.of((15&n[3])<<4|n[4]>>4&15,(15&n[4])<<4|(240&n[5])>>4,(15&n[5])<<4|15&n[6],n[7],(15&n[1])<<4|(240&n[2])>>4,(15&n[2])<<4|(240&n[3])>>4,16|(240&n[0])>>4,(15&n[0])<<4|(240&n[1])>>4,n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]));var n;return"string"==typeof e?(0,i.unsafeStringify)(t):t}},7917:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateV7State=void 0;const r=n(1553),i=n(963),o={};function s(e,t,n){return e.msecs??=-1/0,e.seq??=0,t>e.msecs?(e.seq=n[6]<<23|n[7]<<16|n[8]<<8|n[9],e.msecs=t):(e.seq=e.seq+1|0,0===e.seq&&e.msecs++),e}function a(e,t,n,r,i=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(r){if(i<0||i+16>r.length)throw new RangeError(`UUID byte range ${i}:${i+15} is out of buffer bounds`)}else r=new Uint8Array(16),i=0;return t??=Date.now(),n??=127*e[6]<<24|e[7]<<16|e[8]<<8|e[9],r[i++]=t/1099511627776&255,r[i++]=t/4294967296&255,r[i++]=t/16777216&255,r[i++]=t/65536&255,r[i++]=t/256&255,r[i++]=255&t,r[i++]=112|n>>>28&15,r[i++]=n>>>20&255,r[i++]=128|n>>>14&63,r[i++]=n>>>6&255,r[i++]=n<<2&255|3&e[10],r[i++]=e[11],r[i++]=e[12],r[i++]=e[13],r[i++]=e[14],r[i++]=e[15],r}t.updateV7State=s,t.default=function(e,t,n){let c;if(e)c=a(e.random??e.rng?.()??(0,r.default)(),e.msecs,e.seq,t,n);else{const e=Date.now(),i=(0,r.default)();s(o,e,i),c=a(i,o.msecs,o.seq,t,n)}return t??(0,i.unsafeStringify)(c)}},8830:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6009);t.default=function(e){return"string"==typeof e&&r.default.test(e)}},7725:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8830);t.default=function(e){if(!(0,r.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n(4993)})()}));